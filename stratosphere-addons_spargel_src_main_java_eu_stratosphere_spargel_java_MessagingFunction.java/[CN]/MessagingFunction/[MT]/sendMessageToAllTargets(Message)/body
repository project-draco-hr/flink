{
  if (edgesUsed) {
    throw new IllegalStateException("Can use either 'getOutgoingEdges()' or 'sendMessageToAllTargets()'.");
  }
  edgesUsed=true;
  while (edges.hasNext()) {
    Record next=edges.next();
    VertexKey k=next.getField(1,this.keyClass);
    outValue.setField(0,k);
    outValue.setField(1,m);
    out.collect(outValue);
  }
}
