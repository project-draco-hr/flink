{
  StreamRecord record1=new ArrayStreamRecord(1).setTuple(0,new Tuple1<String>("R1")).setId(1);
  StreamRecord record2=new ArrayStreamRecord(1).setTuple(0,new Tuple1<String>("R2")).setId(1);
  buffer.addToAckCounter(record1.getId());
  buffer.addToAckCounter(record2.getId());
  assertEquals(2,buffer.ackCounter.size());
  buffer.removeFromAckCounter(record2.getId());
  assertEquals(1,buffer.ackCounter.size());
  assertArrayEquals(new int[]{0,1,2,2},buffer.ackCounter.get(record1.getId()));
  assertFalse(buffer.ackCounter.containsKey(record2.getId()));
  StreamRecord record3=new ArrayStreamRecord(1).setTuple(0,new Tuple1<String>("R3")).setId(1);
  StreamRecord record4=new ArrayStreamRecord(1).setTuple(0,new Tuple1<String>("R4")).setId(1);
  buffer.addToAckCounter(record3.getId(),0);
  buffer.addToAckCounter(record4.getId(),2);
  assertEquals(3,buffer.ackCounter.size());
  buffer.removeFromAckCounter(record3.getId());
  assertEquals(2,buffer.ackCounter.size());
  assertTrue(buffer.ackCounter.containsKey(record4.getId()));
  assertFalse(buffer.ackCounter.containsKey(record3.getId()));
}
