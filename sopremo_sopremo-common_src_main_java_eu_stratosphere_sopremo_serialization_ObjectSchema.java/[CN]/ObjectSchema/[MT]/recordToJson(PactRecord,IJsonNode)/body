{
  if (this.mappings.size() + 1 != record.getNumFields())   throw new IllegalStateException("Schema does not match to record!");
  final IObjectNode targetObject;
  if (target == null)   targetObject=new ObjectNode();
 else {
    targetObject=(IObjectNode)target;
    targetObject.removeAll();
  }
  for (int i=0; i < this.mappings.size(); i++)   if (record.getField(i,JsonNodeWrapper.class) != null)   targetObject.put(this.mappings.get(i),record.getField(i,JsonNodeWrapper.class).getValue());
  targetObject.putAll(record.getField(this.mappings.size(),JsonNodeWrapper.class).getValue(IObjectNode.class));
  return targetObject;
}
