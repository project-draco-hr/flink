{
  this.deserializer.clear();
  if (this.dataBuffer != null) {
    releasedConsumedReadBuffer();
  }
  if (this.getType() == ChannelType.NETWORK) {
    if (!this.brokerAggreedToCloseChannel) {
      while (!this.brokerAggreedToCloseChannel) {
        requestReadBufferFromBroker();
        if (this.dataBuffer != null) {
          releasedConsumedReadBuffer();
        }
        Thread.sleep(500);
      }
    }
  }
  final ChannelType type=getType();
  if (type == ChannelType.NETWORK || type == ChannelType.INMEMORY) {
    transferEvent(new ByteBufferedChannelCloseEvent());
  }
}
