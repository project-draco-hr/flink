{
switch (type) {
case MAX:
    return new MaxComparator();
case MIN:
  return new MinComparator();
case MINBY:
return new MinByComparator();
case MAXBY:
return new MaxByComparator();
default :
throw new IllegalArgumentException("Unsupported aggregation type.");
}
}
