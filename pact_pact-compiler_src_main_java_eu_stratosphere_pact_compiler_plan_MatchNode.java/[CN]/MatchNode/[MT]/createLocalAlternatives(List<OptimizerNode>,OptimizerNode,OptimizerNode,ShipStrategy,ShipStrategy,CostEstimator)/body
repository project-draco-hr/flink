{
  LocalProperties lp1;
  LocalProperties lp2;
  lp1=PactConnection.getLocalPropertiesAfterConnection(subPlan1,this,ss1);
  lp2=PactConnection.getLocalPropertiesAfterConnection(subPlan2,this,ss2);
  LocalStrategy ls=getLocalStrategy();
  if (ls != LocalStrategy.NONE) {
    if (ls == LocalStrategy.SORT_BOTH_MERGE || ls == LocalStrategy.SORT_FIRST_MERGE || ls == LocalStrategy.SORT_SECOND_MERGE || ls == LocalStrategy.MERGE) {
      createMatchAlternative(target,subPlan1,subPlan2,ss1,ss2,ls,Order.ASCENDING,true,null,estimator);
    }
 else     if (ls == LocalStrategy.HYBRIDHASH_FIRST || ls == LocalStrategy.HYBRIDHASH_SECOND || ls == LocalStrategy.MMHASH_FIRST || ls == LocalStrategy.MMHASH_SECOND) {
      createMatchAlternative(target,subPlan1,subPlan2,ss1,ss2,ls,Order.NONE,false,null,estimator);
    }
 else     if (ls == LocalStrategy.SORT_SELF_NESTEDLOOP) {
      createMatchAlternative(target,subPlan1,null,ss1,null,ls,Order.ASCENDING,true,null,estimator);
    }
 else     if (ls == LocalStrategy.SELF_NESTEDLOOP) {
      LocalProperties outLp=new LocalProperties();
      outLp.setOrdering(lp1.getOrdering());
      outLp.setGroupedFields(lp1.getGroupedFields());
      createMatchAlternative(target,subPlan1,null,ss1,null,ls,Order.ANY,true,outLp,estimator);
    }
  }
 else {
    if (haveValidOutputEstimates(subPlan1) && haveValidOutputEstimates(subPlan2)) {
      createMatchAlternative(target,subPlan1,subPlan2,ss1,ss2,LocalStrategy.HYBRIDHASH_FIRST,Order.NONE,false,null,estimator);
      createMatchAlternative(target,subPlan1,subPlan2,ss1,ss2,LocalStrategy.HYBRIDHASH_SECOND,Order.NONE,false,null,estimator);
    }
    int[] keyColumns=getPactContract().getKeyColumnNumbers(0);
    Ordering ordering1=new Ordering();
    for (    int keyColumn : keyColumns) {
      ordering1.appendOrdering(keyColumn,null,Order.ASCENDING);
    }
    keyColumns=getPactContract().getKeyColumnNumbers(1);
    Ordering ordering2=new Ordering();
    for (    int keyColumn : keyColumns) {
      ordering2.appendOrdering(keyColumn,null,Order.ASCENDING);
    }
    if (ordering1.isMetBy(lp1.getOrdering()) && ordering2.isMetBy(lp2.getOrdering())) {
      createMatchAlternative(target,subPlan1,subPlan2,ss1,ss2,LocalStrategy.MERGE,Order.ASCENDING,true,null,estimator);
    }
 else     if (!ordering1.isMetBy(lp1.getOrdering()) && ordering2.isMetBy(lp2.getOrdering())) {
      createMatchAlternative(target,subPlan1,subPlan2,ss1,ss2,LocalStrategy.SORT_FIRST_MERGE,Order.ASCENDING,true,null,estimator);
    }
 else     if (ordering1.isMetBy(lp1.getOrdering()) && !ordering2.isMetBy(lp2.getOrdering())) {
      createMatchAlternative(target,subPlan1,subPlan2,ss1,ss2,LocalStrategy.SORT_SECOND_MERGE,Order.ASCENDING,true,null,estimator);
    }
 else {
      createMatchAlternative(target,subPlan1,subPlan2,ss1,ss2,LocalStrategy.SORT_BOTH_MERGE,Order.ASCENDING,true,null,estimator);
    }
  }
}
