{
  FieldSet fieldSet1=new FieldSet(getPactContract().getKeyColumnNumbers(0));
  FieldSet fieldSet2=new FieldSet(getPactContract().getKeyColumnNumbers(1));
  long numKey1=0;
  long numRecords1=0;
  long numKey2=0;
  long numRecords2=0;
  for (  PactConnection c : this.input1) {
    OptimizerNode n=c.getSourcePact();
    if (n.getEstimatedCardinality(fieldSet1) == -1 || n.getEstimatedNumRecords() == -1) {
      numKey1=-1;
      break;
    }
    numKey1+=n.getEstimatedCardinality(fieldSet1);
    numRecords1+=n.getEstimatedNumRecords();
  }
  for (  PactConnection c : this.input2) {
    OptimizerNode n=c.getSourcePact();
    if (n.getEstimatedCardinality(fieldSet2) == -1 || n.getEstimatedNumRecords() == -1) {
      numKey2=-1;
      break;
    }
    numKey2+=n.getEstimatedCardinality(fieldSet2);
    numRecords2+=n.getEstimatedNumRecords();
  }
  if (numKey1 == -1 && numKey2 == -1)   return -1;
  double callsPerKey=1;
  if (numKey1 != -1) {
    callsPerKey*=numKey1 / (double)numRecords1;
  }
  if (numKey2 != -1) {
    callsPerKey*=numKey2 / (double)numRecords2;
  }
  return callsPerKey;
}
