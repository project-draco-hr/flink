{
  final ExecutionGraph eg=this.executionVertex.getExecutionGraph();
  if (newExecutionState == ExecutionState.FINISHED || newExecutionState == ExecutionState.CANCELED || newExecutionState == ExecutionState.FAILED) {
    this.queueScheduler.checkAndReleaseAllocatedResource(eg,this.executionVertex.getAllocatedResource());
  }
  if (newExecutionState == ExecutionState.FAILED) {
    if (this.executionVertex.hasRetriesLeft()) {
      this.executionVertex.setExecutionState(ExecutionState.SCHEDULED);
    }
  }
  final ExecutionGraph executionGraph=this.executionVertex.getExecutionGraph();
  final JobStatus jobStatus=executionGraph.getJobStatus();
  if (jobStatus == JobStatus.FAILED || jobStatus == JobStatus.FINISHED || jobStatus == JobStatus.CANCELLED) {
    this.queueScheduler.removeJobFromSchedule(executionGraph);
  }
}
