{
synchronized (this.floatingInstances) {
    if (this.floatingInstances.size() == 0) {
      return null;
    }
    final List<com.xerox.amazonws.ec2.ReservationDescription.Instance> instances=describeInstances(owner,awsAccessId,awsSecretKey);
    if (instances == null) {
      LOG.debug("EC2 describesInstances includes no instances for owner " + owner);
      return null;
    }
    final Iterator<com.xerox.amazonws.ec2.ReservationDescription.Instance> it=instances.iterator();
    while (it.hasNext()) {
      final com.xerox.amazonws.ec2.ReservationDescription.Instance instance=it.next();
      if (!type.getIdentifier().equals(instance.getInstanceType().getTypeId())) {
        continue;
      }
      InetAddress inetAddress=null;
      try {
        inetAddress=InetAddress.getByName(instance.getDnsName());
      }
 catch (      UnknownHostException e) {
        LOG.error("Cannot resolve " + instance.getDnsName() + " into an IP address: "+ StringUtils.stringifyException(e));
        continue;
      }
      if (this.floatingInstances.containsKey(inetAddress)) {
        final FloatingInstance floatingInstance=this.floatingInstances.remove(inetAddress);
        this.floatingInstanceIDs.remove(floatingInstance.getInstanceID());
        return convertIntoCloudInstance(instance,floatingInstance.getInstanceConnectionInfo(),owner);
      }
    }
  }
  return null;
}
