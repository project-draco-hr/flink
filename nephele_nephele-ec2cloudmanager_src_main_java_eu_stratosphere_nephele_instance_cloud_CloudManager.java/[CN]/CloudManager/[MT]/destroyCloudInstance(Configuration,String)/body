{
  if (conf == null) {
    throw new InstanceException("No job configuration provided, unable to acquire credentials");
  }
  final String awsAccessId=conf.getString("job.cloud.awsaccessid",null);
  if (awsAccessId == null) {
    throw new InstanceException("Unable to allocate cloud instance: Cannot find AWS access ID");
  }
  final String awsSecretKey=conf.getString("job.cloud.awssecretkey",null);
  if (awsSecretKey == null) {
    throw new InstanceException("Unable to allocate cloud instance: Cannot find AWS secret key");
  }
  AmazonEC2Client ec2client=EC2ClientFactory.getEC2Client(awsAccessId,awsSecretKey);
  TerminateInstancesRequest tr=new TerminateInstancesRequest();
  LinkedList<String> instances=new LinkedList<String>();
  instances.add(instanceID);
  tr.setInstanceIds(instances);
  TerminateInstancesResult trr=ec2client.terminateInstances(tr);
  return trr.getTerminatingInstances().get(0).getInstanceId();
}
