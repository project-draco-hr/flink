{
  if (prog.isUsingProgramEntryPoint()) {
    return getOptimizedPlan(prog.getPlanWithJars(),parallelism);
  }
 else   if (prog.isUsingInteractiveMode()) {
    OptimizerPlanEnvironment env=new OptimizerPlanEnvironment(this.compiler);
    if (parallelism > 0) {
      env.setDegreeOfParallelism(parallelism);
    }
    env.setAsContext();
    try {
      prog.invokeInteractiveModeForExecution();
    }
 catch (    Throwable t) {
    }
    return env.optimizerPlan;
  }
 else {
    throw new RuntimeException();
  }
}
