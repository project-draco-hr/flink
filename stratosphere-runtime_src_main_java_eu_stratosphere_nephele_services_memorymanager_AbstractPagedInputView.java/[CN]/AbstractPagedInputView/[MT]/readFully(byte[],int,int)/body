{
  if (off < 0 || len < 0 || off + len > b.length)   throw new IndexOutOfBoundsException();
  int remaining=this.limitInSegment - this.positionInSegment;
  if (remaining >= len) {
    this.currentSegment.get(this.positionInSegment,b,off,len);
    this.positionInSegment+=len;
  }
 else {
    if (remaining == 0) {
      advance();
      remaining=this.limitInSegment - this.positionInSegment;
    }
    while (true) {
      int toRead=Math.min(remaining,len);
      this.currentSegment.get(this.positionInSegment,b,off,toRead);
      off+=toRead;
      len-=toRead;
      if (len > 0) {
        advance();
        remaining=this.limitInSegment - this.positionInSegment;
      }
 else {
        this.positionInSegment+=toRead;
        break;
      }
    }
  }
}
