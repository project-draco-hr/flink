{
  if (LOG.isDebugEnabled()) {
    LOG.debug(this.taskContext.formatLogString("AllGroupReduce preprocessing done. Running Reducer code."));
  }
  if (objectReuseEnabled) {
    final ReusingMutableToRegularIteratorWrapper<IT> inIter=new ReusingMutableToRegularIteratorWrapper<IT>(this.input,this.serializer);
    if (inIter.hasNext()) {
      if (strategy == DriverStrategy.ALL_GROUP_REDUCE) {
        final GroupReduceFunction<IT,OT> reducer=this.taskContext.getStub();
        final Collector<OT> output=this.taskContext.getOutputCollector();
        reducer.reduce(inIter,output);
      }
 else {
        @SuppressWarnings("unchecked") final FlatCombineFunction<IT> combiner=(FlatCombineFunction<IT>)this.taskContext.getStub();
        @SuppressWarnings("unchecked") final Collector<IT> output=(Collector<IT>)this.taskContext.getOutputCollector();
        combiner.combine(inIter,output);
      }
    }
  }
 else {
    final NonReusingMutableToRegularIteratorWrapper<IT> inIter=new NonReusingMutableToRegularIteratorWrapper<IT>(this.input,this.serializer);
    if (inIter.hasNext()) {
      if (strategy == DriverStrategy.ALL_GROUP_REDUCE) {
        final GroupReduceFunction<IT,OT> reducer=this.taskContext.getStub();
        final Collector<OT> output=this.taskContext.getOutputCollector();
        reducer.reduce(inIter,output);
      }
 else {
        @SuppressWarnings("unchecked") final FlatCombineFunction<IT> combiner=(FlatCombineFunction<IT>)this.taskContext.getStub();
        @SuppressWarnings("unchecked") final Collector<IT> output=(Collector<IT>)this.taskContext.getOutputCollector();
        combiner.combine(inIter,output);
      }
    }
  }
}
