{
  StreamRecord<IN> nextRecord=inSerializer.createInstance();
  try {
    return recordIterator.next(nextRecord);
  }
 catch (  IOException e) {
    if (isRunning) {
      throw new RuntimeException("Could not read next record.",e);
    }
 else {
      return null;
    }
  }
catch (  IllegalStateException e) {
    if (isRunning) {
      throw new RuntimeException("Could not read next record.",e);
    }
 else {
      return null;
    }
  }
}
