{
  super.registerInputOutput();
  inSerializer=configuration.getTypeSerializerIn1(getUserCodeClassLoader());
  int numberOfInputs=configuration.getNumberOfInputs();
  if (numberOfInputs > 0) {
    InputGate inputGate=InputGateFactory.createInputGate(getEnvironment().getAllInputGates());
    inputs=new IndexedMutableReader<DeserializationDelegate<StreamRecord<IN>>>(inputGate);
    AccumulatorRegistry registry=getEnvironment().getAccumulatorRegistry();
    AccumulatorRegistry.Reporter reporter=registry.getReadWriteReporter();
    inputs.setReporter(reporter);
    inputs.registerTaskEventListener(getSuperstepListener(),StreamingSuperstep.class);
    recordIterator=new IndexedReaderIterator<StreamRecord<IN>>(inputs,inSerializer);
  }
}
