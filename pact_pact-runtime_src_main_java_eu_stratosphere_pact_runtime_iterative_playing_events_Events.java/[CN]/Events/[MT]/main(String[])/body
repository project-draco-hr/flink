{
  JobGraph jobGraph=new JobGraph("Events");
  JobFileInputVertex input=new JobFileInputVertex("Input 1",jobGraph);
  input.setFileInputClass(FileLineReader.class);
  input.setFilePath(new Path("file://" + PlayConstants.PLAY_DIR + "test-inputs/simple/1.txt"));
  JobTaskVertex task1=new JobTaskVertex("Sender",jobGraph);
  task1.setTaskClass(Sender.class);
  JobTaskVertex task2=new JobTaskVertex("Receiver",jobGraph);
  task2.setTaskClass(Receiver.class);
  JobFileOutputVertex output=new JobFileOutputVertex("Output 1",jobGraph);
  output.setFileOutputClass(FileLineWriter.class);
  output.setFilePath(new Path("file:///tmp/stratosphere/output.txt"));
  input.connectTo(task1,ChannelType.INMEMORY,CompressionLevel.NO_COMPRESSION);
  task1.connectTo(task2,ChannelType.FILE,CompressionLevel.NO_COMPRESSION);
  task2.connectTo(output,ChannelType.INMEMORY,CompressionLevel.NO_COMPRESSION);
  GlobalConfiguration.loadConfiguration(PlayConstants.PLAY_DIR + "local-conf");
  Configuration conf=GlobalConfiguration.getConfiguration();
  JobGraphUtils.submit(jobGraph,conf);
}
