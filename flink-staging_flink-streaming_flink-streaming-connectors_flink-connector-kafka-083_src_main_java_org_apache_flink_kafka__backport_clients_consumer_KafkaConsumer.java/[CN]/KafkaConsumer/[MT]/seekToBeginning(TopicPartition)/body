{
  acquire();
  try {
    Collection<TopicPartition> parts=partitions.length == 0 ? this.subscriptions.assignedPartitions() : Arrays.asList(partitions);
    for (    TopicPartition tp : parts) {
      log.debug("Seeking to beginning of partition {}",tp);
      subscriptions.needOffsetReset(tp,OffsetResetStrategy.EARLIEST);
    }
  }
  finally {
    release();
  }
}
