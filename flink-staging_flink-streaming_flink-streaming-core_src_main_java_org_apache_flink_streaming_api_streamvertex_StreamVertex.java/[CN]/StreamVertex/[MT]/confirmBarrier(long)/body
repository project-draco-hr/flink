{
  if (states != null && states.containsKey("kafka")) {
    getEnvironment().getJobManager().tell(new StateBarrierAck(getEnvironment().getJobID(),getEnvironment().getJobVertexId(),context.getIndexOfThisSubtask(),barrierID,states.get("kafka")),ActorRef.noSender());
  }
 else {
    getEnvironment().getJobManager().tell(new BarrierAck(getEnvironment().getJobID(),getEnvironment().getJobVertexId(),context.getIndexOfThisSubtask(),barrierID),ActorRef.noSender());
  }
}
