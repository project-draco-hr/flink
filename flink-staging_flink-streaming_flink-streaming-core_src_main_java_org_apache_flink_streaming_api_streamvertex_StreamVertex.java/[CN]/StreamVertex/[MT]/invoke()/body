{
  boolean operatorOpen=false;
  if (LOG.isDebugEnabled()) {
    LOG.debug("Task {} invoked with instance id {}",getName(),getInstanceID());
  }
  try {
    userInvokable.setRuntimeContext(context);
    operatorOpen=true;
    openOperator();
    userInvokable.invoke();
    closeOperator();
    operatorOpen=false;
    if (LOG.isDebugEnabled()) {
      LOG.debug("Task {} invoke finished instance id {}",getName(),getInstanceID());
    }
  }
 catch (  Exception e) {
    if (operatorOpen) {
      try {
        closeOperator();
      }
 catch (      Throwable t) {
      }
    }
    if (LOG.isErrorEnabled()) {
      LOG.error("StreamInvokable failed due to: {}",StringUtils.stringifyException(e));
    }
    throw e;
  }
 finally {
    outputHandler.flushOutputs();
    clearBuffers();
  }
}
