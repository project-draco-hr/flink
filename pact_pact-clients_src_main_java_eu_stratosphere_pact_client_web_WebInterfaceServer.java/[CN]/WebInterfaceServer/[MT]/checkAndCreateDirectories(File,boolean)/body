{
  String dir=f.getAbsolutePath();
  if (f.exists() && !f.isDirectory()) {
    throw new IOException("A none directory file with the same name as the configured directory '" + dir + "' already exists.");
  }
  if (!f.exists()) {
    if (!f.mkdirs()) {
      throw new IOException("Could not create the directory '" + dir + "'.");
    }
  }
  if (!(f.canRead() && f.canExecute())) {
    throw new IOException("The directory '" + dir + "' cannot be read and listed.");
  }
  if (needWritePermission && !f.canWrite()) {
    throw new IOException("No write access could be obtained on directory '" + dir + "'.");
  }
}
