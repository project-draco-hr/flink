{
  for (int i=0; i < 3; i++) {
    if (LOG.isInfoEnabled()) {
      LOG.info("Trying to find a new leader after Broker failure.");
    }
    boolean goToSleep=false;
    PartitionMetadata metadata=findLeader(replicaBrokers,a_topic,a_partition);
    if (metadata == null) {
      goToSleep=true;
    }
 else     if (metadata.leader() == null) {
      goToSleep=true;
    }
 else     if (a_oldLeader.host().equalsIgnoreCase(metadata.leader().host()) && i == 0) {
      goToSleep=true;
    }
 else {
      return metadata.leader();
    }
    if (goToSleep) {
      try {
        Thread.sleep(10000);
      }
 catch (      InterruptedException ie) {
      }
    }
  }
  throw new InterruptedException("Unable to find new leader after Broker failure.");
}
