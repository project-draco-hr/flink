{
synchronized (fetchResponse) {
    if (!iter.hasNext()) {
      throw new RuntimeException("Trying to read when response is not fetched. Call fetchHasNext() first.");
    }
    MessageAndOffset messageAndOffset=iter.next();
    long currentOffset=messageAndOffset.offset();
    while (currentOffset < readOffset) {
      messageAndOffset=iter.next();
      currentOffset=messageAndOffset.offset();
    }
    readOffset=messageAndOffset.nextOffset();
    ByteBuffer payload=messageAndOffset.message().payload();
    byte[] bytes=new byte[payload.limit()];
    payload.get(bytes);
    return new MessageWithMetadata(messageAndOffset.offset(),bytes,partition);
  }
}
