{
  inputSerializer=configuration.getTypeSerializerIn1(streamVertex.userClassLoader);
  int numberOfInputs=configuration.getNumberOfInputs();
  if (numberOfInputs > 0) {
    if (numberOfInputs < 2) {
      inputs=new MutableRecordReader<IOReadableWritable>(streamVertex.getEnvironment().getReader(0));
    }
 else {
      UnionBufferReader reader=new UnionBufferReader(streamVertex.getEnvironment().getAllReaders());
      inputs=new MutableRecordReader<IOReadableWritable>(reader);
    }
    inputIter=createInputIterator();
  }
}
