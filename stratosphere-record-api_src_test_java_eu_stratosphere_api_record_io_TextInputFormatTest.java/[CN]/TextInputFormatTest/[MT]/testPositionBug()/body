{
  final String FIRST="First line";
  final String SECOND="Second line";
  try {
    File tempFile=File.createTempFile("TextInputFormatTest","tmp");
    tempFile.deleteOnExit();
    tempFile.setWritable(true);
    PrintStream ps=new PrintStream(tempFile);
    ps.println(FIRST);
    ps.println(SECOND);
    ps.close();
    TextInputFormat inputFormat=new TextInputFormat();
    inputFormat.setFilePath(tempFile.toURI().toString());
    Configuration parameters=new Configuration();
    inputFormat.configure(parameters);
    FileInputSplit[] splits=inputFormat.createInputSplits(1);
    assertTrue("expected at least one input split",splits.length >= 1);
    inputFormat.open(splits[0]);
    Record r=new Record();
    assertTrue("Expecting first record here",inputFormat.nextRecord(r));
    assertEquals(FIRST,r.getField(0,StringValue.class).getValue());
    assertTrue("Expecting second record here",inputFormat.nextRecord(r));
    assertEquals(SECOND,r.getField(0,StringValue.class).getValue());
    assertFalse("The input file is over",inputFormat.nextRecord(r));
  }
 catch (  Throwable t) {
    System.err.println("test failed with exception: " + t.getMessage());
    t.printStackTrace(System.err);
    fail("Test erroneous");
  }
}
