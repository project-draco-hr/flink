{
  int scale=Long.SIZE - Long.numberOfLeadingZeros(vertexCount - 1);
  int cyclesPerEdge=noiseEnabled ? 5 * scale : scale;
  List<BlockInfo<T>> generatorBlocks=randomGenerableFactory.getRandomGenerables(edgeCount,cyclesPerEdge);
  DataSet<Edge<LongValue,NullValue>> generatedEdges=env.fromCollection(generatorBlocks).name("Random generators").rebalance().setParallelism(parallelism).name("Rebalance").flatMap(new GenerateEdges<T>(vertexCount,scale,A,B,C,noiseEnabled,noise,simpleGraph,clipAndFlip)).setParallelism(parallelism).name("RMat graph edges");
  DataSet<Edge<LongValue,NullValue>> edges;
  if (simpleGraph) {
    edges=generatedEdges.distinct(1,0).setParallelism(parallelism).name("Distinct");
  }
 else {
    edges=generatedEdges;
  }
  DataSet<Vertex<LongValue,NullValue>> vertices=GraphGeneratorUtils.vertexSet(edges,parallelism);
  return Graph.fromDataSet(vertices,edges,env);
}
