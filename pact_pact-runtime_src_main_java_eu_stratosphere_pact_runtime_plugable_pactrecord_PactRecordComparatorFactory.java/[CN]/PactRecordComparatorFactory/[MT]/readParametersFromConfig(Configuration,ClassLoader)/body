{
  final int numKeyFields=config.getInteger(NUM_KEYS,-1);
  if (numKeyFields < 0) {
    throw new CorruptConfigurationException("The number of keys for the comparator is invalid: " + numKeyFields);
  }
  final int[] positions=new int[numKeyFields];
  @SuppressWarnings("unchecked") final Class<? extends Key>[] types=new Class[numKeyFields];
  final boolean[] direction=new boolean[numKeyFields];
  for (int i=0; i < numKeyFields; i++) {
    final int p=config.getInteger(KEY_POS_PREFIX + i,-1);
    if (p >= 0) {
      positions[i]=p;
    }
 else {
      throw new CorruptConfigurationException("Contained invalid position for key no positions for keys.");
    }
    final String name=config.getString(KEY_CLASS_PREFIX + i,null);
    if (name != null) {
      types[i]=Class.forName(name,true,cl).asSubclass(Key.class);
    }
 else {
      throw new CorruptConfigurationException("The key type (" + i + ") for the comparator is null");
    }
    direction[i]=config.getBoolean(KEY_SORT_DIRECTION_PREFIX + i,true);
  }
  this.positions=positions;
  this.types=types;
  this.sortDirections=direction;
}
