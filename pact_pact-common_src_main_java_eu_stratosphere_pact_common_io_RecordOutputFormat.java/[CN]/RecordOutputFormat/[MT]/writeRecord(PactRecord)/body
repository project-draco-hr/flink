{
  int numFields=record.getNumFields();
  if (numFields > this.classes.length) {
    if (this.lenient) {
      numFields=this.classes.length;
      if (LOG.isWarnEnabled())       LOG.warn("Serializing only first " + numFields + " fields from record.");
    }
 else {
      throw new RuntimeException("Cannot serialize record with more fields than the RecordOutputFormat knows types.");
    }
  }
  for (int i=0; i < numFields; i++) {
    if (i != 0)     this.wrt.write(this.fieldDelimiter);
    Value v=record.getField(i,this.classes[i]);
    this.wrt.write(v.toString());
  }
  this.wrt.write(this.recordDelimiter);
}
