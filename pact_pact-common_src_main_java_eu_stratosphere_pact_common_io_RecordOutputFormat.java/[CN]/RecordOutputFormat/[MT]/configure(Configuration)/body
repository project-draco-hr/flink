{
  super.configure(parameters);
  int numFields=parameters.getInteger(NUM_FIELDS_PARAMETER,-1);
  if (numFields < 1) {
    throw new RuntimeException("Invalid configuration for RecordOutputFormat: " + "Need to specify number of fields > 0.");
  }
  @SuppressWarnings("unchecked") Class<Value>[] arr=new Class[numFields];
  this.classes=arr;
  for (int i=0; i < numFields; i++) {
    @SuppressWarnings("unchecked") Class<? extends Value> clazz=(Class<? extends Value>)parameters.getClass(FIELD_TYPE_PARAMETER_PREFIX + i,null);
    if (clazz == null) {
      throw new RuntimeException("Invalid configuration for RecordOutputFormat: " + "No type class for parameter " + i);
    }
    this.classes[i]=clazz;
  }
  this.recordDelimiter=parameters.getString(RECORD_DELIMITER_PARAMETER,"\n");
  this.fieldDelimiter=parameters.getString(FIELD_DELIMITER_PARAMETER,",");
}
