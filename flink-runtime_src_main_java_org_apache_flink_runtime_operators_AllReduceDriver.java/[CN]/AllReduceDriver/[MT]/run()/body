{
  if (LOG.isDebugEnabled()) {
    LOG.debug(this.taskContext.formatLogString("AllReduce preprocessing done. Running Reducer code."));
  }
  final ReduceFunction<T> stub=this.taskContext.getStub();
  final MutableObjectIterator<T> input=this.input;
  final TypeSerializer<T> serializer=this.serializer;
  if (objectReuseEnabled) {
    T val1=serializer.createInstance();
    if ((val1=input.next(val1)) == null) {
      return;
    }
    T val2=serializer.createInstance();
    while (running && (val2=input.next(val2)) != null) {
      val1=stub.reduce(val1,val2);
    }
    this.taskContext.getOutputCollector().collect(val1);
  }
 else {
    T val1;
    if ((val1=input.next()) == null) {
      return;
    }
    T val2;
    while (running && (val2=input.next()) != null) {
      val1=stub.reduce(val1,val2);
    }
    this.taskContext.getOutputCollector().collect(val1);
  }
}
