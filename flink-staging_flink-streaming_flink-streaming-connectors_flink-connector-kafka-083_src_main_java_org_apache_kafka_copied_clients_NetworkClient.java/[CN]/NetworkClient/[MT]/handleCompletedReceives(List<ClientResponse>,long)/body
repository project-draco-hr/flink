{
  for (  NetworkReceive receive : this.selector.completedReceives()) {
    String source=receive.source();
    ClientRequest req=inFlightRequests.completeNext(source);
    ResponseHeader header=ResponseHeader.parse(receive.payload());
    short apiKey=req.request().header().apiKey();
    Struct body=(Struct)ProtoUtils.currentResponseSchema(apiKey).read(receive.payload());
    correlate(req.request().header(),header);
    if (apiKey == ApiKeys.METADATA.id) {
      handleMetadataResponse(req.request().header(),body,now);
    }
 else {
      responses.add(new ClientResponse(req,now,false,body));
    }
  }
}
