{
  int noSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String dataInput=(args.length > 1 ? args[1] : "");
  String dataInput2=(args.length > 2 ? args[2] : "");
  String output=(args.length > 3 ? args[3] : "");
  FileDataSource source=new FileDataSource(TextInputFormat.class,dataInput,"Input Lines");
  FileDataSource source2=new FileDataSource(TextInputFormat.class,dataInput2,"Input Lines");
  MapContract mapper=new MapContract(TokenizeLine.class,source,"Tokenize Lines");
  MapContract mapper2=new MapContract(TokenizeLine.class,source2,"Tokenize Lines");
  CoGroupContract coGroup=new CoGroupContract(IdentityCoGroup.class,PactInteger.class,0,0);
  coGroup.setSecondarySortKeyClasses(new Class[]{PactInteger.class});
  coGroup.setSecondarySortKeyColumnNumbers(0,new int[]{1});
  coGroup.setSecondarySortKeyColumnNumbers(1,new int[]{1});
  coGroup.setFirstInput(mapper);
  coGroup.setSecondInput(mapper2);
  FileDataSink out=new FileDataSink(SecondarySortOutFormat.class,output,coGroup,"Sorted entries");
  source.setParameter(TextInputFormat.CHARSET_NAME,"ASCII");
  source2.setParameter(TextInputFormat.CHARSET_NAME,"ASCII");
  Plan plan=new Plan(out,"SecondarySort Example");
  plan.setDefaultParallelism(noSubTasks);
  return plan;
}
