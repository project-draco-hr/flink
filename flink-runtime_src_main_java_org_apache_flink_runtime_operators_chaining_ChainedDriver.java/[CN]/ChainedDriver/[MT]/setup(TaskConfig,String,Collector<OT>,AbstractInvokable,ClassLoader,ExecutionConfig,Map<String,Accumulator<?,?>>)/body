{
  this.config=config;
  this.taskName=taskName;
  this.outputCollector=outputCollector;
  this.userCodeClassLoader=userCodeClassLoader;
  Environment env=parent.getEnvironment();
  if (parent instanceof BatchTask) {
    this.udfContext=((BatchTask<?,?>)parent).createRuntimeContext();
  }
 else {
    this.udfContext=new DistributedRuntimeUDFContext(env.getTaskInfo(),userCodeClassLoader,parent.getExecutionConfig(),env.getDistributedCacheEntries(),accumulatorMap);
  }
  this.executionConfig=executionConfig;
  this.objectReuseEnabled=executionConfig.isObjectReuseEnabled();
  setup(parent);
}
