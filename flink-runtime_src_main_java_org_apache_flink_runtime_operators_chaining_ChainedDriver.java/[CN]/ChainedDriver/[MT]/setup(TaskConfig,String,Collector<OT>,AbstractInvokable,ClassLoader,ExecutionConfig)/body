{
  this.config=config;
  this.taskName=taskName;
  this.outputCollector=outputCollector;
  this.userCodeClassLoader=userCodeClassLoader;
  if (parent instanceof RegularPactTask) {
    this.udfContext=((RegularPactTask<?,?>)parent).createRuntimeContext(taskName);
  }
 else {
    Environment env=parent.getEnvironment();
    this.udfContext=new DistributedRuntimeUDFContext(taskName,env.getCurrentNumberOfSubtasks(),env.getIndexInSubtaskGroup(),userCodeClassLoader,env.getCopyTask());
  }
  this.executionConfig=executionConfig;
  this.objectReuseEnabled=executionConfig.isObjectReuseEnabled();
  setup(parent);
}
