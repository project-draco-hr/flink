{
  Promise<String> promise=savepointPromises.remove(checkpoint.getCheckpointID());
  if (promise == null) {
    LOG.info("Pending savepoint with ID " + checkpoint.getCheckpointID() + "  has been "+ "removed before receiving acknowledgment.");
  }
  if (promise.isCompleted()) {
    throw new IllegalStateException("Savepoint promise completed");
  }
  try {
    String savepointPath=savepointStore.putState(checkpoint);
    promise.success(savepointPath);
  }
 catch (  Exception e) {
    LOG.warn("Failed to store savepoint.",e);
    promise.failure(e);
  }
}
