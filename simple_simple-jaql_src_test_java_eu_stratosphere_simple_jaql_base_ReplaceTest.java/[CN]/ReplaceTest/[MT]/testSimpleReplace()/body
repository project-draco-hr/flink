{
  SopremoPlan actualPlan=parseScript("$persons = read hdfs('persons.json');" + "$nickNames = read hdfs('nickNames.json');" + "$normalizedPersons = replace $person in $persons"+ "	on $person.firstName"+ "	with $nickNames;"+ "write $normalizedPersons to hdfs('normalizedPersons.json');");
  SopremoPlan expectedPlan=new SopremoPlan();
  Source persons=new Source("persons.json");
  Source nickNames=new Source("nickNames.json");
  Replace replace=new Replace().withInputs(persons,nickNames).withReplaceExpression(JsonUtil.createPath("0","firstName"));
  Sink normalizedPersons=new Sink("normalizedPersons.json").withInputs(replace);
  expectedPlan.setSinks(normalizedPersons);
  assertEquals(expectedPlan,actualPlan);
}
