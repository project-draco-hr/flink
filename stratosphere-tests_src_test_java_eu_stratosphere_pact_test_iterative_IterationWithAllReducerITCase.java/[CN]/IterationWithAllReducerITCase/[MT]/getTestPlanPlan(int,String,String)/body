{
  FileDataSource initialInput=new FileDataSource(TextInputFormat.class,input,"input");
  BulkIteration iteration=new BulkIteration("Loop");
  iteration.setInput(initialInput);
  iteration.setMaximumNumberOfIterations(2);
  Assert.assertTrue(iteration.getMaximumNumberOfIterations() > 1);
  ReduceOperator sumReduce=ReduceOperator.builder(new SumReducer()).input(iteration.getPartialSolution()).name("Compute sum (Reduce)").build();
  iteration.setNextPartialSolution(sumReduce);
  FileDataSink finalResult=new FileDataSink(CsvOutputFormat.class,output,iteration,"Output");
  CsvOutputFormat.configureRecordFormat(finalResult).recordDelimiter('\n').fieldDelimiter(' ').field(PactString.class,0);
  Job plan=new Job(finalResult,"Iteration with AllReducer (keyless Reducer)");
  plan.setDefaultParallelism(numSubTasks);
  return plan;
}
