{
  int bucket=indexFor(hash(key.hashCode()),offsets.length);
  segment.outputView.setPosition(writePosition);
  segment.outputView.writeInt(offsets[bucket]);
  segment.outputView.writeInt(OFFSET_NULL);
  key.write(segment.outputView);
  offsets[bucket]=writePosition;
  writePosition=segment.outputView.getPosition();
  numberOfKeys++;
  return offsets[bucket];
}
