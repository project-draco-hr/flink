{
  String fileContent="Year,Make,Model,Description,Price\n" + "1997,Ford,E350,\"ac, abs, moon\",3000.00\n" + "1999,Chevy,\"Venture \"\"Extended Edition\"\"\",\"\",4900.00\n"+ "1996,Jeep,Grand Cherokee,\"MUST SELL! air, moon roof, loaded\",4799.00\n"+ "1999,Chevy,\"Venture \"\"Extended Edition, Very Large\"\"\",,5000.00\n"+ ",,\"Venture \"\"Extended Edition\"\"\",\"\",4900.00";
  FileInputSplit split=createTempFile(fileContent);
  RowTypeInfo typeInfo=new RowTypeInfo(new TypeInformation<?>[]{BasicTypeInfo.INT_TYPE_INFO,BasicTypeInfo.STRING_TYPE_INFO,BasicTypeInfo.STRING_TYPE_INFO,BasicTypeInfo.STRING_TYPE_INFO,BasicTypeInfo.DOUBLE_TYPE_INFO});
  CsvInputFormat<Row> format=new RowCsvInputFormat(PATH,typeInfo);
  format.setSkipFirstLineAsHeader(true);
  format.setFieldDelimiter(',');
  format.configure(new Configuration());
  format.open(split);
  Row result=new Row(5);
  Row r1=new Row(5);
  r1.setField(0,1997);
  r1.setField(1,"Ford");
  r1.setField(2,"E350");
  r1.setField(3,"ac, abs, moon");
  r1.setField(4,3000.0);
  Row r2=new Row(5);
  r2.setField(0,1999);
  r2.setField(1,"Chevy");
  r2.setField(2,"Venture \"Extended Edition\"");
  r2.setField(3,"");
  r2.setField(4,4900.0);
  Row r3=new Row(5);
  r3.setField(0,1996);
  r3.setField(1,"Jeep");
  r3.setField(2,"Grand Cherokee");
  r3.setField(3,"MUST SELL! air, moon roof, loaded");
  r3.setField(4,4799.0);
  Row r4=new Row(5);
  r4.setField(0,1999);
  r4.setField(1,"Chevy");
  r4.setField(2,"Venture \"Extended Edition, Very Large\"");
  r4.setField(3,"");
  r4.setField(4,5000.0);
  Row r5=new Row(5);
  r5.setField(0,0);
  r5.setField(1,"");
  r5.setField(2,"Venture \"Extended Edition\"");
  r5.setField(3,"");
  r5.setField(4,4900.0);
  Row[] expectedLines=new Row[]{r1,r2,r3,r4,r5};
  try {
    for (    Row expected : expectedLines) {
      result=format.nextRecord(result);
      assertEquals(expected,result);
    }
    assertNull(format.nextRecord(result));
    assertTrue(format.reachedEnd());
  }
 catch (  Exception ex) {
    fail("Test failed due to a " + ex.getClass().getName() + ": "+ ex.getMessage());
  }
}
