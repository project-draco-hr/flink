{
  this.serializer=serializer;
  this.memManager=memManager;
  ArrayList<MemorySegment> mem=new ArrayList<MemorySegment>(numPages);
  memManager.allocatePages(owner,mem,numPages);
  this.buffer=new SpillingBuffer(ioManager,new ListMemorySegmentSource(mem),memManager.getPageSize());
  this.tempWriter=new TempWritingThread(input,serializer,this.buffer);
}
