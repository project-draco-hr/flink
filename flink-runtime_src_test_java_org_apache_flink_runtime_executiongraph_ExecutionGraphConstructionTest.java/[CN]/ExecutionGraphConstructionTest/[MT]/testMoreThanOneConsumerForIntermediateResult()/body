{
  try {
    final JobID jobId=new JobID();
    final String jobName="Test Job Sample Name";
    final Configuration cfg=new Configuration();
    AbstractJobVertex v1=new AbstractJobVertex("vertex1");
    AbstractJobVertex v2=new AbstractJobVertex("vertex2");
    AbstractJobVertex v3=new AbstractJobVertex("vertex3");
    v1.setParallelism(5);
    v2.setParallelism(7);
    v3.setParallelism(2);
    IntermediateDataSet result=v1.createAndAddResultDataSet();
    v2.connectDataSetAsInput(result,DistributionPattern.BIPARTITE);
    v3.connectDataSetAsInput(result,DistributionPattern.BIPARTITE);
    List<AbstractJobVertex> ordered=new ArrayList<AbstractJobVertex>(Arrays.asList(v1,v2,v3));
    ExecutionGraph eg=new ExecutionGraph(jobId,jobName,cfg);
    try {
      eg.attachJobGraph(ordered);
      fail("Should not be possible");
    }
 catch (    RuntimeException e) {
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
