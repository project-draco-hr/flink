{
  super(template,driverStrategy);
  this.input=input;
  this.keys=driverKeyFields;
  this.sortOrders=driverSortOrders;
  if (this.input.getShipStrategy() == ShipStrategyType.BROADCAST) {
    this.input.setReplicationFactor(getDegreeOfParallelism());
  }
  final PlanNode predNode=input.getSource();
  if (this.branchPlan == null) {
    this.branchPlan=predNode.branchPlan;
  }
 else   if (predNode.branchPlan != null) {
    this.branchPlan.putAll(predNode.branchPlan);
  }
  this.globalProps=input.getGlobalProperties().clone();
  this.localProps=input.getLocalProperties().clone();
}
