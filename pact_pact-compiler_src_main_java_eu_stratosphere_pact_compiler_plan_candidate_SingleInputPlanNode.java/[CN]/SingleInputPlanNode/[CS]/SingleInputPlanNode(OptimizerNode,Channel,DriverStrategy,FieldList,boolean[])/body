{
  super(template,driverStrategy);
  this.input=input;
  this.keys=driverKeyFields;
  this.sortOrders=driverSortOrders;
  if (this.input.getShipStrategy() == ShipStrategyType.BROADCAST) {
    this.input.setReplicationFactor(getDegreeOfParallelism());
  }
  this.globalProps=input.getGlobalProperties().clone();
  this.globalProps.clearUniqueFieldSets();
  this.localProps=input.getLocalProperties().clone();
  this.localProps.clearUniqueFieldSets();
switch (driverStrategy) {
case NONE:
case MAP:
    break;
case PARTIAL_GROUP:
case GROUP:
  break;
default :
throw new CompilerException("Unrecognized diver strategy impacting local properties.");
}
this.globalProps.filterByNodesConstantSet(template,0);
this.localProps.filterByNodesConstantSet(template,0);
updatePropertiesWithUniqueSets(template.getUniqueFields());
}
