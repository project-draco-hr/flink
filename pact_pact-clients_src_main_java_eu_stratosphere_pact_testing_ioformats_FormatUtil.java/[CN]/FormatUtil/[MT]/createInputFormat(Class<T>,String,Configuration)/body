{
  configuration=configuration == null ? new Configuration() : configuration;
  org.apache.hadoop.fs.Path hadoopPath=normalizePath(new org.apache.hadoop.fs.Path(path));
  final T inputFormat=ReflectionUtil.newInstance(inputFormatClass);
  configuration.setString(FileInputFormat.FILE_PARAMETER_KEY,path);
  inputFormat.configure(configuration);
  final org.apache.hadoop.fs.FileSystem fs=org.apache.hadoop.fs.FileSystem.get(hadoopPath.toUri(),new org.apache.hadoop.conf.Configuration());
  inputFormat.open(new FileInputSplit(0,new Path(path),0,fs.getFileStatus(hadoopPath).getLen(),new String[]{"localhost"}));
  return inputFormat;
}
