{
  org.apache.hadoop.fs.Path hadoopPath=normalizePath(new org.apache.hadoop.fs.Path(path));
  final T inputFormat=ReflectionUtil.newInstance(inputFormatClass);
  inputFormat.configure(configuration == null ? new Configuration() : configuration);
  final org.apache.hadoop.fs.FileSystem fs=org.apache.hadoop.fs.FileSystem.get(hadoopPath.toUri(),new org.apache.hadoop.conf.Configuration());
  final org.apache.hadoop.fs.FSDataInputStream fdis=fs.open(hadoopPath);
  inputFormat.setInput(new DistributedDataInputStream(fdis),0,fs.getFileStatus(hadoopPath).getLen(),1024 * 1024);
  inputFormat.open();
  return inputFormat;
}
