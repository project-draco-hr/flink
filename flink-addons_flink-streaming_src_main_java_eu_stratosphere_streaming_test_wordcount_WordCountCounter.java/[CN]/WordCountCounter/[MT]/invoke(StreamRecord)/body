{
  wordValue=(StringValue)record.getField(0);
  word=wordValue.getValue();
  if (wordCounts.containsKey(word)) {
    count=wordCounts.get(word) + 1;
    wordCounts.put(word,count);
    countValue.setValue(count);
    outputRecord.setField(0,wordValue);
    outputRecord.setField(1,countValue);
    emit(outputRecord);
  }
 else {
    wordCounts.put(word,1);
    countValue.setValue(1);
    outputRecord.setField(0,wordValue);
    outputRecord.setField(1,countValue);
    emit(outputRecord);
  }
}
