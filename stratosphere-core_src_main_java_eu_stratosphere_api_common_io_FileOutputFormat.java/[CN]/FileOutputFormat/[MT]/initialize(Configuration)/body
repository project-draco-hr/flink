{
  final Path path=this.getOutputFilePath();
  final WriteMode writeMode=this.getWriteMode();
  final OutputDirectoryMode outDirMode=this.getOutputDirectoryMode();
  try {
    final FileSystem fs=path.getFileSystem();
    int dop=configuration.getInteger(DEGREE_OF_PARALLELISM_KEY,-1);
    if (dop == 1 && outDirMode == OutputDirectoryMode.PARONLY) {
      if (fs.isDistributedFS()) {
        if (!fs.initOutPathDistFS(path,writeMode,false)) {
          throw new IOException("Output path could not be initialized.");
        }
      }
    }
 else {
      if (fs.isDistributedFS()) {
        if (!fs.initOutPathDistFS(path,writeMode,true)) {
          throw new IOException("Output directory could not be created.");
        }
      }
    }
  }
 catch (  IOException e) {
    LOG.error("Could not access the file system to detemine the status of the output.",e);
    throw new RuntimeException("I/O Error while accessing file",e);
  }
}
