{
  if (LOG.isDebugEnabled()) {
    LOG.debug(this.taskContext.formatLogString("AllGroupReduce preprocessing done. Running Reducer code."));
  }
  final MutableToRegularIteratorWrapper<IT> inIter=new MutableToRegularIteratorWrapper<IT>(this.input,this.serializer);
  if (inIter.hasNext()) {
    if (strategy == DriverStrategy.ALL_GROUP_REDUCE) {
      final GenericGroupReduce<IT,OT> reducer=this.taskContext.getStub();
      final Collector<OT> output=this.taskContext.getOutputCollector();
      reducer.reduce(inIter,output);
    }
 else {
      @SuppressWarnings("unchecked") final GenericCombine<IT> combiner=(GenericCombine<IT>)this.taskContext.getStub();
      @SuppressWarnings("unchecked") final Collector<IT> output=(Collector<IT>)this.taskContext.getOutputCollector();
      combiner.combine(inIter,output);
    }
  }
}
