{
  SingleInputOperator<?,?,?> contract=(SingleInputOperator<?,?,?>)node.getSingleInputNode().getPactContract();
  if (!(contract instanceof RecordOperator)) {
    throw new CompilerPostPassException("Error: Operator is not a Record based contract. Wrong compiler invokation.");
  }
  RecordOperator recContract=(RecordOperator)contract;
  int[] localPositions=contract.getKeyColumns(0);
  Class<? extends Key<?>>[] types=recContract.getKeyClasses();
  for (int i=0; i < localPositions.length; i++) {
    schema.addType(localPositions[i],types[i]);
  }
  if (contract instanceof GroupReduceOperatorBase) {
    Ordering groupOrder=((GroupReduceOperatorBase<?,?,?>)contract).getGroupOrder();
    if (groupOrder != null) {
      addOrderingToSchema(groupOrder,schema);
    }
  }
}
