{
  currentChannel=(currentChannel + 1) % numChannels;
  if (barrierGens[currentChannel].isNextBarrier()) {
    return BarrierBufferTest.createSuperstep(++currentSupersteps[currentChannel],currentChannel);
  }
 else {
    Buffer buffer=bufferPools[currentChannel].requestBuffer();
    buffer.getMemorySegment().putLong(0,c++);
    return new BufferOrEvent(buffer,currentChannel);
  }
}
