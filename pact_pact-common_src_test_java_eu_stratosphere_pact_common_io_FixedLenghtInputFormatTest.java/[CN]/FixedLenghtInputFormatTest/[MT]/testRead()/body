{
  final int[] fileContent={1,2,3,4,5,6,7,8};
  final FileInputSplit split=createTempFile(fileContent);
  final Configuration parameters=new Configuration();
  parameters.setString(FileInputFormat.FILE_PARAMETER_KEY,"file:///some/file/that/will/not/be/read");
  parameters.setInteger(FixedLengthInputFormat.RECORDLENGTH_PARAMETER_KEY,8);
  format.configure(parameters);
  format.setTargetReadBufferSize(16);
  format.open(split);
  KeyValuePair<PactInteger,PactInteger> pair=new KeyValuePair<PactInteger,PactInteger>();
  pair.setKey(new PactInteger());
  pair.setValue(new PactInteger());
  assertTrue(format.nextRecord(pair));
  assertEquals(1,pair.getKey().getValue());
  assertEquals(2,pair.getValue().getValue());
  assertTrue(format.nextRecord(pair));
  assertEquals(3,pair.getKey().getValue());
  assertEquals(4,pair.getValue().getValue());
  assertTrue(format.nextRecord(pair));
  assertEquals(5,pair.getKey().getValue());
  assertEquals(6,pair.getValue().getValue());
  assertTrue(format.nextRecord(pair));
  assertEquals(7,pair.getKey().getValue());
  assertEquals(8,pair.getValue().getValue());
  assertFalse(format.nextRecord(pair));
  assertTrue(format.reachedEnd());
}
