{
  final int[] fileContent={1,2,3,4,5,6,7,8};
  final FileInputSplit split=createTempFile(fileContent);
  final Configuration parameters=new Configuration();
  parameters.setString(FileInputFormat.FILE_PARAMETER_KEY,"file:///some/file/that/will/not/be/read");
  parameters.setInteger(FixedLengthInputFormat.RECORDLENGTH_PARAMETER_KEY,8);
  format.configure(parameters);
  format.open(split);
  PactRecord record=new PactRecord();
  assertTrue(format.nextRecord(record));
  assertEquals(1,record.getField(0,PactInteger.class).getValue());
  assertEquals(2,record.getField(1,PactInteger.class).getValue());
  assertTrue(format.nextRecord(record));
  assertEquals(3,record.getField(0,PactInteger.class).getValue());
  assertEquals(4,record.getField(1,PactInteger.class).getValue());
  assertTrue(format.nextRecord(record));
  assertEquals(5,record.getField(0,PactInteger.class).getValue());
  assertEquals(6,record.getField(1,PactInteger.class).getValue());
  assertTrue(format.nextRecord(record));
  assertEquals(7,record.getField(0,PactInteger.class).getValue());
  assertEquals(8,record.getField(1,PactInteger.class).getValue());
  assertFalse(format.nextRecord(record));
  assertTrue(format.reachedEnd());
}
