{
  SourceFunction.SourceContext<T> ctx;
  if (userFunction instanceof EventTimeSourceFunction) {
    ctx=new ManualWatermarkContext<T>(lockingObject,collector);
  }
 else   if (executionConfig.getAutoWatermarkInterval() > 0) {
    ctx=new AutomaticWatermarkContext<T>(lockingObject,collector,executionConfig);
  }
 else   if (executionConfig.areTimestampsEnabled()) {
    ctx=new NonWatermarkContext<T>(lockingObject,collector);
  }
 else {
    ctx=new NonTimestampContext<T>(lockingObject,collector);
  }
  userFunction.run(ctx);
}
