{
synchronized (lockingObject) {
    long currentTime=System.currentTimeMillis();
    output.collect(reuse.replace(element,currentTime));
    long watermarkTime=currentTime - (currentTime % watermarkInterval);
    if (watermarkTime - lastWatermarkTime >= watermarkInterval) {
      output.emitWatermark(new Watermark(watermarkTime));
      lastWatermarkTime=watermarkTime;
    }
  }
}
