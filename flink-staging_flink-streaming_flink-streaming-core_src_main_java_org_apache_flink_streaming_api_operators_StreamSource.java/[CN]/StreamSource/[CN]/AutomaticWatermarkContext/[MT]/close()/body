{
  watermarkTimer.cancel(true);
  scheduleExecutor.shutdownNow();
synchronized (lockingObject) {
    output.emitWatermark(new Watermark(Long.MAX_VALUE));
  }
}
