{
  super(filePath);
  TypeSerializer<OUT> serializer=typeInfo.createSerializer();
  if (serializer.isStateful()) {
    serializerFactory=new RuntimeStatefulSerializerFactory<OUT>(serializer,typeInfo.getTypeClass());
  }
 else {
    serializerFactory=new RuntimeStatelessSerializerFactory<OUT>(serializer,typeInfo.getTypeClass());
  }
  if (!(typeInfo.isTupleType())) {
    throw new UnsupportedOperationException("This only works on tuple types.");
  }
  TupleTypeInfoBase<OUT> tupleType=(TupleTypeInfoBase<OUT>)typeInfo;
  Class[] classes=new Class[tupleType.getArity()];
  for (int i=0; i < tupleType.getArity(); i++) {
    classes[i]=tupleType.getTypeAt(i).getTypeClass();
  }
  setFieldTypes(classes);
}
