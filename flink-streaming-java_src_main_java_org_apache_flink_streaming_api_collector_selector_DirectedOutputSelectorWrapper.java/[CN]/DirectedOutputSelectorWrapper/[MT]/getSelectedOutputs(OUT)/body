{
  Set<Collector<StreamRecord<OUT>>> selectedOutputs=new HashSet<Collector<StreamRecord<OUT>>>(selectAllOutputs);
  for (  OutputSelector<OUT> outputSelector : outputSelectors) {
    Iterable<String> outputNames=outputSelector.select(record);
    for (    String outputName : outputNames) {
      List<Collector<StreamRecord<OUT>>> outputList=outputMap.get(outputName);
      try {
        selectedOutputs.addAll(outputList);
      }
 catch (      NullPointerException e) {
        if (LOG.isErrorEnabled()) {
          String format=String.format("Cannot emit because no output is selected with the name: %s",outputName);
          LOG.error(format);
        }
      }
    }
  }
  return selectedOutputs;
}
