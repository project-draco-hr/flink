{
  final FileDataSource read=new FileDataSource(JsonInputFormat.class,this.getResource("SopremoTestPlan/test.json"),"Input");
  SopremoUtil.serialize(read.getParameters(),IOConstants.SCHEMA,Schema.Default);
  final MapContract map=new MapContract(IdentityMap.class,"Map");
  map.setInput(read);
  final FileDataSink output=this.createOutput(map,SequentialOutputFormat.class);
  final TestPlan testPlan=new TestPlan(output);
  testPlan.run();
  TestRecords input=testPlan.getInput();
  input.setSchema(Schema.Default.getPactSchema());
  Assert.assertEquals("input and output should be equal in identity map",input,testPlan.getActualOutput());
}
