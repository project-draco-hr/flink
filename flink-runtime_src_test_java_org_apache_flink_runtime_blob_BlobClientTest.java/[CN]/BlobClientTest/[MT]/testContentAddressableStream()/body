{
  try {
    final File testFile=File.createTempFile("testfile",".dat");
    testFile.deleteOnExit();
    final BlobKey origKey=prepareTestFile(testFile);
    BlobClient client=null;
    InputStream is=null;
    try {
      final InetSocketAddress serverAddress=new InetSocketAddress("localhost",BLOB_SERVER.getServerPort());
      client=new BlobClient(serverAddress);
      is=new FileInputStream(testFile);
      final BlobKey receivedKey=client.put(is);
      assertEquals(origKey,receivedKey);
      is.close();
      is=null;
      is=client.get(receivedKey);
      validateGet(is,testFile);
    }
  finally {
      if (is != null) {
        is.close();
      }
      if (client != null) {
        client.close();
      }
    }
  }
 catch (  IOException ioe) {
    fail(StringUtils.stringifyException(ioe));
  }
}
