{
  Record rec=null;
  int c1=0, c2=0;
  int numValues=0;
  while (records.hasNext()) {
    rec=records.next();
    final int f1=rec.getField(2,IntValue.class).getValue();
    final int f2=rec.getField(3,IntValue.class).getValue();
    c1+=f1;
    c2+=f2;
    numValues++;
  }
  if (numValues != 2 || c1 == 0 || c2 == 0) {
    throw new RuntimeException("JoinCountsAndUniquify Problem: key1=" + rec.getField(0,IntValue.class).getValue() + ", key2="+ rec.getField(1,IntValue.class).getValue()+ "values="+ numValues+ ", c1="+ c1+ ", c2="+ c2);
  }
  count1.setValue(c1);
  count2.setValue(c2);
  rec.setField(2,count1);
  rec.setField(3,count2);
  out.collect(rec);
}
