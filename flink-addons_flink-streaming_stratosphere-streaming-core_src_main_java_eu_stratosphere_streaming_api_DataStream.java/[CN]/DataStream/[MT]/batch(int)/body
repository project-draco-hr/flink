{
  DataStream<T> returnStream=copy();
  if (batchSize < 1) {
    throw new IllegalArgumentException("Batch size must be positive.");
  }
  for (int i=0; i < returnStream.batchSizes.size(); i++) {
    returnStream.batchSizes.set(i,batchSize);
  }
  return returnStream;
}
