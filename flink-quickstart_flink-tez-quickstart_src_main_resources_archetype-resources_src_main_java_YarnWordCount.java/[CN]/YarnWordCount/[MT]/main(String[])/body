{
  if (!parseParameters(args)) {
    return;
  }
  final RemoteTezEnvironment env=RemoteTezEnvironment.create();
  env.setParallelism(parallelism);
  DataSet<String> text=env.readTextFile(textPath);
  DataSet<Tuple2<String,Integer>> counts=text.flatMap(new LineSplitter()).groupBy(0).sum(1);
  counts.writeAsCsv(outputPath,"\n"," ");
  env.registerMainClass(YarnWordCount.class);
  env.execute("WordCount Example");
}
