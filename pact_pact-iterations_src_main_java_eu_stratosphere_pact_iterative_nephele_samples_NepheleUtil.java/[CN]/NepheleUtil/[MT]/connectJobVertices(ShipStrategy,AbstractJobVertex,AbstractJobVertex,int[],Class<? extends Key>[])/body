{
  ChannelType channelType;
switch (shipStrategy) {
case FORWARD:
case PARTITION_LOCAL_HASH:
    channelType=ChannelType.INMEMORY;
  break;
case PARTITION_HASH:
case PARTITION_RANGE:
case BROADCAST:
case SFR:
channelType=ChannelType.NETWORK;
break;
default :
throw new IllegalArgumentException("Unsupported ship-strategy: " + shipStrategy.name());
}
TaskConfig outputConfig=new TaskConfig(outputVertex.getConfiguration());
TaskConfig inputConfig=new TaskConfig(inputVertex.getConfiguration());
outputVertex.connectTo(inputVertex,channelType,CompressionLevel.NO_COMPRESSION);
if ((keyPos == null | keyTypes == null) || (keyPos.length == 0 | keyTypes.length == 0)) {
outputConfig.addOutputShipStrategy(shipStrategy);
}
 else {
}
System.out.println(outputVertex.getName() + " --> " + inputVertex.getName()+ "::"+ channelType);
}
