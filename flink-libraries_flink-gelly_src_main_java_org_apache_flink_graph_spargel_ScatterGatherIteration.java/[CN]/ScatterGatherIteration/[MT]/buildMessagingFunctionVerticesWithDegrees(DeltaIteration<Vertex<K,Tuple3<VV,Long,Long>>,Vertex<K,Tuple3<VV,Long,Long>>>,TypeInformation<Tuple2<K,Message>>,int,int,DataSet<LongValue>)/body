{
  CoGroupOperator<?,?,Tuple2<K,Message>> messages;
  MessagingUdfWithEdgeValues<K,Tuple3<VV,Long,Long>,VV,Message,EV> messenger=new MessagingUdfWithEVsVVWithDegrees<K,VV,Message,EV>(messagingFunction,messageTypeInfo);
  messages=this.edgesWithValue.coGroup(iteration.getWorkset()).where(whereArg).equalTo(equalToArg).with(messenger);
  messages=messages.name("Messaging");
  if (this.configuration != null) {
    for (    Tuple2<String,DataSet<?>> e : this.configuration.getMessagingBcastVars()) {
      messages=messages.withBroadcastSet(e.f1,e.f0);
    }
    if (this.configuration.isOptNumVertices()) {
      messages=messages.withBroadcastSet(numberOfVertices,"number of vertices");
    }
  }
  return messages;
}
