{
  Map<KafkaTopicPartitionLeader,Long> searchMap=new HashMap<>(map);
  for (  Map.Entry<KafkaTopicPartitionLeader,Long> entry : searchMap.entrySet()) {
    if (entry.getKey().getTopicPartition().equals(newKey.getTopicPartition())) {
      Long oldValue=map.remove(entry.getKey());
      if (map.put(newKey,newValue) != null) {
        throw new IllegalStateException("Key was not removed before");
      }
      return oldValue;
    }
  }
  return null;
}
