{
  TransitiveClosureEntry tc=new TransitiveClosureEntry();
  ComponentUpdate update=new ComponentUpdate();
  long vid;
  long oldCid;
  while (inputs[0].next(tc)) {
    vid=tc.getVid();
    oldCid=tc.getCid();
    long cid=oldCid;
    int numNeighbours=tc.getNumNeighbors();
    long[] neighbourIds=tc.getNeighbors();
    for (int i=0; i < numNeighbours; i++) {
      if (neighbourIds[i] < cid) {
        cid=neighbourIds[i];
      }
    }
    if (cid < oldCid) {
      update.setVid(vid);
      update.setCid(cid);
      output.collect(update);
    }
  }
}
