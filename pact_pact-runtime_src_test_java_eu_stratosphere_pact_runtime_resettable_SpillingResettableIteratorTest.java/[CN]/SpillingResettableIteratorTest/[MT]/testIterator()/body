{
  KeyValuePair<TestData.Key,TestData.Value> actual, expected;
  TestData.Generator generator=new TestData.Generator(SEED,KEY_MAX,VALUE_LENGTH);
  SpillingResettableIterator<KeyValuePair<TestData.Key,TestData.Value>> iterator=new SpillingResettableIterator<KeyValuePair<TestData.Key,TestData.Value>>(memoryManager,ioManager,reader,MEMORY_SIZE,new KeyValuePairDeserializer<TestData.Key,TestData.Value>(TestData.Key.class,TestData.Value.class));
  try {
    iterator.open();
  }
 catch (  IOException e) {
    Assert.fail("Could not open resettable iterator:" + e.getMessage());
  }
  for (int i=0; i < NUMBER_OF_RECORDS; i++) {
    Assert.assertTrue("Next pair expected but does not exist",iterator.hasNext());
    actual=iterator.next();
    expected=generator.next();
    Assert.assertEquals("Pairs don't match at index " + i,expected,actual);
  }
  Assert.assertFalse("Unexpected next pair",iterator.hasNext());
  iterator.reset();
  generator.reset();
  while (iterator.hasNext()) {
    actual=iterator.next();
    expected=generator.next();
    Assert.assertEquals("Pairs don't match",expected,actual);
  }
  iterator.close();
}
