{
  this.inputs=inputs;
  if (inputs.isEmpty()) {
    throw new RuntimeException("Inputs must not be empty");
  }
  TypeInformation<IN> inTypeInfo=TypeExtractor.getForObject(inputs.iterator().next());
  inDeserializer=new StreamRecordSerializer<IN>(inTypeInfo);
  iterator=new MockInputIterator();
  outputs=new ArrayList<OUT>();
  collector=new MockCollector<OUT>(outputs);
}
