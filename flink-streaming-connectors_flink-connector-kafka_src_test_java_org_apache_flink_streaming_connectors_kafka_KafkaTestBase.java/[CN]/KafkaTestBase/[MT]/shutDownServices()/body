{
  LOG.info("-------------------------------------------------------------------------");
  LOG.info("    Shut down KafkaITCase ");
  LOG.info("-------------------------------------------------------------------------");
  flinkPort=-1;
  if (flink != null) {
    flink.shutdown();
  }
  for (  KafkaServer broker : brokers) {
    if (broker != null) {
      broker.shutdown();
    }
  }
  brokers.clear();
  if (zookeeper != null) {
    try {
      zookeeper.stop();
    }
 catch (    Exception e) {
      LOG.warn("ZK.stop() failed",e);
    }
    zookeeper=null;
  }
  if (tmpKafkaParent != null && tmpKafkaParent.exists()) {
    try {
      FileUtils.deleteDirectory(tmpKafkaParent);
    }
 catch (    Exception e) {
    }
  }
  if (tmpZkDir != null && tmpZkDir.exists()) {
    try {
      FileUtils.deleteDirectory(tmpZkDir);
    }
 catch (    Exception e) {
    }
  }
  LOG.info("-------------------------------------------------------------------------");
  LOG.info("    KafkaITCase finished");
  LOG.info("-------------------------------------------------------------------------");
}
