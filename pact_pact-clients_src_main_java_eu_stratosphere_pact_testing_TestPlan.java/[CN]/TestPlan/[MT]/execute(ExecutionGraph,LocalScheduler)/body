{
  while (!eg.isExecutionFinished() && eg.getJobStatus() != InternalJobStatus.FAILED) {
    final Set<ExecutionVertex> verticesReadyToBeExecuted=localScheduler.getVerticesReadyToBeExecuted();
    for (    final ExecutionVertex executionVertex : verticesReadyToBeExecuted) {
      if (executionVertex.isInputVertex())       InputSplitAssigner.assignInputSplits(executionVertex);
      executionVertex.getEnvironment().registerExecutionListener(new ExecutionExceptionHandler(executionVertex));
      final TaskSubmissionResult submissionResult=executionVertex.startTask();
      if (submissionResult.getReturnCode() == AbstractTaskResult.ReturnCode.ERROR)       Assert.fail(submissionResult.getDescription());
    }
    try {
      Thread.sleep(10);
    }
 catch (    final InterruptedException e) {
    }
  }
  if (this.executionError != null)   Assert.fail(String.format("Error @ %s: %s",this.erroneousVertex.getName(),this.executionError));
}
