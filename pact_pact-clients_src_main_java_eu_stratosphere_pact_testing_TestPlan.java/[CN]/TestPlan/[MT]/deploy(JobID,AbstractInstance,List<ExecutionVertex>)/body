{
  final Iterator<ExecutionVertex> it=verticesToBeDeployed.iterator();
  while (it.hasNext()) {
    final ExecutionVertex executionVertex=it.next();
    if (executionVertex.isInputVertex()) {
      try {
        InputSplitAssigner.assignInputSplits(executionVertex);
      }
 catch (      ExecutionFailureException e) {
        fail(e);
      }
    }
    executionVertex.getEnvironment().registerExecutionListener(new ExecutionExceptionHandler(executionVertex));
    final TaskSubmissionResult submissionResult=executionVertex.startTask();
    if (submissionResult.getReturnCode() == AbstractTaskResult.ReturnCode.ERROR)     fail(submissionResult.getDescription());
  }
}
