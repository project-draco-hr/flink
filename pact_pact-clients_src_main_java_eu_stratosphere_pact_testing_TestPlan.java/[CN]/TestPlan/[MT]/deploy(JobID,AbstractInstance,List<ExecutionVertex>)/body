{
  final Iterator<ExecutionVertex> it=verticesToBeDeployed.iterator();
  while (it.hasNext()) {
    final ExecutionVertex vertex=it.next();
    Environment environment=vertex.getEnvironment();
    environment.registerExecutionListener(new ExecutionExceptionHandler(vertex));
    environment.setInputSplitProvider(new MockInputSplitProvider(vertex));
    final TaskSubmissionResult submissionResult=vertex.startTask();
    if (submissionResult.getReturnCode() == AbstractTaskResult.ReturnCode.ERROR)     fail(submissionResult.getDescription());
  }
}
