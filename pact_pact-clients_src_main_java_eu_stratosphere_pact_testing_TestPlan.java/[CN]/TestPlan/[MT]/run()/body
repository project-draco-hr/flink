{
  this.errorHandlers.clear();
  try {
    ExecutionGraph eg=this.getExecutionGraph();
    final LocalScheduler localScheduler=new LocalScheduler(this,MockInstanceManager.INSTANCE);
    this.inputSplitManager.registerJob(eg);
    localScheduler.schedulJob(eg);
    this.execute(eg);
  }
 catch (  final Exception e) {
    Assert.fail("plan scheduling: " + StringUtils.stringifyException(e));
  }
  for (  ExecutionExceptionHandler errorHandler : errorHandlers)   if (errorHandler.executionError != null)   Assert.fail(String.format("Error @ %s: %s",errorHandler.executionVertex.getName(),errorHandler.executionError));
  try {
    this.validateResults();
  }
  finally {
    try {
      this.close();
    }
 catch (    IOException e) {
    }
  }
}
