{
  final Plan plan=this.buildPlanWithReadableSinks();
  this.syncDegreeOfParallelism(plan);
  this.initAdhocInputs();
  final OptimizedPlan optimizedPlan=this.compile(plan);
  this.replaceShippingStrategy(optimizedPlan);
  final JobGraph jobGraph=new JobGraphGenerator().compileJobGraph(optimizedPlan);
  LibraryCacheManager.register(jobGraph.getJobID(),new String[0]);
  final ExecutionGraph eg=new ExecutionGraph(jobGraph,MockInstanceManager.INSTANCE);
  return eg;
}
