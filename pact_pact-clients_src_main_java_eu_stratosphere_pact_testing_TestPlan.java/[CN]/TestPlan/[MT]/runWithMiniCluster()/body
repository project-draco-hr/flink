{
  try {
    Configuration config=new Configuration();
    config.setString(ConfigConstants.JOB_MANAGER_IPC_ADDRESS_KEY,"localhost");
    JobManager jobManager=new JobManager(this.getNepheleConf(),"local");
    PactCompiler pc=new PactCompiler();
    Plan plan=this.buildPlanWithReadableSinks();
    OptimizedPlan op=pc.compile(plan);
    JobGraphGenerator jgg=new JobGraphGenerator();
    JobGraph jobGraph=jgg.compileJobGraph(op);
    jobManager.submitJob(jobGraph);
    Configuration configuration=jobGraph.getJobConfiguration();
    configuration.setString(ConfigConstants.JOB_MANAGER_IPC_ADDRESS_KEY,"localhost");
    JobClient jobClient=new JobClient(jobGraph,configuration);
    jobClient.submitJobAndWait();
  }
 catch (  CompilerException e1) {
    e1.printStackTrace();
  }
catch (  IOException e1) {
    e1.printStackTrace();
  }
catch (  JobExecutionException e1) {
    e1.printStackTrace();
  }
  try {
    this.validateResults();
  }
  finally {
    try {
      this.close();
    }
 catch (    IOException e) {
    }
  }
}
