{
  if (t instanceof ParameterizedType && (Collector.class.isAssignableFrom(typeToClass(t)) || Iterable.class.isAssignableFrom(typeToClass(t)))) {
    return ((ParameterizedType)t).getActualTypeArguments()[0];
  }
  return t;
}
