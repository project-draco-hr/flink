{
  @SuppressWarnings("unchecked") MapState<K,V>[] states=new MapState[numberOfPartitions];
  for (int i=0; i < numberOfPartitions; i++) {
    states[i]=new MapState<K,V>();
  }
  for (  Entry<K,V> entry : this.state.entrySet()) {
    int partition=Math.abs(entry.getKey().hashCode() % numberOfPartitions);
    states[partition].state.put(entry.getKey(),entry.getValue());
  }
  return states;
}
