{
  ParallelSessionsEventGenerator<Integer,SessionEvent<Integer,TestEventPayload>> stream=createTestStream();
  this.isRunning=true;
  while (isRunning) {
synchronized (ctx.getCheckpointLock()) {
      SessionEvent<Integer,TestEventPayload> evt=stream.nextEvent();
      if (evt != null) {
        ctx.collectWithTimestamp(evt,evt.getEventTimestamp());
        ctx.emitWatermark(new Watermark(stream.getWatermark()));
      }
 else {
        break;
      }
    }
  }
}
