{
  DataStream<T> inputStream=this.copy();
  StreamOperator<R> returnStream=new SingleInputStreamOperator<T,R>(environment,functionName);
  try {
    jobGraphBuilder.addTask(returnStream.getId(),functionInvokable,typeWrapper,functionName,SerializationUtils.serialize(function),degreeOfParallelism);
  }
 catch (  SerializationException e) {
    throw new RuntimeException("Cannot serialize user defined function");
  }
  connectGraph(inputStream,returnStream.getId(),0);
  if (inputStream instanceof IterativeDataStream) {
    returnStream.addIterationSource(((IterativeDataStream<T>)inputStream).iterationID.toString());
  }
  if (inputStream instanceof NamedDataStream) {
    returnStream.name(inputStream.userDefinedName);
  }
  return returnStream;
}
