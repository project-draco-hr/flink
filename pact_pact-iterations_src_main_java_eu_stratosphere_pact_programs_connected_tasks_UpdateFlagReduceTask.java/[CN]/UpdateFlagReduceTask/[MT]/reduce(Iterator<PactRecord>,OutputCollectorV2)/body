{
  PactRecord rec=new PactRecord();
  PactLong number=new PactLong();
  PactBoolean updated=new PactBoolean();
  long newCid=Long.MAX_VALUE;
  boolean wasUpdated=false;
  while (records.hasNext()) {
    rec=records.next();
    number=rec.getField(1,number);
    updated=rec.getField(2,updated);
    if (number.getValue() < newCid) {
      newCid=number.getValue();
      wasUpdated=updated.isValue();
    }
 else     if (wasUpdated && !updated.isValue() && number.getValue() == newCid) {
      wasUpdated=false;
    }
  }
  result.setCid(newCid);
  result.setVid(rec.getField(0,number).getValue());
  result.setUpdated(wasUpdated);
  out.collect(result);
}
