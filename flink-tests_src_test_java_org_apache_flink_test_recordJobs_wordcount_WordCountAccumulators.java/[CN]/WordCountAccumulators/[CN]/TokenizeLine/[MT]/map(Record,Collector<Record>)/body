{
  numLines.add(1L);
  String line=record.getField(0,StringValue.class).getValue();
  line=line.replaceAll("\\W+"," ").toLowerCase();
  StringTokenizer tokenizer=new StringTokenizer(line);
  int numWords=0;
  while (tokenizer.hasMoreTokens()) {
    String word=tokenizer.nextToken();
    distinctWords.add(new StringValue(word));
    ++numWords;
    collector.collect(new Record(new StringValue(word),new IntValue(1)));
  }
  this.wordsPerLine.add(numWords);
}
