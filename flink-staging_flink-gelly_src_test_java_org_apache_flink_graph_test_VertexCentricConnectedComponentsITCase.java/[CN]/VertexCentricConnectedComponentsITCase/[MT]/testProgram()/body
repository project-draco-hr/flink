{
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<Long> vertexIds=env.generateSequence(1,NUM_VERTICES);
  DataSet<String> edgeString=env.fromElements(ConnectedComponentsData.getRandomOddEvenEdges(NUM_EDGES,NUM_VERTICES,SEED).split("\n"));
  DataSet<Edge<Long,NullValue>> edges=edgeString.map(new EdgeParser());
  DataSet<Vertex<Long,Long>> initialVertices=vertexIds.map(new IdAssigner());
  Graph<Long,Long,NullValue> graph=Graph.fromDataSet(initialVertices,edges,env);
  VertexCentricIteration<Long,Long,Long,NullValue> iteration=graph.createVertexCentricIteration(new CCUpdater(),new CCMessager(),100);
  Graph<Long,Long,NullValue> result=graph.runVertexCentricIteration(iteration);
  result.getVertices().writeAsCsv(resultPath,"\n"," ");
  env.execute();
}
