Iterator<Record> ranks
Iterator<Record> visits
Collector<Record> out
