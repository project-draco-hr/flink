{
  int numSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String docsInput=(args.length > 1 ? args[1] : "");
  String ranksInput=(args.length > 2 ? args[2] : "");
  String visitsInput=(args.length > 3 ? args[3] : "");
  String output=(args.length > 4 ? args[4] : "");
  @SuppressWarnings("unchecked") CsvInputFormat docsFormat=new CsvInputFormat('|',StringValue.class,StringValue.class);
  FileDataSource docs=new FileDataSource(docsFormat,docsInput,"Docs Input");
  FileDataSource ranks=new FileDataSource(new CsvInputFormat(),ranksInput,"Ranks input");
  CsvInputFormat.configureRecordFormat(ranks).recordDelimiter('\n').fieldDelimiter('|').field(StringValue.class,1).field(IntValue.class,0).field(IntValue.class,2);
  @SuppressWarnings("unchecked") CsvInputFormat visitsFormat=new CsvInputFormat('|',null,StringValue.class,StringValue.class);
  FileDataSource visits=new FileDataSource(visitsFormat,visitsInput,"Visits input:q");
  MapOperator filterDocs=MapOperator.builder(new FilterDocs()).input(docs).name("Filter Docs").build();
  filterDocs.getCompilerHints().setFilterFactor(0.15f);
  MapOperator filterRanks=MapOperator.builder(new FilterRanks()).input(ranks).name("Filter Ranks").build();
  filterRanks.getCompilerHints().setFilterFactor(0.25f);
  MapOperator filterVisits=MapOperator.builder(new FilterVisits()).input(visits).name("Filter Visits").build();
  filterVisits.getCompilerHints().setFilterFactor(0.2f);
  JoinOperator joinDocsRanks=JoinOperator.builder(new JoinDocRanks(),StringValue.class,0,0).input1(filterDocs).input2(filterRanks).name("Join Docs Ranks").build();
  CoGroupOperator antiJoinVisits=CoGroupOperator.builder(new AntiJoinVisits(),StringValue.class,0,0).input1(joinDocsRanks).input2(filterVisits).name("Antijoin DocsVisits").build();
  FileDataSink result=new FileDataSink(new CsvOutputFormat(),output,antiJoinVisits,"Result");
  result.setDegreeOfParallelism(numSubTasks);
  CsvOutputFormat.configureRecordFormat(result).recordDelimiter('\n').fieldDelimiter('|').lenient(true).field(IntValue.class,1).field(StringValue.class,0).field(IntValue.class,2);
  Plan p=new Plan(result,"Weblog Analysis");
  p.setDefaultParallelism(numSubTasks);
  return p;
}
