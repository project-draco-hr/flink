{
  JobOutputVertex output=JobGraphUtils.createFileOutput(jobGraph,"Output",numSubTasks,numSubTasks);
{
    TaskConfig taskConfig=new TaskConfig(output.getConfiguration());
    taskConfig.addInputToGroup(0);
    taskConfig.setInputSerializer(serializer,0);
    taskConfig.setStubWrapper(new UserCodeClassWrapper<CsvOutputFormat>(CsvOutputFormat.class));
    taskConfig.setStubParameter(FileOutputFormat.FILE_PARAMETER_KEY,resultPath);
    Configuration stubConfig=taskConfig.getStubParameters();
    stubConfig.setString(CsvOutputFormat.RECORD_DELIMITER_PARAMETER,"\n");
    stubConfig.setString(CsvOutputFormat.FIELD_DELIMITER_PARAMETER," ");
    stubConfig.setClass(CsvOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 0,LongValue.class);
    stubConfig.setInteger(CsvOutputFormat.RECORD_POSITION_PARAMETER_PREFIX + 0,0);
    stubConfig.setClass(CsvOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 1,LongValue.class);
    stubConfig.setInteger(CsvOutputFormat.RECORD_POSITION_PARAMETER_PREFIX + 1,1);
    stubConfig.setClass(CsvOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 2,LongValue.class);
    stubConfig.setInteger(CsvOutputFormat.RECORD_POSITION_PARAMETER_PREFIX + 2,2);
    stubConfig.setInteger(CsvOutputFormat.NUM_FIELDS_PARAMETER,3);
  }
  return output;
}
