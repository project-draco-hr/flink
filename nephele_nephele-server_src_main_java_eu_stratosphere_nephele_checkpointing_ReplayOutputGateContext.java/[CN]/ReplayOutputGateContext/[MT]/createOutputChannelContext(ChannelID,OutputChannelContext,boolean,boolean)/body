{
  if (previousContext != null) {
    activateForwardingBarrier(previousContext);
  }
  final RuntimeDispatcher runtimeDispatcher=new RuntimeDispatcher(this.taskContext.getTransferEnvelopeDispatcher());
  final SpillingBarrier spillingBarrier=new SpillingBarrier(isReceiverRunning,mergeSpillBuffers,runtimeDispatcher);
  final ForwardingBarrier forwardingBarrier=new ForwardingBarrier(channelID,spillingBarrier);
  final ReplayOutputBroker outputChannelBroker=new ReplayOutputBroker(this.taskContext,forwardingBarrier);
  final OutputChannelForwardingChain forwardingChain=new OutputChannelForwardingChain(outputChannelBroker,runtimeDispatcher);
  outputChannelBroker.setForwardingChain(forwardingChain);
  this.taskContext.registerReplayOutputBroker(channelID,outputChannelBroker);
  return new ReplayOutputChannelContext(null,channelID,forwardingChain,previousContext);
}
