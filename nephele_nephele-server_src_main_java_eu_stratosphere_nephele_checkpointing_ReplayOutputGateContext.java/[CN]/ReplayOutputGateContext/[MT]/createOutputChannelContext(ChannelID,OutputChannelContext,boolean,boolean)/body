{
  if (previousContext != null) {
    activateForwardingBarrier(previousContext);
  }
  final OutputChannelForwardingChain forwardingChain=new OutputChannelForwardingChain();
  final IncomingEventQueue incomingEventQueue=AbstractOutputChannelContext.createIncomingEventQueue(forwardingChain);
  final ReplayOutputBroker outputBroker=new ReplayOutputBroker(this.taskContext,forwardingChain,incomingEventQueue);
  forwardingChain.addForwarder(outputBroker);
  forwardingChain.addForwarder(new ForwardingBarrier(channelID));
  forwardingChain.addForwarder(new SpillingBarrier(isReceiverRunning,mergeSpillBuffers));
  forwardingChain.addForwarder(this.taskContext.getRuntimeDispatcher());
  this.taskContext.registerReplayOutputBroker(channelID,outputBroker);
  return new ReplayOutputChannelContext(null,channelID,incomingEventQueue,previousContext);
}
