{
  FileInputSplit[] splits=getFileInputSplits();
  for (int i=0; i < splits.length; i++) {
    FileInputSplit split=splits[i];
    long start=split.getStart();
    long length=split.getLength();
    FileSystem fs=FileSystem.get(split.getPath().toUri());
    FSDataInputStream fdis=fs.open(split.getPath());
    LineReader lineReader=new LineReader(fdis,start,length,(1024 * 1024));
    byte[] line=lineReader.readLine();
    while (line != null) {
      StringRecord str=new StringRecord();
      str.set(line);
      output.emit(str);
      line=lineReader.readLine();
    }
    lineReader.close();
  }
}
