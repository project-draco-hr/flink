{
  Map<TopicPartition,OffsetFetchResponse.PartitionData> responseData=new HashMap<TopicPartition,OffsetFetchResponse.PartitionData>();
  for (  TopicPartition partition : partitions) {
    responseData.put(partition,new OffsetFetchResponse.PartitionData(OffsetFetchResponse.INVALID_OFFSET,OffsetFetchResponse.NO_METADATA,Errors.forException(e).code()));
  }
switch (versionId) {
case 0:
case 1:
    return new OffsetFetchResponse(responseData);
default :
  throw new IllegalArgumentException(String.format("Version %d is not valid. Valid versions for %s are 0 to %d",versionId,this.getClass().getSimpleName(),ProtoUtils.latestVersion(ApiKeys.OFFSET_FETCH.id)));
}
}
