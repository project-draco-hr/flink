{
  this.config=config;
  final Class<? extends Driver<S,OT>> driverClass=this.config.getDriver();
  this.driver=InstantiationUtil.instantiate(driverClass,Driver.class);
  LOG.info("ClassLoader URLs: " + Arrays.toString(((URLClassLoader)this.userCodeClassLoader).getURLs()));
  this.stub=this.config.<S>getStubWrapper(this.userCodeClassLoader).getUserCodeObject(Function.class,this.userCodeClassLoader);
  this.runtimeUdfContext=runtimeUdfContext;
  this.outSerializer=(TypeSerializer<OT>)this.config.getOutputSerializer(getClass().getClassLoader()).getSerializer();
  this.numberOfSubTasksInOutputs=this.config.getNumberSubtasksInOutput();
  this.taskName=this.config.getTaskName();
  this.numberOfSubtasks=this.runtimeUdfContext.getNumberOfParallelSubtasks();
  this.indexInSubtaskGroup=this.runtimeUdfContext.getIndexOfThisSubtask();
  this.runtimeEnvironment=new TezRuntimeEnvironment((long)(0.7 * availableMemory));
  this.executionConfig=runtimeUdfContext.getExecutionConfig();
  this.invokable.setExecutionConfig(this.executionConfig);
}
