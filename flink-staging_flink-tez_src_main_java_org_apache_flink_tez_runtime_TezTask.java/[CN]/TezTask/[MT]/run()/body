{
  boolean stubOpen=false;
  try {
    try {
      this.driver.prepare();
    }
 catch (    Throwable t) {
      throw new Exception("The data preparation for task '" + this.taskName + "' , caused an error: "+ t.getMessage(),t);
    }
    if (this.stub != null) {
      try {
        Configuration stubConfig=this.config.getStubParameters();
        FunctionUtils.openFunction(this.stub,stubConfig);
        stubOpen=true;
      }
 catch (      Throwable t) {
        throw new Exception("The user defined 'open()' method caused an exception: " + t.getMessage(),t);
      }
    }
    this.driver.run();
    if (this.stub != null) {
      FunctionUtils.closeFunction(this.stub);
      stubOpen=false;
    }
    this.output.close();
  }
 catch (  Exception ex) {
    ex.printStackTrace();
    throw new RuntimeException("Exception in TaskContext: " + ex.getMessage() + " "+ ex.getStackTrace());
  }
 finally {
    this.driver.cleanup();
  }
}
