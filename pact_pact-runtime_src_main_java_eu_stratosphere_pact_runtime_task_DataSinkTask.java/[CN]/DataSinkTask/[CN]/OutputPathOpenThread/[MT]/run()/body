{
  try {
    final FileSystem fs=this.path.getFileSystem();
    Path p=this.path;
    if (fs.exists(this.path) && fs.getFileStatus(this.path).isDir()) {
      p=this.path.suffix(Path.SEPARATOR + this.taskIndex);
    }
    final FSDataOutputStream stream=fs.create(p,true);
synchronized (this.lock) {
      this.lock.notifyAll();
      if (!this.canceled) {
        this.fdos=stream;
      }
 else {
        this.fdos=null;
        stream.close();
      }
    }
  }
 catch (  Exception t) {
synchronized (this.lock) {
      this.canceled=true;
      this.exception=t;
    }
  }
}
