{
  checkErroneous();
  byte[] serializedKey=schema.serializeKey(next);
  byte[] serializedValue=schema.serializeValue(next);
  ProducerRecord<byte[],byte[]> record;
  if (partitioner == null) {
    record=new ProducerRecord<>(topicId,serializedKey,serializedValue);
  }
 else {
    record=new ProducerRecord<>(topicId,partitioner.partition(next,serializedKey,serializedValue,partitions.length),serializedKey,serializedValue);
  }
  producer.send(record,callback);
}
