{
  String pathPrefix=getFilesystemProvider().getURIPrefix() + getFilesystemProvider().getTempDirPath();
  FileDataSource input_left=new FileDataSource(CoGroupTestInFormat.class,pathPrefix + "/cogroup_left");
  input_left.setParameter(DelimitedInputFormat.RECORD_DELIMITER,"\n");
  input_left.setDegreeOfParallelism(config.getInteger("CoGroupTest#NoSubtasks",1));
  FileDataSource input_right=new FileDataSource(CoGroupTestInFormat.class,pathPrefix + "/cogroup_right");
  input_right.setParameter(DelimitedInputFormat.RECORD_DELIMITER,"\n");
  input_right.setDegreeOfParallelism(config.getInteger("CoGroupTest#NoSubtasks",1));
  CoGroupContract testCoGrouper=CoGroupContract.builder(TestCoGrouper.class,PactString.class,0,0).build();
  testCoGrouper.setDegreeOfParallelism(config.getInteger("CoGroupTest#NoSubtasks",1));
  testCoGrouper.getParameters().setString(PactCompiler.HINT_LOCAL_STRATEGY,config.getString("CoGroupTest#LocalStrategy",""));
  testCoGrouper.getParameters().setString(PactCompiler.HINT_SHIP_STRATEGY,config.getString("CoGroupTest#ShipStrategy",""));
  FileDataSink output=new FileDataSink(CoGroupOutFormat.class,pathPrefix + "/result.txt");
  output.setDegreeOfParallelism(1);
  output.addInput(testCoGrouper);
  testCoGrouper.addFirstInput(input_left);
  testCoGrouper.addSecondInput(input_right);
  Plan plan=new Plan(output);
  PactCompiler pc=new PactCompiler();
  OptimizedPlan op=pc.compile(plan);
  JobGraphGenerator jgg=new JobGraphGenerator();
  return jgg.compileJobGraph(op);
}
