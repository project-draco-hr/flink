{
  if (!parseParameters(args)) {
    return;
  }
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment().setDegreeOfParallelism(4);
  @SuppressWarnings("unused") DataStream<String> stream1=env.addSource(new SourceFunction<String>(){
    @Override public void invoke(    Collector<String> collector) throws Exception {
      for (int i=0; i < 100; i++) {
        collector.collect("message #" + i);
        Thread.sleep(100L);
      }
      collector.collect(new String("q"));
    }
  }
).addSink(new KafkaSink<String>(topic,host + ":" + port,new JavaDefaultStringSchema())).setParallelism(3);
  env.execute();
}
