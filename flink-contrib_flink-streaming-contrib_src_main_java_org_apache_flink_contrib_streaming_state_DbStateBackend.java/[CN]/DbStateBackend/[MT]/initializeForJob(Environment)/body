{
  this.rnd=new Random();
  this.env=env;
  connections=dbConfig.createShardedConnection();
  connections.setTransactionIsolation(Connection.TRANSACTION_READ_UNCOMMITTED);
  if (nonPartitionedStateBackend == null) {
    insertStatement=retry(new Callable<PreparedStatement>(){
      public PreparedStatement call() throws SQLException {
        dbAdapter.createCheckpointsTable(env.getJobID().toString(),getConnections().getFirst());
        return dbAdapter.prepareCheckpointInsert(env.getJobID().toString(),getConnections().getFirst());
      }
    }
,numSqlRetries,sqlRetrySleep);
  }
 else {
    nonPartitionedStateBackend.initializeForJob(env);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Database state backend successfully initialized");
  }
}
