{
  super.initializeForJob(env,operatorIdentifier,keySerializer);
  this.operatorIdentifier=operatorIdentifier;
  this.rnd=new Random();
  this.env=env;
  this.appId=env.getApplicationID().toString().substring(0,16);
  connections=dbConfig.createShardedConnection();
  connections.setTransactionIsolation(Connection.TRANSACTION_READ_UNCOMMITTED);
  if (nonPartitionedStateBackend == null) {
    insertStatement=retry(new Callable<PreparedStatement>(){
      public PreparedStatement call() throws SQLException {
        dbAdapter.createCheckpointsTable(appId,getConnections().getFirst());
        return dbAdapter.prepareCheckpointInsert(appId,getConnections().getFirst());
      }
    }
,numSqlRetries,sqlRetrySleep);
  }
 else {
    nonPartitionedStateBackend.initializeForJob(env,operatorIdentifier,keySerializer);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Database state backend successfully initialized");
  }
}
