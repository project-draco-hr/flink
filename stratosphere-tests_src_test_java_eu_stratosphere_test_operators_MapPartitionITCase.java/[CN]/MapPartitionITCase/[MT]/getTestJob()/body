{
  FileDataSource input=new FileDataSource(new ContractITCaseInputFormat(),inPath);
  DelimitedInputFormat.configureDelimitedFormat(input).recordDelimiter('\n');
  input.setDegreeOfParallelism(config.getInteger("MapPartitionTest#NoSubtasks",1));
  MapPartitionOperator testMapper=MapPartitionOperator.builder(new TestMapPartition()).build();
  testMapper.setDegreeOfParallelism(config.getInteger("TestMapPartition#NoSubtasks",1));
  FileDataSink output=new FileDataSink(new ContractITCaseOutputFormat(),resultPath);
  output.setDegreeOfParallelism(1);
  output.setInput(testMapper);
  testMapper.setInput(input);
  return new Plan(output);
}
