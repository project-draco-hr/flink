{
  if (isIterative() && isCheckpointingEnabled() && !forceCheckpoint) {
    throw new UnsupportedOperationException("Checkpointing is currently not supported by default for iterative jobs, as we cannot guarantee exactly once semantics. " + "State checkpoints happen normally, but records in-transit during the snapshot will be lost upon failure. " + "\nThe user can force enable state checkpoints with the reduced guarantees by calling: env.enableCheckpointing(interval,true)");
  }
  setJobName(jobGraphName);
  StreamingJobGraphGenerator jobgraphGenerator=new StreamingJobGraphGenerator(this);
  return jobgraphGenerator.createJobGraph(jobGraphName);
}
