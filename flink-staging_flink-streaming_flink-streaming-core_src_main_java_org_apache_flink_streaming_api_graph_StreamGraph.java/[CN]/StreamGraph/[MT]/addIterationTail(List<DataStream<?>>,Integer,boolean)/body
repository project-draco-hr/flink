{
  if (!streamLoops.containsKey(iterationID)) {
    throw new RuntimeException("Cannot close iteration without head operator.");
  }
  StreamLoop loop=streamLoops.get(iterationID);
  for (  DataStream<?> stream : feedbackStreams) {
    loop.addTailOperator(getStreamNode(stream.getId()),stream.getPartitioner(),stream.getSelectedNames());
  }
  if (keepPartitioning) {
    loop.applyTailPartitioning();
  }
}
