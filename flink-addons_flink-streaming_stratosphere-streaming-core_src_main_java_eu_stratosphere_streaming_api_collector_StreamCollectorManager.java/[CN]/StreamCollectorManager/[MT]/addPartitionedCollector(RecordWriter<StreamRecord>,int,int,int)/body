{
  @SuppressWarnings("unchecked") StreamCollector<Tuple>[] collector=new StreamCollector[outputParallelism];
  for (int j=0; j < outputParallelism; j++) {
    collector[j]=new StreamCollector<Tuple>(batchSize,batchTimeout,channelID,serializationDelegate,output,j);
  }
  PartitionedCollector<Tuple> partitionedCollector=new PartitionedCollector<Tuple>(collector,keyPosition);
  collectors.add(partitionedCollector);
  return partitionedCollector;
}
