{
  List<Integer> sliceSizes=new LinkedList<Integer>();
  if (buf.readableBytes() < MIN_SLICE_SIZE) {
    throw new IllegalStateException("Buffer to slice is smaller than required minimum slice size");
  }
  int available=buf.readableBytes() - MIN_SLICE_SIZE;
  while (available > 0) {
    int size=Math.min(available,Math.max(MIN_SLICE_SIZE,random.nextInt(MAX_SLICE_SIZE) + 1));
    available-=size;
    sliceSizes.add(size);
  }
  int[] slices=new int[sliceSizes.size()];
  for (int i=0; i < sliceSizes.size(); i++) {
    slices[i]=sliceSizes.get(i);
  }
  return slice(buf,slices);
}
