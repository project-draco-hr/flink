{
  Envelope env=new Envelope(random.nextInt(),new JobID(),new ChannelID());
  if (bufferSize > 0) {
    byte[] data=new byte[bufferSize];
    random.nextBytes(data);
    env.setBuffer(spy(new Buffer(new MemorySegment(data),bufferSize,RECYCLER)));
  }
  if (events != null && events.length > 0) {
    env.serializeEventList(Arrays.asList(events));
  }
  return env;
}
