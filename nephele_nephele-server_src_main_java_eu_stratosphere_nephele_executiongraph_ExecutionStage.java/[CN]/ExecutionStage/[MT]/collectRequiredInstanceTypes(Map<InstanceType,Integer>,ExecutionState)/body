{
  final Set<AbstractInstance> collectedInstances=new HashSet<AbstractInstance>();
  for (int i=0; i < getNumberOfStageMembers(); i++) {
    final ExecutionGroupVertex groupVertex=getStageMember(i);
    for (int j=0; j < groupVertex.getCurrentNumberOfGroupMembers(); j++) {
      final ExecutionVertex vertex=groupVertex.getGroupMember(j);
      if (vertex.getExecutionState() == executionState) {
        final AbstractInstance instance=vertex.getAllocatedResource().getInstance();
        if (collectedInstances.contains(instance)) {
          continue;
        }
 else {
          collectedInstances.add(instance);
        }
        if (instance instanceof DummyInstance) {
          Integer num=instanceTypeMap.get(instance.getType());
          num=(num == null) ? Integer.valueOf(1) : Integer.valueOf(num.intValue() + 1);
          instanceTypeMap.put(instance.getType(),num);
        }
 else {
          LOG.debug("Execution Vertex " + vertex.getName() + " ("+ vertex.getID()+ ") is already assigned to non-dummy instance, skipping...");
        }
      }
    }
  }
}
