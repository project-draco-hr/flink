{
  StreamExecutionEnvironment context=new StreamExecutionEnvironment();
  DataStream<Tuple1<Double>> dataStream0=context.addSource(new MySource()).batch(BATCH_SIZE).batchReduce(new MyBatchReduce()).addSink(new MySink());
  context.execute();
  for (int i=0; i < avgs.size(); i++) {
    assertEquals(1.5 + i * BATCH_SIZE,avgs.get(i),0);
  }
}
