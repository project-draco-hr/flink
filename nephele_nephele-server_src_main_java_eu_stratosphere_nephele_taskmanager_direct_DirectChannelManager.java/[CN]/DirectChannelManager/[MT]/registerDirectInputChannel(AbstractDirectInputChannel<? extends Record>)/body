{
  LOG.debug("Registering direct input channel " + directInputChannel.getID());
synchronized (this.directInputChannels) {
    if (this.directInputChannels.containsKey(directInputChannel.getID())) {
      LOG.error("Direct input channel " + directInputChannel.getID() + " is already registered");
      return;
    }
    directInputChannel.setDirectChannelBroker(this);
    directInputChannel.initializeBuffers(this.numberOfBuffersPerChannel,this.bufferSizeInRecords);
    directInputChannel.setNumberOfConnectionRetries(this.numberOfConnectionRetries);
    this.directInputChannels.put(directInputChannel.getID(),directInputChannel);
  }
}
