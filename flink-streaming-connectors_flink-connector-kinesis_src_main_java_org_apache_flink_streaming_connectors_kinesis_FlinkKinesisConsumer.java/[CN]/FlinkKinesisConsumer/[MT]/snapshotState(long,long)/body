{
  if (lastSequenceNums == null) {
    LOG.debug("snapshotState() requested on not yet opened source; returning null.");
    return null;
  }
  if (!running) {
    LOG.debug("snapshotState() called on closed source; returning null.");
    return null;
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Snapshotting state. ...");
  }
  @SuppressWarnings("unchecked") HashMap<KinesisStreamShard,SequenceNumber> currentSequenceNums=(HashMap<KinesisStreamShard,SequenceNumber>)lastSequenceNums.clone();
  return currentSequenceNums;
}
