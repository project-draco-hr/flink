{
  final BaseStatistics statistics=this.originalFormat.getStatistics(cachedStatistics);
  FileBaseStatistics stats=null;
  if (cachedStatistics != null && statistics instanceof FileBaseStatistics)   stats=(FileBaseStatistics)statistics;
 else   stats=new FileBaseStatistics(-1,statistics.getTotalInputSize(),statistics.getAverageRecordWidth());
  long sampleSize=Math.min(this.sampleSize,stats.getNumberOfRecords());
  stats.setTotalInputSize((long)Math.ceil(sampleSize * stats.getAverageRecordWidth()));
  return stats;
}
