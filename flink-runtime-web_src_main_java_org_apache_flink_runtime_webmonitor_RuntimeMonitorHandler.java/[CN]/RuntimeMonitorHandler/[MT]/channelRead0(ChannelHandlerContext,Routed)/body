{
  if (localJobManagerAddress == null) {
    localJobManagerAddress=localJobManagerAddressPromise.future().value().get().get();
  }
  Option<Tuple2<ActorGateway,Integer>> jobManager=retriever.getJobManagerGatewayAndWebPort();
  if (jobManager.isDefined()) {
    String redirectAddress=HandlerRedirectUtils.getRedirectAddress(localJobManagerAddress,jobManager.get());
    if (redirectAddress != null) {
      HttpResponse redirect=HandlerRedirectUtils.getRedirectResponse(redirectAddress,routed.path());
      KeepAliveWrite.flush(ctx,routed.request(),redirect);
    }
 else {
      respondAsLeader(ctx,routed,jobManager.get()._1());
    }
  }
 else {
    KeepAliveWrite.flush(ctx,routed.request(),HandlerRedirectUtils.getUnavailableResponse());
  }
}
