{
  ConstantFields constantSet=udfClass.getAnnotation(ConstantFields.class);
  ConstantFieldsExcept notConstantSet=udfClass.getAnnotation(ConstantFieldsExcept.class);
  ReadFields readfieldSet=udfClass.getAnnotation(ReadFields.class);
  Set<Annotation> result=null;
  if (notConstantSet != null && constantSet != null) {
    throw new InvalidProgramException("Either " + ConstantFields.class.getSimpleName() + " or "+ ConstantFieldsExcept.class.getSimpleName()+ " can be annotated to a function, not both.");
  }
  if (notConstantSet != null) {
    result=new HashSet<Annotation>();
    result.add(notConstantSet);
  }
  if (constantSet != null) {
    result=new HashSet<Annotation>();
    result.add(constantSet);
  }
  if (readfieldSet != null) {
    if (result == null) {
      result=new HashSet<Annotation>();
    }
    result.add(readfieldSet);
  }
  return result;
}
