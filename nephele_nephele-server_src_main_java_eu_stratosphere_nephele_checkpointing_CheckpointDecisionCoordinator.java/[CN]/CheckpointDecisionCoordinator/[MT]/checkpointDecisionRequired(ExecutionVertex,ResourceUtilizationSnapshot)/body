{
  LOG.info("Checkpoint decision for vertex " + vertex + " required");
  boolean checkpointDecision=getDecision(vertex,rus);
  if (checkpointDecision)   LOG.info("Creating Checkpoint for " + vertex.getEnvironment().getTaskNameWithIndex());
  final ExecutionGraph graph=vertex.getExecutionGraph();
  final Map<AbstractInstance,List<CheckpointDecision>> checkpointDecisions=new HashMap<AbstractInstance,List<CheckpointDecision>>();
  final List<CheckpointDecision> checkpointDecisionList=new SerializableArrayList<CheckpointDecision>();
synchronized (graph) {
    checkpointDecisionList.add(new CheckpointDecision(vertex.getID(),checkpointDecision));
    checkpointDecisions.put(vertex.getAllocatedResource().getInstance(),checkpointDecisionList);
  }
  this.decisionPropagator.propagateCheckpointDecisions(checkpointDecisions);
}
