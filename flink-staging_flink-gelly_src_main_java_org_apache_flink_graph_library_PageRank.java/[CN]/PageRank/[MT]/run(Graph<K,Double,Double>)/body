{
  if (numberOfVertices == 0) {
    numberOfVertices=network.numberOfVertices();
  }
  DataSet<Tuple2<K,Long>> vertexOutDegrees=network.outDegrees();
  Graph<K,Double,Double> networkWithWeights=network.joinWithEdgesOnSource(vertexOutDegrees,new InitWeightsMapper());
  return networkWithWeights.runVertexCentricIteration(new VertexRankUpdater<K>(beta,numberOfVertices),new RankMessenger<K>(numberOfVertices),maxIterations);
}
