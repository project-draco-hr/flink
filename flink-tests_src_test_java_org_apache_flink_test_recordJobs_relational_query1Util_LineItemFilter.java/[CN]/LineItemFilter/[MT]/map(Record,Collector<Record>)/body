{
  Tuple value=record.getField(1,Tuple.class);
  if (value != null && value.getNumberOfColumns() >= 11) {
    String shipDateString=value.getStringValueAt(10);
    try {
      Date shipDate=format.parse(shipDateString);
      if (shipDate.before(constantDate)) {
        String returnFlag=value.getStringValueAt(8);
        record.setField(0,new StringValue(returnFlag));
        out.collect(record);
      }
    }
 catch (    ParseException e) {
      LOG.warn("ParseException while parsing the shipping date.",e);
    }
  }
}
