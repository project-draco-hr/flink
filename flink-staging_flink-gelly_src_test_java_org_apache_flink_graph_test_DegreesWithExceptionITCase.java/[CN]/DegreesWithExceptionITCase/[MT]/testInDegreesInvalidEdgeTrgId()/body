{
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  Graph<Long,Long,Long> graph=Graph.fromDataSet(TestGraphUtils.getLongLongVertexData(env),TestGraphUtils.getLongLongEdgeInvalidTrgData(env),env);
  try {
    graph.inDegrees().output(new DiscardingOutputFormat<Tuple2<Long,Long>>());
    env.execute();
    fail("graph.inDegrees() did not throw NoSuchElementException");
  }
 catch (  Exception e) {
    Assert.assertEquals("The edge src/trg id could not be found within the vertexIds",e.getCause().getMessage());
    Assert.assertTrue(e.getCause() instanceof NoSuchElementException);
  }
}
