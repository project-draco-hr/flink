{
  AbstractJobVertex upStreamComponent=components.get(upStreamComponentName);
  AbstractJobVertex downStreamComponent=components.get(downStreamComponentName);
  try {
    upStreamComponent.connectTo(downStreamComponent,ChannelType.INMEMORY);
    Configuration config=new TaskConfig(upStreamComponent.getConfiguration()).getConfiguration();
    config.setClass("partitionerClass_" + upStreamComponent.getNumberOfForwardConnections(),FieldsPartitioner.class);
    config.setClass("partitionerClassParam_" + upStreamComponent.getNumberOfForwardConnections(),keyClass);
    config.setInteger("partitionerIntParam_" + upStreamComponent.getNumberOfForwardConnections(),keyPosition);
    addOutputChannels(upStreamComponentName);
    log.debug("CONNECTED: FIELD PARTITIONING - " + upStreamComponentName + " -> "+ downStreamComponentName+ ", KEY: "+ keyPosition);
  }
 catch (  JobGraphDefinitionException e) {
    log.error("Cannot connect components by field: " + upStreamComponentName + " to "+ downStreamComponentName,e);
  }
}
