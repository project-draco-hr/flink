{
  AbstractJobVertex upStreamComponent=components.get(upStreamComponentName);
  AbstractJobVertex downStreamComponent=components.get(downStreamComponentName);
  try {
    upStreamComponent.connectTo(downStreamComponent,channelType);
    Configuration config=new TaskConfig(upStreamComponent.getConfiguration()).getConfiguration();
    config.setClass("partitioner_" + upStreamComponent.getNumberOfForwardConnections(),getPartitioningClass(partitionType));
  }
 catch (  JobGraphDefinitionException e) {
    e.printStackTrace();
  }
}
