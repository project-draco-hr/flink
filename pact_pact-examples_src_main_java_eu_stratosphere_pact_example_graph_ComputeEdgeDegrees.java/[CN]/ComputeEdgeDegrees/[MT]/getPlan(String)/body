{
  final int noSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  final String edgeInput=args.length > 1 ? args[1] : "";
  final String output=args.length > 2 ? args[2] : "";
  final char delimiter=args.length > 3 ? (char)Integer.parseInt(args[3]) : ',';
  FileDataSource edges=new FileDataSource(EdgeInputFormat.class,edgeInput,"Input Edges");
  edges.setParameter(DelimitedInputFormat.RECORD_DELIMITER,"\n");
  edges.setParameter(EdgeInputFormat.ID_DELIMITER_CHAR,delimiter);
  edges.setDegreeOfParallelism(noSubTasks);
  MapContract projectEdge=new MapContract(ProjectEdge.class,edges,"Project Edge");
  projectEdge.setDegreeOfParallelism(noSubTasks);
  ReduceContract edgeCounter=new ReduceContract(CountEdges.class,PactInteger.class,0,projectEdge,"Count Edges for Vertex");
  edgeCounter.setDegreeOfParallelism(noSubTasks);
  @SuppressWarnings("unchecked") ReduceContract countJoiner=new ReduceContract(JoinCountsAndUniquify.class,new Class[]{PactInteger.class,PactInteger.class},new int[]{0,1},edgeCounter,"Join Counts");
  countJoiner.setDegreeOfParallelism(noSubTasks);
  FileDataSink triangles=new FileDataSink(EdgeWithDegreesOutputFormat.class,output,countJoiner,"Unique Edges With Degrees");
  triangles.setDegreeOfParallelism(noSubTasks);
  return new Plan(triangles,"Normalize Edges and compute Vertex Degrees");
}
