{
  final ShipStrategy strategy=config.getOutputShipStrategy(inputNum);
  final int[] keyPositions=config.getOutputShipKeyPositions(inputNum);
  final Class<? extends Key>[] keyClasses;
  try {
    keyClasses=config.getOutputShipKeyTypes(inputNum,cl);
  }
 catch (  ClassNotFoundException cnfex) {
    throw new RuntimeException("The classes for the keys determining the partitioning for output " + inputNum + "  could not be loaded.");
  }
  return (keyPositions == null || keyClasses == null) ? new OutputEmitter(strategy) : new OutputEmitter(strategy,jobID,keyPositions,keyClasses);
}
