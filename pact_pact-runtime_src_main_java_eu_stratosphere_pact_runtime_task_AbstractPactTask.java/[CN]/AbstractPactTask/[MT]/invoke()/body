{
  if (LOG.isInfoEnabled())   LOG.info(getLogString("Start PACT code."));
  prepare();
  try {
    this.stub.open(this.config.getStubParameters());
  }
 catch (  Throwable t) {
    throw new Exception("The user defined 'open()' method caused an exception: " + t.getMessage(),t);
  }
  try {
    run();
    if (this.running) {
      this.stub.close();
    }
  }
 catch (  Exception ex) {
    try {
      this.stub.close();
    }
 catch (    Throwable t) {
    }
    if (this.running) {
      if (LOG.isErrorEnabled())       LOG.error(getLogString("Unexpected ERROR in PACT code."));
      throw ex;
    }
  }
 finally {
    try {
      this.output.close();
    }
 catch (    Throwable t) {
    }
    cleanup();
  }
  if (this.running) {
    if (LOG.isInfoEnabled())     LOG.info(getLogString("Finished PACT code."));
  }
 else {
    if (LOG.isWarnEnabled())     LOG.warn(getLogString("PACT code cancelled."));
  }
}
