{
  final int numOutputs=config.getNumOutputs();
  final int numChained=config.getNumberOfChainedStubs();
  if (numChained > 0) {
    if (numOutputs != 1 || config.getOutputShipStrategy(0) != ShipStrategy.FORWARD) {
      throw new RuntimeException("Plan Generation Bug: Found a chained stub that is not connected via an only forward connection.");
    }
    Collector previous=null;
    for (int i=numChained - 1; i >= 0; --i) {
      final ChainedTask ct;
      try {
        Class<? extends ChainedTask> ctc=config.getChainedTask(i);
        ct=ctc.newInstance();
      }
 catch (      Exception ex) {
        throw new RuntimeException("Could not instantiate chained task driver.",ex);
      }
      final TaskConfig chainedStubConf=config.getChainedStubConfig(i);
      final String taskName=config.getChainedTaskName(i);
      if (i == numChained - 1) {
        previous=getOutputCollector(nepheleTask,chainedStubConf,cl,chainedStubConf.getNumOutputs());
      }
      ct.setup(chainedStubConf,taskName,nepheleTask,cl,previous);
      chainedTasksTarget.add(0,ct);
      previous=ct;
    }
    return previous;
  }
 else {
    return getOutputCollector(nepheleTask,config,cl,numOutputs);
  }
}
