{
  long batchTimeout=configuration.getLong("batchTimeout",1000);
  if (configuration.getBoolean("directedEmit",false)) {
    OutputSelector outputSelector=null;
    try {
      outputSelector=(OutputSelector)deserializeObject(configuration.getBytes("outputSelector",null));
    }
 catch (    Exception e) {
      if (log.isErrorEnabled()) {
        log.error("Cannot instantiate OutputSelector");
      }
    }
    collectorManager=new DirectedStreamCollectorManager<Tuple>(outSerializationDelegate,instanceID,batchTimeout,outputSelector);
  }
 else {
    collectorManager=new StreamCollectorManager<Tuple>(outSerializationDelegate,instanceID,batchTimeout);
  }
  return collectorManager;
}
