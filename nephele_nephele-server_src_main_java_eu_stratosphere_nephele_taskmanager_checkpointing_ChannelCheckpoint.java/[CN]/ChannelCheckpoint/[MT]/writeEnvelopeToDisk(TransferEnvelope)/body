{
  TransferEnvelope duplicatTransferEnvelope=transferEnvelope;
  if (transferEnvelope.getProcessingLog().mustBeSentViaNetwork()) {
    duplicatTransferEnvelope=transferEnvelope.duplicate();
  }
  if (this.fileChannel == null) {
    final FileOutputStream fos=new FileOutputStream(getFilename());
    this.fileChannel=fos.getChannel();
  }
  if (this.transferEnvelopeSerializer == null) {
    this.transferEnvelopeSerializer=new TransferEnvelopeSerializer();
  }
  this.transferEnvelopeSerializer.setTransferEnvelope(transferEnvelope);
  while (this.transferEnvelopeSerializer.write(this.fileChannel))   ;
}
