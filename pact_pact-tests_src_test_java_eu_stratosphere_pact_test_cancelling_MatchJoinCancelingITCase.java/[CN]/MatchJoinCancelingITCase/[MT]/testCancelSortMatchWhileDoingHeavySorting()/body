{
  GenericDataSource<UniformIntInput> source1=new GenericDataSource<UniformIntInput>(UniformIntInput.class,"Source 1");
  source1.setParameter(UniformIntInput.NUM_KEYS_KEY,50000);
  source1.setParameter(UniformIntInput.NUM_VALUES_KEY,100);
  GenericDataSource<UniformIntInput> source2=new GenericDataSource<UniformIntInput>(UniformIntInput.class,"Source 2");
  source2.setParameter(UniformIntInput.NUM_KEYS_KEY,50000);
  source2.setParameter(UniformIntInput.NUM_VALUES_KEY,100);
  MatchContract matcher=new MatchContract(SimpleMatcher.class,PactInteger.class,0,0,source1,source2,"Long Cancelling Sort Join");
  GenericDataSink sink=new GenericDataSink(DiscardingOutputFormat.class,matcher,"Sink");
  Plan p=new Plan(sink);
  p.setDefaultParallelism(4);
  runAndCancelJob(p,30 * 1000,30 * 1000);
}
