{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment(PARALLELISM);
  DataStream<Tuple1<Integer>> model=env.addSource(new TrainingDataSource(),SOURCE_PARALLELISM).map(new PartialModelBuilder()).broadcast();
  @SuppressWarnings("unchecked") DataStream<Tuple1<Integer>> prediction=env.addSource(new NewDataSource(),SOURCE_PARALLELISM).connectWith(model).map(new Predictor());
  prediction.print();
  env.execute();
}
