{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  IncrementalLearningSkeleton.SOURCE_PARALLELISM=env.getDegreeOfParallelism();
  DataStream<Double[]> model=env.addSource(new TrainingDataSource(),SOURCE_PARALLELISM).window(5000).reduceGroup(new PartialModelBuilder());
  DataStream<Integer> prediction=env.addSource(new NewDataSource(),SOURCE_PARALLELISM).connect(model).map(new Predictor());
  prediction.print();
  env.execute();
}
