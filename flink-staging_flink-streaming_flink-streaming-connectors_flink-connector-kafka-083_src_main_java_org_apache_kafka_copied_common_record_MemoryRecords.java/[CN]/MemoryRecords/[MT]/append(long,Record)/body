{
  if (!writable)   throw new IllegalStateException("Memory records is not writable");
  int size=record.size();
  compressor.putLong(offset);
  compressor.putInt(size);
  compressor.put(record.buffer());
  compressor.recordWritten(size + LOG_OVERHEAD);
  record.buffer().rewind();
}
