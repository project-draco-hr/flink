{
  JobOutputVertex output=JobGraphUtils.createFileOutput(jobGraph,"Final Output",numSubTasks,numSubTasks);
  TaskConfig outputConfig=new TaskConfig(output.getConfiguration());
{
    outputConfig.addInputToGroup(0);
    outputConfig.setInputSerializer(serializer,0);
    outputConfig.setStubWrapper(new UserCodeClassWrapper<RecordOutputFormat>(RecordOutputFormat.class));
    outputConfig.setStubParameter(FileOutputFormat.FILE_PARAMETER_KEY,resultPath);
    Configuration outputUserConfig=outputConfig.getStubParameters();
    outputUserConfig.setString(RecordOutputFormat.RECORD_DELIMITER_PARAMETER,"\n");
    outputUserConfig.setString(RecordOutputFormat.FIELD_DELIMITER_PARAMETER," ");
    outputUserConfig.setClass(RecordOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 0,PactLong.class);
    outputUserConfig.setInteger(RecordOutputFormat.RECORD_POSITION_PARAMETER_PREFIX + 0,0);
    outputUserConfig.setClass(RecordOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 1,PactLong.class);
    outputUserConfig.setInteger(RecordOutputFormat.RECORD_POSITION_PARAMETER_PREFIX + 1,1);
    outputUserConfig.setInteger(RecordOutputFormat.NUM_FIELDS_PARAMETER,2);
  }
  return output;
}
