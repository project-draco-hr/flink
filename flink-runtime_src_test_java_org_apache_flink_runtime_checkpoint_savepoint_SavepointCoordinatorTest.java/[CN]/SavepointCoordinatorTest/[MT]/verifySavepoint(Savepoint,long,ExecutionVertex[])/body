{
  assertEquals(expectedCheckpointId,savepoint.getCheckpointId());
  for (  TaskState taskState : savepoint.getTaskStates()) {
    JobVertexID jobVertexId=taskState.getJobVertexID();
    ExecutionVertex vertex=null;
    for (    ExecutionVertex executionVertex : expectedVertices) {
      if (executionVertex.getJobvertexId().equals(jobVertexId)) {
        vertex=executionVertex;
        break;
      }
    }
    if (vertex == null) {
      fail("Did not find matching vertex");
    }
 else {
      SubtaskState subtaskState=taskState.getState(vertex.getParallelSubtaskIndex());
      ExecutionAttemptID vertexAttemptId=vertex.getCurrentExecutionAttempt().getAttemptId();
      ExecutionAttemptID stateAttemptId=(ExecutionAttemptID)subtaskState.getState().deserializeValue(Thread.currentThread().getContextClassLoader()).getState(Thread.currentThread().getContextClassLoader());
      assertEquals(vertexAttemptId,stateAttemptId);
    }
  }
}
