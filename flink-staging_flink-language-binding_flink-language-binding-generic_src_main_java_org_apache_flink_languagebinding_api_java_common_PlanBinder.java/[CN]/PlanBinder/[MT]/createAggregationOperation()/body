{
  int setID=(Integer)receiver.getRecord(true);
  int parentID=(Integer)receiver.getRecord(true);
  int count=(Integer)receiver.getRecord(true);
  int encodedAgg=(Integer)receiver.getRecord(true);
  int field=(Integer)receiver.getRecord(true);
  Aggregations agg=null;
switch (encodedAgg) {
case 0:
    agg=Aggregations.MAX;
  break;
case 1:
agg=Aggregations.MIN;
break;
case 2:
agg=Aggregations.SUM;
break;
}
DataSet op=(DataSet)sets.get(parentID);
AggregateOperator ao=op.aggregate(agg,field);
for (int x=1; x < count; x++) {
encodedAgg=(Integer)receiver.getRecord(true);
field=(Integer)receiver.getRecord(true);
switch (encodedAgg) {
case 0:
ao=ao.andMax(field);
break;
case 1:
ao=ao.andMin(field);
break;
case 2:
ao=ao.andSum(field);
break;
}
}
sets.put(setID,ao.name("Aggregation"));
}
