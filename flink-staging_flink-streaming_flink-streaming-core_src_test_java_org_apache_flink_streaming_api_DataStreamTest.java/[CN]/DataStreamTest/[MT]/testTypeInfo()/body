{
  StreamExecutionEnvironment env=new TestStreamEnvironment(PARALLELISM,MEMORYSIZE);
  DataStream<Long> src1=env.generateSequence(0,0);
  assertEquals(TypeExtractor.getForClass(Long.class),src1.getType());
  DataStream<Tuple2<Integer,String>> map=src1.map(new MapFunction<Long,Tuple2<Integer,String>>(){
    @Override public Tuple2<Integer,String> map(    Long value) throws Exception {
      return null;
    }
  }
);
  assertEquals(TypeExtractor.getForObject(new Tuple2<Integer,String>(0,"")),map.getType());
  WindowedDataStream<String> window=map.window(Count.of(5)).mapWindow(new WindowMapFunction<Tuple2<Integer,String>,String>(){
    @Override public void mapWindow(    Iterable<Tuple2<Integer,String>> values,    Collector<String> out) throws Exception {
    }
  }
);
  assertEquals(TypeExtractor.getForClass(String.class),window.getType());
  DataStream<CustomPOJO> flatten=window.foldWindow(new CustomPOJO(),new FoldFunction<String,CustomPOJO>(){
    @Override public CustomPOJO fold(    CustomPOJO accumulator,    String value) throws Exception {
      return null;
    }
  }
).flatten();
  assertEquals(TypeExtractor.getForClass(CustomPOJO.class),flatten.getType());
}
