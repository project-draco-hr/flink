{
  StreamingRuntimeContext context=(StreamingRuntimeContext)getRuntimeContext();
  if (context.containsState("collected")) {
    collectedState=(OperatorState<Long>)context.getState("collected");
    collected=collectedState.getState();
  }
 else {
    collectedState=new OperatorState<Long>(collected);
    context.registerState("collected",collectedState);
  }
  super.open(parameters);
  stepSize=context.getNumberOfParallelSubtasks();
  coungrence=context.getIndexOfThisSubtask();
  toCollect=(end % stepSize > coungrence) ? (end / stepSize + 1) : (end / stepSize);
}
