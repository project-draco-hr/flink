{
  CoStreamFlatMap<String,Integer,String> operator=new CoStreamFlatMap<String,Integer,String>(new MyCoFlatMap());
  TwoInputStreamOperatorTestHarness<String,Integer,String> testHarness=new TwoInputStreamOperatorTestHarness<String,Integer,String>(operator);
  long initialTime=0L;
  ConcurrentLinkedQueue<Object> expectedOutput=new ConcurrentLinkedQueue<Object>();
  testHarness.open();
  testHarness.processElement1(new StreamRecord<String>("abc",initialTime + 1));
  testHarness.processElement1(new StreamRecord<String>("def",initialTime + 2));
  testHarness.processWatermark1(new Watermark(initialTime + 2));
  testHarness.processElement1(new StreamRecord<String>("ghi",initialTime + 3));
  testHarness.processElement2(new StreamRecord<Integer>(1,initialTime + 1));
  testHarness.processElement2(new StreamRecord<Integer>(2,initialTime + 2));
  testHarness.processWatermark2(new Watermark(initialTime + 3));
  testHarness.processElement2(new StreamRecord<Integer>(3,initialTime + 3));
  testHarness.processElement2(new StreamRecord<Integer>(4,initialTime + 4));
  testHarness.processElement2(new StreamRecord<Integer>(5,initialTime + 5));
  expectedOutput.add(new StreamRecord<String>("a",initialTime + 1));
  expectedOutput.add(new StreamRecord<String>("b",initialTime + 1));
  expectedOutput.add(new StreamRecord<String>("c",initialTime + 1));
  expectedOutput.add(new StreamRecord<String>("d",initialTime + 2));
  expectedOutput.add(new StreamRecord<String>("e",initialTime + 2));
  expectedOutput.add(new StreamRecord<String>("f",initialTime + 2));
  expectedOutput.add(new StreamRecord<String>("g",initialTime + 3));
  expectedOutput.add(new StreamRecord<String>("h",initialTime + 3));
  expectedOutput.add(new StreamRecord<String>("i",initialTime + 3));
  expectedOutput.add(new StreamRecord<String>("1",initialTime + 1));
  expectedOutput.add(new StreamRecord<String>("2",initialTime + 2));
  expectedOutput.add(new Watermark(initialTime + 2));
  expectedOutput.add(new StreamRecord<String>("3",initialTime + 3));
  expectedOutput.add(new StreamRecord<String>("4",initialTime + 4));
  expectedOutput.add(new StreamRecord<String>("5",initialTime + 5));
  TestHarnessUtil.assertOutputEquals("Output was not correct.",expectedOutput,testHarness.getOutput());
}
