{
  final T value=element.getValue();
  final long newTimestamp=userFunction.extractTimestamp(value,element.getTimestamp());
  output.collect(element.replace(element.getValue(),newTimestamp));
  final long nextWatermark=userFunction.checkAndGetNextWatermark(value,newTimestamp);
  if (nextWatermark >= 0 && nextWatermark > currentWatermark) {
    currentWatermark=nextWatermark;
    output.emitWatermark(new Watermark(nextWatermark));
  }
}
