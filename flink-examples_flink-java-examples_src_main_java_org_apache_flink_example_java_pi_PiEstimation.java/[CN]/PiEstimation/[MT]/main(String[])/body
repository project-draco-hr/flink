{
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  int degOfParal=(env.getDegreeOfParallelism() > 0) ? env.getDegreeOfParallelism() : 2;
  int n=100000 * degOfParal;
  DataSet<Integer> dataSet=env.generateSequence(0l,n).map(new MapFunction<Long,Integer>(){
    private static final long serialVersionUID=1L;
    @Override public Integer map(    Long value) throws Exception {
      return 1;
    }
  }
);
  DataSet<Double> count=dataSet.filter(new PiFilter()).setParallelism(degOfParal).reduce(new PiReducer()).map(new PiMapper(n));
  System.out.println("We estimate Pi to be:");
  count.print();
  env.execute();
}
