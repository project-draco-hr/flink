{
  org.junit.Assume.assumeThat(mode,new IsNot(new IsEqual<ExecutionMode>(ExecutionMode.COLLECTION)));
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<Tuple3<Integer,Long,String>> ds=CollectionDataSets.get3TupleDataSet(env).map(new IdentityMapper<Tuple3<Integer,Long,String>>()).setParallelism(4);
  Configuration cfg=new Configuration();
  cfg.setString(PactCompiler.HINT_SHIP_STRATEGY,PactCompiler.HINT_SHIP_STRATEGY_REPARTITION);
  DataSet<Tuple2<Integer,String>> reduceDs=ds.reduceGroup(new Tuple3AllGroupReduceWithCombine()).withParameters(cfg);
  reduceDs.writeAsCsv(resultPath);
  env.execute();
  expected="322," + "testtesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttest\n";
}
