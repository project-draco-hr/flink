{
  String name=getName() != null ? getName() : function.getClass().getName();
  if (keys1 instanceof Keys.SelectorFunctionKeys && keys2 instanceof Keys.SelectorFunctionKeys && keys1.areCompatibale(keys2)) {
    @SuppressWarnings("unchecked") Keys.SelectorFunctionKeys<I1,?> selectorKeys1=(Keys.SelectorFunctionKeys<I1,?>)keys1;
    @SuppressWarnings("unchecked") Keys.SelectorFunctionKeys<I2,?> selectorKeys2=(Keys.SelectorFunctionKeys<I2,?>)keys2;
    return translateSelectorFunctionCoGroup(selectorKeys1,selectorKeys2,function,getInput1Type(),getInput2Type(),getResultType(),name);
  }
 else   if (keys1 instanceof Keys.FieldPositionKeys && keys2 instanceof Keys.FieldPositionKeys && keys1.areCompatibale(keys2)) {
    int[] logicalKeyPositions1=keys1.computeLogicalKeyPositions();
    int[] logicalKeyPositions2=keys2.computeLogicalKeyPositions();
    return new BinaryNodeTranslation(new PlanCogroupOperator<I1,I2,OUT>(function,logicalKeyPositions1,logicalKeyPositions2,name,getInput1Type(),getInput2Type(),getResultType()));
  }
 else {
    throw new UnsupportedOperationException("Unrecognized or incompatible key types.");
  }
}
