{
  if (this.failedVertices.isEmpty()) {
    LOG.error("No failed vertices to recover");
  }
  Iterator<ExecutionVertex> vertexIter=this.failedVertices.iterator();
  while (vertexIter.hasNext()) {
    ExecutionVertex failed=vertexIter.next();
    LOG.info("Staring Recovery for " + failed);
    List<ExecutionVertex> restart=findRestarts(failed);
    Iterator<ExecutionVertex> restartIterator=restart.iterator();
    while (restartIterator.hasNext()) {
      ExecutionVertex vertex=restartIterator.next();
      if (!vertex.equals(failed)) {
        LOG.info("Restarting " + vertex.getName());
        final List<ExecutionVertexID> checkpointsToReplay=new ArrayList<ExecutionVertexID>();
        checkpointsToReplay.add(vertex.getID());
        try {
          vertex.getAllocatedResource().getInstance().replayCheckpoints(checkpointsToReplay);
        }
 catch (        Exception e) {
          LOG.info("Catched Exception " + StringUtils.stringifyException(e) + "wihle restarting");
        }
      }
    }
    LOG.info("Finished recovery for " + failed);
  }
  this.job.executionStateChanged(this.job.getJobID(),null,ExecutionState.RERUNNING,null);
  LOG.info("Recovery Finsihed");
}
