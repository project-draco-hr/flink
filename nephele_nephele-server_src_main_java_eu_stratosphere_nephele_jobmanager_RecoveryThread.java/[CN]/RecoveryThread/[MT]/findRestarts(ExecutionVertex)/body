{
  LOG.info("in findRestarts");
  ArrayList<ExecutionVertex> restart=new ArrayList<ExecutionVertex>();
  Queue<ExecutionVertex> totest=new ArrayDeque<ExecutionVertex>();
  ArrayList<ExecutionVertex> visited=new ArrayList<ExecutionVertex>();
  totest.add(failed);
  int k=0;
  LOG.info("added totest");
  ExecutionVertex vertex=failed;
  while (!totest.isEmpty()) {
    LOG.info("in while");
    if (k != 0) {
      vertex=totest.peek();
    }
    LOG.info("Testing " + vertex.getName());
    k++;
    totest.remove(vertex);
    if (!restart.contains(vertex)) {
      restart.add(vertex);
    }
    for (int i=0; i < vertex.getNumberOfSuccessors(); i++) {
      ExecutionVertex successor=vertex.getSuccessor(i);
      restart.add(successor);
      LOG.info("add " + successor.getName() + " torestart");
      if (successor.getCheckpointState() == CheckpointState.COMPLETE) {
        this.checkpoints.remove(successor);
      }
      List<ExecutionVertex> follower=findFollowers(successor,restart);
      restart.addAll(follower);
      Iterator<ExecutionVertex> iter=follower.iterator();
      while (iter.hasNext()) {
        ExecutionVertex follow=iter.next();
        if (!visited.contains(follow)) {
          LOG.info("add totest" + follow.getName());
          totest.add(follow);
        }
      }
    }
    for (int j=0; j < vertex.getNumberOfPredecessors(); j++) {
      ExecutionVertex predecessor=vertex.getPredecessor(j);
      if (predecessor.getCheckpointState() != CheckpointState.COMPLETE) {
        LOG.info("add " + predecessor.getName() + " torestart");
        restart.add(predecessor);
        if (!visited.contains(predecessor)) {
          totest.add(predecessor);
          LOG.info("add totest" + predecessor);
        }
      }
 else {
        if (!this.globalConsistentCheckpoint.contains(predecessor)) {
          this.globalConsistentCheckpoint.add(predecessor);
        }
        List<ExecutionVertex> follower=findFollowers(predecessor,restart);
        for (int i=0; i < follower.size(); i++) {
          LOG.info("add " + follower.get(i) + " torestart");
        }
        restart.addAll(follower);
        Iterator<ExecutionVertex> iter=follower.iterator();
        while (iter.hasNext()) {
          ExecutionVertex follow=iter.next();
          if (!visited.contains(follow)) {
            LOG.info("add totest" + follow.getName());
            totest.add(follow);
          }
        }
      }
    }
    visited.add(vertex);
  }
  LOG.info("finderestartsfinished");
  return restart;
}
