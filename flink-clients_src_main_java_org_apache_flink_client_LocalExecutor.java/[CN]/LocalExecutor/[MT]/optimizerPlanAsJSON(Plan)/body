{
  LocalExecutor exec=new LocalExecutor();
  try {
    exec.start();
    Optimizer pc=new Optimizer(new DataStatistics(),exec.flink.getConfiguration());
    OptimizedPlan op=pc.compile(plan);
    PlanJSONDumpGenerator gen=new PlanJSONDumpGenerator();
    return gen.getOptimizerPlanAsJSON(op);
  }
  finally {
    exec.stop();
  }
}
