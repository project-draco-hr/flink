{
synchronized (this.lock) {
    if (this.flink == null) {
      this.flink=new LocalFlinkMiniCluster(configDir);
      Configuration configuration=new Configuration();
      configuration.setInteger(ConfigConstants.TASK_MANAGER_NUM_TASK_SLOTS,getTaskManagerNumSlots());
      configuration.setBoolean(ConfigConstants.FILESYSTEM_DEFAULT_OVERWRITE_KEY,isDefaultOverwriteFiles());
      this.flink.start(configuration);
    }
 else {
      throw new IllegalStateException("The local executor was already started.");
    }
  }
}
