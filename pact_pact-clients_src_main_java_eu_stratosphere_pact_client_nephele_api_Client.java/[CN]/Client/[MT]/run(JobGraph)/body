{
  nepheleConfig.setBoolean("jobclient.shutdown.terminatejob",false);
  JobSubmissionResult result=null;
  JobClient client;
  try {
    client=new JobClient(jobGraph,nepheleConfig);
  }
 catch (  IOException e) {
    throw new ProgramInvocationException("Could not open job manager: " + e.getMessage(),e);
  }
  try {
    result=client.submitJob();
  }
 catch (  IOException e) {
    throw new ProgramInvocationException("Could not submit job to job manager: " + e.getMessage(),e);
  }
  if (result.getReturnCode() != ReturnCode.SUCCESS) {
    throw new ProgramInvocationException("The job was not successfully submitted to the nephele job manager" + (result.getDescription() == null ? "." : ": " + result.getDescription()));
  }
}
