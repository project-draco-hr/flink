{
  JobGraphGenerator gen=new JobGraphGenerator();
  JobGraph job=gen.compileJobGraph(optPlan);
  job.addJar(new Path(prog.getJarFile().getAbsolutePath()));
  try {
    File[] containedJars=prog.extractContainedLibaries();
    if (containedJars != null) {
      for (int i=0; i < containedJars.length; i++) {
        job.addJar(new Path(containedJars[i].getAbsolutePath()));
      }
    }
  }
 catch (  IOException ioex) {
    throw new ProgramInvocationException("Could not extract the nested libraries: " + ioex.getMessage(),ioex);
  }
  return job;
}
