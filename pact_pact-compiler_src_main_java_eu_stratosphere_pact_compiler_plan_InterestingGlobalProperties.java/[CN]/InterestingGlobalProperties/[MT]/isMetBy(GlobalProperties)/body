{
  if (this.partitioning == PartitioningProperty.FULL_REPLICATION) {
    return props.isFullyReplicated();
  }
 else   if (props.isFullyReplicated()) {
    return false;
  }
 else   if (this.partitioning == PartitioningProperty.RANDOM) {
    return true;
  }
 else   if (this.partitioning == PartitioningProperty.ANY_PARTITIONING) {
    return props.isPartitionedOnFields(this.partitioningFields);
  }
 else   if (this.partitioning == PartitioningProperty.HASH_PARTITIONED) {
    return props.getPartitioning() == PartitioningProperty.HASH_PARTITIONED && props.isPartitionedOnFields(this.partitioningFields);
  }
 else   if (this.partitioning == PartitioningProperty.RANGE_PARTITIONED) {
    return props.getPartitioning() == PartitioningProperty.RANGE_PARTITIONED && props.matchesOrderedPartitioning(this.ordering);
  }
 else {
    throw new CompilerException("Bug in properties matching logic.");
  }
}
