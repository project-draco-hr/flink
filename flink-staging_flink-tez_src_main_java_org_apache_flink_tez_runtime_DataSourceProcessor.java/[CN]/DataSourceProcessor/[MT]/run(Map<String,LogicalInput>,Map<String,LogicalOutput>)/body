{
  Preconditions.checkArgument(inputs.size() == 1);
  LogicalInput logicalInput=inputs.values().iterator().next();
  if (!(logicalInput instanceof FlinkInput)) {
    throw new RuntimeException("Input to Flink Data Source Processor should be of type FlinkInput");
  }
  this.input=(FlinkInput)logicalInput;
  this.outputs=outputs;
  this.numOutputs=outputs.size();
  this.writers=new ArrayList<KeyValueWriter>(numOutputs);
  if (this.outputs != null) {
    for (    LogicalOutput output : this.outputs.values()) {
      output.start();
      writers.add((KeyValueWriter)output.getWriter());
    }
  }
  this.invoke();
}
