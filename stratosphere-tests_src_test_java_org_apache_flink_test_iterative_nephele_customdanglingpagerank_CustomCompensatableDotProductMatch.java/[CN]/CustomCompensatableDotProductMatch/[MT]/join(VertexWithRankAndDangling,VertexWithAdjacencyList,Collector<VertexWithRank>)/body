{
  double rank=pageWithRank.getRank();
  long[] adjacentNeighbors=adjacencyList.getTargets();
  int numNeighbors=adjacencyList.getNumTargets();
  double rankToDistribute=rank / (double)numNeighbors;
  record.setRank(rankToDistribute);
  for (int n=0; n < numNeighbors; n++) {
    record.setVertexID(adjacentNeighbors[n]);
    if (isFailure) {
      if (random.nextDouble() >= messageLoss) {
        collector.collect(record);
      }
    }
 else {
      collector.collect(record);
    }
  }
}
