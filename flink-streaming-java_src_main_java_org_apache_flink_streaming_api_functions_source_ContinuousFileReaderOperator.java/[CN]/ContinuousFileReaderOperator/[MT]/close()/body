{
  super.close();
  if (reader != null && reader.isAlive() && reader.isRunning()) {
    reader.addSplit(EOS);
    checkpointLock.wait();
  }
  collector.close();
}
