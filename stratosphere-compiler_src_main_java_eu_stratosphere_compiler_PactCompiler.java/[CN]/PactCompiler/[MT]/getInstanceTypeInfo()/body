{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Connecting compiler to JobManager to dertermine instance information.");
  }
  Map<InstanceType,InstanceTypeDescription> instances=null;
  JobManagerConnector jmc=new JobManagerConnector(this.jobManagerAddress);
  Thread connectorThread=new Thread(jmc,"Compiler - JobManager connector.");
  connectorThread.setDaemon(true);
  connectorThread.start();
  try {
    jmc.waitForCompletion();
    instances=jmc.instances;
    if (instances == null) {
      throw new NullPointerException("Returned instance map is <null>");
    }
  }
 catch (  IOException e) {
    throw new CompilerException(e.getMessage());
  }
catch (  Throwable t) {
    throw new CompilerException("Cannot connect to the JobManager to determine the available TaskManagers. " + "Check if the JobManager is running (using the web interface or log files). Reason: " + t.getMessage(),t);
  }
  return getType(instances);
}
