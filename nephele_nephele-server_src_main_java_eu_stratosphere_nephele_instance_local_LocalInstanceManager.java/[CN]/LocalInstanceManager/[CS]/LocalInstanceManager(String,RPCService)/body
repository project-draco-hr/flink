{
  final Configuration config=GlobalConfiguration.getConfiguration();
  InstanceType type=null;
  final String descr=config.getString(LOCALINSTANCE_TYPE_KEY,null);
  if (descr != null) {
    LOG.info("Attempting to parse default instance type from string " + descr);
    type=InstanceTypeFactory.constructFromDescription(descr);
    if (type == null) {
      LOG.warn("Unable to parse default instance type from configuration, using hardware profile instead");
    }
  }
  this.rpcService=rpcService;
  this.defaultInstanceType=(type != null) ? type : createDefaultInstanceType();
  LOG.info("Default instance type is " + this.defaultInstanceType.getIdentifier());
  this.networkTopology=NetworkTopology.createEmptyTopology();
  this.instanceTypeDescriptionMap=new HashMap<InstanceType,InstanceTypeDescription>();
  this.localTaskManagerThread=new LocalTaskManagerThread(configDir);
  this.localTaskManagerThread.start();
}
