{
  Configuration config=configuration.clone();
  int rpcPort=config.getInteger(ConfigConstants.TASK_MANAGER_IPC_PORT_KEY,ConfigConstants.DEFAULT_TASK_MANAGER_IPC_PORT);
  int dataPort=config.getInteger(ConfigConstants.TASK_MANAGER_DATA_PORT_KEY,ConfigConstants.DEFAULT_TASK_MANAGER_DATA_PORT);
  if (rpcPort > 0) {
    config.setInteger(ConfigConstants.TASK_MANAGER_IPC_PORT_KEY,rpcPort + index);
  }
  if (dataPort > 0) {
    config.setInteger(ConfigConstants.TASK_MANAGER_DATA_PORT_KEY,dataPort + index);
  }
  return TaskManager.startActorWithConfiguration(HOSTNAME,config,false,system);
}
