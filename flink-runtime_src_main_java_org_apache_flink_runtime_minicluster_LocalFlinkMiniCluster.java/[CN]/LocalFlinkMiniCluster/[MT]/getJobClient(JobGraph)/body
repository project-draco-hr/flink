{
  if (configuration == null) {
    throw new RuntimeException("The cluster has not been started yet.");
  }
  Configuration jobConfiguration=jobGraph.getJobConfiguration();
  int jobManagerRPCPort=getJobManagerRPCPort();
  jobConfiguration.setString(ConfigConstants.JOB_MANAGER_IPC_ADDRESS_KEY,HOSTNAME);
  jobConfiguration.setInteger(ConfigConstants.JOB_MANAGER_IPC_PORT_KEY,jobManagerRPCPort);
  return new JobClient(jobGraph,jobConfiguration,getClass().getClassLoader());
}
