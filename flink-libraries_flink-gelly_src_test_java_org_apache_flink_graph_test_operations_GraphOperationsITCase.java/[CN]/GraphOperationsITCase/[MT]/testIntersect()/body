{
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  @SuppressWarnings("unchecked") List<Edge<Long,Long>> edges1=Lists.newArrayList(new Edge<>(1L,3L,12L),new Edge<>(1L,3L,13L),new Edge<>(1L,3L,14L));
  @SuppressWarnings("unchecked") List<Edge<Long,Long>> edges2=Lists.newArrayList(new Edge<>(1L,3L,13L));
  Graph<Long,NullValue,Long> graph1=Graph.fromCollection(edges1,env);
  Graph<Long,NullValue,Long> graph2=Graph.fromCollection(edges2,env);
  Graph<Long,NullValue,Long> intersect=graph1.intersect(graph2,true);
  List<Vertex<Long,NullValue>> vertices=Lists.newArrayList();
  List<Edge<Long,Long>> edges=Lists.newArrayList();
  intersect.getVertices().output(new LocalCollectionOutputFormat<>(vertices));
  intersect.getEdges().output(new LocalCollectionOutputFormat<>(edges));
  env.execute();
  String expectedVertices="1,(null)\n" + "3,(null)\n";
  String expectedEdges="1,3,13\n";
  compareResultAsTuples(vertices,expectedVertices);
  compareResultAsTuples(edges,expectedEdges);
}
