{
  boolean useFixedPointTerminator=getEnvironment().getTaskConfiguration().getBoolean(FIXED_POINT_TERMINATOR,false);
  channelStateListener=new ClosedListener();
  getEnvironment().getOutputGate(2).subscribeToEvent(channelStateListener,ChannelStateEvent.class);
  if (useFixedPointTerminator) {
    terminationStateListener=new ClosedListener();
    getEnvironment().getOutputGate(4).subscribeToEvent(terminationStateListener,ChannelStateEvent.class);
    numInternalOutputs=5;
  }
 else {
    int numIterations=getEnvironment().getTaskConfiguration().getInteger(NUMBER_OF_ITERATIONS,-1);
    terminationStateListener=new FixedRoundListener(numIterations);
    numInternalOutputs=4;
  }
  updateBufferSize=config.getMemorySize() * 1 / 5;
  config.setMemorySize(config.getMemorySize() * 4 / 5);
  Preconditions.checkState(output instanceof PactRecordOutputCollector);
  outputCollector=(PactRecordOutputCollector)output;
}
