{
  try {
    Configuration hdConf=new Configuration();
    File baseDir=new File("./target/hdfs/filestatehandletest").getAbsoluteFile();
    FileUtil.fullyDelete(baseDir);
    hdConf.set(MiniDFSCluster.HDFS_MINIDFS_BASEDIR,baseDir.getAbsolutePath());
    MiniDFSCluster.Builder builder=new MiniDFSCluster.Builder(hdConf);
    hdfsCluster=builder.build();
    hdfsURI="hdfs://" + hdfsCluster.getURI().getHost() + ":"+ hdfsCluster.getNameNodePort()+ "/";
    hdPath=new org.apache.hadoop.fs.Path("/StateHandleTest");
    hdfs=hdPath.getFileSystem(hdConf);
    hdfs.mkdirs(hdPath);
  }
 catch (  Throwable e) {
    e.printStackTrace();
    Assert.fail("Test failed " + e.getMessage());
  }
}
