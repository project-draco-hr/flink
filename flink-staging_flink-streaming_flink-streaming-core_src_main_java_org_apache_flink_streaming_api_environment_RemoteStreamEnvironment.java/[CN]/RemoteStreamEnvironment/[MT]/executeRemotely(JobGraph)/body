{
  if (LOG.isInfoEnabled()) {
    LOG.info("Running remotely at {}:{}",host,port);
  }
  for (  File file : jarFiles) {
    jobGraph.addJar(new Path(file.getAbsolutePath()));
  }
  Configuration configuration=jobGraph.getJobConfiguration();
  Client client=new Client(new InetSocketAddress(host,port),configuration,JobWithJars.buildUserCodeClassLoader(jarFiles,JobWithJars.class.getClassLoader()));
  try {
    return client.run(jobGraph,true);
  }
 catch (  ProgramInvocationException e) {
    throw new RuntimeException("Cannot execute job due to ProgramInvocationException",e);
  }
}
