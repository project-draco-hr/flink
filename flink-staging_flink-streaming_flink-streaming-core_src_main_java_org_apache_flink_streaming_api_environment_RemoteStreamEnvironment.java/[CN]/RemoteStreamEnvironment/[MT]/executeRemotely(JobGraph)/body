{
  if (LOG.isInfoEnabled()) {
    LOG.info("Running remotely at {}:{}",host,port);
  }
  for (  File file : jarFiles) {
    jobGraph.addJar(new Path(file.getAbsolutePath()));
  }
  Configuration configuration=jobGraph.getJobConfiguration();
  ClassLoader usercodeClassLoader=JobWithJars.buildUserCodeClassLoader(jarFiles,getClass().getClassLoader());
  configuration.setString(ConfigConstants.JOB_MANAGER_IPC_ADDRESS_KEY,host);
  configuration.setInteger(ConfigConstants.JOB_MANAGER_IPC_PORT_KEY,port);
  try {
    Client client=new Client(configuration,usercodeClassLoader,-1);
    client.setPrintStatusDuringExecution(getConfig().isSysoutLoggingEnabled());
    JobSubmissionResult result=client.run(jobGraph,true);
    if (result instanceof JobExecutionResult) {
      return (JobExecutionResult)result;
    }
 else {
      LOG.warn("The Client didn't return a JobExecutionResult");
      return new JobExecutionResult(result.getJobID(),-1,null);
    }
  }
 catch (  ProgramInvocationException e) {
    throw e;
  }
catch (  Exception e) {
    String term=e.getMessage() == null ? "." : (": " + e.getMessage());
    throw new ProgramInvocationException("The program execution failed" + term,e);
  }
}
