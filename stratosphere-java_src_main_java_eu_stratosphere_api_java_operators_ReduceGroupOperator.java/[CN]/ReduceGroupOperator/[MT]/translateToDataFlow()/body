{
  String name=getName() != null ? getName() : function.getClass().getName();
  if (grouper == null) {
    return new UnaryNodeTranslation(new PlanGroupReduceOperator<IN,OUT>(function,new int[0],name,getInputType(),getResultType()));
  }
  if (grouper.getKeys() instanceof Keys.SelectorFunctionKeys) {
    @SuppressWarnings("unchecked") Keys.SelectorFunctionKeys<IN,?> selectorKeys=(Keys.SelectorFunctionKeys<IN,?>)grouper.getKeys();
    return translateSelectorFunctionReducer(selectorKeys,function,getInputType(),getResultType(),name);
  }
 else   if (grouper.getKeys() instanceof Keys.FieldPositionKeys) {
    int[] logicalKeyPositions=grouper.getKeys().computeLogicalKeyPositions();
    PlanGroupReduceOperator<IN,OUT> reduceOp=new PlanGroupReduceOperator<IN,OUT>(function,logicalKeyPositions,name,getInputType(),getResultType());
    if (grouper.getGroupSortKeyPositions() != null) {
      int[] sortKeyPositions=grouper.getGroupSortKeyPositions();
      Order[] sortOrders=grouper.getGroupSortOrders();
      Ordering o=new Ordering();
      for (int i=0; i < sortKeyPositions.length; i++) {
        o.appendOrdering(sortKeyPositions[i],null,sortOrders[i]);
      }
      reduceOp.setGroupOrder(o);
    }
    return new UnaryNodeTranslation(reduceOp);
  }
 else {
    throw new UnsupportedOperationException("Unrecognized key type.");
  }
}
