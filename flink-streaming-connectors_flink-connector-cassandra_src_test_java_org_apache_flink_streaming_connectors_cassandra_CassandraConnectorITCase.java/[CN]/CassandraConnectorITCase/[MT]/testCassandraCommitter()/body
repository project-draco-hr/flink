{
  CassandraCommitter cc1=new CassandraCommitter(builder);
  cc1.setJobId("job");
  cc1.setOperatorId("operator");
  cc1.setOperatorSubtaskId(0);
  CassandraCommitter cc2=new CassandraCommitter(builder);
  cc2.setJobId("job");
  cc2.setOperatorId("operator");
  cc2.setOperatorSubtaskId(1);
  CassandraCommitter cc3=new CassandraCommitter(builder);
  cc3.setJobId("job");
  cc3.setOperatorId("operator1");
  cc3.setOperatorSubtaskId(0);
  cc1.createResource();
  cc1.open();
  cc2.open();
  cc3.open();
  Assert.assertFalse(cc1.isCheckpointCommitted(1));
  Assert.assertFalse(cc2.isCheckpointCommitted(1));
  Assert.assertFalse(cc3.isCheckpointCommitted(1));
  cc1.commitCheckpoint(1);
  Assert.assertTrue(cc1.isCheckpointCommitted(1));
  Assert.assertFalse(cc2.isCheckpointCommitted(1));
  Assert.assertFalse(cc3.isCheckpointCommitted(1));
  Assert.assertFalse(cc1.isCheckpointCommitted(2));
  cc1.close();
  cc2.close();
  cc3.close();
  cc1=new CassandraCommitter(builder);
  cc1.setJobId("job");
  cc1.setOperatorId("operator");
  cc1.setOperatorSubtaskId(0);
  cc1.open();
  Assert.assertTrue(cc1.isCheckpointCommitted(1));
  Assert.assertFalse(cc1.isCheckpointCommitted(2));
  cc1.close();
}
