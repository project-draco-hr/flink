{
  try {
    partitionFunction.selectChannels(record,numberOfChannels,this.channels);
  }
 catch (  NullPointerException npe) {
    throw new RuntimeException("Partition function for RangePartitioner not set!");
  }
  return this.channels;
}
