{
  error.set(null);
  ServerSocket serverSo=new ServerSocket(0);
  SocketSource source=new SocketSource(serverSo,0);
  source.start();
  Socket channel;
  channel=serverSo.accept();
  channel.close();
  serverSo.close();
  sleep(2000);
  source.cancel();
  if (error.get() != null) {
    Throwable t=error.get();
    t.printStackTrace();
    fail("Error in spawned thread: " + t.getMessage());
  }
  assertEquals(0,source.socketSource.retries);
}
