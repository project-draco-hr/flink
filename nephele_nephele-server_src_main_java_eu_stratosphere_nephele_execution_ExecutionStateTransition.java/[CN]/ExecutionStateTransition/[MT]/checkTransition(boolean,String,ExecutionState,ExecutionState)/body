{
  LOG.info((jobManager ? "JM: " : "TM: ") + "ExecutionState set from " + oldState+ " to "+ newState+ " for task "+ taskName+ " at "+ System.currentTimeMillis());
  boolean unexpectedStateChange=true;
  if (oldState == ExecutionState.CREATED && newState == ExecutionState.SCHEDULED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.SCHEDULED && newState == ExecutionState.ASSIGNED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.ASSIGNED && newState == ExecutionState.READY) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.READY && newState == ExecutionState.STARTING) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.STARTING && newState == ExecutionState.RUNNING) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.RUNNING && newState == ExecutionState.FINISHING) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.FINISHING && newState == ExecutionState.FINISHED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.FAILED && newState == ExecutionState.ASSIGNED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.FAILED && newState == ExecutionState.CREATED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.FINISHED && newState == ExecutionState.ASSIGNED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.FINISHED && newState == ExecutionState.CREATED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.CANCELED && newState == ExecutionState.ASSIGNED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.CANCELED && newState == ExecutionState.CREATED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.STARTING && newState == ExecutionState.REPLAYING) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.REPLAYING && newState == ExecutionState.FINISHING) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.CREATED && newState == ExecutionState.ASSIGNED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.SCHEDULED && newState == ExecutionState.CANCELING) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.ASSIGNED && newState == ExecutionState.CANCELING) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.READY && newState == ExecutionState.CANCELING) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.STARTING && newState == ExecutionState.FAILED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.RUNNING && newState == ExecutionState.FAILED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.FINISHING && newState == ExecutionState.FAILED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.REPLAYING && newState == ExecutionState.FAILED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.RUNNING && newState == ExecutionState.ASSIGNED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.FINISHING && newState == ExecutionState.ASSIGNED) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.RUNNING && newState == ExecutionState.CANCELING) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.FINISHING && newState == ExecutionState.CANCELING) {
    unexpectedStateChange=false;
  }
  if (oldState == ExecutionState.CANCELING && newState == ExecutionState.CANCELED) {
    unexpectedStateChange=false;
  }
  if (unexpectedStateChange) {
    try {
      throw new IllegalStateException("Unexpected state change: " + oldState + " -> "+ newState);
    }
 catch (    IllegalStateException e) {
      LOG.error(StringUtils.stringifyException(e));
    }
  }
}
