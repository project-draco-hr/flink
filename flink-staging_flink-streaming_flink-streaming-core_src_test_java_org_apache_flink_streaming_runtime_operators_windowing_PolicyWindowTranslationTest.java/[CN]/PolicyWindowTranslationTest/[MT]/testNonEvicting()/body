{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  DataStream<Tuple2<String,Integer>> source=env.fromElements(Tuple2.of("hello",1),Tuple2.of("hello",2));
  DummyReducer reducer=new DummyReducer();
  DataStream<Tuple2<String,Integer>> window1=source.keyBy(0).window(Count.of(200)).reduceWindow(reducer);
  OneInputTransformation<Tuple2<String,Integer>,Tuple2<String,Integer>> transform1=(OneInputTransformation<Tuple2<String,Integer>,Tuple2<String,Integer>>)window1.getTransformation();
  OneInputStreamOperator<Tuple2<String,Integer>,Tuple2<String,Integer>> operator1=transform1.getOperator();
  Assert.assertTrue(operator1 instanceof WindowOperator);
  WindowOperator winOperator1=(WindowOperator)operator1;
  Assert.assertTrue(winOperator1.getTriggerTemplate() instanceof PurgingTrigger);
  Assert.assertTrue(((PurgingTrigger)winOperator1.getTriggerTemplate()).getNestedTrigger() instanceof CountTrigger);
  Assert.assertTrue(winOperator1.getWindowAssigner() instanceof GlobalWindows);
  Assert.assertTrue(winOperator1.getWindowBufferFactory() instanceof PreAggregatingHeapWindowBuffer.Factory);
  DataStream<Tuple2<String,Integer>> window2=source.keyBy(0).window(Delta.of(15.0,new DeltaFunction<Object>(){
    @Override public double getDelta(    Object oldDataPoint,    Object newDataPoint){
      return 0;
    }
  }
)).mapWindow(new KeyedWindowFunction<Tuple2<String,Integer>,Tuple2<String,Integer>,Tuple,Window>(){
    private static final long serialVersionUID=1L;
    @Override public void evaluate(    Tuple tuple,    Window window,    Iterable<Tuple2<String,Integer>> values,    Collector<Tuple2<String,Integer>> out) throws Exception {
    }
  }
);
  OneInputTransformation<Tuple2<String,Integer>,Tuple2<String,Integer>> transform2=(OneInputTransformation<Tuple2<String,Integer>,Tuple2<String,Integer>>)window2.getTransformation();
  OneInputStreamOperator<Tuple2<String,Integer>,Tuple2<String,Integer>> operator2=transform2.getOperator();
  Assert.assertTrue(operator2 instanceof WindowOperator);
  WindowOperator winOperator2=(WindowOperator)operator2;
  Assert.assertTrue(winOperator2.getTriggerTemplate() instanceof PurgingTrigger);
  Assert.assertTrue(((PurgingTrigger)winOperator2.getTriggerTemplate()).getNestedTrigger() instanceof DeltaTrigger);
  Assert.assertTrue(winOperator2.getWindowAssigner() instanceof GlobalWindows);
  Assert.assertTrue(winOperator2.getWindowBufferFactory() instanceof HeapWindowBuffer.Factory);
}
