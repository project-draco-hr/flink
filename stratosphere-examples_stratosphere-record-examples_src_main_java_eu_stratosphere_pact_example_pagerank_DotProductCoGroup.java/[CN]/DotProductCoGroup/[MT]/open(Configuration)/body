{
  int currentIteration=getIterationRuntimeContext().getSuperstepNumber();
  numVertices=ConfigUtils.asLong(NUM_VERTICES_PARAMETER,parameters);
  numDanglingVertices=ConfigUtils.asLong(NUM_DANGLING_VERTICES_PARAMETER,parameters);
  dampingFactor=(1d - BETA) / (double)numVertices;
  aggregator=(PageRankStatsAggregator)getIterationRuntimeContext().<PageRankStats>getIterationAggregator(AGGREGATOR_NAME);
  if (currentIteration == 1) {
    danglingRankFactor=BETA * (double)numDanglingVertices / ((double)numVertices * (double)numVertices);
  }
 else {
    PageRankStats previousAggregate=getIterationRuntimeContext().getPreviousIterationAggregate(AGGREGATOR_NAME);
    danglingRankFactor=BETA * previousAggregate.danglingRank() / (double)numVertices;
  }
}
