{
  final int BUFFER_SIZE=1024;
  final int NUM_BUFFERS=20;
  final int port;
  try {
    port=NetUtils.getAvailablePort();
  }
 catch (  Throwable t) {
    return;
  }
  try {
    NettyConfig nettyConf=new NettyConfig(InetAddress.getLocalHost(),port,BUFFER_SIZE,1,new Configuration());
    NetworkEnvironmentConfiguration config=new NetworkEnvironmentConfiguration(NUM_BUFFERS,BUFFER_SIZE,MemoryType.HEAP,IOManager.IOMode.SYNC,new Some<>(nettyConf),new Tuple2<>(0,0));
    NetworkEnvironment env=new NetworkEnvironment(TestingUtils.defaultExecutionContext(),new FiniteDuration(30,TimeUnit.SECONDS),config,new InstanceConnectionInfo(InetAddress.getLocalHost(),port));
    assertFalse(env.isShutdown());
    assertFalse(env.isAssociated());
    assertNotNull(env.getNetworkBufferPool());
    assertEquals(NUM_BUFFERS,env.getNetworkBufferPool().getTotalNumberOfMemorySegments());
    assertNull(env.getConnectionManager());
    assertNull(env.getPartitionConsumableNotifier());
    assertNull(env.getTaskEventDispatcher());
    assertNull(env.getPartitionManager());
    env.associateWithTaskManagerAndJobManager(DummyActorGateway.INSTANCE,DummyActorGateway.INSTANCE);
    assertNotNull(env.getConnectionManager());
    assertNotNull(env.getPartitionConsumableNotifier());
    assertNotNull(env.getTaskEventDispatcher());
    assertNotNull(env.getPartitionManager());
    BufferPool localPool=env.getNetworkBufferPool().createBufferPool(10,false);
    assertNotNull(localPool);
    env.disassociate();
    assertNull(env.getConnectionManager());
    assertNull(env.getPartitionConsumableNotifier());
    assertNull(env.getTaskEventDispatcher());
    assertNull(env.getPartitionManager());
    assertNotNull(env.getNetworkBufferPool());
    assertTrue(localPool.isDestroyed());
    env.associateWithTaskManagerAndJobManager(DummyActorGateway.INSTANCE,DummyActorGateway.INSTANCE);
    assertNotNull(env.getConnectionManager());
    assertNotNull(env.getPartitionConsumableNotifier());
    assertNotNull(env.getTaskEventDispatcher());
    assertNotNull(env.getPartitionManager());
    env.shutdown();
    assertTrue(env.isShutdown());
    assertFalse(env.isAssociated());
    assertNull(env.getConnectionManager());
    assertNull(env.getPartitionConsumableNotifier());
    assertNull(env.getTaskEventDispatcher());
    assertNull(env.getPartitionManager());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
