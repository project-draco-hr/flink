{
  final TimeCharacteristic timeCharacteristic=getOperatorConfig().getTimeCharacteristic();
switch (timeCharacteristic) {
case EventTime:
    ctx=new ManualWatermarkContext<>(this,lockingObject,collector);
  break;
case IngestionTime:
ctx=new AutomaticWatermarkContext<>(this,lockingObject,collector,getRuntimeContext().getExecutionConfig().getAutoWatermarkInterval());
break;
case ProcessingTime:
ctx=new NonTimestampContext<>(this,lockingObject,collector);
break;
default :
throw new Exception(String.valueOf(timeCharacteristic));
}
userFunction.run(ctx);
ctx.close();
}
