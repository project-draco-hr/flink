{
  if (watermarkInterval < 1L) {
    throw new IllegalArgumentException("The watermark interval cannot be smaller than one.");
  }
  this.owner=owner;
  this.timeService=owner.getTimerService();
  this.lockingObject=lockingObjectParam;
  this.output=outputParam;
  this.watermarkInterval=watermarkInterval;
  this.reuse=new StreamRecord<T>(null);
  long now=this.timeService.getCurrentProcessingTime();
  this.watermarkTimer=this.timeService.registerTimer(now + watermarkInterval,new WatermarkEmittingTask(this.timeService,lockingObjectParam,outputParam));
}
