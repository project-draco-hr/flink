{
  if (watermarkInterval < 1L) {
    throw new IllegalArgumentException("The watermark interval cannot be smaller than one.");
  }
  this.owner=owner;
  this.lockingObject=lockingObjectParam;
  this.output=outputParam;
  this.watermarkInterval=watermarkInterval;
  this.reuse=new StreamRecord<T>(null);
  long now=owner.getCurrentProcessingTime();
  this.watermarkTimer=owner.registerTimer(now + watermarkInterval,new WatermarkEmittingTask(owner,lockingObjectParam,outputParam));
}
