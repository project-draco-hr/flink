{
  final long currentTime=this.timeService.getCurrentProcessingTime();
  if (currentTime > nextWatermarkTime) {
    final long watermarkTime=currentTime - (currentTime % watermarkInterval);
synchronized (lockingObject) {
      if (currentTime > nextWatermarkTime) {
        output.emitWatermark(new Watermark(watermarkTime));
        nextWatermarkTime+=watermarkInterval;
      }
    }
  }
  this.timeService.registerTimer(this.timeService.getCurrentProcessingTime() + watermarkInterval,new WatermarkEmittingTask(this.timeService,lockingObject,output));
}
