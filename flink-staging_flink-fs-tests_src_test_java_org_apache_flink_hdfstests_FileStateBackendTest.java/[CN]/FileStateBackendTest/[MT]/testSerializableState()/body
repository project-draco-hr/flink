{
  try {
    FsStateBackend backend=CommonTestUtils.createCopySerializable(new FsStateBackend(randomHdfsFileUri()));
    backend.initializeForJob(new JobID());
    Path checkpointDir=backend.getCheckpointDirectory();
    String state1="dummy state";
    String state2="row row row your boat";
    Integer state3=42;
    StateHandle<String> handle1=backend.checkpointStateSerializable(state1,439568923746L,System.currentTimeMillis());
    StateHandle<String> handle2=backend.checkpointStateSerializable(state2,439568923746L,System.currentTimeMillis());
    StateHandle<Integer> handle3=backend.checkpointStateSerializable(state3,439568923746L,System.currentTimeMillis());
    assertFalse(isDirectoryEmpty(checkpointDir));
    assertEquals(state1,handle1.getState(getClass().getClassLoader()));
    handle1.discardState();
    assertFalse(isDirectoryEmpty(checkpointDir));
    assertEquals(state2,handle2.getState(getClass().getClassLoader()));
    handle2.discardState();
    assertFalse(isDirectoryEmpty(checkpointDir));
    assertEquals(state3,handle3.getState(getClass().getClassLoader()));
    handle3.discardState();
    assertTrue(isDirectoryEmpty(checkpointDir));
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
