{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  DataStream<Long> source=env.generateSequence(1,10);
  try {
    source.map(new TestMap<Long,Long>()).print();
    fail();
  }
 catch (  Exception e) {
  }
  try {
    source.flatMap(new TestFlatMap<Long,Long>()).print();
    fail();
  }
 catch (  Exception e) {
  }
  try {
    source.connect(source).map(new TestCoMap<Long,Long,Integer>()).print();
    fail();
  }
 catch (  Exception e) {
  }
  try {
    source.connect(source).flatMap(new TestCoFlatMap<Long,Long,Integer>()).print();
    fail();
  }
 catch (  Exception e) {
  }
  try {
    source.connect(source).reduce(new TestCoReduce<Long,Long,Integer>()).print();
    fail();
  }
 catch (  Exception e) {
  }
  try {
    source.connect(source).windowReduce(new TestCoWindow<Long,Long,String>(),10,100).print();
    fail();
  }
 catch (  Exception e) {
  }
  source.map(new TestMap<Long,Long>()).returns(Long.class).print();
  source.flatMap(new TestFlatMap<Long,Long>()).returns("Long").print();
  source.connect(source).map(new TestCoMap<Long,Long,Integer>()).returns("Integer").print();
  source.connect(source).flatMap(new TestCoFlatMap<Long,Long,Integer>()).returns(BasicTypeInfo.INT_TYPE_INFO).print();
  source.connect(source).reduce(new TestCoReduce<Long,Long,Integer>()).returns(Integer.class).print();
  source.connect(source).windowReduce(new TestCoWindow<Long,Long,String>(),10,100).returns("String").print();
  assertEquals(BasicTypeInfo.LONG_TYPE_INFO,source.map(new TestMap<Long,Long>()).returns(Long.class).getType());
  SingleOutputStreamOperator<String,?> map=source.map(new MapFunction<Long,String>(){
    @Override public String map(    Long value) throws Exception {
      return null;
    }
  }
);
  map.print();
  try {
    map.returns("String");
    fail();
  }
 catch (  Exception e) {
  }
}
