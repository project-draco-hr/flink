{
  ClassLoader cl=getClass().getClassLoader();
  int[] keyPositions=config.getOutputShipKeyPositions(outputIndex);
  Class<? extends Key>[] keyClasses;
  try {
    keyClasses=config.getOutputShipKeyTypes(outputIndex,cl);
  }
 catch (  ClassNotFoundException cnfex) {
    throw new RuntimeException("The classes for the keys determining the partitioning for output " + outputIndex + "  could not be loaded.");
  }
  keyPositions=keyPositions != null ? keyPositions : new int[]{};
  keyClasses=keyClasses != null ? keyClasses : new Class[]{};
  outputAccessors[outputIndex]=new PactRecordAccessorsV2(keyPositions,keyClasses);
}
