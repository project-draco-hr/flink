{
  if (inputs.size() <= 1)   return new Projection(this.expression,new OneSourceAggregation(inputs.get(0)));
  List<Operator> aggreations=new ArrayList<Operator>();
  for (int index=0; index < inputs.size(); index++) {
    EvaluableExpression[] elements=new EvaluableExpression[this.getInputs().size()];
    Arrays.fill(elements,EvaluableExpression.NULL);
    elements[index]=EvaluableExpression.SAME_VALUE;
    aggreations.add(new Projection(new ArrayCreation(elements),inputs.get(index)));
  }
  UnionAll union=new UnionAll(aggreations);
  return new Projection(this.expression,new Projection(new ArrayUnion(),new OneSourceAggregation(union)));
}
