{
  final Path path=getFileOutputPath();
  final FileSystem fs=path.getFileSystem();
  try {
    while (input.hasNext()) {
      final FileRecord record=input.next();
      Path newPath=new Path(path + Path.SEPARATOR + record.getFileName());
      FSDataOutputStream outputStream=fs.create(newPath,true);
      outputStream.write(record.getDataBuffer(),0,record.getDataBuffer().length);
      outputStream.close();
    }
  }
 catch (  InterruptedException e) {
    LOG.error(e);
  }
}
