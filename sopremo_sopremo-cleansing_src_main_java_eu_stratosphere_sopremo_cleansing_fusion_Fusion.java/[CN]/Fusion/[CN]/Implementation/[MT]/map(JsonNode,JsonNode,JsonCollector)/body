{
  try {
    this.contextNodes.clear();
    if (this.multipleRecordsPerSource) {
      final Iterator<JsonNode> iterator=values.iterator();
      final IntList sourceIndexes=new IntArrayList();
      for (int sourceIndex=0; iterator.hasNext(); sourceIndex++)       for (      final JsonNode value : iterator.next()) {
        this.contextNodes.add(value);
        sourceIndexes.add(sourceIndex);
      }
      this.context.setSourceIndexes(sourceIndexes.toIntArray());
    }
 else {
      for (      final JsonNode value : values)       this.contextNodes.add(value);
      final int[] sourceIndexes=new int[this.contextNodes.size()];
      for (int index=0; index < sourceIndexes.length; index++)       sourceIndexes[index]=index;
      this.context.setSourceIndexes(sourceIndexes);
    }
    this.context.setContextNodes(this.contextNodes.toArray(new JsonNode[this.contextNodes.size()]));
    final double[] initialWeights=new double[this.contextNodes.size()];
    for (int index=0; index < initialWeights.length; index++)     initialWeights[index]=this.getWeight(index,Collections.EMPTY_LIST);
    out.collect(key,this.fuse(this.context.getContextNodes(),initialWeights,new ArrayList<String>()));
  }
 catch (  final UnresolvableEvaluationException e) {
  }
}
