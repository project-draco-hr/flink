{
  final JsonNode[] children=new JsonNode[values.length];
  final List<String> childPath=new ArrayList<String>(currentPath);
  final double[] childWeights=new double[weights.length];
  final ObjectNode fusedObject=new ObjectNode(null);
  final int lastPath=childPath.size();
  childPath.add(null);
  while (fieldNames.hasNext()) {
    final String fieldName=fieldNames.next();
    for (int index=0; index < values.length; index++) {
      children[index]=values[index] == NullNode.getInstance() ? values[index] : values[index].get(fieldName);
      childWeights[index]=weights[index] * this.getWeight(index,childPath);
    }
    childPath.set(lastPath,fieldName);
    fusedObject.put(fieldName,this.fuse(children,childWeights,childPath));
  }
  return fusedObject;
}
