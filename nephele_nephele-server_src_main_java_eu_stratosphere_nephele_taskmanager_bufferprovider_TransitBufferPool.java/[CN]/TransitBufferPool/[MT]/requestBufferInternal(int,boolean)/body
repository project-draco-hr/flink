{
  if (minimumSizeOfBuffer > this.bufferSizeInBytes) {
    throw new IllegalArgumentException("Buffer of " + minimumSizeOfBuffer + " bytes is requested, but maximum buffer size is "+ this.bufferSizeInBytes);
  }
  ByteBuffer byteBuffer;
synchronized (this.buffers) {
    if (block) {
      while (this.buffers.isEmpty()) {
        this.buffers.wait();
      }
      byteBuffer=this.buffers.poll();
    }
 else {
      byteBuffer=this.buffers.poll();
      if (byteBuffer == null) {
        return null;
      }
    }
  }
  return BufferFactory.createFromMemory(minimumSizeOfBuffer,byteBuffer,this.buffers);
}
