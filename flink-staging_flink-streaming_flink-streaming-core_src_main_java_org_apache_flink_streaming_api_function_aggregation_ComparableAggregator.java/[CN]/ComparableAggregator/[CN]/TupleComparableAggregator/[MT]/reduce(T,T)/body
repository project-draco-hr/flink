{
  Tuple tuple1=(Tuple)value1;
  Tuple tuple2=(Tuple)value2;
  Comparable<Object> o1=tuple1.getField(position);
  Object o2=tuple2.getField(position);
  int c=comparator.isExtremal(o1,o2);
  if (byAggregate) {
    if (c == 1) {
      return (T)tuple1;
    }
    if (first) {
      if (c == 0) {
        return (T)tuple1;
      }
    }
    return (T)tuple2;
  }
 else {
    if (c == 1) {
      tuple2.setField(o1,position);
    }
    return (T)tuple2;
  }
}
