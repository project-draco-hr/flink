{
  OneInputStreamOperator<T,WindowEvent<T>> discretizer=getDiscretizer();
  OneInputStreamOperator<WindowEvent<T>,StreamWindow<T>> bufferOperator=getBufferOperator(windowBuffer);
  @SuppressWarnings({"unchecked","rawtypes"}) TypeInformation<WindowEvent<T>> bufferEventType=new TupleTypeInfo(WindowEvent.class,getType(),BasicTypeInfo.INT_TYPE_INFO);
  int parallelism=getDiscretizerParallelism(transformation);
  return new DiscretizedStream<T>(dataStream.transform(discretizer.getClass().getSimpleName(),bufferEventType,discretizer).setParallelism(parallelism).transform(windowBuffer.getClass().getSimpleName(),new StreamWindowTypeInfo<T>(getType()),bufferOperator).setParallelism(parallelism),keyByKey,transformation,false);
}
