{
  WindowTransformation transformation=WindowTransformation.REDUCEWINDOW.with(clean(reduceFunction));
  WindowBuffer<OUT> windowBuffer=getWindowBuffer(transformation).emitEmpty().sequentialID();
  if (groupByKey != null) {
    dataStream=dataStream.groupBy(groupByKey);
  }
  DiscretizedStream<OUT> discretized=discretize(transformation,windowBuffer);
  return discretized.timeReduce(reduceFunction,windowBuffer instanceof PreAggregator);
}
