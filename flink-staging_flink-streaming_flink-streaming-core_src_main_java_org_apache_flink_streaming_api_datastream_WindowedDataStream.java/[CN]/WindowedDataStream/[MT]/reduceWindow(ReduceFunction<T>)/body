{
  if (WindowUtils.isTimeOnly(getTrigger(),getEviction()) && discretizerKey == null && dataStream.getParallelism() > 1) {
    return timeReduce(reduceFunction);
  }
 else {
    WindowTransformation transformation=WindowTransformation.REDUCEWINDOW.with(clean(reduceFunction));
    WindowBuffer<T> windowBuffer=getWindowBuffer(transformation);
    DiscretizedStream<T> discretized=discretize(transformation,windowBuffer);
    if (windowBuffer instanceof PreAggregator) {
      return discretized;
    }
 else {
      return discretized.reduceWindow(reduceFunction);
    }
  }
}
