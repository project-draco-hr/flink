{
  if (transformation == WindowTransformation.REDUCEWINDOW && getEviction() instanceof TumblingEvictionPolicy) {
    if (groupByKey == null) {
      return new TumblingPreReducer<OUT>(clean((ReduceFunction<OUT>)transformation.getUDF()),getType().createSerializer(getExecutionConfig()));
    }
 else {
      return new TumblingGroupedPreReducer<OUT>(clean((ReduceFunction<OUT>)transformation.getUDF()),groupByKey,getType().createSerializer(getExecutionConfig()));
    }
  }
  return new BasicWindowBuffer<OUT>();
}
