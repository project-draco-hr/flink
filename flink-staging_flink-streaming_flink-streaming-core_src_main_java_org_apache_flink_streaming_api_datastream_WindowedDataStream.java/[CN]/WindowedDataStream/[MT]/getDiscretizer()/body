{
  if (discretizerKey == null) {
    return new StreamDiscretizer<OUT>(getTrigger(),getEvicter());
  }
 else   if (getTrigger() instanceof TimeTriggerPolicy && ((TimeTriggerPolicy<OUT>)getTrigger()).timestampWrapper.isDefaultTimestamp()) {
    return new GroupedTimeDiscretizer<OUT>(discretizerKey,(TimeTriggerPolicy<OUT>)getTrigger(),(CloneableEvictionPolicy<OUT>)getEvicter());
  }
 else {
    return new GroupedStreamDiscretizer<OUT>(discretizerKey,(CloneableTriggerPolicy<OUT>)getTrigger(),(CloneableEvictionPolicy<OUT>)getEvicter());
  }
}
