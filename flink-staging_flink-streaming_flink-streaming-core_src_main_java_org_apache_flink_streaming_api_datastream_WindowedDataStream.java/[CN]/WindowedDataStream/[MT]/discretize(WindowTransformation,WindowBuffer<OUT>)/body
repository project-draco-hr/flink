{
  StreamInvokable<OUT,WindowEvent<OUT>> discretizer=getDiscretizer();
  StreamInvokable<WindowEvent<OUT>,StreamWindow<OUT>> bufferInvokable=getBufferInvokable(windowBuffer);
  @SuppressWarnings({"unchecked","rawtypes"}) TypeInformation<WindowEvent<OUT>> bufferEventType=new TupleTypeInfo(WindowEvent.class,getType(),BasicTypeInfo.INT_TYPE_INFO);
  int parallelism=getDiscretizerParallelism(transformation);
  return new DiscretizedStream<OUT>(dataStream.transform("Stream Discretizer",bufferEventType,discretizer).setParallelism(parallelism).transform("WindowBuffer",new StreamWindowTypeInfo<OUT>(getType()),bufferInvokable).setParallelism(parallelism),groupByKey,transformation,false);
}
