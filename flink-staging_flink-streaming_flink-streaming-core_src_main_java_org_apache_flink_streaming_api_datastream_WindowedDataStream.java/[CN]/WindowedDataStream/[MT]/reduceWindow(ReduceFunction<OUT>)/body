{
  WindowTransformation transformation=WindowTransformation.REDUCEWINDOW.with(clean(reduceFunction));
  WindowBuffer<OUT> windowBuffer=getWindowBuffer(transformation);
  DiscretizedStream<OUT> discretized=discretize(transformation,windowBuffer);
  if (windowBuffer instanceof CompletePreAggregator) {
    return discretized;
  }
 else {
    return discretized.reduceWindow(reduceFunction);
  }
}
