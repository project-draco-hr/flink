{
  WindowTransformation transformation=WindowTransformation.REDUCEWINDOW.with(reduceFunction);
  WindowBuffer<OUT> windowBuffer=getWindowBuffer(transformation,getTrigger(),getEviction(),discretizerKey);
  if (windowBuffer instanceof CompletePreAggregator) {
    return discretize(transformation,windowBuffer);
  }
 else {
    return discretize(transformation,windowBuffer).reduceWindow(reduceFunction);
  }
}
