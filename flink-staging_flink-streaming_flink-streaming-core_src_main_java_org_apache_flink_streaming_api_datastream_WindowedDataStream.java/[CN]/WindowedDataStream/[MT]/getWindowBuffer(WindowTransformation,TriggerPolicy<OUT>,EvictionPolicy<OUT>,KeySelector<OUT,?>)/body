{
  if (transformation == WindowTransformation.REDUCEWINDOW && eviction instanceof TumblingEvictionPolicy) {
    if (groupByKey == null) {
      return new TumblingPreReducer<OUT>(dataStream.clean((ReduceFunction<OUT>)transformation.UDF),getType().createSerializer(getExecutionConfig()));
    }
 else {
      return new TumblingGroupedPreReducer<OUT>(dataStream.clean((ReduceFunction<OUT>)transformation.UDF),groupByKey,getType().createSerializer(getExecutionConfig()));
    }
  }
  return new BasicWindowBuffer<OUT>();
}
