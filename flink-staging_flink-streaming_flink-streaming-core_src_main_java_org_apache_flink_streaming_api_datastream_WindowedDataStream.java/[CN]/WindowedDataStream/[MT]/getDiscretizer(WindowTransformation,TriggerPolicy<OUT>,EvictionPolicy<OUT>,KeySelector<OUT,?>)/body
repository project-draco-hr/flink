{
  WindowBuffer<OUT> windowBuffer=getWindowBuffer(transformation,trigger,eviction,discretizerKey);
  if (discretizerKey == null) {
    return new StreamDiscretizer<OUT>(trigger,eviction,windowBuffer);
  }
 else   if (trigger instanceof TimeTriggerPolicy && ((TimeTriggerPolicy<OUT>)trigger).timestampWrapper.isDefaultTimestamp()) {
    return new GroupedTimeDiscretizer<OUT>(discretizerKey,(TimeTriggerPolicy<OUT>)trigger,(CloneableEvictionPolicy<OUT>)eviction,windowBuffer);
  }
 else {
    return new GroupedStreamDiscretizer<OUT>(discretizerKey,(CloneableTriggerPolicy<OUT>)trigger,(CloneableEvictionPolicy<OUT>)eviction,windowBuffer);
  }
}
