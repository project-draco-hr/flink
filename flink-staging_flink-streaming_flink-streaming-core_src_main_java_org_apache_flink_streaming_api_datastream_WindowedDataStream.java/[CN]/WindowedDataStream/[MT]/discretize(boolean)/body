{
  StreamInvokable<OUT,StreamWindow<OUT>> discretizer=getDiscretizer();
  int parallelism=isLocal || (discretizerKey != null) ? dataStream.environment.getDegreeOfParallelism() : 1;
  return new DiscretizedStream<OUT>(dataStream.transform("Stream Discretizer",new StreamWindowTypeInfo<OUT>(getType()),discretizer).setParallelism(parallelism),groupByKey);
}
