{
  StreamInvokable<OUT,StreamWindow<OUT>> discretizer;
  if (discretizerKey == null) {
    discretizer=new StreamDiscretizer<OUT>(getTrigger(),getEvicter());
  }
 else {
    discretizer=new GroupedStreamDiscretizer<OUT>(discretizerKey,(CloneableTriggerPolicy<OUT>)getTrigger(),(CloneableEvictionPolicy<OUT>)getEvicter());
  }
  int parallelism=isLocal || (discretizerKey != null) ? dataStream.environment.getDegreeOfParallelism() : 1;
  return new DiscretizedStream<OUT>(dataStream.transform("Stream Discretizer",new StreamWindowTypeInfo<OUT>(getType()),discretizer).setParallelism(parallelism),groupByKey);
}
