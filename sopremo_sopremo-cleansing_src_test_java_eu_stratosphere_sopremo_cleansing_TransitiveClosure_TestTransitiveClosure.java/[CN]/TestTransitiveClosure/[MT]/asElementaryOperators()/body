{
  final SopremoModule sopremoModule=new SopremoModule(this.getName(),2,1);
  JsonStream input=sopremoModule.getInput(0);
  JsonStream nullInput=sopremoModule.getInput(1);
  final GenerateMatrix filledMatrix=new GenerateMatrix().withInputs(input,nullInput);
  filledMatrix.setNumberOfPartitions(this.numberOfPartitions);
  final Phase1 phase1=new Phase1().withInputs(filledMatrix);
  final Phase2 phase2=new Phase2().withInputs(phase1,filledMatrix);
  final Phase3 phase3=new Phase3().withInputs(new UnionAll().withInputs(phase1,phase2));
  phase3.setNumberOfPartitions(this.numberOfPartitions);
  final EmitMatrix result;
  if (this.phase == 1) {
    result=new EmitMatrix().withInputs(phase1);
  }
 else {
    if (this.phase == 2) {
      result=new EmitMatrix().withInputs(new UnionAll().withInputs(phase1,phase2));
    }
 else {
      result=new EmitMatrix().withInputs(phase3);
    }
  }
  sopremoModule.getOutput(0).setInput(0,result);
  return sopremoModule;
}
