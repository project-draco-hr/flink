{
  final SopremoPlan actualPlan=this.parseScript("$persons = read from hdfs('persons.json');\n" + "$nickNames = read from hdfs('nickNames.json');\n" + "$normalizedPersons = replace $person in $persons\n"+ "	on $person.firstName\n"+ "	with $nickNames;\n"+ "write $normalizedPersons to hdfs('normalizedPersons.json');");
  final SopremoPlan expectedPlan=new SopremoPlan();
  final Source persons=new Source("persons.json");
  final Source nickNames=new Source("nickNames.json");
  final Replace replace=new Replace().withInputs(persons,nickNames).withReplaceExpression(JsonUtil.createPath("0","firstName"));
  final Sink normalizedPersons=new Sink("normalizedPersons.json").withInputs(replace);
  expectedPlan.setSinks(normalizedPersons);
  assertPlanEquals(expectedPlan,actualPlan);
}
