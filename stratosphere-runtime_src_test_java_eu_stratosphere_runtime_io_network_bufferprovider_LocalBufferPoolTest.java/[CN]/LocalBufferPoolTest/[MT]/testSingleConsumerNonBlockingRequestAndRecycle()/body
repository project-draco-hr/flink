{
  final LocalBufferPool bufferPool=new LocalBufferPool(GLOBAL_BUFFER_POOL,NUM_BUFFERS);
  Assert.assertEquals(0,bufferPool.numRequestedBuffers());
  for (int numRequested=0; numRequested < NUM_BUFFERS; numRequested++) {
    Buffer buffer=bufferPool.requestBuffer(BUFFER_SIZE);
    Assert.assertEquals(BUFFER_SIZE,buffer.size());
    Assert.assertEquals("Expected single buffer request in buffer pool.",1,bufferPool.numRequestedBuffers());
    Assert.assertEquals("Expected no available buffer in buffer pool.",0,bufferPool.numAvailableBuffers());
    buffer.recycleBuffer();
    Assert.assertEquals("Expected single available buffer after recycle.",1,bufferPool.numAvailableBuffers());
  }
  bufferPool.destroy();
}
