{
  ChannelWithAccessInfo cwa=this.fileMap.get(id);
  if (cwa == null) {
    if (createIfAbsent) {
      if (distributed && this.distributedFileSystem != null) {
        final String checkpointFile=this.distributedTempPath + File.separator + FILE_BUFFER_PREFIX+ id.toString();
        final Path p=new Path(checkpointFile);
        cwa=new DistributedChannelWithAccessInfo(this.distributedFileSystem,p,this.bufferSize);
      }
 else {
        final int dirIndex=Math.abs(id.hashCode()) % this.tmpDirs.length;
        final File file=new File(this.tmpDirs[dirIndex] + id.toString());
        cwa=new LocalChannelWithAccessInfo(file);
      }
      final ChannelWithAccessInfo alreadyContained=this.fileMap.putIfAbsent(id,cwa);
      if (alreadyContained != null) {
        cwa.disposeSilently();
        cwa=alreadyContained;
      }
    }
 else {
      return null;
    }
  }
  return cwa;
}
