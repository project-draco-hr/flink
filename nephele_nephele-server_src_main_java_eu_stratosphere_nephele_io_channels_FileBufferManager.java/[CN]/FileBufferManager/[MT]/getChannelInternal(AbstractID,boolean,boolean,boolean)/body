{
  ChannelWithAccessInfo cwa=this.fileMap.get(id);
  if (cwa == null) {
    if (distributed && this.distributedFileSystem != null) {
      final Path p=constructDistributedPath(id);
      if (this.distributedFileSystem.exists(p)) {
        cwa=new DistributedChannelWithAccessInfo(this.distributedFileSystem,p,this.bufferSize,deleteOnClose);
      }
    }
 else {
      final File f=constructLocalFile(id);
      if (f.exists()) {
        cwa=new LocalChannelWithAccessInfo(f,deleteOnClose);
      }
    }
    if (createIfAbsent && cwa == null) {
      if (distributed && this.distributedFileSystem != null) {
        final Path p=constructDistributedPath(id);
        cwa=new DistributedChannelWithAccessInfo(this.distributedFileSystem,p,this.bufferSize,deleteOnClose);
      }
 else {
        final File f=constructLocalFile(id);
        cwa=new LocalChannelWithAccessInfo(f,deleteOnClose);
      }
    }
    if (cwa != null) {
      final ChannelWithAccessInfo alreadyContained=this.fileMap.putIfAbsent(id,cwa);
      if (alreadyContained != null) {
        cwa.disposeSilently();
        cwa=alreadyContained;
      }
    }
 else {
      return null;
    }
  }
  cwa.updateDeleteOnCloseFlag(deleteOnClose);
  return cwa;
}
