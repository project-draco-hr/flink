{
  final Object groupObject=this.channelGroupMap.get(sourceChannelID);
  if (groupObject == null) {
    if (this.canceledChannels.contains(sourceChannelID)) {
      throw new ChannelCanceledException();
    }
 else {
      throw new IOException("Cannot find input gate for source channel ID " + sourceChannelID);
    }
  }
synchronized (this.writableSpillingFileMap) {
    WritableSpillingFile writableSpillingFile=this.writableSpillingFileMap.get(groupObject);
    if (writableSpillingFile == null) {
      final String filename=this.tmpDir + File.separator + FileUtils.getRandomFilename("fb_");
      writableSpillingFile=new WritableSpillingFile(new File(filename));
      this.writableSpillingFileMap.put(groupObject,writableSpillingFile);
    }
    return writableSpillingFile.lockWritableFileChannel();
  }
}
