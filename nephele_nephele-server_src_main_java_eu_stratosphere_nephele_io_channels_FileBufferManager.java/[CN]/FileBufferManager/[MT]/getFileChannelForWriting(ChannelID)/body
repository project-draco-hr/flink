{
  final Object groupObject=getGroupObject(sourceChannelID);
synchronized (this.writableSpillingFileMap) {
    WritableSpillingFile writableSpillingFile=this.writableSpillingFileMap.get(groupObject);
    if (writableSpillingFile == null) {
      final String filename=this.tmpDir + File.separator + FileUtils.getRandomFilename("fb_");
      writableSpillingFile=new WritableSpillingFile(new File(filename));
      this.writableSpillingFileMap.put(groupObject,writableSpillingFile);
    }
    return writableSpillingFile.lockWritableFileChannel();
  }
}
