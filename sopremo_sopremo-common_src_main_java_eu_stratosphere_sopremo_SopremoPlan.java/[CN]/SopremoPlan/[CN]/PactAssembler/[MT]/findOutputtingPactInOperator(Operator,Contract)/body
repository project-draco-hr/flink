{
  int inputIndex=-1;
  DataSourceContract<?,?>[] inputPacts=modules.get(operator).getInputs();
  for (int index=0; index < inputPacts.length; index++)   if (inputPacts[index] == o) {
    inputIndex=index;
    break;
  }
  if (inputIndex >= operator.getInputs().size() || inputIndex == -1)   return o;
  Output input=operator.getInputs().get(inputIndex);
  Contract outputtingContract=operatorOutputs.get(input.getOperator())[input.getIndex()];
  if (outputtingContract instanceof DataSourceContract<?,?> && !(input.getOperator() instanceof Source)) {
    outputtingContract=findOutputtingPactInOperator(input.getOperator(),outputtingContract);
  }
  return outputtingContract;
}
