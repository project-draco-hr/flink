{
  CheckpointBarrier receivedBarrier=(CheckpointBarrier)bufferOrEvent.getEvent();
  if (receivedBarrier.getId() < lastCheckpointId) {
    return;
  }
  if (currentBarrier == null) {
    this.currentBarrier=receivedBarrier;
    if (LOG.isDebugEnabled()) {
      LOG.debug("Checkpoint barrier received start waiting for checkpoint: {}",receivedBarrier);
    }
  }
 else   if (receivedBarrier.getId() > currentBarrier.getId()) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Checkpoint barrier received while waiting on checkpoint {}. Restarting waiting with checkpoint {}: ",currentBarrier,receivedBarrier);
    }
    releaseBlocks();
    currentBarrier=receivedBarrier;
  }
  blockChannel(bufferOrEvent.getChannelIndex());
}
