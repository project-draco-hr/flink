{
  if (!nonprocessed.isEmpty()) {
    throw new RuntimeException("Error in barrier buffer logic");
  }
  nonprocessed=blockedNonprocessed;
  blockedNonprocessed=new LinkedList<SpillingBufferOrEvent>();
  try {
    spillReader.setSpillFile(bufferSpiller.getSpillFile());
    bufferSpiller.resetSpillFile();
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  blockedChannels.clear();
  superstepStarted=false;
  if (LOG.isDebugEnabled()) {
    LOG.debug("All barriers received, blocks released");
  }
}
