{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Releasing blocks");
  }
  for (int i=0; i < blockedChannels.length; i++) {
    blockedChannels[i]=false;
  }
  numReceivedBarriers=0;
  if (currentBuffered == null) {
    currentBuffered=bufferSpiller.rollOver();
    if (currentBuffered != null) {
      currentBuffered.open();
    }
  }
 else {
    queuedBuffered.addFirst(currentBuffered);
    currentBuffered=bufferSpiller.rollOverWithNewBuffer();
    if (currentBuffered != null) {
      currentBuffered.open();
    }
  }
}
