{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Publishing barrier to the vertex");
  }
  if (currentBarrier != null && !inputFinished) {
    reader.publish(currentBarrier);
    lastCheckpointId=currentBarrier.getId();
  }
  releaseBlocks();
}
