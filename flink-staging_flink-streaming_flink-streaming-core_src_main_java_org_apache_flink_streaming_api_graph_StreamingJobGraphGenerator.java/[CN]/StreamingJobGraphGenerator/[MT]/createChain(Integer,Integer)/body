{
  if (!builtVertices.contains(startNode)) {
    List<StreamEdge> transitiveOutEdges=new ArrayList<StreamEdge>();
    List<StreamEdge> chainableOutputs=new ArrayList<StreamEdge>();
    List<StreamEdge> nonChainableOutputs=new ArrayList<StreamEdge>();
    for (    StreamEdge outEdge : streamGraph.getStreamNode(current).getOutEdges()) {
      if (isChainable(outEdge)) {
        chainableOutputs.add(outEdge);
      }
 else {
        nonChainableOutputs.add(outEdge);
      }
    }
    for (    StreamEdge chainable : chainableOutputs) {
      transitiveOutEdges.addAll(createChain(startNode,chainable.getTargetId()));
    }
    for (    StreamEdge nonChainable : nonChainableOutputs) {
      transitiveOutEdges.add(nonChainable);
      createChain(nonChainable.getTargetId(),nonChainable.getTargetId());
    }
    chainedNames.put(current,createChainedName(current,chainableOutputs));
    StreamConfig config=current.equals(startNode) ? createProcessingVertex(startNode) : new StreamConfig(new Configuration());
    setVertexConfig(current,config,chainableOutputs,nonChainableOutputs);
    if (current.equals(startNode)) {
      config.setChainStart();
      config.setOutEdgesInOrder(transitiveOutEdges);
      config.setOutEdges(streamGraph.getStreamNode(current).getOutEdges());
      for (      StreamEdge edge : transitiveOutEdges) {
        connect(startNode,edge);
      }
      config.setTransitiveChainedTaskConfigs(chainedConfigs.get(startNode));
    }
 else {
      Map<Integer,StreamConfig> chainedConfs=chainedConfigs.get(startNode);
      if (chainedConfs == null) {
        chainedConfigs.put(startNode,new HashMap<Integer,StreamConfig>());
      }
      chainedConfigs.get(startNode).put(current,config);
    }
    return transitiveOutEdges;
  }
 else {
    return new ArrayList<StreamEdge>();
  }
}
