{
  final int numSubtasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String orders1Path=(args.length > 1 ? args[1] : "");
  String orders2Path=(args.length > 2 ? args[2] : "");
  String partJoin1Path=(args.length > 3 ? args[3] : "");
  String partJoin2Path=(args.length > 4 ? args[4] : "");
  String lineitemsPath=(args.length > 5 ? args[5] : "");
  String output=(args.length > 6 ? args[6] : "");
  FileDataSource orders1=new FileDataSource(new CsvInputFormat(),orders1Path,"Orders 1");
  CsvInputFormat.configureRecordFormat(orders1).recordDelimiter('\n').fieldDelimiter('|').field(LongValue.class,0).field(IntValue.class,7).field(StringValue.class,2,2).field(StringValue.class,4,10).field(StringValue.class,5,8);
  FileDataSource orders2=new FileDataSource(new CsvInputFormat(),orders2Path,"Orders 2");
  CsvInputFormat.configureRecordFormat(orders2).recordDelimiter('\n').fieldDelimiter('|').field(LongValue.class,0).field(IntValue.class,7).field(StringValue.class,2,2).field(StringValue.class,4,10).field(StringValue.class,5,8);
  FileDataSource lineitems=new FileDataSource(new CsvInputFormat(),lineitemsPath,"LineItems");
  CsvInputFormat.configureRecordFormat(lineitems).recordDelimiter('\n').fieldDelimiter('|').field(LongValue.class,0).field(DoubleValue.class,5);
  MapOperator filterO1=MapOperator.builder(new FilterO()).name("FilterO").input(orders1).build();
  filterO1.setParameter(TPCHQuery3.YEAR_FILTER,1993);
  filterO1.setParameter(TPCHQuery3.PRIO_FILTER,"5");
  filterO1.getCompilerHints().setFilterFactor(0.05f);
  MapOperator filterO2=MapOperator.builder(new FilterO()).name("FilterO").input(orders2).build();
  filterO2.setParameter(TPCHQuery3.YEAR_FILTER,1993);
  filterO2.setParameter(TPCHQuery3.PRIO_FILTER,"5");
  @SuppressWarnings("unchecked") JoinOperator joinLiO=JoinOperator.builder(new JoinLiO(),LongValue.class,0,0).input1(filterO2,filterO1).input2(lineitems).name("JoinLiO").build();
  FileDataSource partJoin1=new FileDataSource(new CsvInputFormat(),partJoin1Path,"Part Join 1");
  CsvInputFormat.configureRecordFormat(partJoin1).recordDelimiter('\n').fieldDelimiter('|').field(LongValue.class,0).field(IntValue.class,1).field(DoubleValue.class,2);
  FileDataSource partJoin2=new FileDataSource(new CsvInputFormat(),partJoin2Path,"Part Join 2");
  CsvInputFormat.configureRecordFormat(partJoin2).recordDelimiter('\n').fieldDelimiter('|').field(LongValue.class,0).field(IntValue.class,1).field(DoubleValue.class,2);
  @SuppressWarnings("unchecked") ReduceOperator aggLiO=ReduceOperator.builder(new AggLiO()).keyField(LongValue.class,0).keyField(StringValue.class,1).input(joinLiO,partJoin2,partJoin1).name("AggLio").build();
  FileDataSink result=new FileDataSink(new CsvOutputFormat(),output,aggLiO,"Output");
  CsvOutputFormat.configureRecordFormat(result).recordDelimiter('\n').fieldDelimiter('|').lenient(true).field(LongValue.class,0).field(IntValue.class,1).field(DoubleValue.class,2);
  Plan plan=new Plan(result,"TPCH Q3 Unioned");
  plan.setDefaultParallelism(numSubtasks);
  return plan;
}
