{
  try {
    Properties properties=new Properties();
    StreamExecutionEnvironment see=StreamExecutionEnvironment.createRemoteEnvironment("localhost",flinkPort);
    see.getConfig().disableSysoutLogging();
    see.setNumberOfExecutionRetries(0);
    see.setParallelism(1);
    properties.setProperty("bootstrap.servers","localhost:80");
    properties.setProperty("zookeeper.connect","localhost:80");
    properties.setProperty("group.id","test");
    FlinkKafkaConsumerBase<String> source=kafkaServer.getConsumer("doesntexist",new SimpleStringSchema(),properties);
    DataStream<String> stream=see.addSource(source);
    stream.print();
    see.execute("No broker test");
  }
 catch (  RuntimeException re) {
    Assert.assertTrue("Wrong RuntimeException thrown: " + StringUtils.stringifyException(re),re.getClass().equals(RuntimeException.class) && re.getMessage().contains("Unable to retrieve any partitions for the requested topics [doesntexist]"));
  }
}
