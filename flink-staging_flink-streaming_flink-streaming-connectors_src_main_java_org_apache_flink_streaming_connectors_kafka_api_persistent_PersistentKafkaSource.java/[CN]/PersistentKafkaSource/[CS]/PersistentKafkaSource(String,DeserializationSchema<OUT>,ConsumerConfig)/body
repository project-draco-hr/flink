{
  Preconditions.checkNotNull(topicName);
  Preconditions.checkNotNull(deserializationSchema);
  Preconditions.checkNotNull(consumerConfig);
  this.topicName=topicName;
  this.deserializationSchema=deserializationSchema;
  this.consumerConfig=consumerConfig;
  if (consumerConfig.autoCommitEnable()) {
    throw new IllegalArgumentException("'auto.commit.enable' is set to 'true'. " + "This source can only be used with auto commit disabled because the " + "source is committing to zookeeper by itself (not using the KafkaConsumer).");
  }
  if (!consumerConfig.offsetsStorage().equals("zookeeper")) {
    throw new IllegalArgumentException("The 'offsets.storage' has to be set to 'zookeeper' for this Source to work reliably");
  }
}
