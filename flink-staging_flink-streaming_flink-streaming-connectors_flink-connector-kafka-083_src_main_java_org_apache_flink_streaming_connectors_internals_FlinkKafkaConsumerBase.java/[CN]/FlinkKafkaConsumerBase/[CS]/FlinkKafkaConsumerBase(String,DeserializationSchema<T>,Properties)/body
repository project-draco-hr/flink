{
  this.topic=topic;
  this.props=props;
  this.valueDeserializer=valueDeserializer;
  List<PartitionInfo> partitionInfos=getPartitionsForTopic(this.topic,this.props);
  partitions=new int[partitionInfos.size()];
  for (int i=0; i < partitionInfos.size(); i++) {
    partitions[i]=partitionInfos.get(i).partition();
  }
  LOG.info("Topic {} has {} partitions",topic,partitions.length);
}
