{
  TopicAndPartition tap=new TopicAndPartition(topic,partition);
  ZKGroupTopicDirs topicDirs=new ZKGroupTopicDirs(groupId,tap.topic());
  scala.Tuple2<Option<String>,Stat> data=ZkUtils.readDataMaybeNull(zkClient,topicDirs.consumerOffsetDir() + "/" + tap.partition());
  if (data._1().isEmpty()) {
    return OFFSET_NOT_SET;
  }
 else {
    return Long.valueOf(data._1().get());
  }
}
