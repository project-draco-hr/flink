{
synchronized (commitedOffsets) {
    if (closed) {
      LOG.warn("setOffset called on closed source");
      return;
    }
    if (commitedOffsets[partition] < offset) {
      setOffset(zkClient,props.getProperty(ConsumerConfig.GROUP_ID_CONFIG),topic,partition,offset);
      commitedOffsets[partition]=offset;
    }
 else {
      LOG.debug("Ignoring offset {} for partition {} because it is already committed",offset,partition);
    }
  }
}
