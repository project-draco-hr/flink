{
  KafkaConsumer<byte[],byte[]> consumer=new KafkaConsumer<byte[],byte[]>(properties,null,new ByteArrayDeserializer(),new ByteArrayDeserializer());
  try {
    List<PartitionInfo> partitions=consumer.partitionsFor(topic);
    if (partitions == null) {
      throw new RuntimeException("The topic " + topic + " does not seem to exist");
    }
    if (partitions.size() == 0) {
      throw new RuntimeException("The topic " + topic + " does not seem to have any partitions");
    }
    return partitions;
  }
  finally {
    consumer.close();
  }
}
