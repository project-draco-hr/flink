{
  if (makeFinal) {
    if (!this.canBeFinal())     throw new IllegalStateException("Cluster cannot be made final");
    this.child1=this.child2=null;
  }
 else {
    if (this.canBeFinal())     this.rollbackRowsums();
    this.points=null;
  }
  this.oldRowsums=null;
  this.isFinal=makeFinal;
}
