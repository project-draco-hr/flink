{
  if (makeFinal) {
    if (!canBeFinal()) {
      throw new IllegalStateException("Cluster cannot be made final");
    }
    child1=child2=null;
  }
 else {
    if (canBeFinal()) {
      rollbackRowsums();
    }
    points=null;
  }
  oldRowsums=null;
  isFinal=makeFinal;
}
