{
  if (completed())   throw new KafkaException("This operation cannot be completed on a complete request.");
  int totalWrittenPerCall=0;
  boolean sendComplete=false;
  do {
    long written=current.writeTo(channel);
    totalWritten+=written;
    totalWrittenPerCall+=written;
    sendComplete=current.completed();
    if (sendComplete)     nextSendOrDone();
  }
 while (!completed() && sendComplete);
  if (log.isTraceEnabled())   log.trace("Bytes written as part of multisend call : " + totalWrittenPerCall + "Total bytes written so far : "+ totalWritten+ "Expected bytes to write : "+ size);
  return totalWrittenPerCall;
}
