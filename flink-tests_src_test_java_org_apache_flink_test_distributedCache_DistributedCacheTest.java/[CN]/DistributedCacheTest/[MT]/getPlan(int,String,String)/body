{
  FileDataSource source=new FileDataSource(new TextInputFormat(),dataInput,"Input Lines");
  MapOperator mapper=MapOperator.builder(new TokenizeLine()).input(source).name("Tokenize Lines").build();
  FileDataSink out=new FileDataSink(new CsvOutputFormat(),output,mapper,"Selection");
  CsvOutputFormat.configureRecordFormat(out).recordDelimiter('\n').fieldDelimiter(' ').field(StringValue.class,0).field(IntValue.class,1);
  Plan plan=new Plan(out,"Distributed Cache");
  plan.setDefaultParallelism(numSubTasks);
  plan.setExecutionConfig(new ExecutionConfig());
  return plan;
}
