{
  if (!parseParameters(args)) {
    return;
  }
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<Vertex<Long,Long>> vertices=getVertexDataSet(env);
  DataSet<Edge<Long,NullValue>> edges=getEdgeDataSet(env);
  Graph<Long,Long,NullValue> graph=Graph.fromDataSet(vertices,edges,env);
  DataSet<Vertex<Long,Long>> verticesWithCommunity=graph.run(new LabelPropagationAlgorithm<Long>(maxIterations)).getVertices();
  if (fileOutput) {
    verticesWithCommunity.writeAsCsv(outputPath,"\n",",");
  }
 else {
    verticesWithCommunity.print();
  }
  env.execute("Label Propagation Example");
}
