{
  testFile=File.createTempFile("AvroInputFormatTest",null);
  ArrayList<CharSequence> stringArray=new ArrayList<CharSequence>();
  stringArray.add(TEST_ARRAY_STRING_1);
  stringArray.add(TEST_ARRAY_STRING_2);
  ArrayList<Boolean> booleanArray=new ArrayList<Boolean>();
  booleanArray.add(TEST_ARRAY_BOOLEAN_1);
  booleanArray.add(TEST_ARRAY_BOOLEAN_2);
  HashMap<CharSequence,Long> longMap=new HashMap<CharSequence,Long>();
  longMap.put(TEST_MAP_KEY1,TEST_MAP_VALUE1);
  longMap.put(TEST_MAP_KEY2,TEST_MAP_VALUE2);
  User user1=new User();
  user1.setName(TEST_NAME);
  user1.setFavoriteNumber(256);
  user1.setTypeDoubleTest(123.45d);
  user1.setTypeBoolTest(true);
  user1.setTypeArrayString(stringArray);
  user1.setTypeArrayBoolean(booleanArray);
  user1.setTypeEnum(TEST_ENUM_COLOR);
  user1.setTypeMap(longMap);
  User user2=User.newBuilder().setName("Charlie").setFavoriteColor("blue").setFavoriteNumber(null).setTypeBoolTest(false).setTypeDoubleTest(1.337d).setTypeNullTest(null).setTypeLongTest(1337L).setTypeArrayString(new ArrayList<CharSequence>()).setTypeArrayBoolean(new ArrayList<Boolean>()).setTypeNullableArray(null).setTypeEnum(Colors.RED).setTypeMap(new HashMap<CharSequence,Long>()).build();
  DatumWriter<User> userDatumWriter=new SpecificDatumWriter<User>(User.class);
  DataFileWriter<User> dataFileWriter=new DataFileWriter<User>(userDatumWriter);
  dataFileWriter.create(user1.getSchema(),testFile);
  dataFileWriter.append(user1);
  dataFileWriter.append(user2);
  dataFileWriter.close();
}
