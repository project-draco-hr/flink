{
  Map<Object,OUT> values=new HashMap<Object,OUT>();
  if (batchNotFull()) {
    do {
      Object key=reuse.getField(keyPosition);
      OUT nextValue=reuse.getObject();
      OUT currentValue=values.get(key);
      if (currentValue == null) {
        values.put(key,nextValue);
      }
 else {
        values.put(key,reducer.reduce(currentValue,nextValue));
      }
      resetReuse();
    }
 while (getNextRecord() != null && batchNotFull());
  }
  intermediateValues.pushBack(values);
}
