{
  double[] userFeatureVector=userFeatures.getField(1,DenseVector.class).values();
  DenseVector itemFeatureVector=interactionWithItemFeatures.getField(3,DenseVector.class);
  float rating=(float)interactionWithItemFeatures.getField(2,PactDouble.class).getValue();
  factorizer.updateParameters(userFeatureVector,itemFeatureVector.values(),rating,0.05);
  result.setField(0,interactionWithItemFeatures.getField(1,PactInteger.class));
  result.setField(1,itemFeatureVector);
  out.collect(result);
}
