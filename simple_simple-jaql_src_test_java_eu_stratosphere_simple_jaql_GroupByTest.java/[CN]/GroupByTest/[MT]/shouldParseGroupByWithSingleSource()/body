{
  Source source=new Source(createJsonArray(createObject("a",1L,"b",2L),createObject("a",1L,"b",4L)));
  Transformation transformation=new Transformation();
  transformation.addMapping(new ValueAssignment("a",createPath("$","a")));
  transformation.addMapping(new ValueAssignment("total",new JsonPath.Function("sum",createPath("$","[*]","b"))));
  assertParseResult(new Aggregation(transformation,createPath("$","a"),source),"[{a: 1, b: 2}, {a: 1, b: 4}] -> group by a = $.a into { a, total: sum($[*].b) }");
}
