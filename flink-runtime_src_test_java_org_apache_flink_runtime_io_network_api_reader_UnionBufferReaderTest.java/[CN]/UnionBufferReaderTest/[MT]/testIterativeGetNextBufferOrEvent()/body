{
  final MockBufferReader reader1=new MockBufferReader();
  final MockBufferReader reader2=new MockBufferReader();
  final UnionBufferReader unionReader=new UnionBufferReader(reader1.getMock(),reader2.getMock());
  unionReader.setIterativeReader();
  reader1.readBuffer().readBuffer().readEvent().readBuffer().readBuffer().readEvent().readBuffer().finishSuperstep().readBuffer().readBuffer().readEvent().readBuffer().readBuffer().readEvent().readBuffer().finish();
  reader2.readBuffer().readBuffer().readEvent().readBuffer().readBuffer().readEvent().readBuffer().finishSuperstep().readBuffer().readBuffer().readEvent().readBuffer().readBuffer().readEvent().readBuffer().finish();
  final EventListener<TaskEvent> listener=mock(EventListener.class);
  unionReader.subscribeToTaskEvent(listener,TestTaskEvent.class);
  consumeAndVerify(unionReader,20,1);
  verifyListenerCalled(listener,8);
}
