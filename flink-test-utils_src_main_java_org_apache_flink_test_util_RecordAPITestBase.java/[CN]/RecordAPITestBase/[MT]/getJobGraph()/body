{
  Plan p=getTestJob();
  if (p == null) {
    Assert.fail("Error: Cannot obtain plan. Did the test forget to override either 'getPactPlan()' or 'getJobGraph()' ?");
  }
  p.setExecutionConfig(new ExecutionConfig());
  Optimizer pc=new Optimizer(new DataStatistics(),this.config);
  OptimizedPlan op=pc.compile(p);
  if (printPlan) {
    System.out.println(new PlanJSONDumpGenerator().getOptimizerPlanAsJSON(op));
  }
  JobGraphGenerator jgg=new JobGraphGenerator();
  return jgg.compileJobGraph(op);
}
