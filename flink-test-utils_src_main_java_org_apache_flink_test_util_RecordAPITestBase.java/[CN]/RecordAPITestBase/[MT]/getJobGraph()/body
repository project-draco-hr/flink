{
  Plan p=getTestJob();
  p.setExecutionConfig(new ExecutionConfig());
  if (p == null) {
    Assert.fail("Error: Cannot obtain Pact plan. Did the test forget to override either 'getPactPlan()' or 'getJobGraph()' ?");
  }
  Optimizer pc=new Optimizer(new DataStatistics(),this.config);
  OptimizedPlan op=pc.compile(p);
  if (printPlan) {
    System.out.println(new PlanJSONDumpGenerator().getOptimizerPlanAsJSON(op));
  }
  JobGraphGenerator jgg=new JobGraphGenerator();
  return jgg.compileJobGraph(op);
}
