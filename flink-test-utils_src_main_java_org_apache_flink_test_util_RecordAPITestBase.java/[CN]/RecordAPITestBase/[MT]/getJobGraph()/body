{
  Plan p=getTestJob();
  if (p == null) {
    Assert.fail("Error: Cannot obtain Pact plan. Did the thest forget to override either 'getPactPlan()' or 'getJobGraph()' ?");
  }
  Optimizer pc=new Optimizer(new DataStatistics());
  OptimizedPlan op=pc.compile(p);
  if (printPlan) {
    System.out.println(new PlanJSONDumpGenerator().getOptimizerPlanAsJSON(op));
  }
  JobGraphGenerator jgg=new JobGraphGenerator();
  return jgg.compileJobGraph(op);
}
