{
  Map<String,List<KafkaStream<byte[],byte[]>>> consumerMap=consumer.createMessageStreams(Collections.singletonMap(topicId,1));
  KafkaStream<byte[],byte[]> stream=consumerMap.get(topicId).get(0);
  ConsumerIterator<byte[],byte[]> it=stream.iterator();
  while (it.hasNext()) {
    OUT out=scheme.deserialize(it.next().message());
    if (scheme.isEndOfStream(out)) {
      break;
    }
    collector.collect(out);
  }
  consumer.shutdown();
}
