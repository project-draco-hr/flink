{
  File baseDir;
  String sd=GlobalConfiguration.getString(ConfigConstants.BLOB_STORAGE_DIRECTORY_KEY,null);
  if (sd != null) {
    baseDir=new File(sd);
  }
 else {
    baseDir=new File(System.getProperty("java.io.tmpdir"));
  }
  File storageDir;
  final int MAX_ATTEMPTS=10;
  int attempt;
  for (attempt=0; attempt < MAX_ATTEMPTS; attempt++) {
    storageDir=new File(baseDir,String.format("blobStore-%s",UUID.randomUUID().toString()));
    if (!storageDir.exists()) {
      storageDir.mkdirs();
      return storageDir;
    }
  }
  throw new RuntimeException("Could not create a storage directory");
}
