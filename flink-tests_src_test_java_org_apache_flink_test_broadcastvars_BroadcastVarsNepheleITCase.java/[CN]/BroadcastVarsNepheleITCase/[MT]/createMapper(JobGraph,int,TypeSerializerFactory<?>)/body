{
  AbstractJobVertex pointsInput=JobGraphUtils.createTask(RegularPactTask.class,"Map[DotProducts]",jobGraph,numSubTasks);
{
    TaskConfig taskConfig=new TaskConfig(pointsInput.getConfiguration());
    taskConfig.setStubWrapper(new UserCodeClassWrapper<DotProducts>(DotProducts.class));
    taskConfig.addOutputShipStrategy(ShipStrategyType.FORWARD);
    taskConfig.setOutputSerializer(serializer);
    taskConfig.setDriver(CollectorMapDriver.class);
    taskConfig.setDriverStrategy(DriverStrategy.COLLECTOR_MAP);
    taskConfig.addInputToGroup(0);
    taskConfig.setInputLocalStrategy(0,LocalStrategy.NONE);
    taskConfig.setInputSerializer(serializer,0);
    taskConfig.setBroadcastInputName("models",0);
    taskConfig.addBroadcastInputToGroup(0);
    taskConfig.setBroadcastInputSerializer(serializer,0);
  }
  return pointsInput;
}
