{
  super(set,keys);
  if (!(this.keys instanceof Keys.SelectorFunctionKeys)) {
    throw new InvalidProgramException("Sorting on KeySelector only works for KeySelector grouping.");
  }
  this.groupSortKeyPositions=keySelector.computeLogicalKeyPositions();
  for (int i=0; i < groupSortKeyPositions.length; i++) {
    groupSortKeyPositions[i]+=this.keys.getNumberOfKeyFields();
  }
  this.groupSortSelectorFunctionKey=keySelector;
  this.groupSortOrders=new Order[groupSortKeyPositions.length];
  Arrays.fill(this.groupSortOrders,order);
}
