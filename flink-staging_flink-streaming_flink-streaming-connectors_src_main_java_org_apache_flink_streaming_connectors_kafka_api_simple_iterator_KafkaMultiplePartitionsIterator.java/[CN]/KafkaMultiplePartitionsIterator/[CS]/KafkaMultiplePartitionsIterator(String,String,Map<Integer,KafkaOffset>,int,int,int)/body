{
  partitions=new ArrayList<KafkaSinglePartitionIterator>(partitionsWithOffset.size());
  String[] hostAndPort=hostName.split(":");
  String host=hostAndPort[0];
  int port=Integer.parseInt(hostAndPort[1]);
  this.waitOnEmptyFetch=waitOnEmptyFetch;
  for (  Map.Entry<Integer,KafkaOffset> partitionWithOffset : partitionsWithOffset.entrySet()) {
    partitions.add(new KafkaSinglePartitionIterator(host,port,topic,partitionWithOffset.getKey(),partitionWithOffset.getValue(),connectTimeoutMs,bufferSize));
  }
}
