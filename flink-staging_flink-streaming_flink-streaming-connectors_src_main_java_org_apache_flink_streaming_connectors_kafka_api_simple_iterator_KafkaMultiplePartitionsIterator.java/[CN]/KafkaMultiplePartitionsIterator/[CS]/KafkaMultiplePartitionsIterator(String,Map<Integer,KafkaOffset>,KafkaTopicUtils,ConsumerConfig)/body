{
  partitions=new ArrayList<KafkaSinglePartitionIterator>(partitionsWithOffset.size());
  this.consumerConfig=consumerConfig;
  for (  Map.Entry<Integer,KafkaOffset> partitionWithOffset : partitionsWithOffset.entrySet()) {
    partitions.add(new KafkaSinglePartitionIterator(topic,partitionWithOffset.getKey(),partitionWithOffset.getValue(),kafkaTopicUtils,this.consumerConfig));
  }
}
