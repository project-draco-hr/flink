{
  KeyValuePair<K,VP> pair;
  int partition;
  try {
    while (readerProbe.hasNext()) {
      pair=readerProbe.next();
      partition=partitioner.getPartition(pair.getKey());
      partitionWriters.get(partition).write(pair);
    }
  }
 catch (  InterruptedException iex) {
    throw new IOException("Probe side reading was interrupted.");
  }
}
