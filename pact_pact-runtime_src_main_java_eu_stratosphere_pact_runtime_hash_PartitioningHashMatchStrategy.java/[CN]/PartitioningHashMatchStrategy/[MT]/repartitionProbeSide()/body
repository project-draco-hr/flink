{
  KeyValuePair<K,VP> pair;
  int partition;
  while (readerProbe.hasNext()) {
    pair=readerProbe.next();
    partition=partitioner.getPartition(pair.getKey());
    partitionWriters.get(partition).write(pair);
  }
}
