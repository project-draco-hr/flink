{
  for (int i=0; i < numberOfPartitions; i++) {
    Channel.ID channel=enumerator.next();
    partitionIDMap.add(channel);
    ArrayList<MemorySegment> channelSegments=new ArrayList<MemorySegment>(2);
    channelSegments.add(freeSegments.poll());
    channelSegments.add(freeSegments.poll());
    partitionWriters.add(ioManager.createChannelWriter(channel,channelSegments));
  }
}
