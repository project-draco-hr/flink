{
  String pathPrefix=getFilesystemProvider().getURIPrefix() + getFilesystemProvider().getTempDirPath();
  FileDataSource input=new FileDataSource(ContractITCaseInputFormat.class,pathPrefix + "/reduceInput");
  DelimitedInputFormat.configureDelimitedFormat(input).recordDelimiter('\n');
  input.setDegreeOfParallelism(config.getInteger("ReduceTest#NoSubtasks",1));
  ReduceContract testReducer=new ReduceContract.Builder(TestReducer.class,PactString.class,0).build();
  testReducer.setDegreeOfParallelism(config.getInteger("ReduceTest#NoSubtasks",1));
  testReducer.getParameters().setString(PactCompiler.HINT_LOCAL_STRATEGY,config.getString("ReduceTest#LocalStrategy",""));
  testReducer.getParameters().setString(PactCompiler.HINT_SHIP_STRATEGY,config.getString("ReduceTest#ShipStrategy",""));
  FileDataSink output=new FileDataSink(ContractITCaseOutputFormat.class,pathPrefix + "/result.txt");
  output.setDegreeOfParallelism(1);
  output.addInput(testReducer);
  testReducer.addInput(input);
  Plan plan=new Plan(output);
  PactCompiler pc=new PactCompiler();
  OptimizedPlan op=pc.compile(plan);
  NepheleJobGraphGenerator jgg=new NepheleJobGraphGenerator();
  return jgg.compileJobGraph(op);
}
