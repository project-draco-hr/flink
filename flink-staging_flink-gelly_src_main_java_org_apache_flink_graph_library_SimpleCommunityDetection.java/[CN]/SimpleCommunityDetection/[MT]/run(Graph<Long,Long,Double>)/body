{
  Graph<Long,Long,Double> undirectedGraph=graph.getUndirected();
  Graph<Long,Tuple2<Long,Double>,Double> graphWithScoredVertices=undirectedGraph.mapVertices(new AddScoreToVertexValuesMapper());
  VertexCentricIteration<Long,Tuple2<Long,Double>,Tuple2<Long,Double>,Double> iteration=graphWithScoredVertices.createVertexCentricIteration(new VertexLabelUpdater(delta),new LabelMessenger(),maxIterations);
  return graphWithScoredVertices.runVertexCentricIteration(iteration).mapVertices(new RemoveScoreFromVertexValuesMapper());
}
