{
  final int dop=args.length > 0 ? Integer.parseInt(args[0]) : 1;
  final String verticesPath=args.length > 1 ? args[1] : "file:///data/demodata/cc/vertices";
  final String edgesPath=args.length > 2 ? args[2] : "file:///data/demodata/cc/edges";
  final String resultPath=args.length > 3 ? args[3] : "file:///tmp";
  final int maxIterations=args.length > 4 ? Integer.parseInt(args[4]) : 10;
  FileDataSource initialVertices=new FileDataSource(DuplicateLongInputFormat.class,verticesPath,"Vertices");
  FileDataSource edges=new FileDataSource(LongLongInputFormat.class,edgesPath,"Edges");
  FileDataSink result=new FileDataSink(RecordOutputFormat.class,resultPath,"Result");
  RecordOutputFormat.configureRecordFormat(result).recordDelimiter('\n').fieldDelimiter(' ').field(PactLong.class,0).field(PactLong.class,1);
  VertexCentricIteration iteration=new VertexCentricIteration(new CCMessager(),new CCUpdater(),"Connected Components Iteration.");
  iteration.setVertexInput(initialVertices);
  iteration.setEdgesInput(edges);
  iteration.setNumberOfIterations(maxIterations);
  result.setInput(iteration.getOutput());
  Plan p=new Plan(result);
  p.setDefaultParallelism(dop);
  return p;
}
