{
  super(struct);
  replicaId=struct.getInt(REPLICA_ID_KEY_NAME);
  maxWait=struct.getInt(MAX_WAIT_KEY_NAME);
  minBytes=struct.getInt(MIN_BYTES_KEY_NAME);
  fetchData=new HashMap<TopicPartition,PartitionData>();
  for (  Object topicResponseObj : struct.getArray(TOPICS_KEY_NAME)) {
    Struct topicResponse=(Struct)topicResponseObj;
    String topic=topicResponse.getString(TOPIC_KEY_NAME);
    for (    Object partitionResponseObj : topicResponse.getArray(PARTITIONS_KEY_NAME)) {
      Struct partitionResponse=(Struct)partitionResponseObj;
      int partition=partitionResponse.getInt(PARTITION_KEY_NAME);
      long offset=partitionResponse.getLong(FETCH_OFFSET_KEY_NAME);
      int maxBytes=partitionResponse.getInt(MAX_BYTES_KEY_NAME);
      PartitionData partitionData=new PartitionData(offset,maxBytes);
      fetchData.put(new TopicPartition(topic,partition),partitionData);
    }
  }
}
