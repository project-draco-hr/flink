{
  int[] positions=fields.toArray();
  Class<? extends Key>[] keyTypes=PostPassUtils.getKeys(schema,positions);
  return new ArrayRecordComparatorFactory(positions,keyTypes,directions);
}
