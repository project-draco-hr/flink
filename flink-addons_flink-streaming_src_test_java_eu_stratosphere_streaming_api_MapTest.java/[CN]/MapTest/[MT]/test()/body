{
  Tuple1<String> tup=new Tuple1<String>("asd");
  StreamExecutionEnvironment env=new StreamExecutionEnvironment();
  DataStream<Tuple1<String>> dataStream=env.addDummySource().map(new MyMap(),PARALELISM).addDummySink();
  env.execute();
  JobGraphBuilder jgb=env.jobGB();
  for (  AbstractJobVertex c : jgb.components.values()) {
    if (c instanceof JobTaskVertex) {
      Configuration config=c.getConfiguration();
      System.out.println(config.getString("componentName","default"));
      byte[] bytes=config.getBytes("operator",null);
      ObjectInputStream in=new ObjectInputStream(new ByteArrayInputStream(bytes));
      MapFunction<Tuple,Tuple> f=(MapFunction<Tuple,Tuple>)in.readObject();
      StreamCollector<Tuple> s=new StreamCollector<Tuple>(1,1000,1,null);
      Tuple t=new Tuple1<String>("asd");
      s.collect(f.map(t));
      System.out.println(f.getClass().getGenericSuperclass());
      TupleTypeInfo<Tuple> ts=(TupleTypeInfo)TypeExtractor.createTypeInfo(MapFunction.class,f.getClass(),0,null,null);
      System.out.println(ts);
      byte[] userFunctionSerialized=config.getBytes("serializedudf",null);
      in=new ObjectInputStream(new ByteArrayInputStream(userFunctionSerialized));
      UserTaskInvokable userFunction=(UserTaskInvokable)in.readObject();
      System.out.println(userFunction.getClass());
      assertTrue(true);
      System.out.println("----------------");
    }
    if (c instanceof JobOutputVertex) {
      Configuration config=c.getConfiguration();
      System.out.println(config.getString("componentName","default"));
      byte[] bytes=config.getBytes("operator",null);
      ObjectInputStream in=new ObjectInputStream(new ByteArrayInputStream(bytes));
      SinkFunction<Tuple> f=(SinkFunction<Tuple>)in.readObject();
      System.out.println(f.getClass().getGenericSuperclass());
      TupleTypeInfo<Tuple> ts=(TupleTypeInfo)TypeExtractor.createTypeInfo(SinkFunction.class,f.getClass(),0,null,null);
      System.out.println(ts);
      byte[] userFunctionSerialized=config.getBytes("serializedudf",null);
      in=new ObjectInputStream(new ByteArrayInputStream(userFunctionSerialized));
      UserSinkInvokable userFunction=(UserSinkInvokable)in.readObject();
      System.out.println(userFunction.getClass());
      assertTrue(true);
      System.out.println("----------------");
    }
    if (c instanceof JobInputVertex) {
      Configuration config=c.getConfiguration();
      System.out.println(config.getString("componentName","default"));
      byte[] bytes=config.getBytes("operator",null);
      ObjectInputStream in=new ObjectInputStream(new ByteArrayInputStream(bytes));
      UserSourceInvokable<Tuple> f=(UserSourceInvokable<Tuple>)in.readObject();
      System.out.println(f.getClass().getGenericSuperclass());
      TupleTypeInfo<Tuple> ts=(TupleTypeInfo)TypeExtractor.createTypeInfo(UserSourceInvokable.class,f.getClass(),0,null,null);
      System.out.println(ts);
      System.out.println("----------------");
    }
  }
}
