{
  StreamWindow<Integer> window1=new StreamWindow<Integer>().setNumberOfParts(3);
  StreamWindow<Integer> window2=new StreamWindow<Integer>(window1.windowID,3);
  StreamWindow<Integer> window3=new StreamWindow<Integer>(window1.windowID,3);
  window1.add(1);
  window2.add(2);
  window3.add(3);
  Set<Integer> values=new HashSet<Integer>();
  values.add(1);
  values.add(2);
  values.add(3);
  StreamWindow<Integer> merged=StreamWindow.merge(window1,window2,window3);
  assertEquals(3,merged.size());
  assertEquals(window1.windowID,merged.windowID);
  assertEquals(values,new HashSet<Integer>(merged));
  try {
    StreamWindow.merge(window1,new StreamWindow<Integer>());
    fail();
  }
 catch (  RuntimeException e) {
  }
  List<StreamWindow<Integer>> wList=merged.split(3);
  StreamWindow<Integer> merged2=StreamWindow.merge(wList);
  assertEquals(3,merged2.size());
  assertEquals(window1.windowID,merged2.windowID);
  assertEquals(values,new HashSet<Integer>(merged2));
}
