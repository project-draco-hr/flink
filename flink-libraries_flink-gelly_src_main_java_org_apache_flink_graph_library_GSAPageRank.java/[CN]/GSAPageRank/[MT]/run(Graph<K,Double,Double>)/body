{
  if (numberOfVertices == 0) {
    numberOfVertices=network.numberOfVertices();
  }
  DataSet<Tuple2<K,Long>> vertexOutDegrees=network.outDegrees();
  Graph<K,Double,Double> networkWithWeights=network.joinWithEdgesOnSource(vertexOutDegrees,new InitWeights());
  return networkWithWeights.runGatherSumApplyIteration(new GatherRanks(numberOfVertices),new SumRanks(),new UpdateRanks<K>(beta,numberOfVertices),maxIterations).getVertices();
}
