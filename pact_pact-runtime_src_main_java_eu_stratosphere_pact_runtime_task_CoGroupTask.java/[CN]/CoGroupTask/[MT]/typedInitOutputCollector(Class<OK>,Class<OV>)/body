{
  List<RecordWriter<KeyValuePair<OK,OV>>> writers=new ArrayList<RecordWriter<KeyValuePair<OK,OV>>>();
  for (int i=0; i < this.config.getNumOutputs(); i++) {
    OutputEmitter<OK,OV> oe=new OutputEmitter<OK,OV>(this.config.getOutputShipStrategy(i));
    @SuppressWarnings("unchecked") Class<KeyValuePair<OK,OV>> pairClass=(Class<KeyValuePair<OK,OV>>)(Class<?>)KeyValuePair.class;
    RecordWriter<KeyValuePair<OK,OV>> writer=new RecordWriter<KeyValuePair<OK,OV>>(this,pairClass,oe);
    writers.add(writer);
  }
  this.output=new OutputCollector<OK,OV>(writers,(int)(Math.pow(2,writers.size()) - 1));
}
