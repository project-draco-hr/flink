{
  RecordDeserializer<KeyValuePair<K,V1>> deserializer1=new KeyValuePairDeserializer<K,V1>(ikClass,iv1Class);
  RecordDeserializer<KeyValuePair<K,V2>> deserializer2=new KeyValuePairDeserializer<K,V2>(ikClass,iv2Class);
  DistributionPattern dp1=null;
switch (config.getInputShipStrategy(0)) {
case FORWARD:
    dp1=new PointwiseDistributionPattern();
  break;
case PARTITION_HASH:
dp1=new BipartiteDistributionPattern();
break;
default :
throw new RuntimeException("No input ship strategy provided for second input of CoGroupTask.");
}
DistributionPattern dp2=null;
switch (config.getInputShipStrategy(1)) {
case FORWARD:
dp2=new PointwiseDistributionPattern();
break;
case PARTITION_HASH:
dp2=new BipartiteDistributionPattern();
break;
default :
throw new RuntimeException("No input ship strategy provided for second input of CoGroupTask.");
}
reader1=new RecordReader<KeyValuePair<K,V1>>(this,deserializer1,dp1);
reader2=new RecordReader<KeyValuePair<K,V2>>(this,deserializer2,dp2);
}
