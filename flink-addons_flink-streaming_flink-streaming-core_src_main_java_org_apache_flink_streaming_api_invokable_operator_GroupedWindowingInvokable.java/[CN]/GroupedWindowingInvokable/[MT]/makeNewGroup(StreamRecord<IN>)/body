{
  LinkedList<TriggerPolicy<IN>> clonedDistributedTriggerPolicies=new LinkedList<TriggerPolicy<IN>>();
  LinkedList<EvictionPolicy<IN>> clonedDistributedEvictionPolicies=new LinkedList<EvictionPolicy<IN>>();
  for (  CloneableTriggerPolicy<IN> trigger : this.distributedTriggerPolicies) {
    clonedDistributedTriggerPolicies.add(trigger.clone());
  }
  for (  CloneableEvictionPolicy<IN> eviction : this.distributedEvictionPolicies) {
    clonedDistributedEvictionPolicies.add(eviction.clone());
  }
  WindowingInvokable<IN,OUT> groupInvokable;
  if (userFunction instanceof ReduceFunction) {
    groupInvokable=(WindowingInvokable<IN,OUT>)new WindowingReduceInvokable<IN>((ReduceFunction<IN>)userFunction,clonedDistributedTriggerPolicies,clonedDistributedEvictionPolicies);
  }
 else {
    groupInvokable=new WindowingGroupInvokable<IN,OUT>((GroupReduceFunction<IN,OUT>)userFunction,clonedDistributedTriggerPolicies,clonedDistributedEvictionPolicies);
  }
  groupInvokable.initialize(collector,recordIterator,inSerializer,isMutable);
  groupInvokable.open(this.parameters);
  windowingGroups.put(keySelector.getKey(element.getObject()),groupInvokable);
  return groupInvokable;
}
