{
  if (!isClosed) {
    jobManager.shutdown();
    nmClient.close();
    rmClient.close();
    if (!isFailed) {
      amRpcServer.stop();
    }
 else {
      LOG.warn("Can not close AM RPC connection since the AM is in failed state");
    }
  }
 else {
    LOG.warn("The AM has already been closed before");
  }
  this.isClosed=true;
  System.exit(0);
}
