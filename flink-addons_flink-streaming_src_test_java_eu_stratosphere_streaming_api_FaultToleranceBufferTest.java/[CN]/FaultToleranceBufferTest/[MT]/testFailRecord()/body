{
  StreamRecord record1=(new StreamRecord(1)).setId("1");
  record1.addRecord(new StringValue("V1"));
  faultTolerancyBuffer.addRecord(record1);
  Long record1TS=faultTolerancyBuffer.getRecordTimestamps().get(record1.getId());
  assertTrue(faultTolerancyBuffer.getRecordBuffer().containsKey(record1.getId()));
  assertTrue(faultTolerancyBuffer.getAckCounter().containsKey(record1.getId()));
  assertTrue(faultTolerancyBuffer.getRecordTimestamps().containsKey(record1.getId()));
  assertTrue(faultTolerancyBuffer.getRecordsByTime().get(record1TS).contains(record1.getId()));
  String prevID=record1.getId();
  faultTolerancyBuffer.failRecord(record1.getId());
  Long record2TS=faultTolerancyBuffer.getRecordTimestamps().get(record1.getId());
  assertFalse(faultTolerancyBuffer.getRecordBuffer().containsKey(prevID));
  assertFalse(faultTolerancyBuffer.getAckCounter().containsKey(prevID));
  assertFalse(faultTolerancyBuffer.getRecordTimestamps().containsKey(prevID));
  assertFalse(faultTolerancyBuffer.getRecordsByTime().get(record1TS).contains(prevID));
  faultTolerancyBuffer.ackRecord(prevID);
  faultTolerancyBuffer.ackRecord(prevID);
  faultTolerancyBuffer.ackRecord(prevID);
  assertTrue(faultTolerancyBuffer.getRecordBuffer().containsKey(record1.getId()));
  assertTrue(faultTolerancyBuffer.getAckCounter().containsKey(record1.getId()));
  assertTrue(faultTolerancyBuffer.getRecordTimestamps().containsKey(record1.getId()));
  assertTrue(faultTolerancyBuffer.getRecordsByTime().get(record2TS).contains(record1.getId()));
  System.out.println("---------");
}
