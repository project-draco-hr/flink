{
  final CsvReader reader=new CsvReader(new ByteArrayInputStream(record),this.charSet);
  reader.setDelimiter(this.fieldDelimiter);
  try {
    if (reader.readRecord()) {
      final ObjectNode node=new ObjectNode();
      if (this.keyNames != null)       for (int i=0; i < this.keyNames.length; i++)       node.put(this.keyNames[i],TextNode.valueOf(reader.get(i)));
 else       for (int i=0; i < reader.getColumnCount(); i++)       node.put(String.format("key%d",i + 1),TextNode.valueOf(reader.get(i)));
      pair.setKey(SopremoUtil.wrap(pair.getKey()));
      pair.setValue(SopremoUtil.wrap(node));
      return true;
    }
  }
 catch (  final IOException e) {
    SopremoUtil.LOG.warn("Parsing CSV record",e);
  }
  return false;
}
