{
  int depth=0;
  int nextStartPos=0;
  final int length=key.length();
  while (nextStartPos < length) {
    final int sepPos=key.indexOf(S3_DIRECTORY_SEPARATOR,nextStartPos);
    if (sepPos < 0) {
      break;
    }
 else {
      ++depth;
      nextStartPos=sepPos + 1;
    }
  }
  if (length > 0) {
    if (key.charAt(length - 1) == S3_DIRECTORY_SEPARATOR) {
      --depth;
    }
  }
  return depth;
}
