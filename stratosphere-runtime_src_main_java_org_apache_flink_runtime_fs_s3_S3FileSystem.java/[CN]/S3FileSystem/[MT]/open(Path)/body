{
  final FileStatus fileStatus=getFileStatus(f);
  if (fileStatus.isDir()) {
    throw new IOException("Cannot open " + f.toUri() + " because it is a directory");
  }
  final S3BucketObjectPair bop=this.directoryStructure.toBucketObjectPair(f);
  if (!bop.hasBucket() || !bop.hasObject()) {
    throw new IOException(f.toUri() + " cannot be opened");
  }
  return new S3DataInputStream(this.s3Client,bop.getBucket(),bop.getObject());
}
