{
  long completeMemorySize=getTaskConfig().getMemorySize();
  long backChannelMemorySize=(long)(completeMemorySize * 0.8);
  getTaskConfig().setMemorySize(completeMemorySize - backChannelMemorySize);
  List<MemorySegment> segments=Lists.newArrayList();
  int segmentSize=getMemoryManager().getPageSize();
  getMemoryManager().allocatePages(this,segments,backChannelMemorySize);
  BlockingBackChannel backChannel=new BlockingBackChannel(new SerializedUpdateBuffer(segments,segmentSize,getIOManager()));
  Broker<BlockingBackChannel> broker=BlockingBackChannelBroker.instance();
  broker.handIn(identifier(),backChannel);
  return backChannel;
}
