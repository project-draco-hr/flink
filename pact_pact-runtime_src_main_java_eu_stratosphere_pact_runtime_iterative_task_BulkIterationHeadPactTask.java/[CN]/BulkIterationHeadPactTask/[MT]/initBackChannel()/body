{
  TaskConfig taskConfig=getTaskConfig();
  long completeMemorySize=taskConfig.getMemorySize();
  long backChannelMemorySize=(long)(completeMemorySize * taskConfig.getBackChannelMemoryFraction());
  taskConfig.setMemorySize(completeMemorySize - backChannelMemorySize);
  List<MemorySegment> segments=Lists.newArrayList();
  int segmentSize=getMemoryManager().getPageSize();
  getMemoryManager().allocatePages(this,segments,backChannelMemorySize);
  BlockingBackChannel backChannel=new BlockingBackChannel(new SerializedUpdateBuffer(segments,segmentSize,getIOManager()));
  Broker<BlockingBackChannel> broker=BlockingBackChannelBroker.instance();
  broker.handIn(brokerKey(),backChannel);
  return backChannel;
}
