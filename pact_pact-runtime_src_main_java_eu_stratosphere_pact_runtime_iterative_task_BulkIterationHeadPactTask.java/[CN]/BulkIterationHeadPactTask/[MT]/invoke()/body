{
  BlockingBackChannel backChannel=initBackChannel();
  SuperstepBarrier barrier=initSuperstepBarrier();
  TypeSerializer serializer=getInputSerializer(getIterationInputIndex());
  output=(Collector<OT>)iterationCollector();
  while (!terminationRequested()) {
    if (log.isInfoEnabled()) {
      log.info(formatLogString("starting iteration [" + currentIteration() + "]"));
    }
    if (!inFirstIteration()) {
      reinstantiateDriver();
    }
    barrier.setup();
    super.invoke();
    EndOfSuperstepEvent endOfSuperstepEvent=new EndOfSuperstepEvent();
    sendEventToAllIterationOutputs(endOfSuperstepEvent);
    DataInputView superStepResult=backChannel.getReadEndAfterSuperstepEnded();
    if (log.isInfoEnabled()) {
      log.info(formatLogString("finishing iteration [" + currentIteration() + "]"));
    }
    sendEventToSync(endOfSuperstepEvent);
    if (log.isInfoEnabled()) {
      log.info(formatLogString("waiting for other workers in iteration [" + currentIteration() + "]"));
    }
    barrier.waitForOtherWorkers();
    if (barrier.terminationSignaled()) {
      if (log.isInfoEnabled()) {
        log.info(formatLogString("head received termination request in iteration [" + currentIteration() + "]"));
      }
      requestTermination();
      sendEventToAllIterationOutputs(new TerminationEvent());
    }
 else {
      feedBackSuperstepResult(superStepResult,serializer);
      incrementIterationCounter();
    }
  }
  if (log.isInfoEnabled()) {
    log.info(formatLogString("streaming out final result after [" + currentIteration() + "] iterations"));
  }
  streamOutFinalOutput();
}
