{
  ReduceContract.Builder builder=ReduceContract.builder(isCombinable() ? CombinableImplementation.class : Implementation.class);
  if (!getKeyExpressions(0).contains(GROUP_ALL)) {
    int[] keyIndices=this.getKeyIndices(globalSchema,this.getKeyExpressions(0));
    PactBuilderUtil.addKeys(builder,this.getKeyClasses(globalSchema,keyIndices),keyIndices);
  }
  builder.name(this.toString());
  return builder.build();
}
