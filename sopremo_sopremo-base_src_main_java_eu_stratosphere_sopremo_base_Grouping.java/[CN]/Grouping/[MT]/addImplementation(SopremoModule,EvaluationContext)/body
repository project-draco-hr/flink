{
  Operator<?> output;
switch (this.getNumInputs()) {
case 0:
    throw new IllegalStateException("No input given for grouping");
case 1:
  output=new GroupProjection(this.resultProjection.remove(InputSelection.class)).withKeyExpression(0,this.getGroupingKey(0)).withInputs(module.getInputs());
break;
case 2:
output=new CoGroupProjection(this.resultProjection).withKeyExpression(0,this.getGroupingKey(0)).withKeyExpression(1,this.getGroupingKey(1)).withInputs(module.getInputs());
break;
default :
throw new IllegalStateException("More than two sources are not supported");
}
module.getOutput(0).setInput(0,output);
}
