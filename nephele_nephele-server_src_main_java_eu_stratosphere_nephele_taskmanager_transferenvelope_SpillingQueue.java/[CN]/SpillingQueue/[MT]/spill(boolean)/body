{
  SpillingQueueElement elem=this.head;
  if (!includeHead) {
    if (elem == null) {
      return 0L;
    }
    elem=elem.getNextElement();
  }
  int reclaimedMemory=0;
  while (elem != null) {
    reclaimedMemory+=elem.spill(this.ownerID,this.fileBufferManager);
    elem=elem.getNextElement();
  }
  this.sizeOfMemoryBuffers.addAndGet(-reclaimedMemory);
  return reclaimedMemory;
}
