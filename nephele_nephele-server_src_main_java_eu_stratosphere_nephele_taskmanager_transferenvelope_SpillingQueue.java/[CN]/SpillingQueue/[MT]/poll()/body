{
  if (isEmpty()) {
    return null;
  }
  TransferEnvelope te=this.head.poll();
  if (this.head.size() == 0) {
    this.head=this.head.getNextElement();
  }
  if (this.head == null) {
    this.tail=null;
  }
  final Buffer buffer=te.getBuffer();
  if (buffer != null) {
    if (buffer.isBackedByMemory()) {
      this.sizeOfMemoryBuffers-=buffer.size();
    }
  }
  if (this.peekCache != null) {
    te=this.peekCache;
    this.peekCache=null;
  }
  --this.size;
  return te;
}
