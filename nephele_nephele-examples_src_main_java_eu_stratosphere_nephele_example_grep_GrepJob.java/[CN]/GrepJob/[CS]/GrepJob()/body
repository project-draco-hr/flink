{
  jobGraph=new JobGraph("Grep Example Job");
  JobFileInputVertex input=new JobFileInputVertex("Input 1",jobGraph);
  input.setFileInputClass(FileLineReader.class);
  input.setFilePath(new Path("hdfs://localhost:8000/user/wenjun/input1"));
  JobTaskVertex task1=new JobTaskVertex("Task 1",jobGraph);
  task1.setTaskClass(GrepTask.class);
  JobTaskVertex task2=new JobTaskVertex("Task 2",jobGraph);
  task2.setTaskClass(GrepTask.class);
  JobFileOutputVertex output=new JobFileOutputVertex("Output 1",jobGraph);
  output.setFileOutputClass(FileLineWriter.class);
  output.setFilePath(new Path("hdfs://localhost:8000/user/wenjun/output1"));
  task1.setNumberOfSubtasks(2);
  try {
    input.connectTo(task1,ChannelType.INMEMORY,CompressionLevel.NO_COMPRESSION);
    task1.connectTo(task2,ChannelType.INMEMORY,CompressionLevel.NO_COMPRESSION);
    task2.connectTo(output,ChannelType.INMEMORY,CompressionLevel.NO_COMPRESSION);
  }
 catch (  JobGraphDefinitionException e) {
    e.printStackTrace();
  }
}
