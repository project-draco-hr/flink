{
  final long numSamples=args.length > 0 ? Long.parseLong(args[0]) : 1000000;
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<Long> count=env.generateSequence(1,numSamples).map(new Sampler()).reduce(new SumReducer());
  DataSet<Double> pi=count.map(new MapFunction<Long,Double>(){
    public Double map(    Long value){
      return value * 4.0 / numSamples;
    }
  }
);
  System.out.println("We estimate Pi to be:");
  pi.print();
}
