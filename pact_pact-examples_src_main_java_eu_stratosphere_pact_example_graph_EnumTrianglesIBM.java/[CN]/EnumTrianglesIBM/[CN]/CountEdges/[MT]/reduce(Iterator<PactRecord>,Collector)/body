{
  int key=-1;
  this.len=0;
  while (records.hasNext()) {
    final PactRecord rec=records.next();
    final int id=rec.getField(1,PactInteger.class).getValue();
    if (key == -1) {
      key=rec.getField(0,PactInteger.class).getValue();
    }
    if (this.len >= this.vals.length) {
      int[] na=new int[this.vals.length * 2];
      System.arraycopy(this.vals,0,na,0,this.vals.length);
      this.vals=na;
    }
    this.vals[this.len++]=id;
  }
  for (int i=0; i < this.len; i++) {
    final int e2=this.vals[i];
    if (key <= e2) {
      firstVertex.setValue(key);
      secondVertex.setValue(e2);
      firstCount.setValue(len);
      secondCount.setValue(0);
    }
 else {
      firstVertex.setValue(e2);
      secondVertex.setValue(key);
      firstCount.setValue(0);
      secondCount.setValue(len);
    }
    this.result.setField(0,firstVertex);
    this.result.setField(1,secondVertex);
    this.result.setField(2,firstCount);
    this.result.setField(3,secondCount);
    out.collect(result);
  }
}
