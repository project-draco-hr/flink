{
  OutputEmitter<PactInteger,PactInteger> oe=new OutputEmitter<PactInteger,PactInteger>(ShipStrategy.PARTITION_HASH);
  int[] hit=new int[100];
  for (int i=0; i < 1000000; i++) {
    PactInteger k=new PactInteger(i);
    hit[oe.selectChannels(new KeyValuePair<PactInteger,PactInteger>(k,k),hit.length)[0]]++;
  }
  for (int i=0; i < hit.length; i++) {
    assertTrue(hit[i] > 0);
  }
  OutputEmitter<PactString,PactString> oes=new OutputEmitter<PactString,PactString>(ShipStrategy.PARTITION_HASH);
  hit=new int[10];
  for (int i=0; i < 1000; i++) {
    PactString k=new PactString(i + "");
    hit[oes.selectChannels(new KeyValuePair<PactString,PactString>(k,k),hit.length)[0]]++;
  }
  for (int i=0; i < hit.length; i++) {
    assertTrue(hit[i] > 0);
  }
}
