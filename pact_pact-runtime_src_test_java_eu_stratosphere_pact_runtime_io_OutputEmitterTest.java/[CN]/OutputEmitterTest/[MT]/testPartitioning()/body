{
  @SuppressWarnings("unchecked") OutputEmitter oe1=new OutputEmitter(ShipStrategy.PARTITION_HASH,new int[]{0},new Class[]{PactInteger.class});
  int[] hit=new int[100];
  for (int i=0; i < 1000000; i++) {
    PactInteger k=new PactInteger(i);
    PactRecord rec=new PactRecord(k);
    hit[oe1.selectChannels(rec,hit.length)[0]]++;
  }
  for (int i=0; i < hit.length; i++) {
    assertTrue(hit[i] > 0);
  }
  @SuppressWarnings("unchecked") OutputEmitter oe2=new OutputEmitter(ShipStrategy.PARTITION_HASH,new int[]{0},new Class[]{PactInteger.class});
  hit=new int[10];
  for (int i=0; i < 1000; i++) {
    PactString k=new PactString(i + "");
    PactRecord rec=new PactRecord(k);
    hit[oe2.selectChannels(rec,hit.length)[0]]++;
  }
  for (int i=0; i < hit.length; i++) {
    assertTrue(hit[i] > 0);
  }
}
