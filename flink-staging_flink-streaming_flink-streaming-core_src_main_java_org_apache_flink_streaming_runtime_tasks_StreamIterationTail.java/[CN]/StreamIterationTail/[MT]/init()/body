{
  super.init();
  final String iterationId=configuration.getIterationId();
  if (iterationId == null || iterationId.length() == 0) {
    throw new Exception("Missing iteration ID in the task configuration");
  }
  final String brokerID=StreamIterationHead.createBrokerIdString(getEnvironment().getJobID(),iterationId,getEnvironment().getIndexInSubtaskGroup());
  final long iterationWaitTime=configuration.getIterationWaitTime();
  LOG.info("Iteration tail {} trying to acquire feedback queue under {}",getName(),brokerID);
  @SuppressWarnings("unchecked") BlockingQueue<StreamRecord<IN>> dataChannel=(BlockingQueue<StreamRecord<IN>>)BlockingQueueBroker.INSTANCE.get(brokerID);
  LOG.info("Iteration tail {} acquired feedback queue {}",getName(),brokerID);
  this.streamOperator=new RecordPusher<>(dataChannel,iterationWaitTime);
}
