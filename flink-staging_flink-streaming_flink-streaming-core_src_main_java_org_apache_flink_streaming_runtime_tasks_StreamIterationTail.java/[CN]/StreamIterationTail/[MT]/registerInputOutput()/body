{
  super.registerInputOutput();
  try {
    iterationId=configuration.getIterationId();
    iterationWaitTime=configuration.getIterationWaitTime();
    shouldWait=iterationWaitTime > 0;
    dataChannel=BlockingQueueBroker.instance().get(iterationId + "-" + getEnvironment().getIndexInSubtaskGroup());
  }
 catch (  Exception e) {
    throw new StreamTaskException(String.format("Cannot register inputs of StreamIterationSink %s",iterationId),e);
  }
  this.streamOperator=new RecordPusher();
}
