{
switch (progId) {
case 1:
{
      final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
      env.getConfig().enableObjectReuse();
      DataSet<Tuple2<String,Integer>> input=env.fromElements(new Tuple2<String,Integer>("a",1),new Tuple2<String,Integer>("a",2),new Tuple2<String,Integer>("a",3),new Tuple2<String,Integer>("a",4),new Tuple2<String,Integer>("a",50));
      DataSet<Tuple2<String,Integer>> result=input.groupBy(0).reduce(new ReduceFunction<Tuple2<String,Integer>>(){
        @Override public Tuple2<String,Integer> reduce(        Tuple2<String,Integer> value1,        Tuple2<String,Integer> value2) throws Exception {
          value2.f1+=value1.f1;
          return value2;
        }
      }
);
      result.writeAsCsv(resultPath);
      env.execute();
      return "a,100\n";
    }
case 2:
{
    final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
    env.getConfig().enableObjectReuse();
    DataSet<Tuple2<String,Integer>> input=env.fromElements(new Tuple2<String,Integer>("a",1),new Tuple2<String,Integer>("a",2),new Tuple2<String,Integer>("a",3),new Tuple2<String,Integer>("a",4),new Tuple2<String,Integer>("a",50));
    DataSet<Tuple2<String,Integer>> result=input.reduce(new ReduceFunction<Tuple2<String,Integer>>(){
      @Override public Tuple2<String,Integer> reduce(      Tuple2<String,Integer> value1,      Tuple2<String,Integer> value2) throws Exception {
        value2.f1+=value1.f1;
        return value2;
      }
    }
);
    result.writeAsCsv(resultPath);
    env.execute();
    return "a,100\n";
  }
case 3:
{
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  env.getConfig().enableObjectReuse();
  DataSet<Tuple2<String,Integer>> input=env.fromElements(new Tuple2<String,Integer>("a",1),new Tuple2<String,Integer>("a",2),new Tuple2<String,Integer>("a",3),new Tuple2<String,Integer>("a",4),new Tuple2<String,Integer>("a",5));
  DataSet<Tuple2<String,Integer>> result=input.reduceGroup(new GroupReduceFunction<Tuple2<String,Integer>,Tuple2<String,Integer>>(){
    @Override public void reduce(    Iterable<Tuple2<String,Integer>> values,    Collector<Tuple2<String,Integer>> out) throws Exception {
      List<Tuple2<String,Integer>> list=new ArrayList<Tuple2<String,Integer>>();
      for (      Tuple2<String,Integer> val : values) {
        list.add(val);
      }
      for (      Tuple2<String,Integer> val : list) {
        out.collect(val);
      }
    }
  }
);
  result.writeAsCsv(resultPath);
  env.execute();
  return "a,4\n" + "a,4\n" + "a,5\n"+ "a,5\n"+ "a,5\n";
}
case 4:
{
final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
env.getConfig().enableObjectReuse();
DataSet<Tuple2<String,Integer>> input=env.fromElements(new Tuple2<String,Integer>("a",1),new Tuple2<String,Integer>("a",2),new Tuple2<String,Integer>("a",3),new Tuple2<String,Integer>("a",4),new Tuple2<String,Integer>("a",5));
DataSet<Tuple2<String,Integer>> result=input.reduceGroup(new GroupReduceFunction<Tuple2<String,Integer>,Tuple2<String,Integer>>(){
  @Override public void reduce(  Iterable<Tuple2<String,Integer>> values,  Collector<Tuple2<String,Integer>> out) throws Exception {
    List<Tuple2<String,Integer>> list=new ArrayList<Tuple2<String,Integer>>();
    for (    Tuple2<String,Integer> val : values) {
      list.add(val);
    }
    for (    Tuple2<String,Integer> val : list) {
      out.collect(val);
    }
  }
}
);
result.writeAsCsv(resultPath);
env.execute();
return "a,4\n" + "a,4\n" + "a,5\n"+ "a,5\n"+ "a,5\n";
}
default :
throw new IllegalArgumentException("Invalid program id");
}
}
