{
  if (this.isDistributedFS()) {
    return false;
  }
  if (this.exists(outPath)) {
switch (writeMode) {
case CREATE:
      if (this.getFileStatus(outPath).isDir()) {
        return true;
      }
 else {
        throw new IOException("Existing file or directory on output path may not be overwritten in CREATE write mode.");
      }
case OVERWRITE:
    if (this.getFileStatus(outPath).isDir()) {
      if (createDirectory) {
        return true;
      }
 else {
        try {
          this.delete(outPath,true);
        }
 catch (        IOException ioe) {
          throw new IOException("Could not prepare output path. ",ioe);
        }
      }
    }
 else {
      try {
        this.delete(outPath,false);
      }
 catch (      IOException ioe) {
      }
    }
  break;
default :
throw new IllegalArgumentException("Invalid write mode: " + writeMode);
}
}
if (createDirectory) {
try {
if (!this.exists(outPath)) {
this.mkdirs(outPath);
}
}
 catch (IOException ioe) {
}
return this.exists(outPath) && this.getFileStatus(outPath).isDir();
}
 else {
return !this.exists(outPath);
}
}
