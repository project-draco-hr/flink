{
  try {
    Path outputPath=getFileOutputPath();
    FileSystem fs=FileSystem.get(outputPath.toUri());
    if (fs.exists(outputPath)) {
      FileStatus status=fs.getFileStatus(outputPath);
      if (status.isDir()) {
        outputPath=new Path(outputPath.toUri().toString() + "/file_" + getIndexInSubtaskGroup()+ ".txt");
      }
    }
    FSDataOutputStream outputStream=fs.create(outputPath,true);
    int i=0;
    while (input.hasNext()) {
      try {
        StringRecord record=input.next();
        i++;
        byte[] recordByte=(record.toString() + "\r\n").getBytes();
        outputStream.write(recordByte,0,recordByte.length);
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
    }
    System.out.println("WRITER: Wrote " + i + "records ");
    outputStream.close();
  }
 catch (  IOException ioe) {
    throw new ExecutionFailureException(StringUtils.stringifyException(ioe));
  }
}
