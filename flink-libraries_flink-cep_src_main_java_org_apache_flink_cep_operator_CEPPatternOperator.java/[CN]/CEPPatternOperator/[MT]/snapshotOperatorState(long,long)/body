{
  StreamTaskState taskState=super.snapshotOperatorState(checkpointId,timestamp);
  final StateBackend.CheckpointStateOutputStream os=this.getStateBackend().createCheckpointStateOutputStream(checkpointId,timestamp);
  final ObjectOutputStream oos=new ObjectOutputStream(os);
  final StateBackend.CheckpointStateOutputView ov=new StateBackend.CheckpointStateOutputView(os);
  oos.writeObject(nfa);
  ov.writeInt(priorityQueue.size());
  for (  StreamRecord<IN> streamRecord : priorityQueue) {
    streamRecordSerializer.serialize(streamRecord,ov);
  }
  taskState.setOperatorState(os.closeAndGetHandle());
  return taskState;
}
