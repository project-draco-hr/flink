{
  if (batchSize < 1) {
    throw new IllegalArgumentException("Batch size must be positive");
  }
  if (slideSize < 1) {
    throw new IllegalArgumentException("Slide size must be positive");
  }
  FunctionTypeWrapper<OUT> inTypeWrapper=new FunctionTypeWrapper<OUT>(reducer,GroupReduceFunction.class,0);
  FunctionTypeWrapper<R> outTypeWrapper=new FunctionTypeWrapper<R>(reducer,GroupReduceFunction.class,1);
  return addFunction("batchReduce",reducer,inTypeWrapper,outTypeWrapper,new BatchGroupReduceInvokable<OUT,R>(reducer,batchSize,slideSize));
}
