{
  DataStreamSink<OUT> returnStream=new DataStreamSink<OUT>(environment,"sink",typeInfo);
  try {
    jobGraphBuilder.addStreamVertex(returnStream.getId(),new SinkInvokable<OUT>(clean(sinkFunction)),inTypeInfo,null,"sink",SerializationUtils.serialize(clean(sinkFunction)),degreeOfParallelism);
  }
 catch (  SerializationException e) {
    throw new RuntimeException("Cannot serialize SinkFunction");
  }
  inputStream.connectGraph(inputStream.copy(),returnStream.getId(),0);
  return returnStream;
}
