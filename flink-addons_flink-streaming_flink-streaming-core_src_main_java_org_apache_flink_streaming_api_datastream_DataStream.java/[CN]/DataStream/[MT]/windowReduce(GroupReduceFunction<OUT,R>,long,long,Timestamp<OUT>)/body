{
  if (windowSize < 1) {
    throw new IllegalArgumentException("Window size must be positive");
  }
  if (slideInterval < 1) {
    throw new IllegalArgumentException("Slide interval must be positive");
  }
  FunctionTypeWrapper<OUT> inTypeWrapper=new FunctionTypeWrapper<OUT>(reducer,GroupReduceFunction.class,0);
  FunctionTypeWrapper<R> outTypeWrapper=new FunctionTypeWrapper<R>(reducer,GroupReduceFunction.class,1);
  return addFunction("batchReduce",reducer,inTypeWrapper,outTypeWrapper,new WindowGroupReduceInvokable<OUT,R>(reducer,windowSize,slideInterval,timestamp));
}
