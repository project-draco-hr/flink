{
  DataStream<OUT> returnStream=new DataStreamSink<OUT>(environment,"sink");
  try {
    jobGraphBuilder.addSink(returnStream.getId(),new SinkInvokable<OUT>(sinkFunction),typeWrapper,"sink",SerializationUtils.serialize(sinkFunction),degreeOfParallelism);
  }
 catch (  SerializationException e) {
    throw new RuntimeException("Cannot serialize SinkFunction");
  }
  inputStream.connectGraph(inputStream,returnStream.getId(),0);
  if (this.copy().userDefinedName != null) {
    returnStream.name(getUserDefinedNames());
  }
  return returnStream;
}
