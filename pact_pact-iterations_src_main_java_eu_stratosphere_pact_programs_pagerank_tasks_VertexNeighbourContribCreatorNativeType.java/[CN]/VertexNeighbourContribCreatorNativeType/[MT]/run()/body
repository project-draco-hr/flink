{
  VertexNeighbourPartial result=new VertexNeighbourPartial();
  PactRecord rec=new PactRecord();
  while (inputs[0].next(rec)) {
    long vid=rec.getField(0,number).getValue();
    adjList=rec.getField(1,adjList);
    long[] neighbours=adjList.getList();
    int numNeighbours=adjList.getLength();
    result.setVid(vid);
    result.setNid(vid);
    result.setPartial(0);
    output.collect(result);
    double contrib=1.0 / numNeighbours;
    for (int i=0; i < numNeighbours; i++) {
      result.setNid(neighbours[i]);
      result.setPartial(contrib);
      output.collect(result);
    }
  }
}
