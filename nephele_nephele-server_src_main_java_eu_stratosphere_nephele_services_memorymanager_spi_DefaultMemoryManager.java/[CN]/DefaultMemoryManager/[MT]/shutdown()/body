{
synchronized (this.lock) {
    if (!isShutDown) {
      LOG.debug("Shutting down MemoryManager instance " + toString());
      isShutDown=true;
      memory=null;
      chunkSize=0;
      freeSegments.clear();
      for (      ArrayList<DefaultMemorySegment> segments : allocatedSegments.values()) {
        for (        DefaultMemorySegment seg : segments) {
          seg.clearMemoryReferences();
        }
      }
    }
  }
}
