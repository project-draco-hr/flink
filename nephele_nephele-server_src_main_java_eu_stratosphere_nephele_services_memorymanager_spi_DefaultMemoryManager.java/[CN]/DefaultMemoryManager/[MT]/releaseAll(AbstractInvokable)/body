{
synchronized (this.lock) {
    if (isShutDown) {
      throw new IllegalStateException("Memory manager has been shut down.");
    }
    final ArrayList<DefaultMemorySegment> segments=this.allocatedSegments.remove(owner);
    if (segments == null || segments.isEmpty()) {
      return;
    }
    for (int i=0; i < segments.size(); i++) {
      internalRelease(segments.get(i));
    }
    segments.clear();
  }
}
