{
  final SopremoPlan actualPlan=this.parseScript("testudf = javaudf('eu.stratosphere.simple.jaql.expression.FunctionTest.udfTest');\n" + "$input = read 'input.json';\n" + "$result = project $input into { squared: testudf($input) };\n"+ "write $result to 'output.json'; ");
  final SopremoPlan expectedPlan=new SopremoPlan();
  final Source input=new Source("input.json");
  final Projection projection=new Projection().withInputs(input).withValueTransformation(new ObjectCreation(new ObjectCreation.FieldAssignment("squared",new MethodCall("testudf",new InputSelection(0)))));
  final Sink sink=new Sink("output.json").withInputs(projection);
  expectedPlan.setSinks(sink);
  Assert.assertEquals("unexpectedPlan",expectedPlan,actualPlan);
}
