{
  if (message instanceof TaskManagerMessages.SubmitTask) {
    TaskDeploymentDescriptor tdd=((TaskManagerMessages.SubmitTask)message).tasks();
    getSender().tell(new TaskOperationResult(tdd.getExecutionId(),true),getSelf());
  }
 else   if (message instanceof TaskManagerMessages.CancelTask) {
    index++;
    if (index >= results.length) {
      getSender().tell(new Status.Failure(new IOException("RPC call failed.")),getSelf());
    }
 else {
      getSender().tell(results[index],getSelf());
    }
  }
 else   if (message instanceof TaskManagerMessages.RequestLibraryCacheProfile) {
    TaskManagerMessages.RequestLibraryCacheProfile request=(TaskManagerMessages.RequestLibraryCacheProfile)message;
    LibraryCacheProfileResponse response=new LibraryCacheProfileResponse(request.request());
    for (int i=0; i < request.request().getRequiredLibraries().length; i++) {
      response.setCached(i,true);
    }
    getSender().tell(response,getSelf());
  }
}
