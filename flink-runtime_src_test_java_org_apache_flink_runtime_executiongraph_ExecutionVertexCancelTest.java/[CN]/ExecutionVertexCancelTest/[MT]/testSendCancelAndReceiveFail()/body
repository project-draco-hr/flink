{
  new JavaTestKit(system){
{
      try {
        final JobVertexID jid=new JobVertexID();
        final ExecutionJobVertex ejv=getExecutionVertex(jid);
        final ExecutionVertex vertex=new ExecutionVertex(ejv,0,new IntermediateResult[0]);
        final ExecutionAttemptID execId=vertex.getCurrentExecutionAttempt().getAttemptId();
        final ActorRef taskManager=system.actorOf(Props.create(new CancelSequenceTaskManagerCreator()));
        Instance instance=getInstance(taskManager);
        AllocatedSlot slot=instance.allocateSlot(new JobID());
        setVertexState(vertex,ExecutionState.RUNNING);
        setVertexResource(vertex,slot);
        assertEquals(ExecutionState.RUNNING,vertex.getExecutionState());
        vertex.cancel();
        assertEquals(ExecutionState.CANCELING,vertex.getExecutionState());
        vertex.getCurrentExecutionAttempt().markFailed(new Throwable("test"));
        assertTrue(vertex.getExecutionState() == ExecutionState.CANCELED || vertex.getExecutionState() == ExecutionState.FAILED);
        assertTrue(slot.isReleased());
        assertEquals(0,vertex.getExecutionGraph().getRegisteredExecutions().size());
      }
 catch (      Exception e) {
        e.printStackTrace();
        fail(e.getMessage());
      }
    }
  }
;
}
