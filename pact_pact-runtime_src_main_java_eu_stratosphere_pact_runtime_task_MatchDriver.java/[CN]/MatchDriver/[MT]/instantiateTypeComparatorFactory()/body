{
  final TypePairComparatorFactory<IT1,IT2> pairComparatorFactory;
  try {
    final Class<? extends TypePairComparatorFactory<IT1,IT2>> factoryClass=this.taskContext.getTaskConfig().getPairComparatorFactory(this.taskContext.getUserCodeClassLoader());
    if (factoryClass == null) {
      @SuppressWarnings("unchecked") TypePairComparatorFactory<IT1,IT2> pactRecordFactory=(TypePairComparatorFactory<IT1,IT2>)PactRecordPairComparatorFactory.get();
      pairComparatorFactory=pactRecordFactory;
    }
 else {
      @SuppressWarnings("unchecked") final Class<TypePairComparatorFactory<IT1,IT2>> clazz=(Class<TypePairComparatorFactory<IT1,IT2>>)(Class<?>)TypePairComparatorFactory.class;
      pairComparatorFactory=InstantiationUtil.instantiate(factoryClass,clazz);
    }
  }
 catch (  ClassNotFoundException cnfex) {
    throw new Exception("The class registered as TypePairComparatorFactory cloud not be loaded.",cnfex);
  }
  return pairComparatorFactory;
}
