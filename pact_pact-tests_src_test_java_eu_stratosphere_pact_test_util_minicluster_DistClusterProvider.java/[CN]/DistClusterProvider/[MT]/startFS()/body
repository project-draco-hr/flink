{
  if (fsIsRunning()) {
    return;
  }
  if (config.getString(Constants.FILESYSTEM_TYPE,"").equals("external_hdfs")) {
    filesystemProvider=new ExternalDFSProvider(this.hdfsConfigDir);
  }
 else {
    throw new IllegalConfigurationException("Invalid file system type: " + config.getString(Constants.FILESYSTEM_TYPE,""));
  }
  filesystemProvider.start();
  this.filesystemRunning=true;
}
