{
synchronized (queues) {
    if (isReleased) {
      buffer.recycle();
    }
 else {
      checkInProducePhase();
      queues[targetQueue].add(buffer);
    }
  }
  maybeNotifyConsumers(partitionType.isPipelined());
}
