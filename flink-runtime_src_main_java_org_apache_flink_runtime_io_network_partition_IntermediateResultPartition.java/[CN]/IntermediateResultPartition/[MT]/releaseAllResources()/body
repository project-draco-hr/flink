{
synchronized (queues) {
    if (!isReleased) {
      try {
        for (        IntermediateResultPartitionQueue queue : queues) {
          try {
            queue.discard();
          }
 catch (          Throwable t) {
            LOG.error("Error while discarding queue: " + t.getMessage(),t);
          }
        }
        if (bufferPool != null) {
          bufferPool.destroy();
        }
      }
  finally {
        isReleased=true;
      }
    }
  }
}
