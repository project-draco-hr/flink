{
synchronized (queues) {
    if (isReleased) {
      throw new IllegalQueueIteratorRequestException("Intermediate result partition has already been released.");
    }
    if (queueIndex < 0 || queueIndex >= queues.length) {
      throw new IllegalQueueIteratorRequestException("Illegal queue index: " + queueIndex + ", allowed: 0-"+ (queues.length - 1));
    }
    return queues[queueIndex].getQueueIterator(bufferProvider);
  }
}
