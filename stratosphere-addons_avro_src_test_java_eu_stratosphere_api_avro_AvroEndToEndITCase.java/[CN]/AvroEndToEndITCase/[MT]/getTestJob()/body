{
  GenericDataSource<CollectionInputFormat> source=new GenericDataSource<CollectionInputFormat>(new CollectionInputFormat());
  MapOperator mapper=MapOperator.builder(new NameExtractor()).input(source).build();
  ReduceOperator reducer=ReduceOperator.builder(new IdReducer()).keyField(StringValue.class,0).input(mapper).build();
  GenericDataSink sink=new GenericDataSink(new DiscardingOutputFormat(),reducer);
  Plan p=new Plan(sink);
  p.setDefaultParallelism(4);
  return p;
}
