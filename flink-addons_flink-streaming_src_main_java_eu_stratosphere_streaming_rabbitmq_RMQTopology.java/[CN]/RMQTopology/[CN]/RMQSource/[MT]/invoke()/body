{
  String QUEUE_NAME="hello";
  ConnectionFactory factory=new ConnectionFactory();
  factory.setHost("localhost");
  Connection connection=factory.newConnection();
  Channel channel=connection.createChannel();
  channel.queueDeclare(QUEUE_NAME,false,false,false,null);
  QueueingConsumer consumer=new QueueingConsumer(channel);
  channel.basicConsume(QUEUE_NAME,true,consumer);
  while (true) {
    QueueingConsumer.Delivery delivery=consumer.nextDelivery();
    String message=new String(delivery.getBody());
    if (message.equals("quit")) {
      break;
    }
    record.setString(0,message);
    emit(record);
  }
  connection.close();
}
