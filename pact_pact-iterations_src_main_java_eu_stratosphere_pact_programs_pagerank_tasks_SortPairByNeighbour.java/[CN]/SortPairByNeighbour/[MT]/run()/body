{
  MutableObjectIterator typehidingIter=inputs[0];
  VertexNeighbourPartial result=new VertexNeighbourPartial();
  PactLong number=new PactLong();
  PactDouble con=new PactDouble();
  try {
    sorter=new UnilateralSortMerger(memoryManager,ioManager,memorySize,64,comparators,keyPos,keyClasses,typehidingIter,this,0.8f);
  }
 catch (  Exception ex) {
    throw new RuntimeException("Error creating sorter",ex);
  }
  MutableObjectIterator<PactRecord> iter=sorter.getIterator();
  PactRecord rec=new PactRecord();
  while (iter.next(rec)) {
    long vid=rec.getField(0,number).getValue();
    long nid=rec.getField(1,number).getValue();
    double contrib=rec.getField(2,con).getValue();
    result.setVid(vid);
    result.setNid(nid);
    result.setPartial(contrib);
    output.collect(result);
  }
}
