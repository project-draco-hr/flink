{
  Object lock=ctx.getCheckpointLock();
  while (count.value() < NUM_INPUT) {
synchronized (lock) {
      for (int i=0; i < PARALLELISM; i++) {
        ctx.collect(Tuple2.of(i,count.value() + 1));
      }
      count.update(count.value() + 1);
    }
  }
}
