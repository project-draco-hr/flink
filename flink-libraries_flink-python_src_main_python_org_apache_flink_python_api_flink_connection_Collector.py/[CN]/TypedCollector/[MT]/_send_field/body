def _send_field(self, value):
    if (value is None):
        self._connection.write(Types.TYPE_NULL)
    elif isinstance(value, stringtype):
        value = value.encode('utf-8')
        size = pack('>I', len(value))
        self._connection.write(''.join([Types.TYPE_STRING, size, value]))
    elif isinstance(value, bytes):
        size = pack('>I', len(value))
        self._connection.write(''.join([Types.TYPE_BYTES, size, value]))
    elif isinstance(value, bool):
        data = pack('>?', value)
        self._connection.write(''.join([Types.TYPE_BOOLEAN, data]))
    elif (isinstance(value, int) or (PY2 and isinstance(value, long))):
        data = pack('>q', value)
        self._connection.write(''.join([Types.TYPE_LONG, data]))
    elif isinstance(value, float):
        data = pack('>d', value)
        self._connection.write(''.join([Types.TYPE_DOUBLE, data]))
    elif isinstance(value, bytearray):
        value = bytes(value)
        size = pack('>I', len(value))
        self._connection.write(''.join([Types.TYPE_BYTES, size, value]))
    elif isinstance(value, _Dummy):
        self._connection.write(pack('>i', 127)[3:])
        self._connection.write(pack('>i', 0))
    else:
        for entry in self._env._types:
            if isinstance(value, entry[1]):
                self._connection.write(entry[0])
                self._connection.write(CustomTypeSerializer(entry[2]).serialize(value))
                return
        raise Exception('Unsupported Type encountered.')
