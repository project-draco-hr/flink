{
  this.memoryManager=memoryManager;
  this.ioManager=ioManager;
  this.reader1=reader1;
  this.reader2=reader2;
  this.keySerialization=new WritableSerializationFactory<K>(keyClass);
  this.value1Serialization=new WritableSerializationFactory<V1>(value1Class);
  this.value2Serialization=new WritableSerializationFactory<V2>(value2Class);
  this.keyClass=keyClass;
  this.value1Class=value1Class;
  this.value2Class=value2Class;
  this.memoryForBlockNestedLoops=Math.max((long)(memory * memPercentageForBlockNL),SpillingResettableIterator.MIN_TOTAL_MEMORY + BlockResettableIterator.MIN_BUFFER_SIZE);
  this.memoryPerChannel=(memory - this.memoryForBlockNestedLoops) / 2;
  this.fileHandlesPerChannel=(maxNumFileHandles / 2) < 2 ? 2 : (maxNumFileHandles / 2);
  this.localStrategy=localStrategy;
  this.parentTask=parentTask;
  this.spillingThreshold=spillingThreshold;
}
