{
  TypeInformation<Tuple2<Integer,Integer>> type1=TypeExtractor.getForObject(new Tuple2<Integer,Integer>(0,0));
  ExecutionConfig config=new ExecutionConfig();
  ReduceFunction<Tuple2<Integer,Integer>> maxByFunctionFirst=new ComparableAggregator<Tuple2<Integer,Integer>>(0,type1,AggregationType.MAXBY,true,config);
  ReduceFunction<Tuple2<Integer,Integer>> maxByFunctionLast=new ComparableAggregator<Tuple2<Integer,Integer>>(0,type1,AggregationType.MAXBY,false,config);
  ReduceFunction<Tuple2<Integer,Integer>> minByFunctionFirst=new ComparableAggregator<Tuple2<Integer,Integer>>(0,type1,AggregationType.MINBY,true,config);
  ReduceFunction<Tuple2<Integer,Integer>> minByFunctionLast=new ComparableAggregator<Tuple2<Integer,Integer>>(0,type1,AggregationType.MINBY,false,config);
  List<Tuple2<Integer,Integer>> maxByFirstExpected=new ArrayList<Tuple2<Integer,Integer>>();
  maxByFirstExpected.add(new Tuple2<Integer,Integer>(0,0));
  maxByFirstExpected.add(new Tuple2<Integer,Integer>(1,1));
  maxByFirstExpected.add(new Tuple2<Integer,Integer>(2,2));
  maxByFirstExpected.add(new Tuple2<Integer,Integer>(2,2));
  maxByFirstExpected.add(new Tuple2<Integer,Integer>(2,2));
  maxByFirstExpected.add(new Tuple2<Integer,Integer>(2,2));
  maxByFirstExpected.add(new Tuple2<Integer,Integer>(2,2));
  maxByFirstExpected.add(new Tuple2<Integer,Integer>(2,2));
  maxByFirstExpected.add(new Tuple2<Integer,Integer>(2,2));
  List<Tuple2<Integer,Integer>> maxByLastExpected=new ArrayList<Tuple2<Integer,Integer>>();
  maxByLastExpected.add(new Tuple2<Integer,Integer>(0,0));
  maxByLastExpected.add(new Tuple2<Integer,Integer>(1,1));
  maxByLastExpected.add(new Tuple2<Integer,Integer>(2,2));
  maxByLastExpected.add(new Tuple2<Integer,Integer>(2,2));
  maxByLastExpected.add(new Tuple2<Integer,Integer>(2,2));
  maxByLastExpected.add(new Tuple2<Integer,Integer>(2,5));
  maxByLastExpected.add(new Tuple2<Integer,Integer>(2,5));
  maxByLastExpected.add(new Tuple2<Integer,Integer>(2,5));
  maxByLastExpected.add(new Tuple2<Integer,Integer>(2,8));
  List<Tuple2<Integer,Integer>> minByFirstExpected=new ArrayList<Tuple2<Integer,Integer>>();
  minByFirstExpected.add(new Tuple2<Integer,Integer>(0,0));
  minByFirstExpected.add(new Tuple2<Integer,Integer>(0,0));
  minByFirstExpected.add(new Tuple2<Integer,Integer>(0,0));
  minByFirstExpected.add(new Tuple2<Integer,Integer>(0,0));
  minByFirstExpected.add(new Tuple2<Integer,Integer>(0,0));
  minByFirstExpected.add(new Tuple2<Integer,Integer>(0,0));
  minByFirstExpected.add(new Tuple2<Integer,Integer>(0,0));
  minByFirstExpected.add(new Tuple2<Integer,Integer>(0,0));
  minByFirstExpected.add(new Tuple2<Integer,Integer>(0,0));
  List<Tuple2<Integer,Integer>> minByLastExpected=new ArrayList<Tuple2<Integer,Integer>>();
  minByLastExpected.add(new Tuple2<Integer,Integer>(0,0));
  minByLastExpected.add(new Tuple2<Integer,Integer>(0,0));
  minByLastExpected.add(new Tuple2<Integer,Integer>(0,0));
  minByLastExpected.add(new Tuple2<Integer,Integer>(0,3));
  minByLastExpected.add(new Tuple2<Integer,Integer>(0,3));
  minByLastExpected.add(new Tuple2<Integer,Integer>(0,3));
  minByLastExpected.add(new Tuple2<Integer,Integer>(0,6));
  minByLastExpected.add(new Tuple2<Integer,Integer>(0,6));
  minByLastExpected.add(new Tuple2<Integer,Integer>(0,6));
  assertEquals(maxByFirstExpected,MockContext.createAndExecute(new StreamReduce<Tuple2<Integer,Integer>>(maxByFunctionFirst),getInputList()));
  assertEquals(maxByLastExpected,MockContext.createAndExecute(new StreamReduce<Tuple2<Integer,Integer>>(maxByFunctionLast),getInputList()));
  assertEquals(minByLastExpected,MockContext.createAndExecute(new StreamReduce<Tuple2<Integer,Integer>>(minByFunctionLast),getInputList()));
  assertEquals(minByFirstExpected,MockContext.createAndExecute(new StreamReduce<Tuple2<Integer,Integer>>(minByFunctionFirst),getInputList()));
}
