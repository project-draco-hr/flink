{
  List<Tuple3<Integer,Integer,Integer>> maxByFirstExpected=ImmutableList.of(Tuple3.of(0,0,0),Tuple3.of(0,1,1),Tuple3.of(0,2,2),Tuple3.of(0,2,2),Tuple3.of(0,2,2),Tuple3.of(0,2,2),Tuple3.of(0,2,2),Tuple3.of(0,2,2),Tuple3.of(0,2,2));
  List<Tuple3<Integer,Integer,Integer>> maxByLastExpected=ImmutableList.of(Tuple3.of(0,0,0),Tuple3.of(0,1,1),Tuple3.of(0,2,2),Tuple3.of(0,2,2),Tuple3.of(0,2,2),Tuple3.of(0,2,5),Tuple3.of(0,2,5),Tuple3.of(0,2,5),Tuple3.of(0,2,8));
  List<Tuple3<Integer,Integer,Integer>> minByFirstExpected=ImmutableList.of(Tuple3.of(0,0,0),Tuple3.of(0,0,0),Tuple3.of(0,0,0),Tuple3.of(0,0,0),Tuple3.of(0,0,0),Tuple3.of(0,0,0),Tuple3.of(0,0,0),Tuple3.of(0,0,0),Tuple3.of(0,0,0));
  List<Tuple3<Integer,Integer,Integer>> minByLastExpected=ImmutableList.of(Tuple3.of(0,0,0),Tuple3.of(0,0,0),Tuple3.of(0,0,0),Tuple3.of(0,0,3),Tuple3.of(0,0,3),Tuple3.of(0,0,3),Tuple3.of(0,0,6),Tuple3.of(0,0,6),Tuple3.of(0,0,6));
  TypeInformation<Tuple3<Integer,Integer,Integer>> typeInfo=TypeExtractor.getForObject(Tuple3.of(0,0,0));
  ExecutionConfig config=new ExecutionConfig();
  KeySelector<Tuple3<Integer,Integer,Integer>,?> keySelector=KeySelectorUtil.getSelectorForKeys(new Keys.ExpressionKeys<>(new int[]{0},typeInfo),typeInfo,config);
  ReduceFunction<Tuple3<Integer,Integer,Integer>> maxByFunctionFirst=new ComparableAggregator<>(1,typeInfo,AggregationType.MAXBY,true,config);
  ReduceFunction<Tuple3<Integer,Integer,Integer>> maxByFunctionLast=new ComparableAggregator<>(1,typeInfo,AggregationType.MAXBY,false,config);
  ReduceFunction<Tuple3<Integer,Integer,Integer>> minByFunctionFirst=new ComparableAggregator<>(1,typeInfo,AggregationType.MINBY,true,config);
  ReduceFunction<Tuple3<Integer,Integer,Integer>> minByFunctionLast=new ComparableAggregator<>(1,typeInfo,AggregationType.MINBY,false,config);
  assertEquals(maxByFirstExpected,MockContext.createAndExecute(new StreamGroupedReduce<>(maxByFunctionFirst,keySelector,typeInfo),getInputByList()));
  assertEquals(maxByLastExpected,MockContext.createAndExecute(new StreamGroupedReduce<>(maxByFunctionLast,keySelector,typeInfo),getInputByList()));
  assertEquals(minByLastExpected,MockContext.createAndExecute(new StreamGroupedReduce<>(minByFunctionLast,keySelector,typeInfo),getInputByList()));
  assertEquals(minByFirstExpected,MockContext.createAndExecute(new StreamGroupedReduce<>(minByFunctionFirst,keySelector,typeInfo),getInputByList()));
}
