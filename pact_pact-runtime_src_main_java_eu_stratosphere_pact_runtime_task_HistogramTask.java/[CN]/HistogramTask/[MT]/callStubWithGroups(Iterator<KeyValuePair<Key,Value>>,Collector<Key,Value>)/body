{
  boolean run=false;
  while (!this.taskCanceled && in.hasNext()) {
    if (run) {
      throw new RuntimeException("Blubb not working");
    }
 else {
      run=true;
    }
    int recordCount=reader.getCount();
    int bucketSize=recordCount / numBuckets;
    for (int i=0; i < recordCount; i++) {
      Key value=in.next().getKey();
      if (i % bucketSize == 0 && i / bucketSize != 0 && i / bucketSize != numBuckets) {
        out.collect(value,PactNull.getInstance());
      }
    }
  }
}
