{
  boolean run=false;
  while (!this.taskCanceled && in.hasNext()) {
    if (run) {
      throw new RuntimeException("Blubb not working");
    }
    run=true;
    int recordCount=0;
    for (    CountingRecordReader crr : this.allReaders)     recordCount+=crr.getCount();
    int bucketSize=recordCount / this.numBuckets;
    for (int i=0; i < recordCount; i++) {
      Key value=in.next().getKey();
      if (i % bucketSize == 0 && i / bucketSize != 0 && i / bucketSize != this.numBuckets) {
        out.collect(value,PactNull.getInstance());
      }
    }
  }
}
