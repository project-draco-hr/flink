{
  if (readNext) {
    int bytesRead=currentReadRecord.deserialize(segments,CURRENT_READ_SEGMENT_INDEX,currentReadOffset);
    while (bytesRead > 0) {
      if (currentReadSegment.size() - currentReadOffset > bytesRead) {
        currentReadOffset+=bytesRead;
        bytesRead=0;
      }
 else {
        bytesRead-=(currentReadSegment.size() - currentReadOffset);
        MemorySegment unused=segments.remove(CURRENT_READ_SEGMENT_INDEX);
        memoryManager.release(unused);
        currentReadSegment=segments.get(CURRENT_READ_SEGMENT_INDEX);
        currentReadOffset=0;
      }
    }
    readNext=false;
  }
  return currentReadRecord;
}
