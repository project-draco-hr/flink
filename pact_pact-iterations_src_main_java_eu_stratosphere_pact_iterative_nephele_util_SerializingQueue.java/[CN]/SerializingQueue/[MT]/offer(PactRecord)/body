{
  try {
    rec.serialize(null,currentWriteSegment.outputView,allocatingIterator,newSegments);
  }
 catch (  Exception ex) {
    throw new RuntimeException("Bad error during serialization",ex);
  }
  if (!newSegments.isEmpty()) {
    segments.addAll(newSegments);
    currentWriteSegment=segments.get(segments.size() - 1);
    newSegments.clear();
  }
  count++;
  return true;
}
