{
  final ByteArrayOutputStream baos=new ByteArrayOutputStream();
  original.write(new DataOutputViewStreamWrapper(baos));
  final String className=original.getClass().getName();
  if (className == null) {
    fail("Class name is null");
  }
  Class<T> clazz=null;
  try {
    clazz=(Class<T>)Class.forName(className);
  }
 catch (  ClassNotFoundException e) {
    fail(e.getMessage());
  }
  if (clazz == null) {
    fail("Cannot find class with name " + className);
  }
  T copy=null;
  try {
    copy=clazz.newInstance();
  }
 catch (  InstantiationException|IllegalAccessException e) {
    fail(e.getMessage());
  }
  if (copy == null) {
    fail("Copy of object of type " + className + " is null");
  }
  final ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  copy.read(new DataInputViewStreamWrapper(bais));
  return copy;
}
