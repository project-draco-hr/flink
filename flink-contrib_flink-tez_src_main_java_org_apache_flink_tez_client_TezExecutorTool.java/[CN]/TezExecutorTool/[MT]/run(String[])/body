{
  Configuration conf=getConf();
  TezConfiguration tezConf;
  if (conf != null) {
    tezConf=new TezConfiguration(conf);
  }
 else {
    tezConf=new TezConfiguration();
  }
  UserGroupInformation.setConfiguration(tezConf);
  executor.setConfiguration(tezConf);
  try {
    if (jarPath != null) {
      executor.setJobJar(jarPath);
    }
    JobExecutionResult result=executor.executePlan(plan);
  }
 catch (  Exception e) {
    LOG.error("Job execution failed due to: " + e.getMessage());
    throw new RuntimeException(e.getMessage());
  }
  return 0;
}
