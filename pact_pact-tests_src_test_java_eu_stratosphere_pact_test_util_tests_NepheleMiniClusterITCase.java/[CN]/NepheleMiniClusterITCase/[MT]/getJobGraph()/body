{
  JobGraph jobGraph=new JobGraph("Grep Example Job");
  JobFileInputVertex input=new JobFileInputVertex("Output 1",jobGraph);
  input.setFileInputClass(FileLineReader.class);
  input.setFilePath(new Path(hdfs.getURIPrefix() + hdfs.getTempDirPath() + "/input.txt"));
  JobTaskVertex task=new JobTaskVertex("Task 1",jobGraph);
  task.setTaskClass(GrepTask.class);
  JobFileOutputVertex output=new JobFileOutputVertex("Output 1",jobGraph);
  output.setFileOutputClass(FileLineWriter.class);
  output.setFilePath(new Path(hdfs.getURIPrefix() + hdfs.getTempDirPath() + "/output.txt"));
  input.connectTo(task,ChannelType.INMEMORY,CompressionLevel.NO_COMPRESSION);
  task.connectTo(output,ChannelType.INMEMORY,CompressionLevel.NO_COMPRESSION);
  return jobGraph;
}
