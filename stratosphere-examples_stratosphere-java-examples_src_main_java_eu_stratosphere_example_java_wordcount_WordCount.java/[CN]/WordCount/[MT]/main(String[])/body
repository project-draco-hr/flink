{
  if (args.length < 2) {
    System.err.println("Usage: WordCount <input path> <result path>");
    return;
  }
  final String input=args[0];
  final String output=args[1];
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<String> text=env.readTextFile(input);
  DataSet<Tuple2<String,Integer>> result=text.flatMap(new Tokenizer()).groupBy(0).reduce(new Counter());
  result.writeAsText(output);
  env.execute();
}
