{
  if (args.length < 2) {
    System.err.println("Usage: WordCount <input path> <result path>");
    return;
  }
  final String input=args[0];
  final String output=args[1];
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<String> text=env.readTextFile(input);
  DataSet<Tuple2<String,Integer>> words=text.flatMap(new Tokenizer());
  DataSet<Tuple2<String,Integer>> result=words.groupBy(0).aggregate(Aggregations.SUM,1);
  result.writeAsText(output);
  env.execute("Word Count");
}
