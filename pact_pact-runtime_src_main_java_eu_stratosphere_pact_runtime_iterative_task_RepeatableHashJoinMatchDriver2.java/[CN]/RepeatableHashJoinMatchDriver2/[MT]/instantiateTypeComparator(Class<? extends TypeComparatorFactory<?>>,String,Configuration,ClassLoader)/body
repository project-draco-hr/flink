{
  final TypeComparatorFactory<?> comparatorFactory;
  if (comparatorFactoryClass == null) {
    comparatorFactory=PactRecordComparatorFactory.get();
  }
 else {
    comparatorFactory=InstantiationUtil.instantiate(comparatorFactoryClass,TypeComparatorFactory.class);
  }
  return (TypeComparator<T>)comparatorFactory.createComparator(new TaskConfig.DelegatingConfiguration(config,keyPrefix),userCodeClassLoader);
}
