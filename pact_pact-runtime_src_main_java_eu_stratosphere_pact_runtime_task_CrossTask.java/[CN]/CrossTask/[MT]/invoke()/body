{
  if (LOG.isInfoEnabled())   LOG.info(getLogString("Start PACT code"));
  final Iterator<KeyValuePair<Key,Value>> innerInput;
  final Iterator<KeyValuePair<Key,Value>> outerInput;
  if (config.getLocalStrategy() == LocalStrategy.NESTEDLOOP_BLOCKED_OUTER_SECOND || config.getLocalStrategy() == LocalStrategy.NESTEDLOOP_STREAMED_OUTER_SECOND) {
    innerInput=this.input1;
    outerInput=this.input2;
  }
 else   if (config.getLocalStrategy() == LocalStrategy.NESTEDLOOP_BLOCKED_OUTER_FIRST || config.getLocalStrategy() == LocalStrategy.NESTEDLOOP_STREAMED_OUTER_FIRST) {
    innerInput=this.input2;
    outerInput=this.input1;
  }
 else {
    throw new RuntimeException("Invalid local strategy for CROSS: " + config.getLocalStrategy());
  }
  final MemoryManager memoryManager=getEnvironment().getMemoryManager();
  final IOManager ioManager=getEnvironment().getIOManager();
  if (config.getLocalStrategy() == LocalStrategy.NESTEDLOOP_BLOCKED_OUTER_FIRST || config.getLocalStrategy() == LocalStrategy.NESTEDLOOP_BLOCKED_OUTER_SECOND) {
    runBlocked(memoryManager,ioManager,innerInput,outerInput);
  }
 else {
    runStreamed(memoryManager,ioManager,innerInput,outerInput);
  }
  if (!this.taskCanceled) {
    if (LOG.isInfoEnabled())     LOG.info(getLogString("Finished PACT code"));
  }
 else {
    if (LOG.isWarnEnabled())     LOG.warn(getLogString("PACT code cancelled"));
  }
}
