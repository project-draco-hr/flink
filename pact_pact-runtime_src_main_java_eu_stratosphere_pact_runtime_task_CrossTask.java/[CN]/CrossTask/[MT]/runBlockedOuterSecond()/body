{
  if (LOG.isDebugEnabled()) {
    LOG.debug(getLogString("Running Cross with Block-Nested-Loops: " + "First input is inner (spilling) side, second input is outer (blocking) side."));
  }
  final MutableObjectIterator<T1> in1=getInput(0);
  final MutableObjectIterator<T2> in2=getInput(1);
  final TypeSerializer<T1> serializer1=getInputSerializer(0);
  final TypeSerializer<T2> serializer2=getInputSerializer(1);
  final SpillingResettableMutableObjectIterator<T1> spillVals=new SpillingResettableMutableObjectIterator<T1>(in1,serializer1,this.memManager,getEnvironment().getIOManager(),this.memForSpillingSide,this);
  this.spillIter=spillVals;
  final BlockResettableMutableObjectIterator<T2> blockVals=new BlockResettableMutableObjectIterator<T2>(this.memManager,in2,serializer2,this.memForBlockSide,this);
  this.blockIter=blockVals;
  final T1 val1=serializer1.createInstance();
  final T1 val1Copy=serializer1.createInstance();
  final T2 val2=serializer2.createInstance();
  final GenericCrosser<T1,T2,OT> crosser=this.stub;
  final Collector<OT> collector=this.output;
  do {
    while (this.running && spillVals.next(val1)) {
      while (this.running && blockVals.next(val2)) {
        serializer1.copyTo(val1,val1Copy);
        crosser.cross(val1Copy,val2,collector);
      }
      blockVals.reset();
    }
    spillVals.reset();
  }
 while (this.running && blockVals.nextBlock());
}
