{
  if (consumerExecution != null) {
    PartitionInfo.PartitionLocation producerLocation;
    RemoteAddress resolvedProducerAddress;
    if (consumerExecution.getAssignedResourceLocation().equals(producerInstanceConnectionInfo)) {
      resolvedProducerAddress=null;
      producerLocation=PartitionInfo.PartitionLocation.LOCAL;
    }
 else {
      resolvedProducerAddress=new RemoteAddress(producerInstanceConnectionInfo,partitionConnectionIndex);
      producerLocation=PartitionInfo.PartitionLocation.REMOTE;
    }
    return new PartitionInfo(partitionID,producerExecutionID,producerLocation,resolvedProducerAddress);
  }
 else {
    throw new RuntimeException("Cannot create partition info, because consumer execution " + "is null.");
  }
}
