{
  final File localBackupPath=new File(basePath,"local-chk-" + checkpointId);
  final URI backupUri=new URI(checkpointPath + "/chk-" + checkpointId);
  if (!localBackupPath.exists()) {
    if (!localBackupPath.mkdirs()) {
      throw new RuntimeException("Could not create local backup path " + localBackupPath);
    }
  }
  try (BackupEngine backupEngine=BackupEngine.open(Env.getDefault(),new BackupableDBOptions(localBackupPath.getAbsolutePath()))){
    backupEngine.createNewBackup(db);
  }
   return new AsyncRocksDBSnapshot<>(localBackupPath,backupUri,checkpointId,this);
}
