{
  try {
    HDFSCopyFromLocal.copyFromLocal(localBackupPath,backupUri);
    return state.createRocksDBSnapshot(backupUri,checkpointId);
  }
 catch (  Exception e) {
    FileSystem fs=FileSystem.get(backupUri,HadoopFileSystem.getHadoopConfiguration());
    fs.delete(new Path(backupUri),true);
    throw e;
  }
 finally {
    FileUtils.deleteQuietly(localBackupPath);
  }
}
