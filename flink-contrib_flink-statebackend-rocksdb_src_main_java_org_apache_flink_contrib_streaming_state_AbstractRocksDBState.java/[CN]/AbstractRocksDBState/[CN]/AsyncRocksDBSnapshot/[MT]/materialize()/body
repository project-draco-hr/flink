{
  try {
    long startTime=System.currentTimeMillis();
    HDFSCopyFromLocal.copyFromLocal(localBackupPath,backupUri);
    long endTime=System.currentTimeMillis();
    LOG.info("RocksDB materialization from " + localBackupPath + " to "+ backupUri+ " (asynchronous part) took "+ (endTime - startTime)+ " ms.");
    return state.createRocksDBSnapshot(backupUri,checkpointId);
  }
 catch (  Exception e) {
    FileSystem fs=FileSystem.get(backupUri,HadoopFileSystem.getHadoopConfiguration());
    fs.delete(new Path(backupUri),true);
    throw e;
  }
 finally {
    FileUtils.deleteQuietly(localBackupPath);
  }
}
