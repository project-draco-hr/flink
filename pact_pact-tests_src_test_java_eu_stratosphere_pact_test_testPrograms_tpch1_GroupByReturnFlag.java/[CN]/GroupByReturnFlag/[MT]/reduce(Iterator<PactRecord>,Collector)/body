{
  PactRecord outRecord=new PactRecord();
  Tuple returnTuple=new Tuple();
  long quantity=0;
  double extendedPriceSum=0.0;
  boolean first=true;
  while (records.hasNext()) {
    PactRecord rec=records.next();
    Tuple t=rec.getField(1,Tuple.class);
    if (first) {
      first=false;
      rec.copyTo(outRecord);
      returnTuple.addAttribute(rec.getField(0,PactString.class).toString());
    }
    long tupleQuantity=Long.parseLong(t.getStringValueAt(4));
    quantity+=tupleQuantity;
    double extendedPricePerTuple=Double.parseDouble(t.getStringValueAt(5));
    extendedPriceSum+=extendedPricePerTuple;
  }
  PactLong pactQuantity=new PactLong(quantity);
  returnTuple.addAttribute("" + pactQuantity);
  returnTuple.addAttribute("" + extendedPriceSum);
  outRecord.setField(1,returnTuple);
  out.collect(outRecord);
}
