{
  try {
    dataOutputStream.flush();
    client.close();
  }
 catch (  IOException e) {
    throw new RuntimeException("Error while closing connection with socket server at " + hostIp.toString() + ":"+ port,e);
  }
 finally {
    if (client != null) {
      try {
        client.close();
      }
 catch (      IOException e) {
        LOG.error("Cannot close connection with socket server at " + hostIp.toString() + ":"+ port,e);
      }
    }
  }
}
