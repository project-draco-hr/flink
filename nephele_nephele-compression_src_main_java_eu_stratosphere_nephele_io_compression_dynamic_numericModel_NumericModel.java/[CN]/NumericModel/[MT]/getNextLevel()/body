{
  int lzocpuwait=-1, lzoiowait=Integer.MAX_VALUE, lzoresult=Integer.MAX_VALUE;
  int lzmacpuwait=-1, lzmaiowait=Integer.MAX_VALUE, lzmaresult=Integer.MAX_VALUE;
  int bzip2cpuwait=-1, bzip2iowait=Integer.MAX_VALUE, bzip2result=Integer.MAX_VALUE;
  int zlibcpuwait=-1, zlibiowait=Integer.MAX_VALUE, zlibresult=Integer.MAX_VALUE;
  int nocompressioncpuwait=-1, nocompressioniowait=Integer.MAX_VALUE, nocompressionresult=Integer.MAX_VALUE;
  InternalInstanceProfilingDataCompression tmp=null;
  tmp=this.profilingResultsPerAlgorithm.get(CompressionLevel.LIGHT_COMPRESSION);
  if (tmp != null) {
    lzocpuwait=tmp.getUserCPU() + tmp.getSystemCPU() - tmp.getIOWaitCPU();
    lzoiowait=tmp.getIOWaitCPU();
    lzoresult=(tmp.getIOWaitCPU() * 100) + (int)(tmp.getCompressionTime() * 10 * tmp.getCompressionRatio());
  }
  tmp=this.profilingResultsPerAlgorithm.get(CompressionLevel.MEDIUM_COMPRESSION);
  if (tmp != null) {
    zlibcpuwait=tmp.getUserCPU() + tmp.getSystemCPU() - tmp.getIOWaitCPU();
    zlibiowait=tmp.getIOWaitCPU();
    zlibresult=(tmp.getIOWaitCPU() * 100) + (int)(tmp.getCompressionTime() * 10 * tmp.getCompressionRatio());
  }
  tmp=this.profilingResultsPerAlgorithm.get(CompressionLevel.HEAVY_COMPRESSION);
  if (tmp != null) {
    lzmacpuwait=tmp.getUserCPU() + tmp.getSystemCPU() - tmp.getIOWaitCPU();
    lzmaiowait=tmp.getIOWaitCPU();
    lzmaresult=(tmp.getIOWaitCPU() * 100) + (int)(tmp.getCompressionTime() * 10 * tmp.getCompressionRatio());
  }
  tmp=this.profilingResultsPerAlgorithm.get(CompressionLevel.NO_COMPRESSION);
  if (tmp != null) {
    nocompressioncpuwait=tmp.getUserCPU() + tmp.getSystemCPU() - tmp.getIOWaitCPU();
    nocompressioniowait=tmp.getIOWaitCPU();
    nocompressionresult=(tmp.getIOWaitCPU() * 100) + (int)(tmp.getCompressionTime() * tmp.getCompressionRatio());
  }
  System.out.println("Results: NC: " + nocompressionresult + " LZO: "+ lzoresult+ " ZLIB: "+ zlibresult+ " BZIP2: "+ bzip2result+ " LZMA: "+ lzmaresult);
  if (nocompressioniowait == 0)   return CompressionLevel.NO_COMPRESSION;
 else   if (lzoiowait == 0)   return CompressionLevel.LIGHT_COMPRESSION;
 else   if (zlibiowait == 0)   return CompressionLevel.MEDIUM_COMPRESSION;
 else   if (lzmaiowait == 0)   return CompressionLevel.HEAVY_COMPRESSION;
  if (nocompressionresult <= lzoresult && nocompressionresult <= zlibresult && nocompressionresult <= bzip2result && nocompressionresult <= lzmaresult) {
    return CompressionLevel.NO_COMPRESSION;
  }
 else   if (lzoresult <= zlibresult && lzoresult <= bzip2result && lzoresult <= lzmaresult) {
    return CompressionLevel.LIGHT_COMPRESSION;
  }
 else   if (zlibresult <= bzip2result && zlibresult <= lzmaresult) {
    return CompressionLevel.MEDIUM_COMPRESSION;
  }
 else   return CompressionLevel.HEAVY_COMPRESSION;
}
