{
  if (!writable)   throw new IllegalStateException("Memory records is not writable");
  int size=Record.recordSize(key,value);
  compressor.putLong(offset);
  compressor.putInt(size);
  compressor.putRecord(key,value);
  compressor.recordWritten(size + LOG_OVERHEAD);
}
