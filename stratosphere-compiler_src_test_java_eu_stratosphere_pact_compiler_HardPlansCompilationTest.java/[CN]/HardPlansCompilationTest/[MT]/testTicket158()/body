{
  FileDataSource source=new FileDataSource(new DummyInputFormat(),IN_FILE,"Source");
  MapContract map=MapContract.builder(new IdentityMap()).name("Map1").input(source).build();
  ReduceContract reduce1=ReduceContract.builder(new IdentityReduce(),PactInteger.class,0).name("Reduce1").input(map).build();
  CrossContract cross1=CrossContract.builder(new DummyCrossStub()).name("Cross1").input1(reduce1).input2(source).build();
  ReduceContract reduce2=ReduceContract.builder(new IdentityReduce(),PactInteger.class,0).name("Reduce2").input(cross1).build();
  CrossContract cross2=CrossContract.builder(new DummyCrossStub()).name("Cross2").input1(reduce2).input2(source).build();
  ReduceContract reduce3=ReduceContract.builder(new IdentityReduce(),PactInteger.class,0).name("Reduce3").input(cross2).build();
  FileDataSink sink=new FileDataSink(new DummyOutputFormat(),OUT_FILE,"Sink");
  sink.setInput(reduce3);
  Plan plan=new Plan(sink,"Test Temp Task");
  plan.setDefaultParallelism(DEFAULT_PARALLELISM);
  OptimizedPlan oPlan=compileNoStats(plan);
  NepheleJobGraphGenerator jobGen=new NepheleJobGraphGenerator();
  jobGen.compileJobGraph(oPlan);
}
