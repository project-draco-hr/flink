{
  int buildSize=1000000;
  int buildStep=5;
  int buildScope=buildStep * buildSize;
  int probeSize=5000000;
  int probeStep=1;
  int probeScope=buildSize;
  int expectedResult=1000000;
  long withBloomFilterCost=hybridHashJoin(buildSize,buildStep,buildScope,probeSize,probeStep,probeScope,expectedResult,true);
  long withoutBloomFilterCost=hybridHashJoin(buildSize,buildStep,buildScope,probeSize,probeStep,probeScope,expectedResult,false);
  System.out.println("HybridHashJoin3:");
  System.out.println("Build input size: " + 100 * buildSize);
  System.out.println("Probe input size: " + 100 * probeSize);
  System.out.println("Available memory: " + this.memManager.getMemorySize());
  System.out.println("Probe record be filtered before spill: " + (1 - (double)probeScope / buildScope) * 100 + "% percent.");
  System.out.println(String.format("Cost: without bloom filter(%d), with bloom filter(%d)",withoutBloomFilterCost,withBloomFilterCost));
}
