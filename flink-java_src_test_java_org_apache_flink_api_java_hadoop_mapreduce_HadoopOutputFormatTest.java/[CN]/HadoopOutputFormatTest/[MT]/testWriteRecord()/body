{
  OutputFormat<String,Long> dummyOutputFormat=new DummyOutputFormat();
  String key="Test";
  Long value=1L;
  map=new HashMap<>();
  map.put(key,0L);
  try {
    Job job=Job.getInstance();
    Tuple2<String,Long> tuple=new Tuple2<>();
    tuple.setFields(key,value);
    HadoopOutputFormat<String,Long> hadoopOutputFormat=new HadoopOutputFormat<>(dummyOutputFormat,job);
    hadoopOutputFormat.recordWriter=new DummyRecordWriter();
    hadoopOutputFormat.writeRecord(tuple);
    Long expected=map.get(key);
    assertEquals(expected,value);
  }
 catch (  IOException e) {
    fail();
  }
}
