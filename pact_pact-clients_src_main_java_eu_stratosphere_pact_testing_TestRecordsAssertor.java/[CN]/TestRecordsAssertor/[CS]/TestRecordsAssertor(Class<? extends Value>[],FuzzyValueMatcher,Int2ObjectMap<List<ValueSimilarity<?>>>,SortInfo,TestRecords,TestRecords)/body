{
  this.schema=schema;
  this.fuzzyMatcher=fuzzyMatcher;
  this.similarityMap=similarityMap;
  this.sortInfo=this.getSortInfoForAssertion(similarityMap,TestRecords.firstNonNull(expectedValues.sortInfo,this.sortInfo));
  if (sortInfo == null)   throw new IllegalStateException("Expected value does not have schema specified");
  this.expectedValues=expectedValues;
  this.actualRecords=actualRecords;
  this.actualIterator=actualRecords.iterator(sortInfo);
  this.expectedIterator=expectedValues.iterator(sortInfo);
}
