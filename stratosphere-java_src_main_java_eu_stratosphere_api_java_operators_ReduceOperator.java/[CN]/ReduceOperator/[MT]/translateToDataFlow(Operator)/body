{
  String name=getName() != null ? getName() : function.getClass().getName();
  if (grouper == null) {
    PlanReduceOperator<IN> po=new PlanReduceOperator<IN>(function,new int[0],name,getInputType());
    po.setInput(input);
    po.setDegreeOfParallelism(1);
    return po;
  }
  if (grouper.getKeys() instanceof Keys.SelectorFunctionKeys) {
    @SuppressWarnings("unchecked") Keys.SelectorFunctionKeys<IN,?> selectorKeys=(Keys.SelectorFunctionKeys<IN,?>)grouper.getKeys();
    PlanMapOperator<?,IN> po=translateSelectorFunctionReducer(selectorKeys,function,getInputType(),name,input,this.getParallelism());
    return po;
  }
 else   if (grouper.getKeys() instanceof Keys.FieldPositionKeys) {
    int[] logicalKeyPositions=grouper.getKeys().computeLogicalKeyPositions();
    PlanReduceOperator<IN> po=new PlanReduceOperator<IN>(function,logicalKeyPositions,name,getInputType());
    po.setInput(input);
    po.setDegreeOfParallelism(this.getParallelism());
    return po;
  }
 else {
    throw new UnsupportedOperationException("Unrecognized key type.");
  }
}
