{
  KMeansIterative kmi=new KMeansIterative();
  Job p=kmi.createJob(String.valueOf(DEFAULT_PARALLELISM),IN_FILE,IN_FILE,OUT_FILE,String.valueOf(20));
  ContractResolver cr=getContractResolver(p);
  CrossOperator crossNode=cr.getNode(CROSS_NAME);
  crossNode.setParameter(PactCompiler.HINT_SHIP_STRATEGY_SECOND_INPUT,PactCompiler.HINT_SHIP_STRATEGY_FORWARD);
  OptimizedPlan plan=compileNoStats(p);
  OptimizerPlanNodeResolver or=getOptimizerPlanNodeResolver(plan);
  final SinkPlanNode sink=or.getNode(SINK);
  final BulkIterationPlanNode iter=or.getNode(ITERATION_NAME);
  final SingleInputPlanNode newCenterReducer=or.getNode(RECOMPUTE_CENTERS_REDUCER);
  final SingleInputPlanNode newCenterCombiner=(SingleInputPlanNode)newCenterReducer.getPredecessor();
  final SingleInputPlanNode nearestCenterReducer=or.getNode(NEAREST_CENTER_REDUCER);
  final SingleInputPlanNode nearestCenterCombiner=nearestCenterReducer.getPredecessor() instanceof SingleInputPlanNode ? (SingleInputPlanNode)nearestCenterReducer.getPredecessor() : null;
  final DualInputPlanNode cross=or.getNode(CROSS_NAME);
  checkIterNodeAndSink(iter,sink);
  checkStandardStrategies(nearestCenterReducer,nearestCenterCombiner,newCenterReducer,newCenterCombiner);
  Assert.assertEquals(ShipStrategyType.BROADCAST,cross.getInput1().getShipStrategy());
  Assert.assertEquals(ShipStrategyType.FORWARD,cross.getInput2().getShipStrategy());
  NepheleJobGraphGenerator jobGen=new NepheleJobGraphGenerator();
  jobGen.compileJobGraph(plan);
}
