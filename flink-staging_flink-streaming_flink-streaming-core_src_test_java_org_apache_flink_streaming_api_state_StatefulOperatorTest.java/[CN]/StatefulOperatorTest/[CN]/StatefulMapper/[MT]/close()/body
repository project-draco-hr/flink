{
  Map<String,StreamOperatorState> states=((StreamingRuntimeContext)getRuntimeContext()).getOperatorStates();
  PartitionedStreamOperatorState<Integer,Integer,Integer> groupCounter=(PartitionedStreamOperatorState<Integer,Integer,Integer>)states.get("groupCounter");
  for (  Entry<Serializable,Integer> count : groupCounter.getPartitionedState().entrySet()) {
    Integer key=(Integer)count.getKey();
    Integer expected=key < 3 ? 2 : 1;
    assertEquals(new MutableInt(expected),count.getValue());
  }
}
