{
  final ExecutionGraph eg=this.executionVertex.getExecutionGraph();
  if (newExecutionState == ExecutionState.FINISHED || newExecutionState == ExecutionState.CANCELED || newExecutionState == ExecutionState.FAILED) {
    this.localScheduler.checkAndReleaseAllocatedResource(eg,this.executionVertex.getAllocatedResource());
  }
  if (newExecutionState == ExecutionState.FAILED) {
    if (this.executionVertex.hasRetriesLeft()) {
      this.executionVertex.setExecutionState(ExecutionState.SCHEDULED);
    }
  }
  final ExecutionGraph executionGraph=this.executionVertex.getExecutionGraph();
  final InternalJobStatus jobStatus=executionGraph.getJobStatus();
  if (jobStatus == InternalJobStatus.FAILED || jobStatus == InternalJobStatus.FINISHED || jobStatus == InternalJobStatus.CANCELED) {
    this.localScheduler.removeJobFromSchedule(executionGraph);
  }
}
