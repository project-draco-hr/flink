{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Combiner starting.");
  }
  final Counter numRecordsIn=this.taskContext.getMetricGroup().counter("numRecordsIn");
  final MutableObjectIterator<T> in=this.taskContext.getInput(0);
  final TypeSerializer<T> serializer=this.serializer;
  if (objectReuseEnabled) {
    T value=serializer.createInstance();
    while (running && (value=in.next(value)) != null) {
      numRecordsIn.inc();
      if (this.sorter.write(value)) {
        continue;
      }
      sortAndCombine();
      this.sorter.reset();
      if (!this.sorter.write(value)) {
        throw new IOException("Cannot write record to fresh sort buffer. Record too large.");
      }
    }
  }
 else {
    T value;
    while (running && (value=in.next()) != null) {
      numRecordsIn.inc();
      if (this.sorter.write(value)) {
        continue;
      }
      sortAndCombine();
      this.sorter.reset();
      if (!this.sorter.write(value)) {
        throw new IOException("Cannot write record to fresh sort buffer. Record too large.");
      }
    }
  }
  sortAndCombine();
}
