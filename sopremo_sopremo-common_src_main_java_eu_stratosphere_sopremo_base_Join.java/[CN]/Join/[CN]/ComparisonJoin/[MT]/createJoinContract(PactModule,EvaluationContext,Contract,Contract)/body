{
  MapContract<PactNull,PactJsonObject,Key,PactJsonObject> in1=new MapContract<PactNull,PactJsonObject,Key,PactJsonObject>(KeyExtractionStub.class);
  SopremoUtil.setTransformationAndContext(in1.getStubParameters(),this.comparison.getExpr1(),context);
  in1.setInput(left);
  MapContract<PactNull,PactJsonObject,Key,PactJsonObject> in2=new MapContract<PactNull,PactJsonObject,Key,PactJsonObject>(KeyExtractionStub.class);
  SopremoUtil.setTransformationAndContext(in2.getStubParameters(),this.comparison.getExpr2(),context);
  in2.setInput(right);
  DualInputContract<PactJsonObject.Key,PactJsonObject,PactJsonObject.Key,PactJsonObject,Key,PactJsonObject> join=null;
switch (this.comparison.getBinaryOperator()) {
case EQUAL:
    if (!Join.this.outerJoinFlag.isEmpty()) {
      boolean leftOuter=Join.this.outerJoinFlag.get(SopremoUtil.getInputIndex((Path)this.comparison.getExpr1()));
      boolean rightOuter=Join.this.outerJoinFlag.get(SopremoUtil.getInputIndex((Path)this.comparison.getExpr2()));
      join=new CoGroupContract<PactJsonObject.Key,PactJsonObject,PactJsonObject,Key,PactJsonObject>(OuterJoinStub.class);
      join.getStubParameters().setBoolean("leftOuter",leftOuter);
      join.getStubParameters().setBoolean("rightOuter",rightOuter);
      break;
    }
  join=new MatchContract<PactJsonObject.Key,PactJsonObject,PactJsonObject,Key,PactJsonObject>(InnerJoinStub.class);
break;
default :
join=new CrossContract<PactJsonObject.Key,PactJsonObject,PactJsonObject.Key,PactJsonObject,Key,PactJsonObject>(ThetaJoinStub.class);
SopremoUtil.setObject(join.getStubParameters(),"comparison",this.comparison);
break;
}
module.getOutput(0).setInput(join);
join.setFirstInput(in1);
join.setSecondInput(in2);
return join;
}
