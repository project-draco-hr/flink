{
  final StormConfig stormConfig=new StormConfig();
  final Configuration flinkConfig=new Configuration();
  final ExecutionConfig taskConfig=mock(ExecutionConfig.class);
  when(taskConfig.getGlobalJobParameters()).thenReturn(null).thenReturn(stormConfig).thenReturn(flinkConfig);
  final StreamingRuntimeContext taskContext=mock(StreamingRuntimeContext.class);
  when(taskContext.getExecutionConfig()).thenReturn(taskConfig);
  final IRichSpout spout=mock(IRichSpout.class);
  final StormSpoutWrapper spoutWrapper=new StormSpoutWrapper(spout);
  spoutWrapper.setRuntimeContext(taskContext);
  spoutWrapper.isRunning=false;
  spoutWrapper.run(mock(SourceContext.class));
  verify(spout).open(any(Map.class),any(TopologyContext.class),any(SpoutOutputCollector.class));
  spoutWrapper.run(mock(SourceContext.class));
  verify(spout).open(same(stormConfig),any(TopologyContext.class),any(SpoutOutputCollector.class));
  spoutWrapper.run(mock(SourceContext.class));
  verify(spout,times(3)).open(eq(flinkConfig.toMap()),any(TopologyContext.class),any(SpoutOutputCollector.class));
}
