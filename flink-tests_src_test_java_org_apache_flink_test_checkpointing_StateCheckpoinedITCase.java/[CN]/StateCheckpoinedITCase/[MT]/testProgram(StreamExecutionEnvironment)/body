{
  assertTrue("Broken test setup",NUM_STRINGS % 40 == 0);
  DataStream<String> stream=env.addSource(new StringGeneratingSourceFunction(NUM_STRINGS));
  stream.filter(new StringRichFilterFunction()).map(new StringPrefixCountRichMapFunction()).startNewChain().map(new StatefulCounterFunction()).partitionByHash("prefix").flatMap(new OnceFailingAggregator(NUM_STRINGS)).addSink(new ValidatingSink());
}
