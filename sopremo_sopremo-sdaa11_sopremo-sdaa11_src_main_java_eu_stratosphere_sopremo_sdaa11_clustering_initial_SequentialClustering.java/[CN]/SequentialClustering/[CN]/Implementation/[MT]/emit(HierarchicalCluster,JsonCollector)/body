{
  if (cluster.isFinal()) {
    ArrayNode pointsNode=new ArrayNode();
    for (    Point point : cluster.getPoints()) {
      pointsNode.add(point.toJsonNode(null));
    }
    ObjectNode clusterNode=new ObjectNode();
    clusterNode.put("id",new TextNode(cluster.getId()));
    clusterNode.put("clustroid",cluster.getClustroid().toJsonNode(null));
    clusterNode.put("points",pointsNode);
    out.collect(clusterNode);
  }
 else {
    for (    HierarchicalCluster child : cluster.getChildren()) {
      emit(child,out);
    }
  }
}
