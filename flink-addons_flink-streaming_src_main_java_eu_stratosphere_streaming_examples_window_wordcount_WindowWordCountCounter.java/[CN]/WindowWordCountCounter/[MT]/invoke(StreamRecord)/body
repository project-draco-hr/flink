{
  StreamRecord outRecord=new StreamRecord(3);
  if (window.isFull()) {
    StreamRecord expiredRecord=window.popFront();
    incrementCompute(record);
    decrementCompute(expiredRecord);
    window.pushBack(record);
    if (window.isComputable()) {
      MutableTableStateIterator<String,Integer> iterator=wordCounts.getIterator();
      while (iterator.hasNext()) {
        Tuple2<String,Integer> tuple=iterator.next();
        Tuple3<String,Integer,Long> outputTuple=new Tuple3<String,Integer,Long>((String)tuple.getField(0),(Integer)tuple.getField(1),timestamp);
        outRecord.addTuple(outputTuple);
      }
      emit(outRecord);
    }
  }
 else {
    incrementCompute(record);
    window.pushBack(record);
    if (window.isFull()) {
      MutableTableStateIterator<String,Integer> iterator=wordCounts.getIterator();
      while (iterator.hasNext()) {
        Tuple2<String,Integer> tuple=iterator.next();
        Tuple3<String,Integer,Long> outputTuple=new Tuple3<String,Integer,Long>((String)tuple.getField(0),(Integer)tuple.getField(1),timestamp);
        outRecord.addTuple(outputTuple);
      }
      emit(outRecord);
    }
  }
}
