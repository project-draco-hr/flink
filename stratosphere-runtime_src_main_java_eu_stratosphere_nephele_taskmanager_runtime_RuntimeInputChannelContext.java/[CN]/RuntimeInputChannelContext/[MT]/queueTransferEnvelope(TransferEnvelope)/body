{
  if (ReceiverNotFoundEvent.isReceiverNotFoundEvent(transferEnvelope)) {
    return;
  }
  final int sequenceNumber=transferEnvelope.getSequenceNumber();
synchronized (this.queuedEnvelopes) {
    if (this.destroyCalled) {
      final Buffer buffer=transferEnvelope.getBuffer();
      if (buffer != null) {
        buffer.recycleBuffer();
      }
      return;
    }
    final int expectedSequenceNumber=this.lastReceivedEnvelope + 1;
    if (sequenceNumber != expectedSequenceNumber) {
      this.byteBufferedInputChannel.reportIOException(new IOException("Expected data packet " + expectedSequenceNumber + " but received "+ sequenceNumber));
      this.byteBufferedInputChannel.notifyGateThatInputIsAvailable();
      if (LOG.isDebugEnabled()) {
        LOG.debug("Input channel " + getChannelName() + " expected envelope "+ expectedSequenceNumber+ " but received "+ sequenceNumber);
      }
      final Buffer buffer=transferEnvelope.getBuffer();
      if (buffer != null) {
        buffer.recycleBuffer();
      }
    }
 else {
      this.queuedEnvelopes.add(transferEnvelope);
      this.lastReceivedEnvelope=sequenceNumber;
      if (transferEnvelope.getBuffer() != null) {
        this.byteBufferedInputChannel.notifyGateThatInputIsAvailable();
      }
      if (transferEnvelope.getEventList() != null) {
        for (int i=0; i < transferEnvelope.getEventList().size(); i++) {
          this.byteBufferedInputChannel.notifyGateThatInputIsAvailable();
        }
      }
    }
  }
}
