{
  if (out != null) {
    OUT result=out;
    out=null;
    return result;
  }
  try {
    delivery=consumer.nextDelivery();
  }
 catch (  Exception e) {
    throw new RuntimeException("Error while reading message from RMQ source from " + QUEUE_NAME + " at "+ HOST_NAME,e);
  }
  out=schema.deserialize(delivery.getBody());
  if (schema.isEndOfStream(out)) {
    throw new RuntimeException("RMQ source is at end for " + QUEUE_NAME + " at "+ HOST_NAME);
  }
  OUT result=out;
  out=null;
  return result;
}
