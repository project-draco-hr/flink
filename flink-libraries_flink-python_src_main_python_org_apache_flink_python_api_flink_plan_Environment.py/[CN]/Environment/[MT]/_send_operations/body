def _send_operations(self):
    collect = self._collector.collect
    for set in self._sets:
        identifier = set.identifier
        collect(set.identifier)
        collect(set.id)
        collect(set.parent.id)
        for case in Switch(identifier):
            if case(_Identifier.REBALANCE):
                break
            if case(_Identifier.DISTINCT, _Identifier.PARTITION_HASH):
                collect(set.keys)
                break
            if case(_Identifier.FIRST):
                collect(set.count)
                break
            if case(_Identifier.SORT):
                collect(set.field)
                collect(set.order)
                break
            if case(_Identifier.GROUP):
                collect(set.keys)
                break
            if case(_Identifier.COGROUP):
                collect(set.other.id)
                collect(set.key1)
                collect(set.key2)
                collect(set.types)
                collect(set.name)
                break
            if case(_Identifier.CROSS, _Identifier.CROSSH, _Identifier.CROSST):
                collect(set.other.id)
                collect(set.uses_udf)
                collect(set.types)
                collect(set.name)
                break
            if case(_Identifier.REDUCE, _Identifier.GROUPREDUCE):
                collect(set.types)
                collect(set.name)
                break
            if case(_Identifier.JOIN, _Identifier.JOINH, _Identifier.JOINT):
                collect(set.key1)
                collect(set.key2)
                collect(set.other.id)
                collect(set.uses_udf)
                collect(set.types)
                collect(set.name)
                break
            if case(_Identifier.MAP, _Identifier.MAPPARTITION, _Identifier.FLATMAP, _Identifier.FILTER):
                collect(set.types)
                collect(set.name)
                break
            if case(_Identifier.UNION):
                collect(set.other.id)
                break
            if case(_Identifier.PROJECTION):
                collect(set.keys)
                break
            if case():
                raise KeyError(('Environment._send_child_sets(): Invalid operation identifier: ' + str(identifier)))
