{
  if (GenericData.Record.class.isAssignableFrom(type)) {
    registerGenericAvro(reg);
  }
  if (SpecificRecordBase.class.isAssignableFrom(type)) {
    @SuppressWarnings("unchecked") Class<? extends SpecificRecordBase> specRecordClass=(Class<? extends SpecificRecordBase>)type;
    registerSpecificAvro(reg,specRecordClass);
  }
  if (DateTime.class.isAssignableFrom(type) || Interval.class.isAssignableFrom(type)) {
    registerJodaTime(reg);
  }
}
