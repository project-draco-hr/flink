{
  try {
    List<KinesisStreamShard> fakeShards=ReferenceKinesisShardTopologies.flatTopologyWithFourOpenShards();
    int consumerTaskCount=fakeShards.size() - 1;
    for (int consumerNum=0; consumerNum < consumerTaskCount; consumerNum++) {
      List<KinesisStreamShard> assignedShardsToThisConsumerTask=FlinkKinesisConsumer.assignShards(fakeShards,consumerTaskCount,consumerNum);
      if (consumerNum != 0) {
        assertEquals(1,assignedShardsToThisConsumerTask.size());
        assertTrue(assignedShardsToThisConsumerTask.get(0).equals(fakeShards.get(consumerNum)));
      }
 else {
        assertEquals(2,assignedShardsToThisConsumerTask.size());
        assertTrue(assignedShardsToThisConsumerTask.get(0).equals(fakeShards.get(0)));
        assertTrue(assignedShardsToThisConsumerTask.get(1).equals(fakeShards.get(fakeShards.size() - 1)));
      }
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
