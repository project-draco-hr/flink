{
  final EvaluationExpression similarityFunction=this.getSimilarityFunction();
  final RecordLinkage recordLinkage=new RecordLinkage(new Naive(),similarityFunction,this.threshold,(JsonStream)null);
  final SopremoTestPlan sopremoTestPlan=this.createTestPlan(recordLinkage,this.useId,this.projection);
  EvaluationExpression duplicateProjection=this.projection;
  if (duplicateProjection == null)   duplicateProjection=new ArrayCreation(new PathExpression(new InputSelection(0),recordLinkage.getIdProjection(0)),new PathExpression(new InputSelection(1),recordLinkage.getIdProjection(1)));
  final EvaluationContext context=sopremoTestPlan.getEvaluationContext();
  for (  final KeyValuePair<Key,PactJsonObject> left : sopremoTestPlan.getInput(0)) {
    boolean skipPairs=true;
    for (    final KeyValuePair<Key,PactJsonObject> right : sopremoTestPlan.getInput(0)) {
      if (left == right) {
        skipPairs=false;
        continue;
      }
 else       if (skipPairs)       continue;
      final JsonNode pair=this.createOrderedPair(left.getValue().getValue(),right.getValue().getValue());
      if (similarityFunction.evaluate(pair,context).getDoubleValue() > this.threshold)       sopremoTestPlan.getExpectedOutput(0).add(new PactJsonObject(duplicateProjection.evaluate(pair,context)));
    }
  }
  sopremoTestPlan.run();
}
