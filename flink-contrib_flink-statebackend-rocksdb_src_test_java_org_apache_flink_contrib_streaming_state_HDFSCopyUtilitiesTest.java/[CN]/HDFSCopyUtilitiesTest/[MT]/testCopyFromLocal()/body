{
  Configuration config=new Configuration();
  config.set("fs.default.name","magic-1337:///");
  File testFolder=tempFolder.newFolder();
  File hadoopConfPath=new File(testFolder,"hadoop-conf.binary");
  try (DataOutputStream out=new DataOutputStream(new FileOutputStream(hadoopConfPath))){
    config.write(out);
  }
   File originalFile=new File(testFolder,"original");
  File copyFile=new File(testFolder,"copy");
  try (DataOutputStream out=new DataOutputStream(new FileOutputStream(originalFile))){
    out.writeUTF("Hello there, 42!");
  }
   try {
    HDFSCopyFromLocal.copyFromLocal(hadoopConfPath,originalFile,new URI(copyFile.getAbsolutePath()));
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("magic-1337"));
  }
  config.set("fs.default.name","file:///");
  hadoopConfPath.delete();
  try (DataOutputStream out=new DataOutputStream(new FileOutputStream(hadoopConfPath))){
    config.write(out);
  }
   HDFSCopyFromLocal.copyFromLocal(hadoopConfPath,originalFile,new URI(copyFile.getAbsolutePath()));
  try (DataInputStream in=new DataInputStream(new FileInputStream(copyFile))){
    assertTrue(in.readUTF().equals("Hello there, 42!"));
  }
 }
