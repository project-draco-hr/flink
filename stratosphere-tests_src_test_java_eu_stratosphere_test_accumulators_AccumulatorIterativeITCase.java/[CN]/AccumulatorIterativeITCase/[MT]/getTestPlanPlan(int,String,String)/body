{
  FileDataSource initialInput=new FileDataSource(TextInputFormat.class,input,"input");
  BulkIteration iteration=new BulkIteration("Loop");
  iteration.setInput(initialInput);
  iteration.setMaximumNumberOfIterations(NUM_ITERATIONS);
  ReduceOperator sumReduce=ReduceOperator.builder(new SumReducer()).input(iteration.getPartialSolution()).name("Compute sum (Reduce)").build();
  iteration.setNextPartialSolution(sumReduce);
  @SuppressWarnings("unchecked") FileDataSink finalResult=new FileDataSink(new CsvOutputFormat("\n"," ",StringValue.class),output,iteration,"Output");
  Plan plan=new Plan(finalResult,"Iteration with AllReducer (keyless Reducer)");
  plan.setDefaultParallelism(numSubTasks);
  return plan;
}
