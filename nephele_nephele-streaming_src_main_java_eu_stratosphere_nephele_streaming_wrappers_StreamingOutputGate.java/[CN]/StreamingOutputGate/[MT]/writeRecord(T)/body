{
  final long timestamp=this.streamListener.recordEmitted(record);
  if (timestamp >= 0) {
    final int numberOfOutputChannels=getNumberOfOutputChannels();
    if (this.lastTimestamp < 0) {
      this.lastSentBytes=new long[numberOfOutputChannels];
      for (int i=0; i < numberOfOutputChannels; ++i) {
        this.lastSentBytes[i]=getOutputChannel(i).getAmountOfDataTransmitted();
      }
    }
 else {
      for (int i=0; i < numberOfOutputChannels; ++i) {
        final long amountOfDataTransmitted=getOutputChannel(i).getAmountOfDataTransmitted();
        final long dataDiff=amountOfDataTransmitted - this.lastSentBytes[i];
        this.lastSentBytes[i]=amountOfDataTransmitted;
        System.out.println("Data diff " + dataDiff);
      }
    }
    this.lastTimestamp=timestamp;
  }
  getWrappedOutputGate().writeRecord(record);
}
