def map_partition(self, iterator, collector):
    for value in iterator:
        if (value in self.expected):
            try:
                self.expected.remove(value)
            except Exception:
                raise Exception((self.name + ' failed!'))
    collector.collect((self.name + ' successful!'))
