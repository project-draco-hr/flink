{
  ByteArrayInputView in=new ByteArrayInputView(stateSnapshot);
  HashMap<K,V> returnMap=new HashMap<>();
  try {
    int size=in.readInt();
    for (int i=0; i < size; i++) {
      returnMap.put(keySerializer.deserialize(in),valueSerializer.deserialize(in));
    }
  }
 catch (  IOException e) {
    throw new RuntimeException("Failed to read snapshot",e);
  }
  return returnMap;
}
