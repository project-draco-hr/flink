{
  if (clazz == null) {
    throw new NullPointerException();
  }
  if (castTo != null && !castTo.isAssignableFrom(clazz)) {
    throw new RuntimeException("The class '" + clazz.getName() + "' is not a subclass of '"+ castTo.getName()+ "' as is required.");
  }
  try {
    return clazz.newInstance();
  }
 catch (  InstantiationException iex) {
    checkForInstantiation(clazz);
    throw new RuntimeException("Could not instantiate type '" + clazz.getName() + "' due to an unspecified exception: "+ iex.getMessage(),iex);
  }
catch (  IllegalAccessException iaex) {
    checkForInstantiation(clazz);
    throw new RuntimeException("Could not instantiate type '" + clazz.getName() + "' due to an unspecified exception: "+ iaex.getMessage(),iaex);
  }
catch (  Throwable t) {
    String message=t.getMessage();
    throw new RuntimeException("Could not instantiate type '" + clazz.getName() + "' Most likely the constructor (or a member variable initialization) threw an exception"+ (message == null ? "." : ": " + message),t);
  }
}
