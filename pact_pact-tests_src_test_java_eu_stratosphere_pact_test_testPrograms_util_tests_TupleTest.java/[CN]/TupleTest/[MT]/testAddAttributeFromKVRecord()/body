{
  Tuple t1=new Tuple();
  t1.addAttribute("a");
  t1.addAttribute("123345");
  t1.addAttribute("adfasdfg");
  Tuple t2=new Tuple();
  Assert.isTrue(t2.getNumberOfColumns() == 0);
  t2.addAttributeFromKVRecord(t1,1);
  Assert.isTrue(t2.getNumberOfColumns() == 1);
  Assert.isTrue(t2.getLongValueAt(0) == 123345);
  Assert.isTrue(t2.getBytes().length == 256);
  t2.compact();
  t2.addAttributeFromKVRecord(t1,2);
  Assert.isTrue(t2.getNumberOfColumns() == 2);
  byte[] ret=t2.getByteArrayValueAt(1);
  Assert.isTrue(ret.length == "adfasdfg".getBytes().length);
  for (int i=0; i < ret.length; i++) {
    Assert.isTrue(ret[i] == "adfasdfg".getBytes()[i]);
  }
  Assert.isTrue(t2.getBytes().length == 16);
  t2.addAttributeFromKVRecord(t1,0);
  Assert.isTrue(t2.getNumberOfColumns() == 3);
  Assert.isTrue(t2.getStringValueAt(2).equals("a"));
  Assert.isTrue(t2.getBytes().length == 18);
}
