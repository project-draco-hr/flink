{
  List<T> outputs=new ArrayList<T>();
  if (sourceFunction instanceof RichSourceFunction) {
    ((RichSourceFunction<T>)sourceFunction).open(new Configuration());
  }
  try {
    final Collector<T> collector=new MockOutput<T>(outputs);
    final Object lockObject=new Object();
    SourceFunction.SourceContext<T> ctx=new SourceFunction.SourceContext<T>(){
      @Override public void collect(      T element){
        collector.collect(element);
      }
      @Override public Object getCheckpointLock(){
        return lockObject;
      }
    }
;
    sourceFunction.run(ctx);
  }
 catch (  Exception e) {
    throw new RuntimeException("Cannot invoke source.",e);
  }
  return outputs;
}
