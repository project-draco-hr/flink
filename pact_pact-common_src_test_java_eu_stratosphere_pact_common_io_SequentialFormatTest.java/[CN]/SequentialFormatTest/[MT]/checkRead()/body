{
  SequentialInputFormat input=createInputFormat();
  FileInputSplit[] inputSplits=input.createInputSplits(0);
  Arrays.sort(inputSplits,new InputSplitSorter());
  int readCount=0;
  for (  FileInputSplit inputSplit : inputSplits) {
    input.open(inputSplit);
    PactRecord record=new PactRecord();
    while (!input.reachedEnd())     if (input.nextRecord(record)) {
      checkEquals(getRecord(readCount),record);
      readCount++;
    }
  }
  Assert.assertEquals(numberOfTuples,readCount);
}
