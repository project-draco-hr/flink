{
  tempFile=File.createTempFile("SequentialInputFormat",null);
  tempFile.deleteOnExit();
  Configuration configuration=new Configuration();
  configuration.setLong(SequentialOutputFormat.BLOCK_SIZE_PARAMETER_KEY,blockSize);
  if (degreeOfParallelism == 1) {
    SequentialOutputFormat output=FormatUtil.openOutput(SequentialOutputFormat.class,"file://" + tempFile.getAbsolutePath(),configuration);
    for (int index=0; index < numberOfTuples; index++)     output.writeRecord(getRecord(index));
    output.close();
  }
 else {
    tempFile.delete();
    tempFile.mkdir();
    int recordIndex=0;
    for (int fileIndex=0; fileIndex < degreeOfParallelism; fileIndex++) {
      SequentialOutputFormat output=FormatUtil.openOutput(SequentialOutputFormat.class,"file://" + tempFile.getAbsolutePath() + "/"+ (fileIndex + 1),configuration);
      for (int fileCount=0; fileCount < getNumberOfTuplesPerFile(fileIndex); fileCount++, recordIndex++)       output.writeRecord(getRecord(recordIndex));
      output.close();
    }
  }
}
