{
  try {
    DataOutputSerializer serializer=events.size() == 0 ? new DataOutputSerializer(4) : new DataOutputSerializer(events.size() * 32);
    serializer.writeInt(events.size());
    for (    AbstractEvent evt : events) {
      serializer.writeUTF(evt.getClass().getName());
      evt.write(serializer);
    }
    return serializer.wrapAsByteBuffer();
  }
 catch (  IOException e) {
    throw new RuntimeException("Error while serializing the task events.",e);
  }
}
