{
  Class<? extends DataDistribution> distribution=conn.getTargetPact().getPactContract().getCompilerHints().getInputDistributionClass();
  if (distribution == null) {
    final long estOutShipSize=(long)(conn.getReplicationFactor() * conn.getSourcePact().getEstimatedOutputSize() * 1.1);
    if (estOutShipSize == -1) {
      costs.setNetworkCost(-1);
    }
 else {
      final long cost=(long)(1.5f * estOutShipSize);
      costs.setNetworkCost(cost);
    }
    costs.setSecondaryStorageCost(estOutShipSize == -1 ? -1 : 2 * estOutShipSize);
  }
 else {
    final long estOutShipSize=conn.getReplicationFactor() * conn.getSourcePact().getEstimatedOutputSize();
    if (estOutShipSize == -1) {
      costs.setNetworkCost(-1);
    }
 else {
      costs.setNetworkCost(estOutShipSize);
    }
    costs.setSecondaryStorageCost(0);
  }
}
