{
  Class<? extends DataDistribution> distribution=conn.getTargetPact().getPactContract().getCompilerHints().getInputDistributionClass();
  if (distribution == null) {
    if (conn.getSourcePact().getEstimatedOutputSize() != -1) {
      long estOutShipSize=(long)(conn.getReplicationFactor() * conn.getSourcePact().getEstimatedOutputSize() * 1.1);
      costs.setNetworkCost((long)(1.5f * estOutShipSize));
      costs.setSecondaryStorageCost(2 * estOutShipSize);
    }
 else {
      costs.setNetworkCost(-1);
      costs.setSecondaryStorageCost(-1);
    }
  }
 else {
    if (conn.getSourcePact().getEstimatedOutputSize() != -1) {
      long estOutShipSize=(long)conn.getReplicationFactor() * conn.getSourcePact().getEstimatedOutputSize();
      costs.setNetworkCost(estOutShipSize);
    }
 else {
      costs.setNetworkCost(-1);
    }
    costs.setSecondaryStorageCost(0);
  }
}
