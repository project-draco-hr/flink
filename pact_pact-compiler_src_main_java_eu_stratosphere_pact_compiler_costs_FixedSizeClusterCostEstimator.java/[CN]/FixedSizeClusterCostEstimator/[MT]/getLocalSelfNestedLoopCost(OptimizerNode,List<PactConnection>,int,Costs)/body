{
  long is=0, ic=0;
  for (  PactConnection c : input) {
    is+=c.getSourcePact().getEstimatedOutputSize() * c.getReplicationFactor();
    ic+=c.getSourcePact().getEstimatedNumRecords();
  }
  long loops=ic == -1 ? 10 : ic / bufferSize;
  costs.setSecondaryStorageCost(is == -1 ? -1 : (loops + 2) * is);
}
