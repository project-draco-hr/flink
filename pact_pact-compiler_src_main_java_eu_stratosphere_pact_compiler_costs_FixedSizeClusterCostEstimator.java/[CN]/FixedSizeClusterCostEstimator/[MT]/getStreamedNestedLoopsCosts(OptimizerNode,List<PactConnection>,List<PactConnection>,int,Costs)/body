{
  costs.setNetworkCost(0);
  long is=0, oc=0;
  int repFac=0;
  for (  PactConnection c : innerSide) {
    is+=c.getSourcePact().getEstimatedOutputSize() * c.getReplicationFactor();
    repFac=Math.max(repFac,c.getReplicationFactor());
  }
  for (  PactConnection c : outerSide)   oc+=c.getSourcePact().getEstimatedNumRecords() * c.getReplicationFactor();
  if (is < (bufferSize * repFac)) {
    is=0;
  }
  costs.setSecondaryStorageCost(is >= 0 && oc >= 0 ? oc * is : -1);
}
