{
  assert(checkDataDistribution(conn));
  Class<? extends DataDistribution> distribution=conn.get(0).getTargetPact().getPactContract().getCompilerHints().getInputDistributionClass();
  if (distribution == null) {
    long estOutShipSize=0;
    for (    PactConnection c : conn) {
      final long estimatedOutputSize=c.getSourcePact().getEstimatedOutputSize();
      if (estimatedOutputSize == -1) {
        estOutShipSize=-1;
        break;
      }
      estOutShipSize+=(long)(c.getReplicationFactor() * estimatedOutputSize * 1.1);
    }
    if (estOutShipSize == -1) {
      costs.setNetworkCost(-1);
    }
 else {
      final long cost=(long)(1.5f * estOutShipSize);
      costs.setNetworkCost(cost);
    }
    costs.setSecondaryStorageCost(estOutShipSize == -1 ? -1 : 2 * estOutShipSize);
  }
 else {
    long estOutShipSize=0;
    for (    PactConnection c : conn) {
      final long estimatedOutputSize=c.getSourcePact().getEstimatedOutputSize();
      if (estimatedOutputSize == -1) {
        estOutShipSize=-1;
        break;
      }
      estOutShipSize+=c.getReplicationFactor() * estimatedOutputSize;
    }
    if (estOutShipSize == -1) {
      costs.setNetworkCost(-1);
    }
 else {
      costs.setNetworkCost(estOutShipSize);
    }
    costs.setSecondaryStorageCost(0);
  }
}
