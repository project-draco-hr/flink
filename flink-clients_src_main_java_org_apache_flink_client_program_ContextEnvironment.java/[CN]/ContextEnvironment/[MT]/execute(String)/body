{
  Plan p=createProgramPlan(jobName);
  JobWithJars toRun=new JobWithJars(p,this.jarFilesToAttach,this.userCodeClassLoader);
  JobSubmissionResult result=this.client.run(toRun,getParallelism(),wait);
  if (result instanceof JobExecutionResult) {
    this.lastJobExecutionResult=(JobExecutionResult)result;
    return (JobExecutionResult)result;
  }
 else {
    LOG.warn("The Client didn't return a JobExecutionResult");
    this.lastJobExecutionResult=new JobExecutionResult(result.getJobID(),-1,null);
    return this.lastJobExecutionResult;
  }
}
