{
  Plan p=createProgramPlan(jobName);
  JobWithJars toRun=new JobWithJars(p,this.jarFilesToAttach,this.classpathsToAttach,this.userCodeClassLoader);
  if (wait) {
    this.lastJobExecutionResult=client.runBlocking(toRun,getParallelism());
    return this.lastJobExecutionResult;
  }
 else {
    JobSubmissionResult result=client.runDetached(toRun,getParallelism());
    LOG.warn("Job was executed in detached mode, the results will be available on completion.");
    this.lastJobExecutionResult=JobExecutionResult.fromJobSubmissionResult(result);
    return this.lastJobExecutionResult;
  }
}
