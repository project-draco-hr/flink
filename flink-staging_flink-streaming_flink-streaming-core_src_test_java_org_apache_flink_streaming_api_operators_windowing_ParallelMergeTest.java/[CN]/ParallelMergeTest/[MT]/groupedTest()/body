{
  TestOutput<StreamWindow<Integer>> output=new TestOutput<StreamWindow<Integer>>();
  TimestampedCollector<StreamWindow<Integer>> collector=new TimestampedCollector<StreamWindow<Integer>>(output);
  List<StreamWindow<Integer>> result=output.getCollected();
  ParallelMerge<Integer> merger=new ParallelGroupedMerge<Integer>();
  merger.numberOfDiscretizers=2;
  merger.flatMap1(createTestWindow(1),collector);
  merger.flatMap1(createTestWindow(1),collector);
  merger.flatMap2(new Tuple2<Integer,Integer>(1,1),collector);
  assertTrue(result.isEmpty());
  merger.flatMap2(new Tuple2<Integer,Integer>(1,1),collector);
  assertEquals(StreamWindow.fromElements(1,1),result.get(0));
}
