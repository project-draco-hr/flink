{
  final Field[] finalKeyFields=Arrays.copyOf(keyFields,comparatorHelperIndex);
  @SuppressWarnings("rawtypes") final TypeComparator[] finalFieldComparators=Arrays.copyOf(fieldComparators,comparatorHelperIndex);
  if (finalFieldComparators.length == 0 || finalKeyFields.length == 0 || finalFieldComparators.length != finalKeyFields.length) {
    throw new IllegalArgumentException("Pojo comparator creation has a bug");
  }
  return new PojoComparator<T>(finalKeyFields,finalFieldComparators,createSerializer(config),typeClass);
}
