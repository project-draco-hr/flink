{
  if (config.isForceKryoEnabled()) {
    return new KryoSerializer<T>(this.typeClass,config);
  }
  if (config.isForceAvroEnabled()) {
    return new AvroSerializer<T>(this.typeClass);
  }
  TypeSerializer<?>[] fieldSerializers=new TypeSerializer<?>[fields.length];
  Field[] reflectiveFields=new Field[fields.length];
  for (int i=0; i < fields.length; i++) {
    fieldSerializers[i]=fields[i].type.createSerializer(config);
    reflectiveFields[i]=fields[i].field;
  }
  return new PojoSerializer<T>(this.typeClass,fieldSerializers,reflectiveFields,config);
}
