{
  for (  Map<AccumulatorRegistry.Metric,Accumulator<?,?>> taskMap : accumulatorMap.values()) {
    if (taskMap != null) {
      for (      Map.Entry<AccumulatorRegistry.Metric,Accumulator<?,?>> entry : taskMap.entrySet()) {
switch (entry.getKey()) {
case NUM_RECORDS_OUT:
          if (!lastRound) {
            if (((LongCounter)entry.getValue()).getLocalValue() != expectedRecords) {
              return false;
            }
          }
        break;
case NUM_BYTES_OUT:
      if (!lastRound) {
        if (((LongCounter)entry.getValue()).getLocalValue() != expectedBytes) {
          return false;
        }
      }
    break;
case NUM_RECORDS_IN:
  if (lastRound && ((LongCounter)taskMap.get(AccumulatorRegistry.Metric.NUM_RECORDS_OUT)).getLocalValue() == 0) {
    if (((LongCounter)entry.getValue()).getLocalValue() != expectedRecords) {
      return false;
    }
  }
break;
case NUM_BYTES_IN:
if (lastRound && ((LongCounter)taskMap.get(AccumulatorRegistry.Metric.NUM_RECORDS_OUT)).getLocalValue() == 0) {
if (((LongCounter)entry.getValue()).getLocalValue() != expectedBytes) {
  return false;
}
}
break;
default :
fail("Unknown accumulator found.");
}
}
}
}
return true;
}
