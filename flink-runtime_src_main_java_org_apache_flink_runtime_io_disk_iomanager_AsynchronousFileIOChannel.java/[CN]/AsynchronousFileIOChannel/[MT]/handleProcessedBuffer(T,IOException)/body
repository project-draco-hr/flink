{
  if (buffer == null) {
    return;
  }
  try {
    if (ex != null && this.exception == null) {
      this.exception=ex;
      this.resultHandler.requestFailed(buffer,ex);
    }
 else {
      this.resultHandler.requestSuccessful(buffer);
    }
  }
  finally {
synchronized (this.closeLock) {
      final int num=this.requestsNotReturned.decrementAndGet();
      if (this.closed && num == 0) {
        this.closeLock.notifyAll();
      }
    }
  }
}
