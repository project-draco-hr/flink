{
  final FiniteStormSpout stormSpout=mock(FiniteStormSpout.class);
  when(stormSpout.reachedEnd()).thenReturn(false,false,false,true,false,false,true);
  final StreamingRuntimeContext taskContext=mock(StreamingRuntimeContext.class);
  when(taskContext.getExecutionConfig()).thenReturn(new ExecutionConfig());
  final FiniteStormSpoutWrapper<?> wrapper=new FiniteStormSpoutWrapper<Object>(stormSpout);
  wrapper.setRuntimeContext(taskContext);
  wrapper.run(mock(SourceContext.class));
  verify(stormSpout,times(3)).nextTuple();
}
