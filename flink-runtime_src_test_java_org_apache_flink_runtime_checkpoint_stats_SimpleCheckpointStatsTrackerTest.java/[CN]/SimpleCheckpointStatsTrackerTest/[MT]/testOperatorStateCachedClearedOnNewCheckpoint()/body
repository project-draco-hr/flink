{
  CompletedCheckpoint[] checkpoints=generateRandomCheckpoints(2);
  ExecutionVertex[] tasksToWaitFor=createTasksToWaitFor(checkpoints[0]);
  CheckpointStatsTracker tracker=new SimpleCheckpointStatsTracker(10,tasksToWaitFor);
  tracker.onCompletedCheckpoint(checkpoints[0]);
  JobVertexID operatorId=checkpoints[0].getStates().get(0).getOperatorId();
  assertNotNull(tracker.getOperatorStats(checkpoints[0].getStates().get(0).getOperatorId()));
  Field f=tracker.getClass().getDeclaredField("operatorStatsCache");
  f.setAccessible(true);
  Map<JobVertexID,OperatorCheckpointStats> cache=(Map<JobVertexID,OperatorCheckpointStats>)f.get(tracker);
  assertTrue(cache.containsKey(operatorId));
  tracker.onCompletedCheckpoint(checkpoints[1]);
  assertTrue(cache.isEmpty());
}
