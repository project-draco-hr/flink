{
  LocalDistributedExecutor lde=new LocalDistributedExecutor();
  try {
    File inFile=File.createTempFile("wctext",".in");
    File outFile=File.createTempFile("wctext",".out");
    inFile.deleteOnExit();
    outFile.deleteOnExit();
    FileWriter fw=new FileWriter(inFile);
    fw.write(WordCountData.TEXT);
    fw.close();
    WordCount wc=new WordCount();
    lde.start(2);
    lde.run(wc.getPlan("4","file://" + inFile.getAbsolutePath(),"file://" + outFile.getAbsolutePath()));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
 finally {
    try {
      lde.stop();
    }
 catch (    Exception e) {
      e.printStackTrace();
      Assert.fail(e.getMessage());
    }
  }
}
