{
  FieldList sourceList;
  RequestedGlobalProperties returnProps=null;
  if (props == null) {
    return null;
  }
  if (this.ordering != null) {
    Ordering no=new Ordering();
    returnProps=new RequestedGlobalProperties();
    returnProps.setPartitioningFields(new FieldSet(),this.partitioning);
    for (int index=0; index < this.ordering.getInvolvedIndexes().size(); index++) {
      int value=this.ordering.getInvolvedIndexes().get(index);
      sourceList=props.getSourceField(input,value) == null ? null : props.getSourceField(input,value).toFieldList();
      if (sourceList != null) {
        no.appendOrdering(sourceList.get(0),this.ordering.getType(index),this.ordering.getOrder(index));
      }
 else {
        return null;
      }
    }
    returnProps.setOrdering(no);
  }
 else   if (this.partitioningFields != null) {
    returnProps=new RequestedGlobalProperties();
    returnProps.setPartitioningFields(new FieldSet(),this.partitioning);
    for (    Integer index : this.partitioningFields) {
      sourceList=props.getSourceField(input,index) == null ? null : props.getSourceField(input,index).toFieldList();
      if (sourceList != null) {
        returnProps.setPartitioningFields(returnProps.getPartitionedFields().addFields(sourceList),this.partitioning);
      }
 else {
        return null;
      }
    }
  }
  final PartitioningProperty partitioning=this.partitioning;
  if (partitioning == PartitioningProperty.FULL_REPLICATION || partitioning == PartitioningProperty.FORCED_REBALANCED || partitioning == PartitioningProperty.CUSTOM_PARTITIONING) {
    return null;
  }
  return returnProps;
}
