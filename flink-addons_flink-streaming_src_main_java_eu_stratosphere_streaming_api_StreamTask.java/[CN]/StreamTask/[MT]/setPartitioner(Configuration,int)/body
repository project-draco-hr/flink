{
  Class<? extends ChannelSelector<Record>> partitioner=taskConfiguration.getClass("partitionerClass_" + nrOutput,DefaultPartitioner.class,ChannelSelector.class);
  try {
    if (partitioner.equals(FieldsPartitioner.class)) {
      int keyPosition=taskConfiguration.getInteger("partitionerIntParam_" + nrOutput,1);
      Class<? extends Key> keyClass=taskConfiguration.getClass("partitionerClassParam_" + nrOutput,StringValue.class,Key.class);
      partitioners.add(partitioner.getConstructor(int.class,Class.class).newInstance(keyPosition,keyClass));
    }
 else {
      partitioners.add(partitioner.newInstance());
    }
  }
 catch (  Exception e) {
    System.out.println("partitioner error" + " " + "partitioner_"+ nrOutput);
    System.out.println(e);
  }
}
