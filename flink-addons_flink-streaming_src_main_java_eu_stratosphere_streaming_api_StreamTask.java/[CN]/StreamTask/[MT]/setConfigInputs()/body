{
  Configuration taskConfiguration=getTaskConfiguration();
  numberOfInputs=taskConfiguration.getInteger("numberOfInputs",0);
  for (int i=0; i < numberOfInputs; i++) {
    inputs.add(new RecordReader<Record>(this,Record.class));
  }
  numberOfOutputs=taskConfiguration.getInteger("numberOfOutputs",0);
  for (int i=1; i <= numberOfOutputs; i++) {
    setPartitioner(taskConfiguration,i);
  }
  for (  ChannelSelector<Record> outputPartitioner : partitioners) {
    outputs.add(new RecordWriter<Record>(this,Record.class,outputPartitioner));
  }
  setUserFunction(taskConfiguration);
}
