{
  numberOfInputs=getTaskConfiguration().getInteger("numberOfInputs",0);
  for (int i=0; i < numberOfInputs; i++) {
    inputs.add(new RecordReader<Record>(this,Record.class));
  }
  numberOfOutputs=getTaskConfiguration().getInteger("numberOfOutputs",0);
  Class<? extends ChannelSelector<Record>> partitioner;
  for (int i=1; i <= numberOfOutputs; i++) {
    partitioner=getTaskConfiguration().getClass("partitioner_" + i,DefaultPartitioner.class,ChannelSelector.class);
    try {
      partitioners.add(partitioner.newInstance());
    }
 catch (    Exception e) {
    }
  }
  for (  ChannelSelector<Record> outputPartitioner : partitioners) {
    outputs.add(new RecordWriter<Record>(this,Record.class,outputPartitioner));
  }
  Class<? extends UserTaskInvokable> userFunctionClass;
  userFunctionClass=getTaskConfiguration().getClass("userfunction",DefaultTaskInvokable.class,UserTaskInvokable.class);
  try {
    userFunction=userFunctionClass.newInstance();
    userFunction.declareOutputs(outputs);
  }
 catch (  Exception e) {
  }
}
