{
  final Configuration stubConfig=this.config.getStubParameters();
  stubConfig.setInteger("pact.parallel.task.id",this.parent.getEnvironment().getIndexInSubtaskGroup());
  stubConfig.setInteger("pact.parallel.task.count",this.parent.getEnvironment().getCurrentNumberOfSubtasks());
  if (this.parent.getEnvironment().getTaskName() != null) {
    stubConfig.setString("pact.parallel.task.name",this.parent.getEnvironment().getTaskName());
  }
  RegularPactTask.openUserCode(this.combiner,stubConfig);
  this.memManager=this.parent.getEnvironment().getMemoryManager();
  final long availableMemory=this.config.getMemoryDriver();
  final TypeSerializerFactory<T> serializerFactory=this.config.getInputSerializer(0,this.userCodeClassLoader);
  final TypeComparatorFactory<T> comparatorFactory=this.config.getDriverComparator(0,this.userCodeClassLoader);
  this.serializer=serializerFactory.getSerializer();
  this.comparator=comparatorFactory.createComparator();
  final List<MemorySegment> memory=this.memManager.allocatePages(this.parent,availableMemory);
  if (this.comparator.supportsSerializationWithKeyNormalization() && this.serializer.getLength() > 0 && this.serializer.getLength() <= THRESHOLD_FOR_IN_PLACE_SORTING) {
    this.sorter=new FixedLengthRecordSorter<T>(this.serializer,this.comparator,memory);
  }
 else {
    this.sorter=new NormalizedKeySorter<T>(this.serializer,this.comparator.duplicate(),memory);
  }
}
