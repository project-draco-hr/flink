{
  try {
    cmp=RPC.getProxy(YARNClientMasterProtocol.class,applicationMasterAddress,NetUtils.getSocketFactory());
    while (running) {
synchronized (lock) {
        try {
          appMasterStatus=cmp.getAppplicationMasterStatus();
        }
 catch (        Throwable e) {
          LOG.warn("Failed to get Application Master status",e);
        }
        if (appMasterStatus != null && messages.size() != appMasterStatus.getMessageCount()) {
          messages=cmp.getMessages();
        }
      }
      try {
        Thread.sleep(5000);
      }
 catch (      InterruptedException e) {
        LOG.warn("Error while getting application status",e);
      }
    }
    RPC.stopProxy(cmp);
  }
 catch (  IOException e) {
    LOG.warn("Error while running RPC service",e);
  }
}
