{
  LOG.info("Started optimizer thread for job " + executionGraph.getJobName());
  try {
    while (!interrupted()) {
      AbstractStreamingData streamingData=streamingDataQueue.take();
      long now=System.currentTimeMillis();
      if (streamingData instanceof ChannelLatency) {
        profilingModel.refreshEdgeLatency(now,(ChannelLatency)streamingData);
      }
 else       if (streamingData instanceof TaskLatency) {
        profilingModel.refreshTaskLatency(now,(TaskLatency)streamingData);
      }
 else       if (streamingData instanceof ChannelThroughput) {
        profilingModel.refreshChannelThroughput(now,(ChannelThroughput)streamingData);
      }
 else       if (streamingData instanceof OutputBufferLatency) {
        profilingModel.refreshChannelOutputBufferLatency(now,(OutputBufferLatency)streamingData);
      }
      if (this.logger.isLoggingNecessary(now)) {
        ProfilingSummary summary=profilingModel.computeProfilingSummary();
        try {
          logger.logLatencies(summary);
        }
 catch (        IOException e) {
          LOG.error("Error when writing to profiling logger file",e);
        }
        if (bufferSizeManager.isAdjustmentNecessary(now)) {
          bufferSizeManager.adjustBufferSizes(summary);
        }
      }
    }
  }
 catch (  InterruptedException e) {
  }
  LOG.info("Stopped optimizer thread for job " + executionGraph.getJobName());
}
