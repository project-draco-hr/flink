{
  jdbcInputFormat=new JDBCInputFormat("org.apache.derby.jdbc.EmbeddedDriver","jdbc:derby:memory:ebookshop","select * from books");
  jdbcInputFormat.configure(null);
  PactRecord record=new PactRecord();
  int recordCount=0;
  while (!jdbcInputFormat.reachedEnd()) {
    jdbcInputFormat.nextRecord(record);
    Assert.assertEquals(5,record.getNumFields());
    Assert.assertEquals("Field 0 should be int",PactInteger.class,record.getField(0,PactInteger.class).getClass());
    Assert.assertEquals("Field 1 should be String",PactString.class,record.getField(1,PactString.class).getClass());
    Assert.assertEquals("Field 2 should be String",PactString.class,record.getField(2,PactString.class).getClass());
    Assert.assertEquals("Field 3 should be float",PactDouble.class,record.getField(3,PactDouble.class).getClass());
    Assert.assertEquals("Field 4 should be int",PactInteger.class,record.getField(4,PactInteger.class).getClass());
    int[] pos={0,1,2,3,4};
    Value[] values={new PactInteger(),new PactString(),new PactString(),new PactDouble(),new PactInteger()};
    Assert.assertTrue(record.equalsFields(pos,dbData[recordCount],values));
    recordCount++;
  }
  Assert.assertEquals(5,recordCount);
}
