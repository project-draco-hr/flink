{
  ParameterTool pt=ParameterTool.fromArgs(args);
  StreamExecutionEnvironment see=StreamExecutionEnvironment.getExecutionEnvironment();
  see.setParallelism(1);
  DataStream<String> simpleStringStream=see.addSource(new EventsGenerator());
  FlinkKinesisProducer<String> kinesis=new FlinkKinesisProducer<>(pt.getRequired("region"),pt.getRequired("accessKey"),pt.getRequired("secretKey"),new SimpleStringSchema());
  kinesis.setFailOnError(true);
  kinesis.setDefaultStream("flink-test");
  kinesis.setDefaultPartition("0");
  simpleStringStream.addSink(kinesis);
  see.execute();
}
