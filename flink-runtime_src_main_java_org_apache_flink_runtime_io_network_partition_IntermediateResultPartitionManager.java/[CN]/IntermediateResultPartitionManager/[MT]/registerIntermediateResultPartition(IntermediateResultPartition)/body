{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Register intermediate result partition {}.",partition);
  }
synchronized (partitions) {
    if (isShutdown) {
      throw new IOException("Intermediate result partition manager has already been shut down.");
    }
    if (partitions.put(partition.getProducerExecutionId(),partition.getPartitionId(),partition) != null) {
      throw new IOException("Tried to re-register intermediate result partition.");
    }
  }
}
