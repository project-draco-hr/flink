{
synchronized (partitions) {
    List<IntermediateResultPartition> partitionsToFail=new ArrayList<IntermediateResultPartition>();
    for (    IntermediateResultPartitionID partitionId : partitions.row(producerExecutionId).keySet()) {
      partitionsToFail.add(partitions.get(producerExecutionId,partitionId));
    }
    for (    IntermediateResultPartition partition : partitionsToFail) {
      failIntermediateResultPartition(partition);
    }
  }
}
