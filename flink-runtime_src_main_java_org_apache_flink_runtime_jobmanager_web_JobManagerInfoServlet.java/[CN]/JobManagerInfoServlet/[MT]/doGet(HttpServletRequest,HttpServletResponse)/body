{
  resp.setStatus(HttpServletResponse.SC_OK);
  resp.setContentType("application/json");
  try {
    if ("archive".equals(req.getParameter("get"))) {
      List<ExecutionGraph> archivedJobs=new ArrayList<ExecutionGraph>(AkkaUtils.<ArchivedJobs>ask(archive,ArchiveMessages.getRequestArchivedJobs(),timeout).asJavaCollection());
      writeJsonForArchive(resp.getWriter(),archivedJobs);
    }
 else     if ("job".equals(req.getParameter("get"))) {
      String jobId=req.getParameter("job");
      JobResponse response=AkkaUtils.ask(archive,new RequestJob(JobID.fromHexString(jobId)),timeout);
      if (response instanceof JobFound) {
        ExecutionGraph archivedJob=((JobFound)response).executionGraph();
        writeJsonForArchivedJob(resp.getWriter(),archivedJob);
      }
 else {
        LOG.warn("DoGet:job: Could not find job for job ID " + jobId);
      }
    }
 else     if ("groupvertex".equals(req.getParameter("get"))) {
      String jobId=req.getParameter("job");
      String groupvertexId=req.getParameter("groupvertex");
      JobResponse response=AkkaUtils.ask(archive,new RequestJob(JobID.fromHexString(jobId)),timeout);
      if (response instanceof JobFound && groupvertexId != null) {
        ExecutionGraph archivedJob=((JobFound)response).executionGraph();
        writeJsonForArchivedJobGroupvertex(resp.getWriter(),archivedJob,JobVertexID.fromHexString(groupvertexId));
      }
 else {
        LOG.warn("DoGet:groupvertex: Could not find job for job ID " + jobId);
      }
    }
 else     if ("taskmanagers".equals(req.getParameter("get"))) {
      int numberOfTaskManagers=AkkaUtils.<Integer>ask(jobmanager,JobManagerMessages.getRequestNumberRegisteredTaskManager(),timeout);
      int numberOfRegisteredSlots=AkkaUtils.<Integer>ask(jobmanager,JobManagerMessages.getRequestTotalNumberOfSlots(),timeout);
      resp.getWriter().write("{\"taskmanagers\": " + numberOfTaskManagers + ", "+ "\"slots\": "+ numberOfRegisteredSlots+ "}");
    }
 else     if ("cancel".equals(req.getParameter("get"))) {
      String jobId=req.getParameter("job");
      AkkaUtils.<CancellationResponse>ask(jobmanager,new CancelJob(JobID.fromHexString(jobId)),timeout);
    }
 else     if ("updates".equals(req.getParameter("get"))) {
      String jobId=req.getParameter("job");
      writeJsonUpdatesForJob(resp.getWriter(),JobID.fromHexString(jobId));
    }
 else     if ("version".equals(req.getParameter("get"))) {
      writeJsonForVersion(resp.getWriter());
    }
 else {
      Iterable<ExecutionGraph> runningJobs=AkkaUtils.<RunningJobs>ask(jobmanager,JobManagerMessages.getRequestRunningJobs(),timeout).asJavaIterable();
      writeJsonForJobs(resp.getWriter(),runningJobs);
    }
  }
 catch (  Exception e) {
    resp.setStatus(HttpServletResponse.SC_BAD_REQUEST);
    resp.getWriter().print(e.getMessage());
    if (LOG.isWarnEnabled()) {
      LOG.warn(StringUtils.stringifyException(e));
    }
  }
}
