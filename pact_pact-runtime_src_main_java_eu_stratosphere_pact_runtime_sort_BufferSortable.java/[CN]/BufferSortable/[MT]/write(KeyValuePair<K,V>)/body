{
  try {
    final int kvnext=(kvindex + 1);
    if (kvnext == kvoffsets.length - 1) {
      LOG.debug(getClass().getSimpleName() + " ran out of accounting space.");
      return false;
    }
    final int keystart=memory.outputView.getPosition();
    this.keySerializer.serialize(pair.getKey());
    final int valstart=memory.outputView.getPosition();
    this.valSerializer.serialize(pair.getValue());
    final int index=this.kvindex * ACCTSIZE;
    this.kvoffsets[kvindex]=index;
    this.kvindices[index + KEYSTART]=keystart;
    this.kvindices[index + VALSTART]=valstart;
    this.kvindex=kvnext;
    this.kvlast=keystart;
    this.position=this.memory.outputView.getPosition();
    return true;
  }
 catch (  IOException e) {
    return false;
  }
}
