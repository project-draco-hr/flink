{
  try {
    final int kvnext=(kvindex + 1);
    if (kvnext == kvoffsets.length - 1) {
      LOG.debug(getClass().getSimpleName() + " ran out of accounting space.");
      return false;
    }
    memory.outputView.skip(4);
    final int keystart=memory.outputView.getPosition();
    keySerializer.serialize(pair.getKey());
    final int valstart=memory.outputView.getPosition();
    valSerializer.serialize(pair.getValue());
    memory.randomAccessView.putInt(position,memory.outputView.getPosition() - position - 4);
    final int index=kvindex * ACCTSIZE;
    kvoffsets[kvindex]=index;
    kvindices[index + KEYSTART]=keystart;
    kvindices[index + VALSTART]=valstart;
    kvindex=kvnext;
    kvlast=keystart;
    position=memory.outputView.getPosition();
    return true;
  }
 catch (  IOException e) {
    return false;
  }
}
