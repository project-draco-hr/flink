{
  if (!parseParameters(args)) {
    return;
  }
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.setBufferTimeout(1000);
  DataStream<String> streamSource=getTextDataStream(env);
  DataStream<Tuple2<String,Integer>> tweets=streamSource.flatMap(new SelectEnglishAndTokenizeFlatMap()).map(new MapFunction<String,Tuple2<String,Integer>>(){
    private static final long serialVersionUID=1L;
    @Override public Tuple2<String,Integer> map(    String value) throws Exception {
      return new Tuple2<String,Integer>(value,1);
    }
  }
).groupBy(0).sum(1).flatMap(new SelectMaxOccurence());
  if (fileOutput) {
    tweets.writeAsText(outputPath,1L);
  }
 else {
    tweets.print();
  }
  env.execute("Twitter Streaming Example");
}
