{
  super.prepare(testPlan,schema);
  final int sinkIndex=this.findSinkIndex(testPlan);
  if (this.doublePrecision > 0) {
    final IntSet fuzzySlots=CollectionUtil.setRangeFrom(0,schema.getPactSchema().length);
    fuzzySlots.removeAll(schema.getKeyIndices());
    final IntIterator iterator=fuzzySlots.iterator();
    while (iterator.hasNext())     testPlan.addFuzzyValueSimilarity(testPlan.getSinks().get(sinkIndex),iterator.next(),new DoubleNodeSimilarity(this.doublePrecision));
  }
}
