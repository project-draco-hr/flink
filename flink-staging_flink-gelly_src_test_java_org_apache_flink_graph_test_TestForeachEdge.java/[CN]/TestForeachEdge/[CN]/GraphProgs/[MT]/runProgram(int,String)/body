{
switch (progId) {
case 1:
{
      final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
      Graph<Long,Long,Long> graph=Graph.create(TestGraphUtils.getLongLongVertexData(env),TestGraphUtils.getLongLongEdgeData(env),env);
      DataSet<Tuple2<Long,Long>> verticesWithLowestOutNeighbor=graph.foreachEdge(new OutEdgesFunction<Long,Long,Long,Long>(){
        public Tuple2<Long,Long> iterateOutEdges(        Vertex<Long,Long> v,        Iterable<Edge<Long,Long>> outEdges){
          long weight=Long.MAX_VALUE;
          long minNeighorId=0;
          for (          Tuple3<Long,Long,Long> edge : outEdges) {
            if (edge.f2 < weight) {
              weight=edge.f2;
              minNeighorId=edge.f1;
            }
          }
          return new Tuple2<Long,Long>(v.f0,minNeighorId);
        }
      }
);
      verticesWithLowestOutNeighbor.writeAsCsv(resultPath);
      env.execute();
      return "1,2\n" + "2,3\n" + "3,4\n"+ "4,5\n"+ "5,1\n";
    }
default :
  throw new IllegalArgumentException("Invalid program id");
}
}
