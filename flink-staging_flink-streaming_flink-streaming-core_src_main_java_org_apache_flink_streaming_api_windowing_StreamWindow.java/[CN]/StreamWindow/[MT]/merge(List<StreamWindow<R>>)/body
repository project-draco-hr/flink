{
  if (windows.isEmpty()) {
    throw new RuntimeException("Need at least one window to merge");
  }
 else {
    StreamWindow<R> window=new StreamWindow<R>(windows.get(0));
    for (int i=1; i < windows.size(); i++) {
      StreamWindow<R> next=windows.get(i);
      if (window.compatibleWith(next)) {
        window.addAll(next);
        window.numberOfParts--;
      }
 else {
        throw new RuntimeException("Can only merge compatible windows");
      }
    }
    return window;
  }
}
