{
  Map<Object,StreamWindow<X>> partitions=new HashMap<Object,StreamWindow<X>>();
  for (  X value : streamWindow) {
    Object key=keySelector.getKey(value);
    StreamWindow<X> window=partitions.get(key);
    if (window == null) {
      window=new StreamWindow<X>(streamWindow.windowID,0);
      partitions.put(key,window);
    }
    window.add(value);
  }
  List<StreamWindow<X>> output=new ArrayList<StreamWindow<X>>();
  int numkeys=partitions.size();
  for (  StreamWindow<X> window : partitions.values()) {
    output.add(window.setNumberOfParts(numkeys));
  }
  return output;
}
