{
  StreamWindow<R> window=new StreamWindow<R>(windows[0]);
  for (int i=1; i < windows.length; i++) {
    StreamWindow<R> next=windows[i];
    if (window.compatibleWith(next)) {
      window.addAll(next);
      window.numberOfParts--;
    }
 else {
      throw new RuntimeException("Can only merge compatible windows");
    }
  }
  return window;
}
