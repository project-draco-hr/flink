{
  TypeInformation<StreamWindow<OUT>> type=discretizedStream.getType();
  if (isPartitioned) {
    return wrap(discretizedStream.keyBy(new WindowKey<OUT>()).transform("Window Merger",type,new WindowMerger<OUT>()).setParallelism(discretizedStream.getParallelism()),false);
  }
 else {
    return this;
  }
}
