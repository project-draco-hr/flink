{
  int parallelism=discretizedStream.getParallelism();
  if (isGrouped()) {
    DiscretizedStream<OUT> out=transform(transformation,"Window partitioner",getType(),new WindowPartitioner<OUT>(groupByKey)).setParallelism(parallelism);
    out.groupByKey=null;
    return out;
  }
 else   if (transformation == WindowTransformation.MAPWINDOW) {
    return transform(transformation,"Window partitioner",getType(),new WindowPartitioner<OUT>(parallelism)).setParallelism(parallelism);
  }
 else {
    return this;
  }
}
