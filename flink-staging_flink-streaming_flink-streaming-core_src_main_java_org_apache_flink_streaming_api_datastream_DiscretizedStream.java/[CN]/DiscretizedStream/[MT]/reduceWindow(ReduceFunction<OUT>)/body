{
  DiscretizedStream<OUT> out=partition(false).transform("Window Reduce",getType(),new WindowReducer<OUT>(reduceFunction)).merge();
  if (!isGrouped()) {
    return out.transform("Window Reduce",out.getType(),new WindowReducer<OUT>(reduceFunction));
  }
 else {
    return out;
  }
}
