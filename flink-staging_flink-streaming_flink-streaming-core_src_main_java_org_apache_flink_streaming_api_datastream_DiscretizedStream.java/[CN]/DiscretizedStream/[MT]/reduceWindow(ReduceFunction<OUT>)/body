{
  DiscretizedStream<OUT> out=partition(transformation).transform(WindowTransformation.REDUCEWINDOW,"Window Reduce",getType(),new WindowReducer<OUT>(reduceFunction)).merge();
  if (!isGrouped() && ((OneInputTransformation<?,?>)out.discretizedStream.getTransformation()).getOperator() instanceof WindowMerger) {
    return out.transform(WindowTransformation.REDUCEWINDOW,"Window Reduce",out.getType(),new WindowReducer<OUT>(discretizedStream.clean(reduceFunction)));
  }
 else {
    return out;
  }
}
