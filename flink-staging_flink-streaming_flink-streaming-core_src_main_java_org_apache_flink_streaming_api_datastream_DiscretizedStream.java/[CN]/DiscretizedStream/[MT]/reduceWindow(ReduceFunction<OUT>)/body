{
  DiscretizedStream<OUT> out=partition(transformation).transform(WindowTransformation.REDUCEWINDOW,"Window Reduce",getType(),new WindowReducer<OUT>(reduceFunction)).merge();
  if (!isGrouped()) {
    return out.transform(WindowTransformation.REDUCEWINDOW,"Window Reduce",out.getType(),new WindowReducer<OUT>(reduceFunction));
  }
 else {
    return out;
  }
}
