{
  CoFlatMapFunction<StreamWindow<OUT>,Tuple2<Integer,Integer>,StreamWindow<OUT>> parallelMerger=isGrouped() ? new ParallelGroupedMerge<OUT>() : new ParallelMerge<OUT>(reduceFunction);
  return reduced.discretizedStream.groupBy(new WindowKey<OUT>()).connect(numOfParts.groupBy(0)).addCoFunction("CoFlatMap",reduced.discretizedStream.getType(),new CoStreamFlatMap<StreamWindow<OUT>,Tuple2<Integer,Integer>,StreamWindow<OUT>>(parallelMerger));
}
