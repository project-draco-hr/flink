{
  ParallelMerge<OUT> parallelMerger=isGrouped() ? new ParallelGroupedMerge<OUT>() : new ParallelMerge<OUT>(reduceFunction);
  return reduced.discretizedStream.groupBy(new WindowKey<OUT>()).connect(numOfParts.groupBy(0)).transform("CoFlatMap",reduced.discretizedStream.getType(),new ParallelMergeOperator<OUT>(parallelMerger));
}
