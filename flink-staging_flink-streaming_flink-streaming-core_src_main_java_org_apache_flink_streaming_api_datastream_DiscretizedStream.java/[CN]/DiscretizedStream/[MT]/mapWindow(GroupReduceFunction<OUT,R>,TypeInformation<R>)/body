{
  DiscretizedStream<R> out=partition(transformation).transform(WindowTransformation.REDUCEWINDOW,"Window Reduce",returnType,new WindowMapper<OUT,R>(reduceFunction));
  if (isGrouped()) {
    return out.merge();
  }
 else {
    return out;
  }
}
