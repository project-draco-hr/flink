{
  DiscretizedStream<R> out=partition(true).transform("Window Reduce",returnType,new WindowMapper<OUT,R>(reduceFunction));
  if (isGrouped()) {
    return out.merge();
  }
 else {
    return out;
  }
}
