{
  TypeInformation<R> retType=TypeExtractor.getGroupReduceReturnTypes(reduceFunction,getType());
  DiscretizedStream<R> out=partition(true).transform("Window Reduce",retType,new WindowMapper<OUT,R>(reduceFunction));
  if (isGrouped()) {
    return out.merge();
  }
 else {
    return out;
  }
}
