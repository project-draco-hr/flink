{
  DiscretizedStream<OUT> partitioned=isPreAggregated ? this : partition(transformation);
  DiscretizedStream<OUT> nonEmpty=filterEmpty(partitioned);
  DataStream<Tuple2<Integer,Integer>> numOfParts=extractPartsByID(partitioned);
  DiscretizedStream<OUT> reduced=isPreAggregated ? nonEmpty : nonEmpty.transform(WindowTransformation.REDUCEWINDOW,"Window Reduce",nonEmpty.getType(),new WindowReducer<OUT>(reduceFunction));
  return wrap(parallelMerge(numOfParts,reduced,reduceFunction),false);
}
