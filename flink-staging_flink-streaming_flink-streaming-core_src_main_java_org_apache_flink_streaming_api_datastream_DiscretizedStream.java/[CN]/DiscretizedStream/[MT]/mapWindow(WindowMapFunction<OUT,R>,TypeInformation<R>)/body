{
  DiscretizedStream<R> out=partition(transformation).transform(WindowTransformation.REDUCEWINDOW,"Window Reduce",returnType,new WindowMapper<OUT,R>(discretizedStream.clean(windowMapFunction)));
  if (isGrouped()) {
    return out.merge();
  }
 else {
    return out;
  }
}
