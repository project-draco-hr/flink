{
  DiscretizedStream<R> out=partition(transformation).transform(WindowTransformation.MAPWINDOW,"Window Map",returnType,new WindowMapper<OUT,R>(discretizedStream.clean(windowMapFunction))).setParallelism(discretizedStream.getParallelism()).merge();
  return out;
}
