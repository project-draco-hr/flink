{
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<Vertex<Long,Double>> pages=getPagesDataSet(env);
  DataSet<Edge<Long,Double>> links=getLinksDataSet(env);
  Graph<Long,Double,Double> network=Graph.fromDataSet(pages,links,env);
  DataSet<Tuple2<Long,Long>> vertexOutDegrees=network.outDegrees();
  Graph<Long,Double,Double> networkWithWeights=network.joinWithEdgesOnSource(vertexOutDegrees,new MapFunction<Tuple2<Double,Long>,Double>(){
    public Double map(    Tuple2<Double,Long> value){
      return value.f0 / value.f1;
    }
  }
);
  DataSet<Vertex<Long,Double>> pageRanks=networkWithWeights.run(new PageRank<Long>(DAMPENING_FACTOR,maxIterations)).getVertices();
  pageRanks.print();
  env.execute();
}
