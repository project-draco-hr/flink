{
  MockRecordWriter recWriter=MockRecordWriterFactory.create();
  SerializationDelegate<StreamRecord<Tuple1<Integer>>> sd=new SerializationDelegate<StreamRecord<Tuple1<Integer>>>(null);
  sd.setInstance(new StreamRecord<Tuple1<Integer>>().setObject(new Tuple1<Integer>()));
  Collector<Tuple1<Integer>> collector=new StreamOutput<Tuple1<Integer>>(recWriter,2,sd);
  collector.collect(new Tuple1<Integer>(3));
  collector.collect(new Tuple1<Integer>(4));
  collector.collect(new Tuple1<Integer>(5));
  collector.collect(new Tuple1<Integer>(6));
  assertArrayEquals(new Integer[]{3,4,5,6},recWriter.emittedRecords.toArray());
}
