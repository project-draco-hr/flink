{
  if (policy instanceof EventTime) {
    EventTime eventTime=(EventTime)policy;
    return ContinuousWatermarkTrigger.of(eventTime.getSize());
  }
 else   if (policy instanceof ProcessingTime) {
    ProcessingTime processingTime=(ProcessingTime)policy;
    return ContinuousProcessingTimeTrigger.of(processingTime.getSize());
  }
 else   if (policy instanceof Count) {
    Count count=(Count)policy;
    return CountTrigger.of(count.getSize());
  }
 else   if (policy instanceof Delta) {
    @SuppressWarnings("unchecked,rawtypes") Delta<IN> delta=(Delta)policy;
    return DeltaTrigger.of(delta.getThreshold(),delta.getDeltaFunction());
  }
  throw new UnsupportedOperationException("Unsupported policy " + policy);
}
