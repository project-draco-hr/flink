{
  String name=getName() != null ? getName() : function.getClass().getName();
  if (super.keys1 instanceof Keys.SelectorFunctionKeys && super.keys2 instanceof Keys.SelectorFunctionKeys && super.keys1.areCompatibale(super.keys2)) {
    @SuppressWarnings("unchecked") Keys.SelectorFunctionKeys<I1,?> selectorKeys1=(Keys.SelectorFunctionKeys<I1,?>)super.keys1;
    @SuppressWarnings("unchecked") Keys.SelectorFunctionKeys<I2,?> selectorKeys2=(Keys.SelectorFunctionKeys<I2,?>)super.keys2;
    PlanUnwrappingJoinOperator<I1,I2,OUT,?> po=translateSelectorFunctionJoin(selectorKeys1,selectorKeys2,function,getInput1Type(),getInput2Type(),getResultType(),name,input1,input2);
    return po;
  }
 else   if (super.keys1 instanceof Keys.FieldPositionKeys && super.keys2 instanceof Keys.FieldPositionKeys && super.keys1.areCompatibale(super.keys2)) {
    int[] logicalKeyPositions1=super.keys1.computeLogicalKeyPositions();
    int[] logicalKeyPositions2=super.keys2.computeLogicalKeyPositions();
    PlanJoinOperator<I1,I2,OUT> po=new PlanJoinOperator<I1,I2,OUT>(function,logicalKeyPositions1,logicalKeyPositions2,name,getInput1Type(),getInput2Type(),getResultType());
    po.setFirstInput(input1);
    po.setSecondInput(input2);
    return po;
  }
 else   if (super.keys1 instanceof Keys.FieldPositionKeys && super.keys2 instanceof Keys.SelectorFunctionKeys && super.keys1.areCompatibale(super.keys2)) {
    int[] logicalKeyPositions1=super.keys1.computeLogicalKeyPositions();
    @SuppressWarnings("unchecked") Keys.SelectorFunctionKeys<I2,?> selectorKeys2=(Keys.SelectorFunctionKeys<I2,?>)super.keys2;
    PlanUnwrappingJoinOperator<I1,I2,OUT,?> po=translateSelectorFunctionJoinRight(logicalKeyPositions1,selectorKeys2,function,getInput1Type(),getInput2Type(),getResultType(),name,input1,input2);
    po.setDegreeOfParallelism(this.getParallelism());
    return po;
  }
 else   if (super.keys1 instanceof Keys.SelectorFunctionKeys && super.keys2 instanceof Keys.FieldPositionKeys && super.keys1.areCompatibale(super.keys2)) {
    @SuppressWarnings("unchecked") Keys.SelectorFunctionKeys<I1,?> selectorKeys1=(Keys.SelectorFunctionKeys<I1,?>)super.keys1;
    int[] logicalKeyPositions2=super.keys2.computeLogicalKeyPositions();
    PlanUnwrappingJoinOperator<I1,I2,OUT,?> po=translateSelectorFunctionJoinLeft(selectorKeys1,logicalKeyPositions2,function,getInput1Type(),getInput2Type(),getResultType(),name,input1,input2);
    po.setDegreeOfParallelism(this.getParallelism());
    return po;
  }
 else {
    throw new UnsupportedOperationException("Unrecognized or incompatible key types.");
  }
}
