{
  LOG.info("Commit checkpoint {}",checkpointId);
  long[] checkpointOffsets=pendingCheckpoints.remove(checkpointId);
  if (checkpointOffsets == null) {
    LOG.warn("Unable to find pending checkpoint for id {}",checkpointId);
    return;
  }
  LOG.info("Got corresponding offsets {}",Arrays.toString(checkpointOffsets));
  for (int partition=0; partition < checkpointOffsets.length; partition++) {
    long offset=checkpointOffsets[partition];
    if (offset != -1) {
      setOffset(partition,offset);
    }
  }
}
