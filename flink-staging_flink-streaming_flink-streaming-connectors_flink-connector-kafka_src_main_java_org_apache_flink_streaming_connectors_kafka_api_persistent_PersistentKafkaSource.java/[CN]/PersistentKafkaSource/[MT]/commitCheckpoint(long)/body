{
  LOG.info("Commit checkpoint {}",checkpointId);
  final int posInMap=pendingCheckpoints.indexOf(checkpointId);
  if (posInMap == -1) {
    LOG.warn("Unable to find pending checkpoint for id {}",checkpointId);
    return;
  }
  long[] checkpointOffsets=(long[])pendingCheckpoints.remove(posInMap);
  LOG.info("Committing offsets {} to ZooKeeper",Arrays.toString(checkpointOffsets));
  if (!pendingCheckpoints.isEmpty()) {
    for (int i=0; i < posInMap; i++) {
      pendingCheckpoints.remove(0);
    }
  }
  setOffsetsInZooKeeper(checkpointOffsets);
}
