{
synchronized (commitedOffsets) {
    if (commitedOffsets[partition] < offset) {
      LOG.info("Committed offsets {}, partition={}, offset={}, locking on {}",Arrays.toString(commitedOffsets),partition,offset,commitedOffsets.hashCode());
      setOffset(zkClient,consumerConfig.groupId(),topicName,partition,offset);
      commitedOffsets[partition]=offset;
    }
 else {
      LOG.debug("Ignoring offset {} for partition {} because it is already committed",offset,partition);
    }
  }
}
