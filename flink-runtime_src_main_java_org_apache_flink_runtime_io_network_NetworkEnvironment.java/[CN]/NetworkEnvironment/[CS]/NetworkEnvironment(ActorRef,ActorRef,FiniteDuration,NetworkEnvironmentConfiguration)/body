{
  this.taskManager=checkNotNull(taskManager);
  this.jobManager=checkNotNull(jobManager);
  this.jobManagerTimeout=checkNotNull(jobManagerTimeout);
  this.partitionManager=new ResultPartitionManager();
  this.taskEventDispatcher=new TaskEventDispatcher();
  this.configuration=checkNotNull(config);
  try {
    networkBufferPool=new NetworkBufferPool(config.numNetworkBuffers(),config.networkBufferSize());
  }
 catch (  Throwable t) {
    throw new IOException("Failed to instantiate network buffer pool: " + t.getMessage(),t);
  }
  final Option<NettyConfig> nettyConfig=config.nettyConfig();
  connectionManager=nettyConfig.isDefined() ? new NettyConnectionManager(nettyConfig.get()) : new LocalConnectionManager();
  try {
    connectionManager.start(partitionManager,taskEventDispatcher,networkBufferPool);
  }
 catch (  Throwable t) {
    throw new IOException("Failed to instantiate network connection manager: " + t.getMessage(),t);
  }
  this.partitionConsumableNotifier=new JobManagerResultPartitionConsumableNotifier(this);
}
