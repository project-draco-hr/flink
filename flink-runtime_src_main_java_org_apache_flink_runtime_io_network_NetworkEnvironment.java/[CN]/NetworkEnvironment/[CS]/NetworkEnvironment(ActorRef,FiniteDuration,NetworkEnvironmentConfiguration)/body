{
  this.jobManager=checkNotNull(jobManager);
  this.jobManagerTimeout=checkNotNull(jobManagerTimeout);
  this.partitionManager=new IntermediateResultPartitionManager();
  this.taskEventDispatcher=new TaskEventDispatcher();
  try {
    networkBufferPool=new NetworkBufferPool(config.numNetworkBuffers(),config.networkBufferSize());
  }
 catch (  Throwable t) {
    throw new IOException("Failed to instantiate network buffer pool: " + t.getMessage(),t);
  }
  final Option<NettyConfig> nettyConfig=config.nettyConfig();
  connectionManager=nettyConfig.isDefined() ? new NettyConnectionManager(nettyConfig.get()) : new LocalConnectionManager();
  try {
    connectionManager.start(partitionManager,taskEventDispatcher);
  }
 catch (  Throwable t) {
    throw new IOException("Failed to instantiate network connection manager: " + t.getMessage(),t);
  }
}
