{
  LOG.debug("Unregistering task {} ({}) from network environment (state: {}).",task.getTaskNameWithSubtasks(),task.getExecutionState());
  final ExecutionAttemptID executionId=task.getExecutionId();
  if (task.isCanceledOrFailed()) {
    partitionManager.releasePartitionsProducedBy(executionId);
  }
  ResultPartitionWriter[] writers=task.getWriters();
  if (writers != null) {
    for (    ResultPartitionWriter writer : task.getWriters()) {
      taskEventDispatcher.unregisterWriter(writer);
    }
  }
  final SingleInputGate[] inputGates=task.getInputGates();
  if (inputGates != null) {
    for (    SingleInputGate gate : inputGates) {
      try {
        if (gate != null) {
          gate.releaseAllResources();
        }
      }
 catch (      IOException e) {
        LOG.error("Error during release of reader resources: " + e.getMessage(),e);
      }
    }
  }
}
