{
  if (!this.subscribedTopics.contains(topic))   throw new IllegalStateException("Topic " + topic + " was never subscribed to.");
  this.subscribedTopics.remove(topic);
  this.needsPartitionAssignment=true;
  for (  TopicPartition tp : assignedPartitions())   if (topic.equals(tp.topic()))   clearPartition(tp);
}
