{
  if (initTimestamp == -1) {
    initTimestamp=record.getTuple(0).getField(windowFieldId);
    nextTimestamp=initTimestamp + computeGranularity;
    tempRecord=new StreamRecord(record.getNumOfFields());
  }
  for (int i=0; i < record.getNumOfTuples(); ++i) {
    while ((Integer)record.getTuple(i).getField(windowFieldId) > nextTimestamp) {
      buffer.add(tempRecord);
      currentRecordNum+=1;
      tempRecord=new StreamRecord(record.getNumOfFields());
    }
    tempRecord.addShadowTuple(record.getTuple(i));
  }
}
