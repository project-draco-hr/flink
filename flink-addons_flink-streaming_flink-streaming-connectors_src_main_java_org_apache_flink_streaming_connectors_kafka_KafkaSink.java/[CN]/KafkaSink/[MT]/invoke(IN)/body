{
  if (!initDone)   initialize();
  OUT out=serialize(tuple);
  KeyedMessage<Integer,OUT> data=new KeyedMessage<Integer,OUT>(topicId,out);
  producer.send(data);
  if (close) {
    producer.close();
  }
}
