{
  if (!initDone) {
    initialize();
  }
  OUT out=serialize(tuple);
  KeyedMessage<Integer,OUT> data=new KeyedMessage<Integer,OUT>(topicId,out);
  if (!closeWithoutSend) {
    producer.send(data);
  }
  if (sendAndClose) {
    producer.close();
  }
}
