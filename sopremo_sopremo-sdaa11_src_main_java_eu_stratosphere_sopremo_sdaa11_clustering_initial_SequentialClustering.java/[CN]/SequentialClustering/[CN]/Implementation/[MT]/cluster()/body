{
  while (this.queue.getNumberOfClusters() > 1) {
    final ClusterPair pair=this.queue.getFirstElement();
    if (pair.getDistance() > maxRadius) {
      break;
    }
    final HierarchicalCluster cluster1=pair.getCluster1();
    final HierarchicalCluster cluster2=pair.getCluster2();
    final HierarchicalCluster mergedCluster=new MergedCluster(cluster1,cluster2,this.createNewId());
    this.queue.removeCluster(cluster1);
    this.queue.removeCluster(cluster2);
    final boolean makeFinal=this.canBeFinal(mergedCluster);
    mergedCluster.makeFinal(makeFinal);
    if (makeFinal)     this.queue.add(mergedCluster);
 else     for (    final HierarchicalCluster child : mergedCluster.getChildren())     this.clusters.add(child);
  }
  this.clusters.addAll(this.queue.getClusters());
  this.queue=null;
}
