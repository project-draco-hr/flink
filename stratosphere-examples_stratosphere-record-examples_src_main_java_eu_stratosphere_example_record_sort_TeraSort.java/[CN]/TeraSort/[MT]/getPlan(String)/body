{
  final int numSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  final String input=(args.length > 1 ? args[1] : "");
  final String output=(args.length > 2 ? args[2] : "");
  final FileDataSource source=new FileDataSource(new TeraInputFormat(),input,"Data Source");
  source.setDegreeOfParallelism(numSubTasks);
  final FileDataSink sink=new FileDataSink(new TeraOutputFormat(),output,"Data Sink");
  sink.setDegreeOfParallelism(numSubTasks);
  sink.setGlobalOrder(new Ordering(0,TeraKey.class,Order.ASCENDING),new TeraDistribution());
  sink.addInput(source);
  return new Plan(sink,"TeraSort");
}
