{
  SopremoPlan actualPlan=parseScript("$oldUsers = read 'oldUsers.json';" + "$currentUsers = read 'currentUsers.json';" + "$newUsers = difference $currentUsers on $currentUsers.id, $oldUsers on $oldUsers.id;"+ "write $newUsers to 'newUsers.json';");
  SopremoPlan expectedPlan=new SopremoPlan();
  Source old=new Source("oldUsers.json");
  Source current=new Source("currentUsers.json");
  Difference difference=new Difference().withInputs(current,old).withIdentityKey(0,JsonUtil.createPath("0","id")).withIdentityKey(1,JsonUtil.createPath("1","id"));
  Sink output=new Sink("newUsers.json").withInputs(difference);
  expectedPlan.setSinks(output);
  assertEquals(expectedPlan,actualPlan);
}
