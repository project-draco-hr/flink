{
  List<Integer> taskIds;
  final int numAtt=this.numberOfAttributes.get(streamId);
  if (numAtt > -1) {
    assert(tuple.size() == numAtt);
    Tuple out=this.outputTuple.get(streamId);
    for (int i=0; i < numAtt; ++i) {
      out.setField(tuple.get(i),i);
    }
    if (this.split) {
      this.splitTuple.streamId=streamId;
      this.splitTuple.value=out;
      taskIds=doEmit((OUT)this.splitTuple);
    }
 else {
      taskIds=doEmit((OUT)out);
    }
  }
 else {
    assert(tuple.size() == 1);
    if (split) {
      this.splitTuple.streamId=streamId;
      this.splitTuple.value=tuple.get(0);
      taskIds=doEmit((OUT)this.splitTuple);
    }
 else {
      taskIds=doEmit((OUT)tuple.get(0));
    }
  }
  this.tupleEmitted=true;
  return taskIds;
}
