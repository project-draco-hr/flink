{
  this.vertex=vertex;
  StreamConfig configuration=new StreamConfig(vertex.getTaskConfiguration());
  this.chainedOperators=new ArrayList<StreamOperator<?>>();
  this.outputMap=new HashMap<StreamEdge,RecordWriterOutput<?>>();
  this.userCodeClassloader=vertex.getUserCodeClassLoader();
  this.chainedConfigs=configuration.getTransitiveChainedTaskConfigs(userCodeClassloader);
  this.chainedConfigs.put(configuration.getVertexID(),configuration);
  List<StreamEdge> outEdgesInOrder=configuration.getOutEdgesInOrder(userCodeClassloader);
  this.reporter=reporter;
  for (  StreamEdge outEdge : outEdgesInOrder) {
    RecordWriterOutput<?> streamOutput=createStreamOutput(outEdge,outEdge.getTargetId(),chainedConfigs.get(outEdge.getSourceId()),outEdgesInOrder.indexOf(outEdge),reporter);
    outputMap.put(outEdge,streamOutput);
  }
  this.outerOutput=createChainedCollector(configuration,accumulatorMap);
  this.chainedOperators.add(vertex.streamOperator);
}
