{
  this.vertex=vertex;
  this.configuration=new StreamConfig(vertex.getTaskConfiguration());
  this.chainedOperators=new ArrayList<StreamOperator<?>>();
  this.outputMap=new HashMap<StreamEdge,StreamOutput<?>>();
  this.cl=vertex.getUserCodeClassLoader();
  this.chainedConfigs=configuration.getTransitiveChainedTaskConfigs(cl);
  this.chainedConfigs.put(configuration.getVertexID(),configuration);
  this.outEdgesInOrder=configuration.getOutEdgesInOrder(cl);
  for (  StreamEdge outEdge : outEdgesInOrder) {
    StreamOutput<?> streamOutput=createStreamOutput(outEdge,outEdge.getTargetId(),chainedConfigs.get(outEdge.getSourceId()),outEdgesInOrder.indexOf(outEdge));
    outputMap.put(outEdge,streamOutput);
  }
  this.outerOutput=createChainedCollector(configuration);
  this.chainedOperators.add(vertex.streamOperator);
}
