{
  final CheckpointMode cpm=CheckpointUtils.getCheckpointMode();
  if (cpm == CheckpointMode.ALWAYS) {
    return CheckpointState.PARTIAL;
  }
 else   if (cpm == CheckpointMode.NEVER) {
    for (int i=0; i < this.forwardLinks.size(); ++i) {
      if (this.forwardLinks.get(i).getChannelType() == ChannelType.FILE) {
        return CheckpointState.PARTIAL;
      }
    }
    final ForceCheckpoint forcedCheckpoint=this.environment.getInvokable().getClass().getAnnotation(ForceCheckpoint.class);
    if (forcedCheckpoint == null) {
      return CheckpointState.NONE;
    }
    if (forcedCheckpoint.checkpoint()) {
      return CheckpointState.PARTIAL;
    }
    return CheckpointState.NONE;
  }
 else   if (cpm == CheckpointMode.NETWORK) {
    for (int i=0; i < this.forwardLinks.size(); ++i) {
      final ChannelType channelType=this.forwardLinks.get(i).getChannelType();
      if (channelType == ChannelType.FILE || channelType == ChannelType.NETWORK) {
        return CheckpointState.PARTIAL;
      }
    }
    final ForceCheckpoint forcedCheckpoint=this.environment.getInvokable().getClass().getAnnotation(ForceCheckpoint.class);
    if (forcedCheckpoint == null) {
      return CheckpointState.NONE;
    }
    if (forcedCheckpoint.checkpoint()) {
      return CheckpointState.PARTIAL;
    }
    return CheckpointState.NONE;
  }
 else {
    for (int i=0; i < this.forwardLinks.size(); ++i) {
      if (this.forwardLinks.get(i).getChannelType() == ChannelType.FILE) {
        return CheckpointState.PARTIAL;
      }
    }
    final ForceCheckpoint forcedCheckpoint=this.environment.getInvokable().getClass().getAnnotation(ForceCheckpoint.class);
    if (forcedCheckpoint == null) {
      return CheckpointState.UNDECIDED;
    }
    if (forcedCheckpoint.checkpoint()) {
      return CheckpointState.PARTIAL;
    }
    return CheckpointState.NONE;
  }
}
