{
  Collection<Node> remainingNodes=new ArrayList<Node>(this.nodes);
  List<Node> usedNodes=new ArrayList<Node>();
  List<Level> levels=new ArrayList<Level>();
  while (!remainingNodes.isEmpty()) {
    List<Node> independentNodes=new ArrayList<Node>();
    for (    Node node : remainingNodes)     if (this.isIndependent(node,usedNodes))     independentNodes.add(node);
    if (independentNodes.isEmpty())     throw new IllegalStateException("graph does not have nodes without input");
    levels.add(new Level(new ArrayList<Node>(independentNodes)));
    remainingNodes.removeAll(independentNodes);
    usedNodes.addAll(independentNodes);
  }
  return levels;
}
