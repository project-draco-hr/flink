{
  if (this.outputFormat == null) {
    TaskConfig cfg=new TaskConfig(getConfiguration());
    UserCodeWrapper<OutputFormat<?>> wrapper=cfg.<OutputFormat<?>>getStubWrapper(loader);
    if (wrapper == null) {
      throw new Exception("No output format present in OutputFormatVertex's task configuration.");
    }
    this.outputFormat=wrapper.getUserCodeObject(OutputFormat.class,loader);
    this.outputFormat.configure(cfg.getStubParameters());
  }
  if (this.outputFormat instanceof InitializeOnMaster) {
    ((InitializeOnMaster)this.outputFormat).initializeGlobal(getParallelism());
  }
}
