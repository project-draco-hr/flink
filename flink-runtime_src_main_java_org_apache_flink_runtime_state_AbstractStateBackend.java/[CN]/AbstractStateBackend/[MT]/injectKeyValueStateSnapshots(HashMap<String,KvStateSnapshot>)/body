{
  if (keyValueStateSnapshots != null) {
    if (keyValueStatesByName == null) {
      keyValueStatesByName=new HashMap<>();
    }
    for (    Map.Entry<String,KvStateSnapshot> state : keyValueStateSnapshots.entrySet()) {
      KvState kvState=state.getValue().restoreState(this,keySerializer,userCodeClassLoader);
      keyValueStatesByName.put(state.getKey(),kvState);
      try {
        StateDescriptor stateDesc=kvState.getStateDescriptor();
        if (stateDesc.isQueryable()) {
          String queryableStateName=stateDesc.getQueryableStateName();
          kvStateRegistry.registerKvState(keyGroupIndex,queryableStateName,kvState);
        }
      }
 catch (      Throwable ignored) {
      }
    }
    keyValueStates=keyValueStatesByName.values().toArray(new KvState[keyValueStatesByName.size()]);
  }
}
