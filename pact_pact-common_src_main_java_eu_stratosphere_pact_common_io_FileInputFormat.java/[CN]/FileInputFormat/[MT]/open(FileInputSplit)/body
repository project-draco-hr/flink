{
  if (!(split instanceof FileInputSplit)) {
    throw new IllegalArgumentException("File Input Formats can only be used with FileInputSplits.");
  }
  final FileInputSplit fileSplit=(FileInputSplit)split;
  fileNumber=Integer.parseInt(split.getPath().getName());
  this.start=fileSplit.getStart();
  this.length=fileSplit.getLength();
  if (LOG.isDebugEnabled())   LOG.debug("Opening input split " + fileSplit.getPath() + " ["+ start+ ","+ length+ "]");
  final InputSplitOpenThread isot=new InputSplitOpenThread(fileSplit,OPEN_TIMEOUT_MILLIES);
  isot.start();
  try {
    isot.waitForCompletion();
  }
 catch (  Throwable t) {
    throw new IOException("Error opening the Input Split " + fileSplit.getPath() + " ["+ start+ ","+ length+ "]: "+ t.getMessage(),t);
  }
  this.stream=isot.getFSDataInputStream();
  this.stream.seek(this.start);
}
