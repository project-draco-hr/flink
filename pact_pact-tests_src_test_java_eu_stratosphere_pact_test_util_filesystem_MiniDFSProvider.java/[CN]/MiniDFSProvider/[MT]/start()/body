{
  deleteDir(getTempDir());
  new FileWriter().dir(getTempDir());
  new FileWriter().dir(getLogDir());
  new FileWriter().dir(getDfsDir());
  new FileWriter().dir(getConfigDir());
  System.setProperty("hadoop.log.dir",getLogDir());
  System.setProperty("test.build.data",getDfsDir());
  cluster=new MiniDFSCluster(NAME_NODE_PORT,new Configuration(),1,true,true,null,null);
  hdfs=cluster.getFileSystem();
  new FileWriter().dir(getConfigDir()).file("hadoop-site.xml").write("<?xml version=\"1.0\" encoding=\"UTF-8\"?>","<?xml-stylesheet href=\"configuration.xsl\" type=\"text/xsl\"?>","<configuration>","   <property>","       <name>fs.default.name</name>","       <value>" + "hdfs://localhost:" + cluster.getNameNodePort() + "</value>","   </property>","   <property>","       <name>dfs.name.dir</name>","       <value>" + getDfsDir() + "/name</value>","   </property>","   <property>","       <name>dfs.data.dir</name>","       <value>" + getDfsDir() + "/data</value>","   </property>","</configuration>").close().file("hadoop-default.xml").write("<?xml version=\"1.0\" encoding=\"UTF-8\"?>","<?xml-stylesheet href=\"configuration.xsl\" type=\"text/xsl\"?>","<configuration>","</configuration>").close();
}
