{
  resp.setContentType("application/json");
  String jobName=req.getParameter(JOB_PARAM_NAME);
  if (jobName == null) {
    LOG.warn("Received request without job parameter name.");
    resp.setStatus(HttpServletResponse.SC_BAD_REQUEST);
    return;
  }
  File jarFile=new File(jobStoreDirectory,jobName);
  if (!jarFile.exists()) {
    LOG.warn("Received request for non-existing jar file.");
    resp.setStatus(HttpServletResponse.SC_BAD_REQUEST);
    return;
  }
  PackagedProgram pactProgram;
  try {
    pactProgram=new PackagedProgram(jarFile,req.getParameter(CLASS_PARAM_NAME),new String[0]);
  }
 catch (  Throwable t) {
    LOG.info("Instantiating the PactProgram for '" + jarFile.getName() + "' failed.",t);
    resp.setStatus(HttpServletResponse.SC_BAD_REQUEST);
    resp.getWriter().print(t.getMessage());
    return;
  }
  String jsonPlan=null;
  String programDescription=null;
  try {
    jsonPlan=pactProgram.getPreviewPlan();
  }
 catch (  Throwable t) {
    LOG.error("Failed to create json dump of pact program.",t);
  }
  try {
    programDescription=pactProgram.getDescription();
  }
 catch (  Throwable t) {
    LOG.error("Failed to create description of pact program.",t);
  }
  if (jsonPlan == null && programDescription == null) {
    resp.setStatus(HttpServletResponse.SC_BAD_REQUEST);
    return;
  }
 else {
    resp.setStatus(HttpServletResponse.SC_OK);
    PrintWriter wrt=resp.getWriter();
    wrt.print("{ \"jobname\": \"");
    wrt.print(jobName);
    if (jsonPlan != null) {
      wrt.print("\", \"plan\": ");
      wrt.println(jsonPlan);
    }
    if (programDescription != null) {
      wrt.print(", \"description\": \"");
      wrt.print(escapeString(programDescription));
      wrt.print("\"");
    }
    wrt.println("}");
  }
}
