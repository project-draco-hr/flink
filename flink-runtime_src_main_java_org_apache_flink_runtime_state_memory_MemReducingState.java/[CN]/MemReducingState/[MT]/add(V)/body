{
  if (currentKey == null) {
    throw new RuntimeException("No key available.");
  }
  if (currentNSState == null) {
    currentNSState=new HashMap<>();
    state.put(currentNamespace,currentNSState);
  }
  V currentValue=currentNSState.get(currentKey);
  if (currentValue == null) {
    currentNSState.put(currentKey,value);
  }
 else {
    try {
      currentNSState.put(currentKey,reduceFunction.reduce(currentValue,value));
    }
 catch (    Exception e) {
      throw new RuntimeException("Could not add value to reducing state.",e);
    }
  }
}
