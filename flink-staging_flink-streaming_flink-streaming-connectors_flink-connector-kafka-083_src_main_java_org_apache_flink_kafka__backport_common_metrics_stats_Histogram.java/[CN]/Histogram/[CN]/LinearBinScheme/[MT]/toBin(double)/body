{
  if (x < 0.0d) {
    throw new IllegalArgumentException("Values less than 0.0 not accepted.");
  }
 else   if (x > this.max) {
    return this.bins - 1;
  }
 else {
    double scaled=x / this.scale;
    return (int)(-0.5 + Math.sqrt(2.0 * scaled + 0.25));
  }
}
