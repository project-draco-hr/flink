{
  if (this.globalProps == null) {
    this.globalProps=this.source.getGlobalProperties().clone();
switch (this.shipStrategy) {
case BROADCAST:
      this.globalProps.setFullyReplicated();
    break;
case PARTITION_HASH:
case PARTITION_LOCAL_HASH:
  this.globalProps.setHashPartitioned(this.shipKeys);
break;
case PARTITION_RANGE:
case PARTITION_LOCAL_RANGE:
this.globalProps.setRangePartitioned(Utils.createOrdering(this.shipKeys,this.shipSortOrder));
break;
case FORWARD:
break;
case NONE:
throw new CompilerException("Cannot produce GlobalProperties before ship strategy is set.");
default :
throw new CompilerException("Unrecognized ship strategy: " + this.shipStrategy);
}
}
return this.globalProps;
}
