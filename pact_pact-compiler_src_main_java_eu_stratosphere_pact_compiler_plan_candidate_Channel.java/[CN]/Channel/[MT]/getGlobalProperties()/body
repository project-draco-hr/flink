{
  if (this.globalProps == null) {
    this.globalProps=this.source.getGlobalProperties().clone();
switch (this.shipStrategy) {
case BROADCAST:
      this.globalProps.clearUniqueFieldCombinations();
    this.globalProps.setFullyReplicated();
  break;
case PARTITION_HASH:
this.globalProps.setHashPartitioned(this.shipKeys);
break;
case PARTITION_RANGE:
this.globalProps.setRangePartitioned(Utils.createOrdering(this.shipKeys,this.shipSortOrder));
break;
case FORWARD:
break;
case PARTITION_RANDOM:
this.globalProps.reset();
break;
case PARTITION_LOCAL_HASH:
if (getSource().getGlobalProperties().isPartitionedOnFields(this.shipKeys)) {
this.globalProps.setAnyPartitioning(this.shipKeys);
}
 else {
this.globalProps.reset();
}
break;
case NONE:
throw new CompilerException("Cannot produce GlobalProperties before ship strategy is set.");
}
}
return this.globalProps;
}
