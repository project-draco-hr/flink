{
  if (this.globalProps == null) {
    this.globalProps=this.source.getGlobalProperties().clone();
switch (this.shipStrategy) {
case BROADCAST:
      this.globalProps.setFullyReplicated();
    break;
case PARTITION_HASH:
case PARTITION_LOCAL_HASH:
  this.globalProps.setHashPartitioned(this.shipKeys);
break;
case PARTITION_RANGE:
case PARTITION_LOCAL_RANGE:
Ordering o=new Ordering();
for (int i=0; i < this.shipKeys.size(); i++) {
o.appendOrdering(this.shipKeys.get(i),null,this.shipSortOrder == null || this.shipSortOrder[i] ? Order.ASCENDING : Order.DESCENDING);
}
this.globalProps.setRangePartitioned(o);
break;
case FORWARD:
break;
case NONE:
throw new CompilerException("Cannot produce GlobalProperties before ship strategy is set.");
}
}
return this.globalProps;
}
