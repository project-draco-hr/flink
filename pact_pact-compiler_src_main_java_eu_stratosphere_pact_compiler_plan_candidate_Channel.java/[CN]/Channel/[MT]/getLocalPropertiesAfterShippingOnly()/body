{
  if (this.shipStrategy == ShipStrategyType.FORWARD) {
    return this.source.getLocalProperties();
  }
 else {
    final LocalProperties props=this.source.getLocalProperties().clone();
switch (this.shipStrategy) {
case BROADCAST:
case PARTITION_HASH:
case PARTITION_RANGE:
case PARTITION_RANDOM:
      props.reset();
    break;
case PARTITION_LOCAL_HASH:
case FORWARD:
  break;
case NONE:
throw new CompilerException("ShipStrategy has not yet been set.");
}
return props;
}
}
