{
  if (this.shipStrategy == ShipStrategyType.FORWARD) {
    return this.source.getLocalProperties();
  }
 else {
    final LocalProperties props=this.source.getLocalProperties().clone();
switch (this.shipStrategy) {
case BROADCAST:
case PARTITION_HASH:
case PARTITION_RANGE:
case PARTITION_LOCAL_HASH:
case PARTITION_LOCAL_RANGE:
      props.reset();
    break;
case NONE:
  throw new CompilerException("ShipStrategy has not yet been set.");
default :
throw new CompilerException();
}
return props;
}
}
