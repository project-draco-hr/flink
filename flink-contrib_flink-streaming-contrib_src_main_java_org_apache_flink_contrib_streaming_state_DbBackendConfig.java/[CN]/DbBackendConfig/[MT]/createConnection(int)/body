{
  validateShardIndex(shardIndex);
  if (JDBCDriver != null) {
    try {
      Class.forName(JDBCDriver);
    }
 catch (    ClassNotFoundException e) {
      throw new RuntimeException("Could not load JDBC driver class",e);
    }
  }
  return DriverManager.getConnection(getShardUrl(shardIndex),userName,userPassword);
}
