{
  if (JDBCDriver != null) {
    try {
      Class.forName(JDBCDriver);
    }
 catch (    ClassNotFoundException e) {
      throw new RuntimeException("Could not load JDBC driver class",e);
    }
  }
  if (shardPartitioner == null) {
    return new ShardedConnection(shardUrls,userName,userPassword);
  }
 else {
    return new ShardedConnection(shardUrls,userName,userPassword,shardPartitioner);
  }
}
