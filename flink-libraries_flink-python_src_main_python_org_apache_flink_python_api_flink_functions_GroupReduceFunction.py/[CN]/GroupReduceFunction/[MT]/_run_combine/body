def _run_combine(self):
    connection = self._connection
    collector = self._collector
    function = self.combine
    iterator = self._iterator
    while 1:
        result = function(iterator, collector)
        if (result is not None):
            for value in result:
                collector.collect(value)
        connection.send_end_signal()
        connection.reset()
