{
  for (int targetChannel=0; targetChannel < numChannels; targetChannel++) {
    RecordSerializer<T> serializer=serializers[targetChannel];
synchronized (serializer) {
      Buffer buffer=serializer.getCurrentBuffer();
      if (buffer == null) {
        writer.writeEvent(event,targetChannel);
      }
 else {
        writer.writeBuffer(buffer,targetChannel);
        writer.writeEvent(event,targetChannel);
        buffer=writer.getBufferProvider().requestBufferBlocking();
        serializer.setNextBuffer(buffer);
      }
    }
  }
}
