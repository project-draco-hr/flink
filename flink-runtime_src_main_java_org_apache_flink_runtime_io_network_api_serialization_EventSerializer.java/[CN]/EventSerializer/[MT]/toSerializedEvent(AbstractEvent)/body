{
  try {
    final DataOutputSerializer serializer=new DataOutputSerializer(128);
    serializer.writeUTF(event.getClass().getName());
    event.write(serializer);
    return serializer.wrapAsByteBuffer();
  }
 catch (  IOException e) {
    throw new RuntimeException("Error while serializing event.",e);
  }
}
