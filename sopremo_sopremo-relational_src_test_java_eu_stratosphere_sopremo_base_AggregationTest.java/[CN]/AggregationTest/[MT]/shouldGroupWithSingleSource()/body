{
  SopremoTestPlan sopremoPlan=new SopremoTestPlan(1,1);
  sopremoPlan.getEvaluationContext().getFunctionRegistry().register(BuiltinFunctions.class);
  ObjectCreation transformation=new ObjectCreation();
  transformation.addMapping("d",createPath("[0]","dept"));
  transformation.addMapping("total",new FunctionCall("sum",createPath("[*]","income")));
  Aggregation aggregation=new Aggregation(transformation,sopremoPlan.getInputOperator(0));
  aggregation.setKeyProjection(0,createPath("dept"));
  sopremoPlan.getOutputOperator(0).setInputs(aggregation);
  sopremoPlan.getInput(0).add(createPactJsonObject("id",1,"dept",1,"income",12000)).add(createPactJsonObject("id",2,"dept",1,"income",13000)).add(createPactJsonObject("id",3,"dept",2,"income",15000)).add(createPactJsonObject("id",4,"dept",1,"income",10000)).add(createPactJsonObject("id",5,"dept",3,"income",8000)).add(createPactJsonObject("id",6,"dept",2,"income",5000)).add(createPactJsonObject("id",7,"dept",1,"income",24000));
  sopremoPlan.getExpectedOutput(0).add(createPactJsonObject("d",1,"total",59000)).add(createPactJsonObject("d",2,"total",20000)).add(createPactJsonObject("d",3,"total",8000));
  sopremoPlan.run();
}
