{
  this.task=task;
  int nooc=0;
  final RuntimeEnvironment environment=task.getRuntimeEnvironment();
  for (int i=0; i < environment.getNumberOfOutputGates(); ++i) {
    nooc+=environment.getOutputGate(i).getNumberOfOutputChannels();
  }
  this.numberOfConnectedChannels=nooc;
  this.checkpointingDecision=(ephemeral ? CheckpointingDecisionState.UNDECIDED : CheckpointingDecisionState.CHECKPOINTING);
  this.asynchronousCheckpointingDecision=this.checkpointingDecision;
  this.fileBufferManager=FileBufferManager.getInstance();
  if (LOG.isDebugEnabled())   LOG.debug("Created checkpoint for vertex " + task.getVertexID() + ", state "+ this.checkpointingDecision);
  if (this.checkpointingDecision == CheckpointingDecisionState.CHECKPOINTING) {
    this.task.checkpointStateChanged(CheckpointState.PARTIAL);
  }
}
