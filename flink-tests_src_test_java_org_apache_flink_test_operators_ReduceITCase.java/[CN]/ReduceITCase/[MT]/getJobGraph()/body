{
  FileDataSource input=new FileDataSource(new ContractITCaseInputFormat(),inPath);
  DelimitedInputFormat.configureDelimitedFormat(input).recordDelimiter('\n');
  input.setParallelism(config.getInteger("ReduceTest#NoSubtasks",1));
  ReduceOperator testReducer=ReduceOperator.builder(new TestReducer(),StringValue.class,0).build();
  testReducer.setParallelism(config.getInteger("ReduceTest#NoSubtasks",1));
  testReducer.getParameters().setString(Optimizer.HINT_LOCAL_STRATEGY,config.getString("ReduceTest#LocalStrategy",""));
  testReducer.getParameters().setString(Optimizer.HINT_SHIP_STRATEGY,config.getString("ReduceTest#ShipStrategy",""));
  FileDataSink output=new FileDataSink(new ContractITCaseOutputFormat(),resultPath);
  output.setParallelism(1);
  output.setInput(testReducer);
  testReducer.setInput(input);
  Plan plan=new Plan(output);
  plan.setExecutionConfig(new ExecutionConfig());
  Optimizer pc=new Optimizer(new DataStatistics(),this.config);
  OptimizedPlan op=pc.compile(plan);
  JobGraphGenerator jgg=new JobGraphGenerator();
  return jgg.compileJobGraph(op);
}
