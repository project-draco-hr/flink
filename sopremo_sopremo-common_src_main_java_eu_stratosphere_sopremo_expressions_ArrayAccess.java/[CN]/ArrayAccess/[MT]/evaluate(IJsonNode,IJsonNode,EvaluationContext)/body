{
  if (!node.isArray())   return MissingNode.getInstance();
  final IArrayNode arrayNode=(IArrayNode)node;
  if (this.isSelectingAll()) {
    final IArrayNode targetArray=SopremoUtil.reinitializeTarget(target,ArrayNode.class);
    targetArray.addAll(arrayNode);
    return targetArray;
  }
  final int size=arrayNode.size();
  if (this.isSelectingRange()) {
    final IArrayNode targetArray=SopremoUtil.reinitializeTarget(target,ArrayNode.class);
    int index=this.resolveIndex(this.startIndex,size);
    final int endIndex=this.resolveIndex(this.endIndex,size);
    final int increment=index < endIndex ? 1 : -1;
    for (boolean moreElements=true; moreElements; index+=increment) {
      targetArray.add(arrayNode.get(index));
      moreElements=index != endIndex;
    }
    return targetArray;
  }
  final IJsonNode value=arrayNode.get(this.resolveIndex(this.startIndex,size));
  return value == null ? NullNode.getInstance() : value;
}
