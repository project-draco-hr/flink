{
  final Lookup lookup=new Lookup();
  lookup.setInputKeyExtractor(new ObjectAccess("fieldToReplace"));
  lookup.setDictionaryKeyExtraction(new ArrayAccess(0));
  lookup.setDictionaryValueExtraction(new ArrayAccess(1));
  lookup.setDefaultExpression(new FunctionCall("format",new ConstantExpression("default %s"),EvaluationExpression.VALUE));
  final SopremoTestPlan sopremoPlan=new SopremoTestPlan(lookup);
  sopremoPlan.getEvaluationContext().getFunctionRegistry().register(BuiltinFunctions.class);
  sopremoPlan.getInput(0).add(createPactJsonObject("field1",1,"fieldToReplace","key1","field2",2)).add(createPactJsonObject("field1",2,"fieldToReplace","notInList","field2",2)).add(createPactJsonObject("field1",3,"fieldToReplace","key2","field2",2)).add(createPactJsonObject("field1",4,"fieldToReplace","notInList2","field2",2));
  sopremoPlan.getInput(1).add(createPactJsonArray("key1","value1")).add(createPactJsonArray("key2","value2")).add(createPactJsonArray("key3","value3"));
  sopremoPlan.getExpectedOutput(0).add(createPactJsonObject("field1",1,"fieldToReplace","value1","field2",2)).add(createPactJsonObject("field1",2,"fieldToReplace","default notInList","field2",2)).add(createPactJsonObject("field1",3,"fieldToReplace","value2","field2",2)).add(createPactJsonObject("field1",4,"fieldToReplace","default notInList2","field2",2));
  sopremoPlan.run();
}
