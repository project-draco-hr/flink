{
  @SuppressWarnings("unchecked") final PactRecordComparator multiComp=new PactRecordComparator(new int[]{0,1,3},new Class[]{PactInteger.class,PactString.class,PactDouble.class});
  final ChannelSelector<PactRecord> oe1=new PactRecordOutputEmitter(ShipStrategyType.PARTITION_HASH,multiComp);
  int numChannels=100;
  int numRecords=5000;
  int[] hit=new int[numChannels];
  for (int i=0; i < numRecords; i++) {
    PactRecord rec=new PactRecord(4);
    rec.setField(0,new PactInteger(i));
    rec.setField(1,new PactString("AB" + i + "CD"+ i));
    rec.setField(3,new PactDouble(i * 3.141d));
    int[] chans=oe1.selectChannels(rec,hit.length);
    for (int j=0; j < chans.length; j++) {
      hit[chans[j]]++;
    }
  }
  int cnt=0;
  for (int i=0; i < hit.length; i++) {
    assertTrue(hit[i] > 0);
    cnt+=hit[i];
  }
  assertTrue(cnt == numRecords);
}
