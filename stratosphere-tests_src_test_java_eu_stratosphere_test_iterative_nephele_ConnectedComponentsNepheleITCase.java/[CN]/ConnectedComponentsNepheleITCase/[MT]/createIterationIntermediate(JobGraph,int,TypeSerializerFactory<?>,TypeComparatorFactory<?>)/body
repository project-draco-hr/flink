{
  JobTaskVertex intermediate=JobGraphUtils.createTask(IterationIntermediatePactTask.class,"Find Min Component-ID",jobGraph,numSubTasks,numSubTasks);
  TaskConfig intermediateConfig=new TaskConfig(intermediate.getConfiguration());
{
    intermediateConfig.setIterationId(ITERATION_ID);
    intermediateConfig.addInputToGroup(0);
    intermediateConfig.setInputSerializer(serializer,0);
    intermediateConfig.setInputComparator(comparator,0);
    intermediateConfig.setInputLocalStrategy(0,LocalStrategy.SORT);
    intermediateConfig.setMemoryInput(0,MEM_PER_CONSUMER * JobGraphUtils.MEGABYTE);
    intermediateConfig.setFilehandlesInput(0,64);
    intermediateConfig.setSpillingThresholdInput(0,0.85f);
    intermediateConfig.setOutputSerializer(serializer);
    intermediateConfig.addOutputShipStrategy(ShipStrategyType.FORWARD);
    intermediateConfig.setDriver(GroupReduceDriver.class);
    intermediateConfig.setDriverStrategy(DriverStrategy.SORTED_GROUP);
    intermediateConfig.setDriverComparator(comparator,0);
    intermediateConfig.setStubWrapper(new UserCodeClassWrapper<MinimumComponentIDReduce>(MinimumComponentIDReduce.class));
  }
  return intermediate;
}
