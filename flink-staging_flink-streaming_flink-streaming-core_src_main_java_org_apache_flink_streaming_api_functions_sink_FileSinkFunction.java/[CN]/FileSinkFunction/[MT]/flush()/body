{
  try {
    for (    IN rec : tupleList) {
      format.writeRecord(rec);
    }
  }
 catch (  Exception ex) {
    try {
      if (LOG.isErrorEnabled()) {
        LOG.error("Error while writing element.",ex);
      }
      if (!cleanupCalled && format instanceof CleanupWhenUnsuccessful) {
        cleanupCalled=true;
        ((CleanupWhenUnsuccessful)format).tryCleanupOnError();
      }
    }
 catch (    Throwable t) {
      LOG.error("Cleanup on error failed.",t);
    }
    throw new RuntimeException(ex);
  }
  resetParameters();
}
