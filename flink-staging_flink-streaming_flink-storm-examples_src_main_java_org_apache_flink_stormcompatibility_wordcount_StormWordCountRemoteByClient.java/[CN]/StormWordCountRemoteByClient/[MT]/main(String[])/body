{
  if (!WordCountTopology.parseParameters(args)) {
    return;
  }
  final FlinkTopologyBuilder builder=WordCountTopology.buildTopology();
  final Config conf=new Config();
  conf.put(Config.NIMBUS_HOST,"localhost");
  conf.put(Config.NIMBUS_THRIFT_PORT,new Integer(6123));
  final FlinkClient cluster=FlinkClient.getConfiguredClient(conf);
  cluster.submitTopology(topologyId,uploadedJarLocation,null,builder.createTopology());
  Utils.sleep(5 * 1000);
  cluster.killTopology(topologyId);
}
