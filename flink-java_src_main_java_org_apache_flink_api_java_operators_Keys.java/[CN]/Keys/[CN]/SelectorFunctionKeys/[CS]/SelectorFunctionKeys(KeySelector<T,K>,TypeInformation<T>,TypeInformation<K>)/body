{
  if (keyExtractor == null) {
    throw new NullPointerException("Key extractor must not be null.");
  }
  if (keyType == null) {
    throw new NullPointerException("Key type must not be null.");
  }
  this.keyExtractor=keyExtractor;
  this.keyType=keyType;
  if (!keyType.isKeyType()) {
    throw new InvalidProgramException("Return type " + keyType + " of KeySelector "+ keyExtractor.getClass()+ " is not a valid key type");
  }
  if (keyType instanceof CompositeType) {
    ExpressionKeys<K> ek=new ExpressionKeys<K>(new String[]{ExpressionKeys.SELECT_ALL_CHAR},keyType);
    logicalKeyFields=ek.computeLogicalKeyPositions();
  }
 else {
    logicalKeyFields=new int[]{0};
  }
}
