{
  if (keyExtractor == null) {
    throw new NullPointerException("Key extractor must not be null.");
  }
  if (keyType == null) {
    throw new NullPointerException("Key type must not be null.");
  }
  this.keyExtractor=keyExtractor;
  this.keyType=keyType;
  if (keyType.isTupleType()) {
    ExpressionKeys<K> ek=new ExpressionKeys<K>(new String[]{ExpressionKeys.SELECT_ALL_CHAR},keyType);
    logicalKeyFields=ek.computeLogicalKeyPositions();
  }
 else {
    logicalKeyFields=new int[]{0};
  }
  if (!this.keyType.isKeyType()) {
    throw new IllegalArgumentException("Invalid type of KeySelector keys");
  }
}
