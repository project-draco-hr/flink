{
  int numTuple=record.getNumOfTuples();
  for (int i=0; i < numTuple; ++i) {
    word=record.getString(i,0);
    count=record.getInteger(i,1);
    timestamp=record.getLong(i,2);
    if (wordCounts.containsKey(word)) {
      count=wordCounts.get(word) + 1;
      wordCounts.put(word,count);
    }
 else {
      count=1;
      wordCounts.put(word,1);
    }
  }
  MutableTableStateIterator<String,Integer> iterator=wordCounts.getIterator();
  while (iterator.hasNext()) {
    Tuple2<String,Integer> tuple=iterator.next();
    Tuple3<String,Integer,Long> outputTuple=new Tuple3<String,Integer,Long>((String)tuple.getField(0),(Integer)tuple.getField(1),timestamp);
    outRecord.addTuple(outputTuple);
  }
  emit(outRecord);
}
