{
  SQLRetrier.retry(new Callable<Void>(){
    public Void call() throws Exception {
      con.setAutoCommit(false);
      for (      Tuple2<byte[],byte[]> kv : toInsert) {
        setKVInsertParams(stateId,insertStatement,checkpointTs,kv.f0,kv.f1);
        insertStatement.addBatch();
      }
      insertStatement.executeBatch();
      con.commit();
      con.setAutoCommit(true);
      insertStatement.clearBatch();
      return null;
    }
  }
,new Callable<Void>(){
    public Void call() throws Exception {
      con.rollback();
      insertStatement.clearBatch();
      return null;
    }
  }
,conf.getMaxNumberOfSqlRetries(),conf.getSleepBetweenSqlRetries());
}
