{
  final byte[] buf=new byte[SEND_BUFFER];
  final MultiPacketOutputStream mbos=new MultiPacketOutputStream(buf);
  while (!this.shutdownRequested) {
    SendingRequest sendingRequest=null;
    try {
      sendingRequest=this.msgQueue.take();
    }
 catch (    InterruptedException ie) {
      if (this.shutdownRequested) {
        return;
      }
 else {
        continue;
      }
    }
    mbos.reset();
    final Output output=new Output(mbos);
    final Kryo kryo=RPCService.createKryoObject();
    kryo.writeObject(output,new RPCEnvelope(sendingRequest.rpcMessage));
    output.close();
    mbos.close();
    final DatagramPacket[] packets=mbos.createPackets(sendingRequest.remoteSocketAddress);
    try {
      for (int i=0; i < packets.length; ++i) {
        this.socket.send(packets[i]);
      }
    }
 catch (    IOException ioe) {
      Log.error("Shutting down sender thread due to error: ",ioe);
      return;
    }
  }
}
