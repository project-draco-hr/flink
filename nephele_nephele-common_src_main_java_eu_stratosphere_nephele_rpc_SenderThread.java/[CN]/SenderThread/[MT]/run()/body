{
  final Kryo kryo=RPCService.createKryoObject();
  final byte[] buf=new byte[SEND_BUFFER];
  final MultiPacketOutputStream mbos=new MultiPacketOutputStream(buf);
  while (!this.shutdownRequested) {
    SendingRequest sendingRequest=null;
    try {
      sendingRequest=this.msgQueue.take();
    }
 catch (    InterruptedException ie) {
      if (this.shutdownRequested) {
        return;
      }
 else {
        continue;
      }
    }
    mbos.reset();
    final Output output=new Output(mbos);
    kryo.writeObject(output,new RPCEnvelope(sendingRequest.rpcMessage));
    output.close();
    mbos.close();
    try {
      mbos.sendPackets(this.socket,sendingRequest.remoteSocketAddress,sendingRequest.rpcMessage.getRequestID());
    }
 catch (    IOException ioe) {
      Log.error("Shutting down sender thread due to error: ",ioe);
      return;
    }
  }
}
