{
  YarnClient yarnClient=YarnClient.createYarnClient();
  yarnClient.init(yarnConfiguration);
  yarnClient.start();
  List<ApplicationReport> apps=yarnClient.getApplications();
  for (  ApplicationReport app : apps) {
    if (app.getYarnApplicationState() != YarnApplicationState.FINISHED) {
      Assert.fail("There is at least one application on the cluster is not finished");
    }
  }
}
