from flink.plan.Environment import get_environment
from flink.functions.MapFunction import MapFunction
from flink.functions.MapPartitionFunction import MapPartitionFunction
from flink.plan.Constants import BOOL, INT, FLOAT, STRING, BYTES
if (__name__ == '__main__'):
    env = get_environment()
    d1 = env.from_elements(bytearray('hello'), bytearray('world'))
    d1.map(Id(), BYTES).map_partition(Verify([bytearray('hello'), bytearray('world')], 'Byte'), STRING).output()
    d2 = env.from_elements(1, 2, 3, 4, 5)
    d2.map(Id(), INT).map_partition(Verify([1, 2, 3, 4, 5], 'Int'), STRING).output()
    d3 = env.from_elements(True, True, False)
    d3.map(Id(), BOOL).map_partition(Verify([True, True, False], 'Bool'), STRING).output()
    d4 = env.from_elements(1.4, 1.7, 12312.23)
    d4.map(Id(), FLOAT).map_partition(Verify([1.4, 1.7, 12312.23], 'Float'), STRING).output()
    d5 = env.from_elements('hello', 'world')
    d5.map(Id(), STRING).map_partition(Verify(['hello', 'world'], 'String'), STRING).output()
    env.set_degree_of_parallelism(1)
    env.execute(local=True)
