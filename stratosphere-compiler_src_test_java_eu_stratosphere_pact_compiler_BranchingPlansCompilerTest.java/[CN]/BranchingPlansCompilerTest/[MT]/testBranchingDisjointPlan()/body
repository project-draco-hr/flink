{
  final String out1Path="file:///test/1";
  final String out2Path="file:///test/2";
  final String out3Path="file:///test/3";
  final String out4Path="file:///test/4";
  FileDataSource sourceA=new FileDataSource(DummyInputFormat.class,IN_FILE);
  FileDataSource sourceB=new FileDataSource(DummyInputFormat.class,IN_FILE);
  FileDataSink sink1=new FileDataSink(DummyOutputFormat.class,out1Path,sourceA,"1");
  FileDataSink sink2=new FileDataSink(DummyOutputFormat.class,out2Path,sourceB,"2");
  FileDataSink sink3=new FileDataSink(DummyOutputFormat.class,out3Path,sourceA,"3");
  FileDataSink sink4=new FileDataSink(DummyOutputFormat.class,out4Path,sourceB,"4");
  List<FileDataSink> sinks=new ArrayList<FileDataSink>();
  sinks.add(sink1);
  sinks.add(sink2);
  sinks.add(sink3);
  sinks.add(sink4);
  Plan plan=new Plan(sinks,"Disjoint plan with multiple data sinks and branches");
  try {
    compileNoStats(plan);
    Assert.fail("Plan must not be compilable, it contains disjoint sub-plans.");
  }
 catch (  Exception ex) {
  }
}
