{
  LOG.debug("JobManager shutdown requested");
  if (!this.isShutdownInProgress.compareAndSet(false,true)) {
    return;
  }
  if (this.instanceManager != null) {
    this.instanceManager.shutdown();
  }
  if (this.profiler != null) {
    this.profiler.shutdown();
  }
  if (this.jobManagerServer != null) {
    this.jobManagerServer.stop();
  }
  if (this.executorService != null) {
    this.executorService.shutdown();
    try {
      this.executorService.awaitTermination(5000L,TimeUnit.MILLISECONDS);
    }
 catch (    InterruptedException e) {
      LOG.debug("Got interrupted while waiting for the executor service to shutdown.",e);
    }
  }
  if (this.eventCollector != null) {
    this.eventCollector.shutdown();
  }
  if (this.scheduler != null) {
    this.scheduler.shutdown();
  }
  if (server != null) {
    try {
      server.stop();
    }
 catch (    Exception e) {
      LOG.error("Error while shutting down the JobManager's webserver",e);
    }
  }
  this.isShutDown=true;
  LOG.debug("Shutdown of job manager completed");
}
