{
  try {
    if (job == null) {
      return new JobSubmissionResult(AbstractJobResult.ReturnCode.ERROR,"Submitted job is null!");
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("Submitted job " + job.getName() + " is not null");
    }
    AbstractJobVertex jv=job.findVertexWithNullEdges();
    if (jv != null) {
      JobSubmissionResult result=new JobSubmissionResult(AbstractJobResult.ReturnCode.ERROR,"Vertex " + jv.getName() + " has at least one null edge");
      return result;
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("Submitted job " + job.getName() + " has no null edges");
    }
    if (!job.isWeaklyConnected()) {
      JobSubmissionResult result=new JobSubmissionResult(AbstractJobResult.ReturnCode.ERROR,"Job graph is not weakly connected");
      return result;
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("The graph of job " + job.getName() + " is weakly connected");
    }
    if (!job.isAcyclic()) {
      JobSubmissionResult result=new JobSubmissionResult(AbstractJobResult.ReturnCode.ERROR,"Job graph is not a DAG");
      return result;
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("The graph of job " + job.getName() + " is acyclic");
    }
    jv=job.areVertexDegreesCorrect();
    if (jv != null) {
      JobSubmissionResult result=new JobSubmissionResult(AbstractJobResult.ReturnCode.ERROR,"Degree of vertex " + jv.getName() + " is incorrect");
      return result;
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("All vertices of job " + job.getName() + " have the correct degree");
    }
    if (!job.isInstanceDependencyChainAcyclic()) {
      JobSubmissionResult result=new JobSubmissionResult(AbstractJobResult.ReturnCode.ERROR,"The dependency chain for instance sharing contains a cycle");
      return result;
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("The dependency chain for instance sharing is acyclic");
    }
    LOG.info("Creating initial execution graph from job graph " + job.getName());
    ExecutionGraph eg;
    try {
      eg=new ExecutionGraph(job,1);
    }
 catch (    GraphConversionException e) {
      if (e.getCause() == null) {
        return new JobSubmissionResult(AbstractJobResult.ReturnCode.ERROR,StringUtils.stringifyException(e));
      }
 else {
        Throwable t=e.getCause();
        if (t instanceof FileNotFoundException) {
          return new JobSubmissionResult(AbstractJobResult.ReturnCode.ERROR,t.getMessage());
        }
 else {
          return new JobSubmissionResult(AbstractJobResult.ReturnCode.ERROR,StringUtils.stringifyException(t));
        }
      }
    }
    if (this.eventCollector != null) {
      this.eventCollector.registerJob(eg,false,System.currentTimeMillis());
    }
    eg.registerJobStatusListener(this);
    if (LOG.isInfoEnabled()) {
      LOG.info("Scheduling job " + job.getName());
    }
    try {
      this.scheduler.scheduleJob(eg);
    }
 catch (    SchedulingException e) {
      unregisterJob(eg);
      JobSubmissionResult result=new JobSubmissionResult(AbstractJobResult.ReturnCode.ERROR,StringUtils.stringifyException(e));
      return result;
    }
    return new JobSubmissionResult(AbstractJobResult.ReturnCode.SUCCESS,null);
  }
 catch (  Throwable t) {
    LOG.error("Job submission failed.",t);
    return new JobSubmissionResult(AbstractJobResult.ReturnCode.ERROR,StringUtils.stringifyException(t));
  }
}
