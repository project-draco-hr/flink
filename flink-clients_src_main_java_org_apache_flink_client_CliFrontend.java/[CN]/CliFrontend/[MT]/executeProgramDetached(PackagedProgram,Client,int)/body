{
  JobSubmissionResult result;
  try {
    result=client.runDetached(program,parallelism);
  }
 catch (  ProgramInvocationException e) {
    return handleError(e);
  }
 finally {
    program.deleteExtractedLibraries();
  }
  if (result != null) {
    if (yarnCluster != null && yarnCluster.isDetached()) {
      yarnCluster.stopAfterJob(result.getJobID());
      yarnCluster.disconnect();
      if (!webFrontend) {
        System.out.println("The Job has been submitted with JobID " + result.getJobID());
      }
      return 0;
    }
 else {
      throw new RuntimeException("Error while starting job. No Job ID set.");
    }
  }
  return 0;
}
