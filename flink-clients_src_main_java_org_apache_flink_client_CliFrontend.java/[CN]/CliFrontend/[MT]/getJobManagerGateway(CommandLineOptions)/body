{
  updateConfig(options);
  if (this.actorSystem == null) {
    LOG.info("Starting actor system to communicate with JobManager");
    try {
      scala.Tuple2<String,Object> systemEndpoint=new scala.Tuple2<String,Object>("",0);
      this.actorSystem=AkkaUtils.createActorSystem(config,new Some<scala.Tuple2<String,Object>>(systemEndpoint));
    }
 catch (    Exception e) {
      throw new IOException("Could not start actor system to communicate with JobManager",e);
    }
    LOG.info("Actor system successfully started");
  }
  LOG.info("Trying to lookup the JobManager gateway");
  LeaderRetrievalService lrs=LeaderRetrievalUtils.createLeaderRetrievalService(config);
  return LeaderRetrievalUtils.retrieveLeaderGateway(lrs,actorSystem,lookupTimeout);
}
