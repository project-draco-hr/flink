{
  if (options.getJobManagerAddress() != null) {
    return parseJobManagerAddress(options.getJobManagerAddress());
  }
  if (jobManagerAddress == null) {
    String jobManagerHost=config.getString(ConfigConstants.JOB_MANAGER_IPC_ADDRESS_KEY,null);
    if (jobManagerHost == null) {
      throw new Exception("Found no configuration in the config directory '" + configDirectory + "' that specifies the JobManager address.");
    }
    int jobManagerPort;
    try {
      jobManagerPort=config.getInteger(ConfigConstants.JOB_MANAGER_IPC_PORT_KEY,-1);
    }
 catch (    NumberFormatException e) {
      throw new Exception("Invalid value for the JobManager port (" + ConfigConstants.JOB_MANAGER_IPC_PORT_KEY + ") in the configuration.");
    }
    if (jobManagerPort == -1) {
      throw new Exception("Found no configuration in the config directory '" + configDirectory + "' that specifies the JobManager port.");
    }
    jobManagerAddress=new InetSocketAddress(jobManagerHost,jobManagerPort);
  }
  return jobManagerAddress;
}
