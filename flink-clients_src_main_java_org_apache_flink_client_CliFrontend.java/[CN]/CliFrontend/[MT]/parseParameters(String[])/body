{
  if (args.length < 1) {
    System.out.println("Please specify an action.");
    printHelp();
    return 1;
  }
  String action=args[0];
  final String[] params=Arrays.copyOfRange(args,1,args.length);
  if (action.equals(ACTION_RUN)) {
    if (SecurityUtils.isSecurityEnabled()) {
      System.out.println("Secure Hadoop setup detected.");
      try {
        return SecurityUtils.runSecured(new SecurityUtils.FlinkSecuredRunner<Integer>(){
          @Override public Integer run() throws Exception {
            return CliFrontend.this.run(params);
          }
        }
);
      }
 catch (      Exception e) {
        handleError(e);
      }
    }
    return run(params);
  }
 else   if (action.equals(ACTION_LIST)) {
    return list(params);
  }
 else   if (action.equals(ACTION_INFO)) {
    return info(params);
  }
 else   if (action.equals(ACTION_CANCEL)) {
    return cancel(params);
  }
 else   if (action.equals("-h") || action.equals("--help")) {
    printHelp();
    return 0;
  }
 else {
    System.out.println("Invalid action!");
    printHelp();
    return 1;
  }
}
