{
  File configDirectory=new File(configDir);
  LOG.info("Using configuration directory " + configDirectory.getAbsolutePath());
  LOG.info("Trying to load configuration file");
  GlobalConfiguration.loadConfiguration(configDirectory.getAbsolutePath());
  this.config=GlobalConfiguration.getConfiguration();
  String defaultPropertiesFileLocation=System.getProperty("java.io.tmpdir");
  String currentUser=System.getProperty("user.name");
  String propertiesFileLocation=config.getString(ConfigConstants.YARN_PROPERTIES_FILE_LOCATION,defaultPropertiesFileLocation);
  File propertiesFile=new File(propertiesFileLocation,CliFrontend.YARN_PROPERTIES_FILE + currentUser);
  if (propertiesFile.exists()) {
    logAndSysout("Found YARN properties file " + propertiesFile.getAbsolutePath());
    Properties yarnProperties=new Properties();
    try {
      try (InputStream is=new FileInputStream(propertiesFile)){
        yarnProperties.load(is);
      }
     }
 catch (    IOException e) {
      throw new Exception("Cannot read the YARN properties file",e);
    }
    String propParallelism=yarnProperties.getProperty(YARN_PROPERTIES_PARALLELISM);
    if (propParallelism != null) {
      try {
        int parallelism=Integer.parseInt(propParallelism);
        this.config.setInteger(ConfigConstants.DEFAULT_PARALLELISM_KEY,parallelism);
        logAndSysout("YARN properties set default parallelism to " + parallelism);
      }
 catch (      NumberFormatException e) {
        throw new Exception("Error while parsing the YARN properties: " + "Property " + YARN_PROPERTIES_PARALLELISM + " is not an integer.");
      }
    }
    String address=yarnProperties.getProperty(YARN_PROPERTIES_JOBMANAGER_KEY);
    InetSocketAddress jobManagerAddress;
    if (address != null) {
      try {
        jobManagerAddress=parseHostPortAddress(address);
        writeJobManagerAddressToConfig(jobManagerAddress);
      }
 catch (      Exception e) {
        throw new Exception("YARN properties contain an invalid entry for JobManager address.",e);
      }
      logAndSysout("Using JobManager address from YARN properties " + jobManagerAddress);
    }
    String dynamicPropertiesEncoded=yarnProperties.getProperty(YARN_PROPERTIES_DYNAMIC_PROPERTIES_STRING);
    Map<String,String> dynamicProperties=getDynamicProperties(dynamicPropertiesEncoded);
    for (    Map.Entry<String,String> dynamicProperty : dynamicProperties.entrySet()) {
      this.config.setString(dynamicProperty.getKey(),dynamicProperty.getValue());
    }
  }
  this.askTimeout=AkkaUtils.getTimeout(config);
  this.lookupTimeout=AkkaUtils.getLookupTimeout(config);
}
