{
  Plan p=createProgramPlan(jobName);
  String jarFile=flinkILoop.writeFilesToDisk().getAbsolutePath();
  List<String> alljars=new ArrayList<String>();
  String[] extJars=this.flinkILoop.getExternalJars();
  if (!ArrayUtils.isEmpty(extJars)) {
    alljars.addAll(Arrays.asList(extJars));
  }
  alljars.add(jarFile);
  String[] alljarsArr=new String[alljars.size()];
  alljarsArr=alljars.toArray(alljarsArr);
  PlanExecutor executor=PlanExecutor.createRemoteExecutor(host,port,new Configuration(),alljarsArr);
  executor.setPrintStatusDuringExecution(p.getExecutionConfig().isSysoutLoggingEnabled());
  return executor.executePlan(p);
}
