{
  final Enumeration<NetworkInterface> interfaces=NetworkInterface.getNetworkInterfaces();
  while (interfaces.hasMoreElements()) {
    NetworkInterface nic=interfaces.nextElement();
    if (!nic.isLoopback() && !nic.isPointToPoint())     return nic;
  }
  throw new SocketException("Cannot find network interface which is not a loopback interface.");
}
