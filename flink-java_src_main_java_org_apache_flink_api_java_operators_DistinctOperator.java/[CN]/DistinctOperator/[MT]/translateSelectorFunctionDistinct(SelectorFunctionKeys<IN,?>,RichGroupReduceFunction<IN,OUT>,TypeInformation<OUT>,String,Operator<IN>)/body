{
  @SuppressWarnings("unchecked") final SelectorFunctionKeys<IN,K> keys=(SelectorFunctionKeys<IN,K>)rawKeys;
  TypeInformation<Tuple2<K,IN>> typeInfoWithKey=SelectorFunctionKeys.createTypeWithKey(keys);
  Operator<Tuple2<K,IN>> keyedInput=SelectorFunctionKeys.appendKeyExtractor(input,keys);
  PlanUnwrappingReduceGroupOperator<IN,OUT,K> reducer=new PlanUnwrappingReduceGroupOperator<>(function,keys,name,outputType,typeInfoWithKey,true);
  reducer.setInput(keyedInput);
  return reducer;
}
