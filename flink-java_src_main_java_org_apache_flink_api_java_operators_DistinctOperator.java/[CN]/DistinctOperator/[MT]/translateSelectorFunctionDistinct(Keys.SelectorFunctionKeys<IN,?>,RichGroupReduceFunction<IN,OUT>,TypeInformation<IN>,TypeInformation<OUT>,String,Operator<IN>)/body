{
  @SuppressWarnings("unchecked") final Keys.SelectorFunctionKeys<IN,K> keys=(Keys.SelectorFunctionKeys<IN,K>)rawKeys;
  TypeInformation<Tuple2<K,IN>> typeInfoWithKey=new TupleTypeInfo<Tuple2<K,IN>>(keys.getKeyType(),inputType);
  KeyExtractingMapper<IN,K> extractor=new KeyExtractingMapper<IN,K>(keys.getKeyExtractor());
  PlanUnwrappingReduceGroupOperator<IN,OUT,K> reducer=new PlanUnwrappingReduceGroupOperator<IN,OUT,K>(function,keys,name,outputType,typeInfoWithKey,true);
  MapOperatorBase<IN,Tuple2<K,IN>,MapFunction<IN,Tuple2<K,IN>>> mapper=new MapOperatorBase<IN,Tuple2<K,IN>,MapFunction<IN,Tuple2<K,IN>>>(extractor,new UnaryOperatorInformation<IN,Tuple2<K,IN>>(inputType,typeInfoWithKey),"Key Extractor");
  reducer.setInput(mapper);
  mapper.setInput(input);
  mapper.setParallelism(input.getParallelism());
  return reducer;
}
