{
switch (this.taskType) {
case INPUT:
    throw new IllegalStateException("Input task received record");
case REGULAR:
{
    final AbstractTaggableRecord taggableRecord=(AbstractTaggableRecord)record;
    this.tag=(StreamingTag)taggableRecord.getTag();
  }
break;
case OUTPUT:
{
final AbstractTaggableRecord taggableRecord=(AbstractTaggableRecord)record;
this.tag=(StreamingTag)taggableRecord.getTag();
if (this.tag != null) {
  System.out.println(System.currentTimeMillis() - this.tag.getTimestamp());
}
}
break;
}
}
