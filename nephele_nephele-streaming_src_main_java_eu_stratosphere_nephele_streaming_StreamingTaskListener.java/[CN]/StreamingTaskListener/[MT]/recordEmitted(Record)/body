{
switch (this.taskType) {
case INPUT:
    if (this.tagCounter++ == this.taggingInterval) {
      final AbstractTaggableRecord taggableRecord=(AbstractTaggableRecord)record;
      taggableRecord.setTag(createTag());
      this.tagCounter=0;
    }
  break;
case REGULAR:
final AbstractTaggableRecord taggableRecord=(AbstractTaggableRecord)record;
if (this.tag == null) {
taggableRecord.setTag(null);
}
 else {
this.tag=createTag();
taggableRecord.setTag(this.tag);
}
break;
case OUTPUT:
throw new IllegalStateException("Output task emitted record");
}
}
