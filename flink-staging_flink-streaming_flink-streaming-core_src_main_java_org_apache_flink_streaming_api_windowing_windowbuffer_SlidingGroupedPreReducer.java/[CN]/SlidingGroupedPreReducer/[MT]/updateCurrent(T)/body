{
  if (currentReducedMap == null) {
    currentReducedMap=new HashMap<Object,T>();
    currentReducedMap.put(key.getKey(element),element);
  }
 else {
    Object nextKey=key.getKey(element);
    T last=currentReducedMap.get(nextKey);
    if (last == null) {
      currentReducedMap.put(nextKey,element);
    }
 else {
      currentReducedMap.put(nextKey,reducer.reduce(serializer.copy(last),element));
    }
  }
}
