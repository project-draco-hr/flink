{
  try {
    List<RecentJobEvent> jobs=jobmanager.getRecentJobs();
    resp.setStatus(HttpServletResponse.SC_OK);
    resp.setContentType("application/json");
    PrintWriter wrt=resp.getWriter();
    wrt.write("[");
    for (int i=0; i < jobs.size(); i++) {
      RecentJobEvent jobEvent=jobs.get(i);
      ManagementGraph jobManagementGraph=jobmanager.getManagementGraph(jobEvent.getJobID());
      wrt.write("{");
      wrt.write("\"jobid\": \"" + jobEvent.getJobID() + "\",");
      wrt.write("\"jobname\": \"" + StringUtils.escapeHtml(jobEvent.getJobName()) + "\",");
      wrt.write("\"status\": \"" + jobEvent.getJobStatus() + "\",");
      wrt.write("\"time\": " + jobEvent.getTimestamp() + ",");
      wrt.write("\"groupvertices\": [");
      boolean first=true;
      for (      ManagementGroupVertex groupVertex : jobManagementGraph.getGroupVerticesInTopologicalOrder()) {
        if (first) {
          first=false;
        }
 else {
          wrt.write(",");
        }
        wrt.write(groupVertex.toJson());
      }
      wrt.write("]");
      wrt.write("}");
      if (i != jobs.size() - 1) {
        wrt.write(",");
      }
    }
    wrt.write("]");
  }
 catch (  EofException eof) {
    LOG.info("Info server for jobmanager: Connection closed by client, EofException");
  }
catch (  IOException ioe) {
    LOG.info("Info server for jobmanager: Connection closed by client, IOException");
  }
catch (  Exception e) {
    resp.setStatus(HttpServletResponse.SC_BAD_REQUEST);
    resp.getWriter().print(e.getMessage());
    if (LOG.isWarnEnabled()) {
      LOG.warn(StringUtils.stringifyException(e));
    }
  }
}
