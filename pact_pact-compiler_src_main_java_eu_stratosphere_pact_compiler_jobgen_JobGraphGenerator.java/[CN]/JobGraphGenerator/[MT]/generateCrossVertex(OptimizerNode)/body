{
  final JobTaskVertex crossVertex=new JobTaskVertex(crossNode.getPactContract().getName(),this.jobGraph);
  final TaskConfig crossConfig=new TaskConfig(crossVertex.getConfiguration());
  crossVertex.setTaskClass(RegularPactTask.class);
  crossConfig.setDriver(CrossDriver.class);
  crossConfig.setStubClass(crossNode.getPactContract().getUserCodeClass());
switch (crossNode.getLocalStrategy()) {
case NESTEDLOOP_BLOCKED_OUTER_FIRST:
    crossConfig.setLocalStrategy(LocalStrategy.NESTEDLOOP_BLOCKED_OUTER_FIRST);
  break;
case NESTEDLOOP_BLOCKED_OUTER_SECOND:
crossConfig.setLocalStrategy(LocalStrategy.NESTEDLOOP_BLOCKED_OUTER_SECOND);
break;
case NESTEDLOOP_STREAMED_OUTER_FIRST:
crossConfig.setLocalStrategy(LocalStrategy.NESTEDLOOP_STREAMED_OUTER_FIRST);
break;
case NESTEDLOOP_STREAMED_OUTER_SECOND:
crossConfig.setLocalStrategy(LocalStrategy.NESTEDLOOP_STREAMED_OUTER_SECOND);
break;
default :
throw new CompilerException("Invalid local strategy for 'Cross' (" + crossNode.getName() + "): "+ crossNode.getLocalStrategy());
}
crossConfig.setStubParameters(crossNode.getPactContract().getParameters());
return crossVertex;
}
