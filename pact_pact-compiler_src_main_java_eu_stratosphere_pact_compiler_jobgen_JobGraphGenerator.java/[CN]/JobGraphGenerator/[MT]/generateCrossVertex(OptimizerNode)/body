{
  JobTaskVertex crossVertex=new JobTaskVertex(crossNode.getPactContract().getName(),this.jobGraph);
  crossVertex.setTaskClass(CrossTask.class);
  TaskConfig crossConfig=new TaskConfig(crossVertex.getConfiguration());
  crossConfig.setStubClass(crossNode.getPactContract().getStubClass());
switch (crossNode.getLocalStrategy()) {
case NESTEDLOOP_BLOCKED_OUTER_FIRST:
    crossConfig.setLocalStrategy(LocalStrategy.NESTEDLOOP_BLOCKED_OUTER_FIRST);
  break;
case NESTEDLOOP_BLOCKED_OUTER_SECOND:
crossConfig.setLocalStrategy(LocalStrategy.NESTEDLOOP_BLOCKED_OUTER_SECOND);
break;
case NESTEDLOOP_STREAMED_OUTER_FIRST:
crossConfig.setLocalStrategy(LocalStrategy.NESTEDLOOP_STREAMED_OUTER_FIRST);
break;
case NESTEDLOOP_STREAMED_OUTER_SECOND:
crossConfig.setLocalStrategy(LocalStrategy.NESTEDLOOP_STREAMED_OUTER_SECOND);
break;
default :
throw new CompilerException("Invalid local strategy for 'Cross' (" + crossNode.getName() + "): "+ crossNode.getLocalStrategy());
}
crossConfig.setIOBufferSize(crossNode.getMemoryPerTask());
crossConfig.setStubParameters(crossNode.getPactContract().getStubParameters());
return crossVertex;
}
