{
  this.jobGraph=new JobGraph(pactPlan.getJobName());
  this.vertices=new HashMap<OptimizerNode,AbstractJobVertex>();
  this.auxVertices=new ArrayList<AbstractJobVertex>();
  this.maxDegreeVertex=null;
  pactPlan.getPlanConfiguration().extractNepheleConfiguration(this.jobGraph.getJobConfiguration());
  pactPlan.accept(this);
  if (pactPlan.getInstanceTypeName() != null) {
    this.maxDegreeVertex.setInstanceType(pactPlan.getInstanceTypeName());
  }
 else {
    LOG.warn("No instance type assigned to Nephele JobVertex.");
  }
  for (  AbstractJobVertex vertex : this.vertices.values()) {
    if (vertex == this.maxDegreeVertex) {
      continue;
    }
    vertex.setVertexToShareInstancesWith(this.maxDegreeVertex);
  }
  for (  AbstractJobVertex vertex : this.auxVertices) {
    if (vertex == this.maxDegreeVertex) {
      continue;
    }
    vertex.setVertexToShareInstancesWith(this.maxDegreeVertex);
  }
  JobGraph graph=this.jobGraph;
  this.maxDegreeVertex=null;
  this.vertices=null;
  this.jobGraph=null;
  return graph;
}
