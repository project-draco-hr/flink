{
  JobFileOutputVertex sinkVertex=new JobFileOutputVertex(sinkNode.getPactContract().getName(),this.jobGraph);
  sinkVertex.setFileOutputClass(DataSinkTask.class);
  sinkVertex.setFilePath(new Path(((DataSinkContract<?,?>)sinkNode.getPactContract()).getFilePath()));
  DataSinkTask.DataSinkConfig sinkConfig=new DataSinkTask.DataSinkConfig(sinkVertex.getConfiguration());
  sinkConfig.setStubClass(((DataSinkContract<?,?>)sinkNode.getPactContract()).getStubClass());
  sinkConfig.setStubParameters((((DataSinkContract<?,?>)sinkNode.getPactContract()).getFormatParameters()));
switch (sinkNode.getLocalStrategy()) {
case NONE:
    sinkConfig.setLocalStrategy(LocalStrategy.NONE);
  break;
case SORT:
sinkConfig.setLocalStrategy(LocalStrategy.SORT);
break;
default :
throw new CompilerException("Invalid local strategy for 'DataSink' (" + sinkNode.getName() + "): "+ sinkNode.getLocalStrategy());
}
assignMemory(sinkConfig,sinkNode.getMemoryPerTask());
sinkNode.getPactContract().setStubParameter(DataSinkTask.SORT_ORDER,sinkNode.getLocalProperties().getKeyOrder().name());
sinkConfig.setStubParameters(sinkNode.getPactContract().getStubParameters());
return sinkVertex;
}
