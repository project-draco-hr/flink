{
  JobTaskVertex mapVertex=new JobTaskVertex(mapNode.getPactContract().getName(),this.jobGraph);
  mapVertex.setTaskClass(MapTask.class);
  TaskConfig mapConfig=new TaskConfig(mapVertex.getConfiguration());
  mapConfig.setStubClass(mapNode.getPactContract().getUserCodeClass());
switch (mapNode.getLocalStrategy()) {
case NONE:
    mapConfig.setLocalStrategy(LocalStrategy.NONE);
  break;
default :
throw new CompilerException("Invalid local strategy for 'Map' (" + mapNode.getName() + "): "+ mapNode.getLocalStrategy());
}
mapConfig.setStubParameters(mapNode.getPactContract().getParameters());
return mapVertex;
}
