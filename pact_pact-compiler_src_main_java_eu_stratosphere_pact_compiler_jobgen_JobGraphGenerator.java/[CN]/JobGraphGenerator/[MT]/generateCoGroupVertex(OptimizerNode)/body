{
  JobTaskVertex coGroupVertex=new JobTaskVertex(coGroupNode.getPactContract().getName(),this.jobGraph);
  coGroupVertex.setTaskClass(CoGroupTask.class);
  TaskConfig coGroupConfig=new TaskConfig(coGroupVertex.getConfiguration());
  coGroupConfig.setStubClass(coGroupNode.getPactContract().getStubClass());
switch (coGroupNode.getLocalStrategy()) {
case SORT_BOTH_MERGE:
    coGroupConfig.setLocalStrategy(LocalStrategy.SORT_BOTH_MERGE);
  break;
case SORT_FIRST_MERGE:
coGroupConfig.setLocalStrategy(LocalStrategy.SORT_FIRST_MERGE);
break;
case SORT_SECOND_MERGE:
coGroupConfig.setLocalStrategy(LocalStrategy.SORT_SECOND_MERGE);
break;
case MERGE:
coGroupConfig.setLocalStrategy(LocalStrategy.MERGE);
break;
default :
throw new CompilerException("Invalid local strategy for 'CoGroup' (" + coGroupNode.getName() + "): "+ coGroupNode.getLocalStrategy());
}
assignMemory(coGroupConfig,coGroupNode.getMemoryPerTask());
coGroupConfig.setStubParameters(coGroupNode.getPactContract().getStubParameters());
return coGroupVertex;
}
