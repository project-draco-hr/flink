{
  JobTaskVertex coGroupVertex=new JobTaskVertex(coGroupNode.getPactContract().getName(),this.jobGraph);
  coGroupVertex.setTaskClass(CoGroupTask.class);
  TaskConfig coGroupConfig=new TaskConfig(coGroupVertex.getConfiguration());
  coGroupConfig.setStubClass(coGroupNode.getPactContract().getStubClass());
switch (coGroupNode.getLocalStrategy()) {
case SORTMERGE:
    coGroupConfig.setLocalStrategy(LocalStrategy.SORTMERGE);
  break;
default :
throw new CompilerException("Invalid local strategy for 'CoGroup' (" + coGroupNode.getName() + "): "+ coGroupNode.getLocalStrategy());
}
assignMemory(coGroupConfig,coGroupNode.getMemoryPerTask());
coGroupConfig.setStubParameters(coGroupNode.getPactContract().getStubParameters());
return coGroupVertex;
}
