{
  MatchContract matchContract=((MatchNode)matchNode).getPactContract();
  JobTaskVertex matchVertex=new JobTaskVertex(matchNode.getPactContract().getName(),this.jobGraph);
  TaskConfig matchConfig=new TaskConfig(matchVertex.getConfiguration());
  matchConfig.setStubClass(matchNode.getPactContract().getUserCodeClass());
  matchConfig.setLocalStrategyKeyTypes(matchContract.getKeyClasses());
  matchConfig.setLocalStrategyKeyTypes(0,matchContract.getKeyColumnNumbers(0));
  matchConfig.setLocalStrategyKeyTypes(1,matchContract.getKeyColumnNumbers(1));
switch (matchNode.getLocalStrategy()) {
case SORT_BOTH_MERGE:
    matchVertex.setTaskClass(MatchTask.class);
  matchConfig.setLocalStrategy(LocalStrategy.SORT_BOTH_MERGE);
break;
case SORT_FIRST_MERGE:
matchVertex.setTaskClass(MatchTask.class);
matchConfig.setLocalStrategy(LocalStrategy.SORT_FIRST_MERGE);
break;
case SORT_SECOND_MERGE:
matchVertex.setTaskClass(MatchTask.class);
matchConfig.setLocalStrategy(LocalStrategy.SORT_SECOND_MERGE);
break;
case MERGE:
matchVertex.setTaskClass(MatchTask.class);
matchConfig.setLocalStrategy(LocalStrategy.MERGE);
break;
case HYBRIDHASH_FIRST:
matchVertex.setTaskClass(MatchTask.class);
matchConfig.setLocalStrategy(LocalStrategy.HYBRIDHASH_FIRST);
break;
case HYBRIDHASH_SECOND:
matchVertex.setTaskClass(MatchTask.class);
matchConfig.setLocalStrategy(LocalStrategy.HYBRIDHASH_SECOND);
break;
case MMHASH_FIRST:
matchVertex.setTaskClass(MatchTask.class);
matchConfig.setLocalStrategy(LocalStrategy.MMHASH_FIRST);
break;
case MMHASH_SECOND:
matchVertex.setTaskClass(MatchTask.class);
matchConfig.setLocalStrategy(LocalStrategy.MMHASH_SECOND);
break;
case SORT_SELF_NESTEDLOOP:
matchVertex.setTaskClass(SelfMatchTask.class);
matchConfig.setLocalStrategy(LocalStrategy.SORT_SELF_NESTEDLOOP);
break;
case SELF_NESTEDLOOP:
matchVertex.setTaskClass(SelfMatchTask.class);
matchConfig.setLocalStrategy(LocalStrategy.SELF_NESTEDLOOP);
break;
default :
throw new CompilerException("Invalid local strategy for 'Match' (" + matchNode.getName() + "): "+ matchNode.getLocalStrategy());
}
assignMemory(matchConfig,matchNode.getMemoryPerTask());
matchConfig.setStubParameters(matchNode.getPactContract().getParameters());
return matchVertex;
}
