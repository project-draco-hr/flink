{
  JobTaskVertex matchVertex=new JobTaskVertex(matchNode.getPactContract().getName(),this.jobGraph);
  matchVertex.setTaskClass(MatchTask.class);
  TaskConfig matchConfig=new TaskConfig(matchVertex.getConfiguration());
  matchConfig.setStubClass(matchNode.getPactContract().getStubClass());
switch (matchNode.getLocalStrategy()) {
case SORT_BOTH_MERGE:
    matchConfig.setLocalStrategy(LocalStrategy.SORT_BOTH_MERGE);
  break;
case SORT_FIRST_MERGE:
matchConfig.setLocalStrategy(LocalStrategy.SORT_FIRST_MERGE);
break;
case SORT_SECOND_MERGE:
matchConfig.setLocalStrategy(LocalStrategy.SORT_SECOND_MERGE);
break;
case MERGE:
matchConfig.setLocalStrategy(LocalStrategy.MERGE);
break;
case HYBRIDHASH_FIRST:
matchConfig.setLocalStrategy(LocalStrategy.HYBRIDHASH_FIRST);
break;
case HYBRIDHASH_SECOND:
matchConfig.setLocalStrategy(LocalStrategy.HYBRIDHASH_SECOND);
break;
case MMHASH_FIRST:
matchConfig.setLocalStrategy(LocalStrategy.MMHASH_FIRST);
break;
case MMHASH_SECOND:
matchConfig.setLocalStrategy(LocalStrategy.MMHASH_SECOND);
break;
default :
throw new CompilerException("Invalid local strategy for 'Match' (" + matchNode.getName() + "): "+ matchNode.getLocalStrategy());
}
assignMemory(matchConfig,matchNode.getMemoryPerTask());
matchConfig.setStubParameters(matchNode.getPactContract().getStubParameters());
return matchVertex;
}
