{
  final MatchContract matchContract=((MatchNode)matchNode).getPactContract();
  final JobTaskVertex matchVertex=new JobTaskVertex(matchNode.getPactContract().getName(),this.jobGraph);
  final TaskConfig matchConfig=new TaskConfig(matchVertex.getConfiguration());
  matchVertex.setTaskClass(RegularPactTask.class);
  matchConfig.setStubClass(matchNode.getPactContract().getUserCodeClass());
  PactRecordComparatorFactory.writeComparatorSetupToConfig(matchConfig.getConfigForInputParameters(0),matchContract.getKeyColumnNumbers(0),matchContract.getKeyClasses(),getTrueArrayOfSize(matchContract.getKeyClasses().length));
  PactRecordComparatorFactory.writeComparatorSetupToConfig(matchConfig.getConfigForInputParameters(1),matchContract.getKeyColumnNumbers(1),matchContract.getKeyClasses(),getTrueArrayOfSize(matchContract.getKeyClasses().length));
switch (matchNode.getLocalStrategy()) {
case SORT_BOTH_MERGE:
    matchConfig.setDriver(MatchDriver.class);
  matchConfig.setLocalStrategy(LocalStrategy.SORT_BOTH_MERGE);
break;
case SORT_FIRST_MERGE:
matchConfig.setDriver(MatchDriver.class);
matchConfig.setLocalStrategy(LocalStrategy.SORT_FIRST_MERGE);
break;
case SORT_SECOND_MERGE:
matchConfig.setDriver(MatchDriver.class);
matchConfig.setLocalStrategy(LocalStrategy.SORT_SECOND_MERGE);
break;
case MERGE:
matchConfig.setDriver(MatchDriver.class);
matchConfig.setLocalStrategy(LocalStrategy.MERGE);
break;
case HYBRIDHASH_FIRST:
matchConfig.setDriver(MatchDriver.class);
matchConfig.setLocalStrategy(LocalStrategy.HYBRIDHASH_FIRST);
break;
case HYBRIDHASH_SECOND:
matchConfig.setDriver(MatchDriver.class);
matchConfig.setLocalStrategy(LocalStrategy.HYBRIDHASH_SECOND);
break;
case MMHASH_FIRST:
matchConfig.setDriver(MatchDriver.class);
matchConfig.setLocalStrategy(LocalStrategy.MMHASH_FIRST);
break;
case MMHASH_SECOND:
matchConfig.setDriver(MatchDriver.class);
matchConfig.setLocalStrategy(LocalStrategy.MMHASH_SECOND);
break;
default :
throw new CompilerException("Invalid local strategy for 'Match' (" + matchNode.getName() + "): "+ matchNode.getLocalStrategy());
}
assignMemory(matchConfig,matchNode.getMemoryPerTask());
matchConfig.setStubParameters(matchNode.getPactContract().getParameters());
return matchVertex;
}
