{
  DataSourceNode dsn=(DataSourceNode)sourceNode;
  DataSourceContract<?,?> contract=(DataSourceContract<?,?>)(dsn.getPactContract());
  JobFileInputVertex sourceVertex=new JobFileInputVertex(contract.getName(),this.jobGraph);
  sourceVertex.setFileInputClass(DataSourceTask.class);
  sourceVertex.setFilePath(new Path(contract.getFilePath()));
  DataSourceTask.Config sourceConfig=new DataSourceTask.Config(sourceVertex.getConfiguration());
  sourceConfig.setStubClass(contract.getStubClass());
  sourceConfig.setFormatParameters(contract.getFormatParameters());
switch (sourceNode.getLocalStrategy()) {
case NONE:
    sourceConfig.setLocalStrategy(LocalStrategy.NONE);
  break;
default :
throw new CompilerException("Invalid local strategy for 'DataSource'(" + sourceNode.getName() + "): "+ sourceNode.getLocalStrategy());
}
sourceConfig.setStubParameters(sourceNode.getPactContract().getStubParameters());
return sourceVertex;
}
