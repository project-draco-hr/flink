{
  JobTaskVertex reduceVertex=new JobTaskVertex(reduceNode.getPactContract().getName(),this.jobGraph);
  TaskConfig reduceConfig=new TaskConfig(reduceVertex.getConfiguration());
  reduceVertex.setTaskClass(RegularPactTask.class);
  reduceConfig.setDriver(ReduceDriver.class);
  reduceConfig.setStubClass(reduceNode.getPactContract().getUserCodeClass());
  final Ordering secondaryOrder=reduceNode.getPactContract().getGroupOrder();
  if (secondaryOrder == null) {
    PactRecordComparatorFactory.writeComparatorSetupToConfig(reduceConfig.getConfigForInputParameters(0),reduceNode.getPactContract().getKeyColumnNumbers(0),reduceNode.getPactContract().getKeyClasses(),getTrueArrayOfSize(reduceNode.getPactContract().getKeyClasses().length));
  }
 else {
    PactRecordComparatorFactory.writeComparatorSetupToConfig(reduceConfig.getConfigForInputParameters(0),reduceNode.getPactContract().getKeyColumnNumbers(0),reduceNode.getPactContract().getKeyClasses(),getTrueArrayOfSize(reduceNode.getPactContract().getKeyClasses().length),secondaryOrder.getFieldPositions(),secondaryOrder.getTypes(),secondaryOrder.getFieldSortDirections());
  }
switch (reduceNode.getLocalStrategy()) {
case SORT:
    reduceConfig.setLocalStrategy(LocalStrategy.SORT);
  break;
case COMBININGSORT:
reduceConfig.setLocalStrategy(LocalStrategy.COMBININGSORT);
break;
case NONE:
reduceConfig.setLocalStrategy(LocalStrategy.NONE);
break;
default :
throw new CompilerException("Invalid local strategy for 'Reduce' (" + reduceNode.getName() + "): "+ reduceNode.getLocalStrategy());
}
reduceConfig.setStubParameters(reduceNode.getPactContract().getParameters());
return reduceVertex;
}
