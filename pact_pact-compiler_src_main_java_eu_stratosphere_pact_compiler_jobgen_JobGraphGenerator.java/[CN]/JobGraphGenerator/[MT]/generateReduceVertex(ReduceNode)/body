{
  JobTaskVertex reduceVertex=new JobTaskVertex(reduceNode.getPactContract().getName(),this.jobGraph);
  TaskConfig reduceConfig=new TaskConfig(reduceVertex.getConfiguration());
  reduceVertex.setTaskClass(RegularPactTask.class);
  reduceConfig.setDriver(ReduceDriver.class);
  reduceConfig.setStubClass(reduceNode.getPactContract().getUserCodeClass());
  PactRecordComparatorFactory.writeComparatorSetupToConfig(reduceConfig.getConfiguration(),reduceConfig.getPrefixForInputParameters(0),reduceNode.getPactContract().getKeyColumnNumbers(0),reduceNode.getPactContract().getKeyClasses());
switch (reduceNode.getLocalStrategy()) {
case SORT:
    reduceConfig.setLocalStrategy(LocalStrategy.SORT);
  break;
case COMBININGSORT:
reduceConfig.setLocalStrategy(LocalStrategy.COMBININGSORT);
break;
case NONE:
reduceConfig.setLocalStrategy(LocalStrategy.NONE);
break;
default :
throw new CompilerException("Invalid local strategy for 'Reduce' (" + reduceNode.getName() + "): "+ reduceNode.getLocalStrategy());
}
assignMemory(reduceConfig,reduceNode.getMemoryPerTask());
reduceConfig.setStubParameters(reduceNode.getPactContract().getParameters());
return reduceVertex;
}
