{
  final MemoryManager memoryManager=getEnvironment().getMemoryManager();
  final IOManager ioManager=getEnvironment().getIOManager();
switch (config.getLocalStrategy()) {
case SORT_BOTH_MERGE:
case SORT_FIRST_MERGE:
case SORT_SECOND_MERGE:
case MERGE:
    return new SortMergeMatchIterator(memoryManager,ioManager,reader1,reader2,matchStub.getFirstInKeyType(),matchStub.getFirstInValueType(),matchStub.getSecondInValueType(),this.availableMemory,this.maxFileHandles,this.spillThreshold,config.getLocalStrategy(),this);
default :
  throw new RuntimeException("Unsupported local strategy for MatchTask: " + config.getLocalStrategy());
}
}
