{
  final MemoryManager memoryManager=getEnvironment().getMemoryManager();
  final IOManager ioManager=getEnvironment().getIOManager();
switch (config.getLocalStrategy()) {
case SORTMERGE:
    return new SortMergeMatchIterator(memoryManager,ioManager,reader1,reader2,match.getFirstInKeyType(),match.getFirstInValueType(),match.getSecondInValueType(),NUM_SORT_BUFFERS,SIZE_SORT_BUFFER,MEMORY_IO,MAX_NUM_FILEHANLDES,this);
case HYBRIDHASH_FIRST:
  return new HybridHashMatchIterator(memoryManager,ioManager,reader1,reader2,match.getFirstInKeyType(),match.getFirstInValueType(),match.getSecondInValueType(),InputRoles.BUILD_PROBE,MEMORY_IO);
case HYBRIDHASH_SECOND:
return new HybridHashMatchIterator(memoryManager,ioManager,reader1,reader2,match.getFirstInKeyType(),match.getFirstInValueType(),match.getSecondInValueType(),InputRoles.PROBE_BUILD,MEMORY_IO);
case MMHASH_FIRST:
return new InMemoryHashMatchIterator(reader1,reader2);
case MMHASH_SECOND:
return new InMemoryHashMatchIterator(reader2,reader1);
default :
throw new RuntimeException("Unknown local strategy for MatchTask");
}
}
