{
  if (LOG.isInfoEnabled())   LOG.info(getLogString("Start PACT code"));
  try {
    this.matchIterator=getIterator(this.reader1,this.reader2);
    this.matchIterator.open();
    if (LOG.isDebugEnabled())     LOG.debug(getLogString("Iterator obtained"));
    this.matchStub.open();
    while (this.taskRunning && matchIterator.callWithNextKey())     ;
  }
 catch (  Exception ex) {
    if (this.taskRunning) {
      LOG.error(getLogString("Unexpected ERROR in PACT code"));
      throw ex;
    }
  }
 finally {
    if (this.matchIterator != null) {
      this.matchIterator.close();
    }
    try {
      this.matchStub.close();
    }
 catch (    Throwable t) {
      LOG.error(getLogString("Error while closing the Match user function"),t);
    }
    if (this.output != null) {
      this.output.close();
    }
  }
  if (this.taskRunning) {
    if (LOG.isInfoEnabled())     LOG.info(getLogString("Finished PACT code"));
  }
 else {
    if (LOG.isWarnEnabled())     LOG.warn(getLogString("PACT code cancelled"));
  }
}
