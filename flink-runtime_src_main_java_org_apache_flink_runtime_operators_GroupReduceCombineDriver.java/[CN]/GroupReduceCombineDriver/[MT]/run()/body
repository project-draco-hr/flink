{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Combiner starting.");
  }
  final MutableObjectIterator<IN> in=this.taskContext.getInput(0);
  final TypeSerializer<IN> serializer=this.serializer;
  IN value=serializer.createInstance();
  while (running && (value=in.next(value)) != null) {
    if (this.sorter.write(value)) {
      continue;
    }
    sortAndCombine();
    this.sorter.reset();
    if (!this.sorter.write(value)) {
      ++oversizedRecordCount;
      LOG.debug("Cannot write record to fresh sort buffer, record is too large. " + "Oversized record count: {}",oversizedRecordCount);
      Iterable<IN> input=Collections.singleton(value);
      this.combiner.combine(input,this.output);
    }
  }
  if (running) {
    sortAndCombine();
  }
}
