{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Combiner starting.");
  }
  final MutableObjectIterator<IN> in=this.taskContext.getInput(0);
  final TypeSerializer<IN> serializer=this.serializer;
  IN value=serializer.createInstance();
  while (running && (value=in.next(value)) != null) {
    if (this.sorter.write(value)) {
      continue;
    }
    sortAndCombine();
    this.sorter.reset();
    if (!this.sorter.write(value)) {
      ++oversizedRecordCount;
      LOG.debug("Cannot write record to fresh sort buffer. Record too large. Oversized record count: {}",oversizedRecordCount);
      this.output.collect((OUT)value);
    }
  }
  sortAndCombine();
}
