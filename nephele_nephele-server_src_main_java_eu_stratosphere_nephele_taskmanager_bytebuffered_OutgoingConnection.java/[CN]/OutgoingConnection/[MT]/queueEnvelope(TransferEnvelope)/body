{
synchronized (this.queuedEnvelopes) {
    if (!this.isConnected) {
      this.retriesLeft=this.numberOfConnectionRetries;
      this.timstampOfLastRetry=System.currentTimeMillis();
      System.out.println("Triggering connection to " + this.connectionAddress);
      this.connectionThread.triggerConnect(this);
      this.isConnected=true;
      this.isSubscribedToWriteEvent=true;
    }
 else {
      if (!this.isSubscribedToWriteEvent) {
        this.connectionThread.subscribeToWriteEvent(this.selectionKey);
        this.isSubscribedToWriteEvent=true;
      }
    }
    this.queuedEnvelopes.add(transferEnvelope);
  }
}
