{
synchronized (this.queuedEnvelopes) {
    int number=0;
    final Iterator<TransferEnvelope> it=this.queuedEnvelopes.iterator();
    while (it.hasNext()) {
      final TransferEnvelope te=it.next();
      if (source) {
        if (channelID.equals(te.getSource())) {
          number++;
        }
      }
 else {
        if (channelID.equals(te.getTarget())) {
          number++;
        }
      }
    }
    return number;
  }
}
