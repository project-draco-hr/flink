{
synchronized (this.queuedEnvelopes) {
    if (!this.queuedEnvelopes.isEmpty()) {
      return;
    }
    LOG.debug("Closing connection to " + this.connectionAddress);
    if (this.selectionKey != null) {
      final SocketChannel socketChannel=(SocketChannel)this.selectionKey.channel();
      socketChannel.close();
      this.selectionKey.cancel();
      this.selectionKey=null;
    }
    this.isConnected=false;
    this.isSubscribedToWriteEvent=false;
  }
}
