{
  if (edgesUsed) {
    throw new IllegalStateException("Can use either 'getEdges()' or 'sendMessageToAllNeighbors()'" + "exactly once.");
  }
  edgesUsed=true;
  outMsg.setField(m,1);
  while (edges.hasNext()) {
    Tuple next=(Tuple)edges.next();
    outMsg.setField(next.getField(1),0);
    out.collect(Either.Right(outMsg));
  }
}
