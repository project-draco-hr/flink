{
  final FileStatus file=fs.getFileStatus(filePath);
  long latestModTime=file.getModificationTime();
  if (file.isDir()) {
    FileStatus[] fss=fs.listStatus(filePath);
    files.ensureCapacity(fss.length);
    for (    FileStatus s : fss) {
      if (!s.isDir()) {
        files.add(s);
        latestModTime=Math.max(s.getModificationTime(),latestModTime);
      }
    }
  }
 else {
    files.add(file);
  }
  if (cachedStats != null && latestModTime <= cachedStats.getLastModificationTime()) {
    return cachedStats;
  }
  long len=0;
  for (  FileStatus s : files) {
    len+=s.getLen();
  }
  if (len <= 0) {
    len=BaseStatistics.SIZE_UNKNOWN;
  }
  return new FileBaseStatistics(latestModTime,len,BaseStatistics.AVG_RECORD_BYTES_UNKNOWN);
}
