{
  if (isInMemory()) {
    this.inMemoryBuffers.add(this.currentPartitionBuffer);
  }
 else {
    spillBuffer(this.currentPartitionBuffer,this.buildSideChannel);
    this.buildSideChannel.close();
    this.probeSideChannel=ioAccess.createBlockChannelWriter(probeChannelEnumerator.next(),this.bufferReturnQueue);
    this.currentPartitionBuffer=getNextWriteBehindBuffer();
    initBuffer(this.currentPartitionBuffer,0);
    this.probeBlockCounter=1;
  }
}
