{
  final int offset=insertIntoCurrentBuffer(object);
  if (isInMemory()) {
    if (offset >= 0) {
      this.buildSideRecordCounter++;
      return (((long)(this.buildSideBlockCounter - 1)) << 32) | offset;
    }
 else {
      return -1;
    }
  }
 else {
    if (offset == -1) {
      spillBuffer(this.currentPartitionBuffer,this.buildSideChannel);
      this.currentPartitionBuffer=getNextWriteBehindBuffer();
      initBuffer(this.currentPartitionBuffer,this.buildSideBlockCounter);
      this.buildSideBlockCounter++;
      if (insertIntoBuildBuffer(object) == -1) {
        throw new IOException("Record could not be added to fresh buffer. " + "Probably cause: Record length exceeds buffer size limit.");
      }
    }
    this.buildSideRecordCounter++;
    return 0;
  }
}
