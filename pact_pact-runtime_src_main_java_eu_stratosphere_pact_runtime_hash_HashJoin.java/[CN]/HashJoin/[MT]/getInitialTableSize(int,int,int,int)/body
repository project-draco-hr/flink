{
  final long totalSize=((long)bufferSize) * numBuffers;
  final long numRecordsStorable=totalSize / (recordLenBytes + RECORD_OVERHEAD_BYTES);
  final long bucketBytes=numRecordsStorable / RECORD_OVERHEAD_BYTES;
  final long numBuckets=bucketBytes / HASH_BUCKET_SIZE + 1;
  return numBuckets > Integer.MAX_VALUE ? Integer.MAX_VALUE : (int)numBuckets;
}
