{
  if (this.availableMemory.size() < numPartitions) {
    throw new RuntimeException("Bug in Hybrid Hash Join: Cannot create more partisions than number of available buffers.");
  }
  this.currentEnumerator=this.ioManager.createChannelEnumerator();
  this.partitionsBeingBuilt.clear();
  for (int i=0; i < numPartitions; i++) {
    Partition p=new Partition(this.availableMemory.remove(this.availableMemory.size() - 1),this.writeBehindBuffers);
    this.partitionsBeingBuilt.add(p);
  }
}
