{
  if (this.probeIterator.nextKey()) {
    final K currKey=this.probeIterator.getCurrentKey();
    final int hash=hash(currKey.hashCode(),this.currentRecursionDepth);
    final int posHashCode=hash % this.numBuckets;
    final int bucketArrayPos=posHashCode >> this.bucketsPerSegmentBits;
    final int bucketInSegmentOffset=(posHashCode & this.bucketsPerSegmentMask) << NUM_INTRA_BUCKET_BITS;
    final MemorySegment bucket=this.buckets[bucketArrayPos];
    final int partitionNumber=bucket.get(bucketInSegmentOffset + HEADER_PARTITION_OFFSET);
    final Partition p=this.partitionsBeingBuilt.get(partitionNumber);
    this.bucketIterator.set(bucket,p.overflowSegments,p.partitionBuffers,currKey,hash,bucketInSegmentOffset);
    return true;
  }
  return false;
}
