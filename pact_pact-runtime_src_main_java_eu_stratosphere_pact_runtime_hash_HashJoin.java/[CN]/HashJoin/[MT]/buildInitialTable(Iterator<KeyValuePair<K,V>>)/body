{
  final int partitionFanOut=getPartitioningFanOutNoEstimates(this.availableMemory.size());
  createPartitions(partitionFanOut);
  final int numBuckets=getInitialTableSize(this.availableMemory.size(),this.segmentSize,partitionFanOut,this.avgRecordLen);
  while (input.hasNext()) {
    final KeyValuePair<K,V> pair=input.next();
    final int hashCode=hash(pair.getKey().hashCode(),0);
    insertIntoTable(pair,hashCode);
  }
}
