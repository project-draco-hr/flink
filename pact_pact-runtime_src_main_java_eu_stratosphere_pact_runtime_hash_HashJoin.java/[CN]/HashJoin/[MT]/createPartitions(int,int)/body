{
  ensureNumBuffersReturned(numPartitions);
  this.currentEnumerator=this.ioManager.createChannelEnumerator();
  this.partitionsBeingBuilt.clear();
  for (int i=0; i < numPartitions; i++) {
    Partition p=new Partition(i,recursionLevel,this.availableMemory.remove(this.availableMemory.size() - 1),this.writeBehindBuffers);
    this.partitionsBeingBuilt.add(p);
  }
}
