{
  if (buildSideInput == null || probeSideInput == null || memorySegments == null) {
    throw new NullPointerException();
  }
  if (memorySegments.size() < MIN_NUM_MEMORY_SEGMENTS) {
    throw new IllegalArgumentException("Too few memory segments provided. Hash Join needs at leas " + MIN_NUM_MEMORY_SEGMENTS + " memory segments.");
  }
  this.buildSideInput=buildSideInput;
  this.probeSideInput=probeSideInput;
  this.availableMemory=memorySegments;
  this.ioManager=ioManager;
  this.writeBehindBuffers=new LinkedBlockingQueue<MemorySegment>();
  for (int i=getNumWriteBehindBuffers(memorySegments.size()); i > 0; --i) {
    this.writeBehindBuffers.add(memorySegments.remove(memorySegments.size() - 1));
  }
  this.partitionsBeingBuilt=new ArrayList<HashJoin.Partition>();
}
