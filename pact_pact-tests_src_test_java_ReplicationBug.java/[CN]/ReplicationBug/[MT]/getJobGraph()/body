{
  String pathPrefix=getFilesystemProvider().getURIPrefix() + getFilesystemProvider().getTempDirPath();
  DataSourceContract<PactString,PactString> input=new DataSourceContract<PactString,PactString>(TestInFormat.class,pathPrefix + "/mapInput");
  input.setFormatParameter("delimiter","\n");
  input.setDegreeOfParallelism(2);
  DataSinkContract<PactString,PactString> output=new DataSinkContract<PactString,PactString>(TestOutFormat.class,pathPrefix + "/result.txt");
  output.setDegreeOfParallelism(1);
  output.setInput(input);
  Plan plan=new Plan(output);
  PactCompiler pc=new PactCompiler();
  OptimizedPlan op=pc.compile(plan);
  JobGraphGenerator jgg=new JobGraphGenerator();
  return jgg.compileJobGraph(op);
}
