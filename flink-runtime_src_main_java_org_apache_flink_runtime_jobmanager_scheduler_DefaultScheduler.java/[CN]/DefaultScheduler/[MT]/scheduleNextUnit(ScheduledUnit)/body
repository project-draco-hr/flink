{
  if (unit == null) {
    throw new IllegalArgumentException("Unit to schedule must not be null.");
  }
  AllocatedSlot resource=this.allocatedSlots.get(unit.getSharedResourceId());
  if (resource == null) {
    try {
      resource=getResourceToScheduleUnit(unit,this.rejectIfNoResourceAvailable);
      if (resource == null) {
        throw new RuntimeException("Error: The resource to schedule to is null.");
      }
    }
 catch (    Exception e) {
      unit.getTaskVertex().handleException(e);
      return;
    }
  }
  resource.runTask(unit.getTaskVertex());
}
