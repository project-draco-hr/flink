{
  while (!shutdown.get()) {
    ScheduledUnit next=null;
    try {
      next=this.taskQueue.take();
    }
 catch (    InterruptedException e) {
      if (shutdown.get()) {
        return;
      }
 else {
        LOG.error("Scheduling loop was interrupted.");
      }
    }
    if (next == TERMINATION_SIGNAL) {
      return;
    }
    try {
      scheduleNextUnit(next);
    }
 catch (    Throwable t) {
      if (!shutdown.get()) {
        if (t instanceof Error) {
          throw (Error)t;
        }
 else         if (t instanceof RuntimeException) {
          throw (RuntimeException)t;
        }
 else {
          throw new RuntimeException("Critical error in scheduler thread.",t);
        }
      }
    }
  }
}
