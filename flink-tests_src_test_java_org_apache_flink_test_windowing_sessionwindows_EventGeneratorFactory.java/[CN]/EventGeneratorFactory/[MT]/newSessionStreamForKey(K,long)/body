{
  EventGenerator<K,E> eventGenerator=latestGeneratorsByKey.get(key);
  if (eventGenerator == null) {
    SessionConfiguration<K,E> sessionConfiguration=SessionConfiguration.of(key,0,maxSessionEventGap,globalWatermark,timelyEventsPerSession,eventFactory);
    SessionStreamConfiguration<K,E> sessionStreamConfiguration=new SessionStreamConfiguration<>(sessionConfiguration,streamConfiguration);
    eventGenerator=new SessionEventGeneratorImpl<>(sessionStreamConfiguration,randomGenerator);
  }
 else {
    eventGenerator=eventGenerator.getNextGenerator(globalWatermark);
  }
  latestGeneratorsByKey.put(key,eventGenerator);
  ++producedGeneratorsCount;
  return eventGenerator;
}
