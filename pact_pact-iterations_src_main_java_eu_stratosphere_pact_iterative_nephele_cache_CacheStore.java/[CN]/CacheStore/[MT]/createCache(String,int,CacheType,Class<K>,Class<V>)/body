{
  cacheTypes.putIfAbsent(cacheId,cacheType);
  String finalCacheId=getFinalCacheId(cacheId,subTaskId,cacheType);
  if (!store.containsKey(finalCacheId)) {
    store.putIfAbsent(finalCacheId,new AccessibleConcurrentHashMap<K,V>(10000));
  }
 else   if (cacheType == CacheType.ISOLATED || cacheType == CacheType.SHARED_READ) {
    throw new RuntimeException("Store already exists: " + finalCacheId);
  }
  if (!subTasks.containsKey(cacheId)) {
    subTasks.putIfAbsent(cacheId,new HashSet<Integer>());
  }
  Set<Integer> taskIdSet=subTasks.get(cacheId);
  boolean existed=!taskIdSet.add(subTaskId);
  if (existed) {
    throw new RuntimeException("Subtask already created cache (cache: " + cacheId + ", id: "+ subTaskId);
  }
}
