{
  CacheType cacheType=CACHE_TYPES.get(cacheId);
  String finalCacheId=getFinalCacheId(cacheId,subTaskId,cacheType);
switch (cacheType) {
case ISOLATED:
case SHARED_READ:
    return (Iterator<Entry<K,V>>)STORE.get(finalCacheId).entrySet().iterator();
case SHARED_READ_WRITE:
  int numSubTasks=SUB_TASKS.get(cacheId).size();
return STORE.get(finalCacheId).getIterators(numSubTasks)[subTaskId];
default :
throw new RuntimeException("Unknown cache type " + cacheType.name());
}
}
