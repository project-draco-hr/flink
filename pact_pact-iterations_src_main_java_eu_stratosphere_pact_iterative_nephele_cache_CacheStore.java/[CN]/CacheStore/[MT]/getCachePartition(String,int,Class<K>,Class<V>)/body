{
  CacheType cacheType=cacheTypes.get(cacheId);
  String finalCacheId=getFinalCacheId(cacheId,subTaskId,cacheType);
switch (cacheType) {
case ISOLATED:
case SHARED_READ:
    return (Iterator<Entry<K,V>>)store.get(finalCacheId).entrySet().iterator();
case SHARED_READ_WRITE:
  int numSubTasks=subTasks.get(cacheId).size();
return store.get(finalCacheId).getIterators(numSubTasks)[subTaskId];
default :
throw new RuntimeException("Unknown cache type " + cacheType.name());
}
}
