{
  if (files.isEmpty())   return;
  BlockInfo blockInfo=this.createBlockInfo();
  long totalCount=0;
  for (  FileStatus file : files) {
    if (file.getLen() < blockInfo.getInfoSize())     continue;
    FSDataInputStream fdis=file.getPath().getFileSystem().open(file.getPath(),blockInfo.getInfoSize());
    fdis.seek(file.getLen() - blockInfo.getInfoSize());
    DataInputStream input=new DataInputStream(fdis);
    blockInfo.read(input);
    totalCount+=blockInfo.getAccumulatedRecordCount();
  }
  stats.setNumberOfRecords(totalCount);
  stats.setAverageRecordWidth(totalCount == 0 ? 0 : ((float)stats.getTotalInputSize() / totalCount));
}
