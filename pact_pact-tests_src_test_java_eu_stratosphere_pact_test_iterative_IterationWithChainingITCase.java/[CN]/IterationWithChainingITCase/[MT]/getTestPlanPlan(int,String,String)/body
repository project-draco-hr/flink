{
  FileDataSource initialInput=new FileDataSource(new PointInFormat(),input,"Input");
  initialInput.setDegreeOfParallelism(1);
  BulkIteration iteration=new BulkIteration("Loop");
  iteration.setInput(initialInput);
  iteration.setMaximumNumberOfIterations(2);
  ReduceContract dummyReduce=ReduceContract.builder(new DummyReducer(),PactInteger.class,0).input(iteration.getPartialSolution()).name("Reduce something").build();
  MapContract dummyMap=MapContract.builder(new IdentityMapper()).input(dummyReduce).build();
  iteration.setNextPartialSolution(dummyMap);
  FileDataSink finalResult=new FileDataSink(new PointOutFormat(),output,iteration,"Output");
  Plan plan=new Plan(finalResult,"Iteration with chained map test");
  plan.setDefaultParallelism(numSubTasks);
  return plan;
}
