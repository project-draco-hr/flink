{
  initializeConnection();
  Map<String,Integer> topicCountMap=new HashMap<String,Integer>();
  topicCountMap.put(topicId,numThreads);
  Map<String,List<KafkaStream<byte[],byte[]>>> consumerMap=consumer.createMessageStreams(topicCountMap);
  KafkaStream<byte[],byte[]> stream=consumerMap.get(topicId).get(0);
  ConsumerIterator<byte[],byte[]> it=stream.iterator();
  while (it.hasNext()) {
    String message=new String(it.next().message());
    if (message.equals("q")) {
      break;
    }
    outTuple.f0=message;
    collector.collect(outTuple);
  }
  consumer.shutdown();
}
