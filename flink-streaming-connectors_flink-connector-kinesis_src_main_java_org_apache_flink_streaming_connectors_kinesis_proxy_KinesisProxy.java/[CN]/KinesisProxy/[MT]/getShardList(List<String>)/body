{
  List<KinesisStreamShard> shardList=new ArrayList<>();
  for (  String stream : streamNames) {
    DescribeStreamResult describeStreamResult;
    String lastSeenShardId=null;
    do {
      describeStreamResult=describeStream(stream,lastSeenShardId);
      List<Shard> shards=describeStreamResult.getStreamDescription().getShards();
      for (      Shard shard : shards) {
        shardList.add(new KinesisStreamShard(stream,shard));
      }
      lastSeenShardId=shards.get(shards.size() - 1).getShardId();
    }
 while (describeStreamResult.getStreamDescription().isHasMoreShards());
  }
  return shardList;
}
