{
  final Queue<InputSplit> queue=this.splitMap.get(vertex.getGroupVertex());
  if (queue == null) {
    final JobID jobID=vertex.getExecutionGraph().getJobID();
    LOG.error("Cannot find split queue for vertex " + vertex.getGroupVertex() + " (job "+ jobID+ ")");
    return null;
  }
  InputSplit nextSplit=queue.poll();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Assigning split " + nextSplit.getPartitionNumber() + " to "+ vertex);
  }
  return nextSplit;
}
