{
  Integer curr=counts.get(value.f0);
  if (curr != null) {
    counts.put(value.f0,curr + value.f1.value);
  }
 else {
    counts.put(value.f0,value.f1.value);
  }
  aggCount+=value.f1.value;
  if (aggCount >= elementCountExpected * countPerElementExpected) {
    assertEquals(elementCountExpected,counts.size());
    for (    Integer i : counts.values()) {
      assertEquals(countPerElementExpected,i.intValue());
    }
    throw new SuccessException();
  }
}
