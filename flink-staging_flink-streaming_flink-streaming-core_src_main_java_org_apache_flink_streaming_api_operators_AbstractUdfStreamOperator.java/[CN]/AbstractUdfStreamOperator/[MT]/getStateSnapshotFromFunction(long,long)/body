{
  Map<String,StreamOperatorState> operatorStates=runtimeContext.getOperatorStates();
  Map<String,Map<Serializable,StateHandle<Serializable>>> snapshots=new HashMap<String,Map<Serializable,StateHandle<Serializable>>>();
  for (  Entry<String,StreamOperatorState> state : operatorStates.entrySet()) {
    snapshots.put(state.getKey(),state.getValue().snapshotState(checkpointId,timestamp));
  }
  return (Serializable)snapshots;
}
