{
  Map<String,StreamOperatorState> operatorStates=runtimeContext.getOperatorStates();
  if (operatorStates.isEmpty()) {
    return null;
  }
 else {
    Map<String,PartitionedStateHandle> snapshots=new HashMap<String,PartitionedStateHandle>();
    for (    Entry<String,StreamOperatorState> state : operatorStates.entrySet()) {
      snapshots.put(state.getKey(),new PartitionedStateHandle(state.getValue().snapshotState(checkpointId,timestamp)));
    }
    return snapshots;
  }
}
