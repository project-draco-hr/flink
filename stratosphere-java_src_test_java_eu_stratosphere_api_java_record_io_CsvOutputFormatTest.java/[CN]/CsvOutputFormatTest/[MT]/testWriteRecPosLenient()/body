{
  try {
    Configuration config=new Configuration();
    config.setString(CsvOutputFormat.FIELD_DELIMITER_PARAMETER,"|");
    config.setInteger(CsvOutputFormat.NUM_FIELDS_PARAMETER,2);
    config.setClass(CsvOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 0,StringValue.class);
    config.setInteger(CsvOutputFormat.RECORD_POSITION_PARAMETER_PREFIX + 0,2);
    config.setClass(CsvOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 1,StringValue.class);
    config.setInteger(CsvOutputFormat.RECORD_POSITION_PARAMETER_PREFIX + 1,0);
    config.setBoolean(CsvOutputFormat.LENIENT_PARSING,true);
    format.configure(config);
    try {
      format.open(0,1);
    }
 catch (    IOException e) {
      fail(e.getMessage());
    }
    Record r=new Record(2);
    try {
      r.setField(0,new StringValue("Hello World"));
      r.setField(1,new IntValue(42));
      r.setField(2,new StringValue("Hello User"));
      format.writeRecord(r);
      r=new Record();
      r.setField(0,new StringValue("AbCdE"));
      r.setField(1,new IntValue(13));
      format.writeRecord(r);
      format.close();
      BufferedReader dis=new BufferedReader(new FileReader(tempFile));
      assertTrue((dis.readLine() + "\n").equals("Hello User|Hello World\n"));
      assertTrue((dis.readLine() + "\n").equals("|AbCdE\n"));
      dis.close();
    }
 catch (    IOException e) {
      fail(e.getMessage());
    }
  }
 catch (  Exception ex) {
    Assert.fail("Test failed due to a " + ex.getClass().getSimpleName() + ": "+ ex.getMessage());
  }
}
