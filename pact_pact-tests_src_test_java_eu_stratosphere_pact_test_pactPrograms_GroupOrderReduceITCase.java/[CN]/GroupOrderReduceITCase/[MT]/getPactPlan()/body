{
  int dop=this.config.getInteger("GroupOrderTest#NumSubtasks",1);
  FileDataSource source=new FileDataSource(RecordInputFormat.class,this.textPath,"Source");
  RecordInputFormat.configureRecordFormat(source).recordDelimiter('\n').fieldDelimiter(',').field(DecimalTextIntParser.class,0).field(DecimalTextIntParser.class,1);
  ReduceContract reducer=ReduceContract.builder(CheckingReducer.class).keyField(PactInteger.class,0).input(source).name("Ordered Reducer").build();
  reducer.setGroupOrder(new Ordering(1,PactInteger.class,Order.ASCENDING));
  FileDataSink sink=new FileDataSink(RecordOutputFormat.class,this.resultPath,reducer,"Sink");
  RecordOutputFormat.configureRecordFormat(sink).recordDelimiter('\n').fieldDelimiter(',').field(PactInteger.class,0).field(PactInteger.class,1);
  Plan p=new Plan(sink);
  p.setDefaultParallelism(dop);
  return p;
}
