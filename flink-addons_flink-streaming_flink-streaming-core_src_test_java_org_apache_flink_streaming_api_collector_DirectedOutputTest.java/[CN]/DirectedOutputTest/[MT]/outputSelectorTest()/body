{
  LocalStreamEnvironment env=StreamExecutionEnvironment.createLocalEnvironment(1);
  SplitDataStream<Long> source=env.generateSequence(1,11).split(new MyOutputSelector());
  source.select(EVEN).addSink(new ListSink(EVEN));
  source.select(ODD,TEN).addSink(new ListSink(ODD_AND_TEN));
  source.select(EVEN,ODD).addSink(new ListSink(EVEN_AND_ODD));
  source.selectAll().addSink(new ListSink(ALL));
  env.executeTest(128);
  assertEquals(Arrays.asList(2L,4L,6L,8L,10L),outputs.get(EVEN));
  assertEquals(Arrays.asList(1L,3L,5L,7L,9L,10L,11L),outputs.get(ODD_AND_TEN));
  assertEquals(Arrays.asList(1L,2L,3L,4L,5L,6L,7L,8L,9L,10L,11L),outputs.get(EVEN_AND_ODD));
  assertEquals(Arrays.asList(1L,2L,3L,4L,5L,6L,7L,8L,9L,10L,11L),outputs.get(ALL));
}
