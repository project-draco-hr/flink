{
  LogUtils.initializeDefaultConsoleLogger(Level.OFF,Level.OFF);
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment(1);
  SplitDataStream<Long> s=env.generateSequence(1,6).split(new MySelector());
  DataStream<Long> ds1=s.select("ds1").shuffle().map(new PlusTwo()).addSink(new EvenSink());
  DataStream<Long> ds2=s.select("ds2").map(new PlusTwo()).addSink(new OddSink());
  DataStream<Long> ds3=s.map(new PlusTwo()).addSink(new OddSink());
  env.execute();
  HashSet<Long> expectedEven=new HashSet<Long>(Arrays.asList(4L,6L,8L));
  HashSet<Long> expectedOdd=new HashSet<Long>(Arrays.asList(3L,5L,7L));
  assertEquals(expectedEven,evenSet);
  assertEquals(expectedOdd,oddSet);
}
