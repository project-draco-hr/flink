{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment(1);
  DataStream<Tuple1<Long>> s=env.generateSequence(1,6).directTo(new MySelector());
  DataStream<Tuple1<Long>> ds1=s.map(new PlusTwo()).name("ds1").addSink(new EvenSink());
  DataStream<Tuple1<Long>> ds2=s.map(new PlusTwo()).name("ds2").addSink(new OddSink());
  DataStream<Tuple1<Long>> ds3=s.map(new PlusTwo()).addSink(new OddSink());
  env.execute();
  HashSet<Long> expectedEven=new HashSet<Long>(Arrays.asList(4L,6L,8L));
  HashSet<Long> expectedOdd=new HashSet<Long>(Arrays.asList(3L,5L,7L));
  assertEquals(expectedEven,evenSet);
  assertEquals(expectedOdd,oddSet);
}
