{
  jobID.write(out);
  out.writeInt(accumulators.size());
  if (accumulators.size() > 0) {
    ByteArrayOutputStream boas=new ByteArrayOutputStream();
    DataOutputStream bufferStream=new DataOutputStream(boas);
    for (    Map.Entry<String,Accumulator<?,?>> entry : this.accumulators.entrySet()) {
      out.writeUTF(entry.getKey());
      out.writeUTF(entry.getValue().getClass().getName());
      entry.getValue().write(new OutputViewDataOutputStreamWrapper(bufferStream));
      bufferStream.flush();
      byte[] bytes=boas.toByteArray();
      out.writeInt(bytes.length);
      out.write(bytes);
      boas.reset();
    }
    bufferStream.close();
    boas.close();
  }
}
