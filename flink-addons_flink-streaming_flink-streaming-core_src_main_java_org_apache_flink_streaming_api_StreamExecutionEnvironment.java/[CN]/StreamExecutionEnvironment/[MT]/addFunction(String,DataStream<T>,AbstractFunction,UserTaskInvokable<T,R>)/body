{
  StreamOperator<T,R> returnStream=new StreamOperator<T,R>(this,functionName);
  try {
    jobGraphBuilder.addTask(returnStream.getId(),functionInvokable,functionName,SerializationUtils.serialize(function),degreeOfParallelism);
  }
 catch (  SerializationException e) {
    throw new RuntimeException("Cannot serialize user defined function");
  }
  connectGraph(inputStream,returnStream.getId());
  if (inputStream.iterationflag) {
    returnStream.addIterationSource(inputStream.iterationID.toString());
    inputStream.iterationflag=false;
  }
  return returnStream;
}
