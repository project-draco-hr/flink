{
  float memoryCutoffRatio=GlobalConfiguration.getFloat(ConfigConstants.YARN_HEAP_CUTOFF_RATIO,DEFAULT_YARN_HEAP_CUTOFF_RATIO);
  int heapLimitCap=GlobalConfiguration.getInteger(ConfigConstants.YARN_HEAP_LIMIT_CAP,DEFAULT_HEAP_LIMIT_CAP);
  int heapLimit=(int)((float)memory * memoryCutoffRatio);
  if ((memory - heapLimit) > heapLimitCap) {
    heapLimit=memory - heapLimitCap;
  }
  return heapLimit;
}
