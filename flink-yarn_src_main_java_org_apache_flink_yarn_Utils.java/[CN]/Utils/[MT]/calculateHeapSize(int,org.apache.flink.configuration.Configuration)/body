{
  float memoryCutoffRatio=conf.getFloat(ConfigConstants.YARN_HEAP_CUTOFF_RATIO,ConfigConstants.DEFAULT_YARN_HEAP_CUTOFF_RATIO);
  int minCutoff=conf.getInteger(ConfigConstants.YARN_HEAP_CUTOFF_MIN,ConfigConstants.DEFAULT_YARN_MIN_HEAP_CUTOFF);
  if (memoryCutoffRatio > 1 || memoryCutoffRatio < 0) {
    throw new IllegalArgumentException("The configuration value '" + ConfigConstants.YARN_HEAP_CUTOFF_RATIO + "' must be between 0 and 1. Value given="+ memoryCutoffRatio);
  }
  if (minCutoff > memory) {
    throw new IllegalArgumentException("The configuration value '" + ConfigConstants.YARN_HEAP_CUTOFF_MIN + "' is higher ("+ minCutoff+ ") than the requested amount of memory "+ memory);
  }
  int heapLimit=(int)((float)memory * memoryCutoffRatio);
  if (heapLimit < minCutoff) {
    heapLimit=minCutoff;
  }
  return memory - heapLimit;
}
