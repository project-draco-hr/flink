{
  if (this.writeMode) {
    final long currentFileSize=this.offset + this.totalBytesWritten;
    if (this.fileChannel != null) {
      this.fileChannel.position(currentFileSize);
    }
    this.fileChannel=null;
    this.bufferSize=this.totalBytesWritten;
    this.writeMode=false;
    this.fileBufferManager.reportEndOfWritePhase(this.gateID,currentFileSize);
  }
}
