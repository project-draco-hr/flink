{
  this.parser=new StringValueParser();
  this.parser.enableQuotedStringParsing((byte)'"');
  byte[] recBytes="\"abcdefgh\"|\"i\"|\"jklmno\"|".getBytes();
  StringValue s=new StringValue();
  int startPos=0;
  startPos=parser.parseField(recBytes,startPos,recBytes.length,new byte[]{'|'},s);
  assertTrue(startPos == 11);
  assertTrue(s.getValue().equals("abcdefgh"));
  startPos=parser.parseField(recBytes,startPos,recBytes.length,new byte[]{'|'},s);
  assertTrue(startPos == 15);
  assertTrue(s.getValue().equals("i"));
  startPos=parser.parseField(recBytes,startPos,recBytes.length,new byte[]{'|'},s);
  assertTrue(startPos == 24);
  assertTrue(s.getValue().equals("jklmno"));
  recBytes="\"abcde\"".getBytes();
  startPos=0;
  startPos=parser.parseField(recBytes,startPos,recBytes.length,new byte[]{'|'},s);
  assertTrue(startPos == 7);
  assertTrue(s.getValue().equals("abcde"));
  recBytes="\"abcde\"|\"fg\"".getBytes();
  startPos=0;
  startPos=parser.parseField(recBytes,startPos,recBytes.length,new byte[]{'|'},s);
  assertTrue(startPos == 8);
  assertTrue(s.getValue().equals("abcde"));
  startPos=parser.parseField(recBytes,startPos,recBytes.length,new byte[]{'|'},s);
  assertTrue(startPos == 12);
  assertTrue(s.getValue().equals("fg"));
  recBytes="\"abcde|fg\"|\"hij|kl|mn|op\"|".getBytes();
  startPos=0;
  startPos=parser.parseField(recBytes,startPos,recBytes.length,new byte[]{'|'},s);
  assertTrue(startPos == 11);
  assertTrue(s.getValue().equals("abcde|fg"));
  startPos=parser.parseField(recBytes,startPos,recBytes.length,new byte[]{'|'},s);
  assertTrue(startPos == 26);
  assertTrue(s.getValue().equals("hij|kl|mn|op"));
  recBytes="\"abcde|fg\"|\"hij|kl|mn|op\"".getBytes();
  startPos=0;
  startPos=parser.parseField(recBytes,startPos,recBytes.length,new byte[]{'|'},s);
  assertTrue(startPos == 11);
  assertTrue(s.getValue().equals("abcde|fg"));
  startPos=parser.parseField(recBytes,startPos,recBytes.length,new byte[]{'|'},s);
  assertTrue(startPos == 25);
  assertTrue(s.getValue().equals("hij|kl|mn|op"));
}
