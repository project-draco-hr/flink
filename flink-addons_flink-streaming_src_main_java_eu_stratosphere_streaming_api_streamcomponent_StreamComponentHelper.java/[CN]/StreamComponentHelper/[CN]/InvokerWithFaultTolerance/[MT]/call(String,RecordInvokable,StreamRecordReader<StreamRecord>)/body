{
  StreamRecord record=input.next();
  UID id=record.getId();
  userFunction.invoke(record);
  threadSafePublish(new AckEvent(id),input);
  log.debug("ACK: " + id + " -- "+ name);
}
