{
  int numberOfOutputs=taskConfiguration.getInteger("numberOfOutputs",0);
  for (int i=1; i <= numberOfOutputs; i++) {
    setPartitioner(taskConfiguration,i,partitioners);
  }
  for (  ChannelSelector<Record> outputPartitioner : partitioners) {
    if (taskBase instanceof StreamTask) {
      outputs.add(new RecordWriter<Record>((StreamTask)taskBase,Record.class,outputPartitioner));
    }
 else     if (taskBase instanceof StreamSource) {
      outputs.add(new RecordWriter<Record>((StreamSource)taskBase,Record.class,outputPartitioner));
    }
 else {
      throw new Exception("Nonsupported object passed to setConfigOutputs");
    }
  }
}
