{
  Class<? extends StreamInvokableComponent> userFunctionClass=taskConfiguration.getClass("userfunction",DefaultTaskInvokable.class,StreamInvokableComponent.class);
  StreamInvokableComponent userFunction=null;
  byte[] userFunctionSerialized=taskConfiguration.getBytes("serializedudf",null);
  if (userFunctionSerialized != null) {
    try {
      ObjectInputStream ois=new ObjectInputStream(new ByteArrayInputStream(userFunctionSerialized));
      userFunction=(StreamInvokableComponent)ois.readObject();
      userFunction.declareOutputs(outputs,instanceID,name,recordBuffer);
    }
 catch (    Exception e) {
      log.error("Cannot instanciate user function: " + userFunctionClass.getSimpleName());
    }
  }
 else {
    try {
      userFunction=userFunctionClass.newInstance();
      userFunction.declareOutputs(outputs,instanceID,name,recordBuffer);
    }
 catch (    InstantiationException e) {
      log.error("Cannot instanciate user function: " + userFunctionClass.getSimpleName());
    }
catch (    Exception e) {
      log.error("Cannot use user function: " + userFunctionClass.getSimpleName());
    }
  }
  return userFunction;
}
