{
  int numberOfInputs=taskConfiguration.getInteger("numberOfInputs",0);
  if (numberOfInputs < 2) {
    return new StreamRecordReader(taskBase,ArrayStreamRecord.class,inDeserializationDelegate,inTupleSerializer);
  }
 else {
    @SuppressWarnings("unchecked") MutableRecordReader<StreamRecord>[] recordReaders=(MutableRecordReader<StreamRecord>[])new MutableRecordReader<?>[numberOfInputs];
    for (int i=0; i < numberOfInputs; i++) {
      recordReaders[i]=new MutableRecordReader<StreamRecord>(taskBase);
    }
    return new UnionStreamRecordReader(recordReaders,ArrayStreamRecord.class,inDeserializationDelegate,inTupleSerializer);
  }
}
