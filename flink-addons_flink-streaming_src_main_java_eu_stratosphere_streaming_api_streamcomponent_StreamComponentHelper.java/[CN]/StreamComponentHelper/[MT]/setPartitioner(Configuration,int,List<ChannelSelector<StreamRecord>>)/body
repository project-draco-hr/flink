{
  Class<? extends ChannelSelector<StreamRecord>> partitioner=taskConfiguration.getClass("partitionerClass_" + nrOutput,DefaultPartitioner.class,ChannelSelector.class);
  try {
    if (partitioner.equals(FieldsPartitioner.class)) {
      int keyPosition=taskConfiguration.getInteger("partitionerIntParam_" + nrOutput,1);
      Class<? extends Key> keyClass=taskConfiguration.getClass("partitionerClassParam_" + nrOutput,StringValue.class,Key.class);
      partitioners.add(partitioner.getConstructor(int.class,Class.class).newInstance(keyPosition,keyClass));
    }
 else {
      partitioners.add(partitioner.newInstance());
    }
    log.debug("Partitioner set: " + partitioner.getSimpleName() + " with "+ nrOutput+ " outputs");
  }
 catch (  Exception e) {
    log.error("Error while setting partitioner: " + partitioner.getSimpleName() + " with "+ nrOutput+ " outputs",e);
  }
}
