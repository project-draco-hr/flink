{
  int numberOfOutputs=taskConfiguration.getInteger("numberOfOutputs",0);
  for (int i=0; i < numberOfOutputs; i++) {
    setPartitioner(taskConfiguration,i,partitioners);
    ChannelSelector<StreamRecord> outputPartitioner=partitioners.get(i);
    if (taskBase instanceof StreamTask) {
      outputs.add(new RecordWriter<StreamRecord>((StreamTask)taskBase,outputPartitioner));
    }
 else     if (taskBase instanceof StreamSource) {
      outputs.add(new RecordWriter<StreamRecord>((StreamSource)taskBase,outputPartitioner));
    }
 else {
      throw new StreamComponentException("Nonsupported object passed to setConfigOutputs");
    }
    if (outputs_f.size() < batchsizes_f.size()) {
      outputs_f.add(outputs.get(i));
    }
 else {
      outputs_s.add(outputs.get(i));
    }
  }
}
