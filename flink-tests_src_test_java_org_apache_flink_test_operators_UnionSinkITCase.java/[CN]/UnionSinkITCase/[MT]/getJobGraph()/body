{
  String path1=config.getBoolean("input1PathHasData",false) ? textInput : emptyInput;
  String path2=config.getBoolean("input2PathHasData",false) ? textInput : emptyInput;
  FileDataSource input1=new FileDataSource(new ContractITCaseInputFormat(),path1);
  FileDataSource input2=new FileDataSource(new ContractITCaseInputFormat(),path2);
  MapOperator testMapper1=MapOperator.builder(new TestMapper()).build();
  MapOperator testMapper2=MapOperator.builder(new TestMapper()).build();
  FileDataSink output=new FileDataSink(new ContractITCaseOutputFormat(),resultDir);
  testMapper1.setInput(input1);
  testMapper2.setInput(input2);
  output.addInput(testMapper1);
  output.addInput(testMapper2);
  Plan plan=new Plan(output);
  plan.setExecutionConfig(new ExecutionConfig());
  plan.setDefaultParallelism(parallelism);
  Optimizer pc=new Optimizer(new DataStatistics(),this.config);
  OptimizedPlan op=pc.compile(plan);
  JobGraphGenerator jgg=new JobGraphGenerator();
  return jgg.compileJobGraph(op);
}
