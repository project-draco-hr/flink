{
  this.config=config;
  this.taskName=taskName;
  this.outputCollector=outputCollector;
  this.userCodeClassLoader=userCodeClassLoader;
  if (parent instanceof RegularPactTask) {
    this.udfContext=((RegularPactTask<?,?>)parent).createRuntimeContext(taskName);
  }
 else {
    Environment env=parent.getEnvironment();
    this.udfContext=new RuntimeUDFContext(taskName,env.getCurrentNumberOfSubtasks(),env.getIndexInSubtaskGroup(),env.getCopyTaskOfCacheFile());
  }
  setup(parent);
}
