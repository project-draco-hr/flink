{
  StreamTaskState state=new StreamTaskState();
  if (stateBackend != null) {
    HashMap<String,KvStateSnapshot<?,?,?,?,?>> partitionedSnapshots=stateBackend.snapshotPartitionedState(checkpointId,timestamp);
    if (partitionedSnapshots != null) {
      state.setKvStates(partitionedSnapshots);
    }
  }
  return state;
}
