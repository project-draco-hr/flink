{
  LocalProperties lp=source.getLocalPropertiesForParent(target);
  if (shipMode == null || shipMode.type() == ShipStrategyType.NONE) {
    throw new CompilerException("Cannot determine properties if shipping strategy is not defined.");
  }
 else   if (shipMode.type() == ShipStrategyType.FORWARD) {
    if (source.getDegreeOfParallelism() > target.getDegreeOfParallelism()) {
      lp.setOrdering(null);
      lp.setGrouped(false,null);
    }
  }
 else {
    lp.reset();
  }
  if (lp.isGrouped() == false && shipMode.type() != ShipStrategyType.BROADCAST && shipMode.type() != ShipStrategyType.SFR) {
    if (source.getUniqueFields().size() > 0) {
      lp.setGrouped(true,source.getUniqueFields().iterator().next());
    }
  }
  return lp;
}
