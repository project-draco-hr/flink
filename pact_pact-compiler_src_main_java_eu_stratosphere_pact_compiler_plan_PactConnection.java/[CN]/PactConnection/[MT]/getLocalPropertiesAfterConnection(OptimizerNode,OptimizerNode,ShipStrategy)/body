{
  LocalProperties lp=source.getLocalProperties().createCopy();
  if (shipMode == null || shipMode == ShipStrategy.NONE) {
    throw new CompilerException("Cannot determine properties if shipping strategy is not defined.");
  }
 else   if (shipMode == ShipStrategy.FORWARD) {
    if (source.getDegreeOfParallelism() > target.getDegreeOfParallelism()) {
      lp.setKeyOrder(Order.NONE);
      lp.setKeysGrouped(lp.isKeyUnique());
    }
  }
 else {
    lp.reset();
  }
  return lp;
}
