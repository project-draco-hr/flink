{
  GlobalProperties gp=source.getGlobalProperties().createCopy();
switch (shipMode) {
case BROADCAST:
    gp.reset();
  break;
case PARTITION_RANGE:
gp.setPartitioning(PartitionProperty.RANGE_PARTITIONED);
break;
case PARTITION_HASH:
gp.setPartitioning(PartitionProperty.HASH_PARTITIONED);
gp.setKeyOrder(Order.NONE);
break;
case FORWARD:
break;
case NONE:
throw new CompilerException("Cannot determine properties after connection, id shipping strategy is not set.");
case SFR:
default :
throw new CompilerException("Unsupported shipping strategy: " + shipMode.name());
}
return gp;
}
