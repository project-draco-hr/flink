{
  int numColumns=currentStateHandleInView.readInt();
  currentStateHandleKVStateColumnFamilies=new ArrayList<>(numColumns);
  for (int i=0; i < numColumns; i++) {
    ObjectInputStream ooIn=new ObjectInputStream(currentStateHandleInStream);
    StateDescriptor stateDescriptor=(StateDescriptor)ooIn.readObject();
    Tuple2<ColumnFamilyHandle,StateDescriptor> columnFamily=rocksDBKeyedStateBackend.kvStateInformation.get(stateDescriptor.getName());
    if (null == columnFamily) {
      ColumnFamilyDescriptor columnFamilyDescriptor=new ColumnFamilyDescriptor(stateDescriptor.getName().getBytes(),rocksDBKeyedStateBackend.columnOptions);
      columnFamily=new Tuple2<>(rocksDBKeyedStateBackend.db.createColumnFamily(columnFamilyDescriptor),stateDescriptor);
      rocksDBKeyedStateBackend.kvStateInformation.put(stateDescriptor.getName(),columnFamily);
    }
    currentStateHandleKVStateColumnFamilies.add(columnFamily.f0);
  }
}
