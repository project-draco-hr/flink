{
  Graph<K,Long,NullValue> undirectedGraph=graph.mapEdges(new NullValueEdgeMapper<K,EV>()).getUndirected();
  return undirectedGraph.runGatherSumApplyIteration(new GatherNeighborIds(),new SelectMinId(),new UpdateComponentId<K>(),maxIterations).getVertices();
}
