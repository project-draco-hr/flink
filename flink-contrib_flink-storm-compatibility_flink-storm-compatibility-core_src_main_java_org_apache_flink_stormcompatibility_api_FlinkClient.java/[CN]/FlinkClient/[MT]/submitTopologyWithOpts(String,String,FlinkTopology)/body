{
  if (this.getTopologyJobId(name) != null) {
    throw new AlreadyAliveException();
  }
  final File uploadedJarFile=new File(uploadedJarLocation);
  try {
    JobWithJars.checkJarFile(uploadedJarFile);
  }
 catch (  final IOException e) {
    throw new RuntimeException("Problem with jar file " + uploadedJarFile.getAbsolutePath(),e);
  }
  final List<File> jarFiles=new ArrayList<File>();
  jarFiles.add(uploadedJarFile);
  final JobGraph jobGraph=topology.getStreamGraph().getJobGraph(name);
  jobGraph.addJar(new Path(uploadedJarFile.getAbsolutePath()));
  final Configuration configuration=jobGraph.getJobConfiguration();
  final Client client;
  configuration.setString(ConfigConstants.JOB_MANAGER_IPC_ADDRESS_KEY,jobManagerHost);
  configuration.setInteger(ConfigConstants.JOB_MANAGER_IPC_PORT_KEY,jobManagerPort);
  client=new Client(configuration,JobWithJars.buildUserCodeClassLoader(jarFiles,JobWithJars.class.getClassLoader()),-1);
  try {
    client.run(jobGraph,false);
  }
 catch (  final ProgramInvocationException e) {
    throw new RuntimeException("Cannot execute job due to ProgramInvocationException",e);
  }
}
