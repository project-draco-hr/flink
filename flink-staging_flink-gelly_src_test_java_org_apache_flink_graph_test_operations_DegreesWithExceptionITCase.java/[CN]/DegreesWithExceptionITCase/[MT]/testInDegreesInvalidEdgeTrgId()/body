{
  final ExecutionEnvironment env=ExecutionEnvironment.createRemoteEnvironment("localhost",cluster.getJobManagerRPCPort());
  env.setParallelism(PARALLELISM);
  Graph<Long,Long,Long> graph=Graph.fromDataSet(TestGraphUtils.getLongLongVertexData(env),TestGraphUtils.getLongLongEdgeInvalidTrgData(env),env);
  try {
    graph.inDegrees().output(new DiscardingOutputFormat<Tuple2<Long,Long>>());
    env.execute();
    fail("graph.inDegrees() did not throw NoSuchElementException");
  }
 catch (  Exception e) {
    assertTrue("Root exception has to be of type ProgramInvocationException.",e instanceof ProgramInvocationException);
    assertTrue("ProgramInvocationException's cause has to be of type JobExecutionException.",e.getCause() instanceof JobExecutionException);
    assertTrue("JobExecutionException's cause has to be of type NoSuchElementException.",e.getCause().getCause() instanceof NoSuchElementException);
  }
}
