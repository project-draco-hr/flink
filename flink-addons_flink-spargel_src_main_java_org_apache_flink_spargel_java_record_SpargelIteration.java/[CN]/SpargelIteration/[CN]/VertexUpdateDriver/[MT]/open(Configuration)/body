{
  if (vertexUpdateFunction == null) {
    ClassLoader cl=getRuntimeContext().getUserCodeClassLoader();
    Class<K> vertexKeyClass=parameters.getClass(KEY_PARAM,null,cl);
    Class<V> vertexValueClass=parameters.getClass(VALUE_PARAM,null,cl);
    Class<M> messageClass=parameters.getClass(MESSAGE_PARAM,null,cl);
    vertexKey=InstantiationUtil.instantiate(vertexKeyClass,Key.class);
    vertexValue=InstantiationUtil.instantiate(vertexValueClass,Value.class);
    messageIter=new MessageIterator<M>(InstantiationUtil.instantiate(messageClass,Value.class));
    ClassLoader ucl=getRuntimeContext().getUserCodeClassLoader();
    try {
      this.vertexUpdateFunction=(VertexUpdateFunction<K,V,M>)InstantiationUtil.readObjectFromConfig(parameters,UDF_PARAM,ucl);
    }
 catch (    Exception e) {
      String message=e.getMessage() == null ? "." : ": " + e.getMessage();
      throw new Exception("Could not instantiate VertexUpdateFunction" + message,e);
    }
    this.vertexUpdateFunction.init(getIterationRuntimeContext());
    this.vertexUpdateFunction.setup(parameters);
  }
  this.vertexUpdateFunction.preSuperstep();
}
