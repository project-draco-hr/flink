{
  PartitionMetadata metadata;
  do {
    metadata=findLeader(hosts,port,topic,partition);
    try {
      Thread.sleep(1000L);
    }
 catch (    InterruptedException e) {
      e.printStackTrace();
    }
  }
 while (metadata == null);
  if (metadata.leader() == null) {
    throw new RuntimeException("Can't find Leader for Topic and Partition. (at " + hosts.get(0) + ":"+ port);
  }
  String leadBroker=metadata.leader().host();
  clientName="Client_" + topic + "_"+ partition;
  consumer=new SimpleConsumer(leadBroker,port,100000,64 * 1024,clientName);
}
