{
  final int totalNumberOfBuffers=GlobalBufferPool.getInstance().getTotalNumberOfBuffers();
  int totalNumberOfChannels=this.registeredChannels.size();
  if (this.multicastEnabled) {
    totalNumberOfChannels+=NUMBER_OF_CHANNELS_FOR_MULTICAST;
  }
  final double buffersPerChannel=(double)totalNumberOfBuffers / (double)totalNumberOfChannels;
  if (buffersPerChannel < 1.0) {
    LOG.warn("System is low on memory buffers. This may result in reduced performance.");
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Total number of buffers is " + totalNumberOfBuffers);
    LOG.debug("Total number of channels is " + totalNumberOfChannels);
  }
  if (this.localBufferPoolOwner.isEmpty()) {
    return;
  }
  final Iterator<LocalBufferPoolOwner> it=this.localBufferPoolOwner.values().iterator();
  while (it.hasNext()) {
    final LocalBufferPoolOwner lbpo=it.next();
    lbpo.setDesignatedNumberOfBuffers((int)Math.ceil(buffersPerChannel * lbpo.getMinimumNumberOfRequiredBuffers()));
  }
  if (this.multicastEnabled) {
    this.transitBufferPool.setDesignatedNumberOfBuffers((int)Math.ceil(buffersPerChannel * NUMBER_OF_CHANNELS_FOR_MULTICAST));
  }
}
