{
  ExecutionVertex2 vertex=mock(ExecutionVertex2.class);
  when(vertex.getPreferredLocations()).thenReturn(Arrays.asList(locations));
  when(vertex.getJobId()).thenReturn(new JobID());
  when(vertex.getJobvertexId()).thenReturn(jid);
  when(vertex.getParallelSubtaskIndex()).thenReturn(taskIndex);
  when(vertex.getTotalNumberOfParallelSubtasks()).thenReturn(numTasks);
  when(vertex.toString()).thenReturn("TEST-VERTEX");
  return vertex;
}
