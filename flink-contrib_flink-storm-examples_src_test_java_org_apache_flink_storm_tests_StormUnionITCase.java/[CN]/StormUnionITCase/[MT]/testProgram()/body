{
  final TopologyBuilder builder=new TopologyBuilder();
  builder.setSpout(spoutId1,new FiniteRandomSpout(0,10));
  builder.setSpout(spoutId2,new FiniteRandomSpout(1,8));
  builder.setSpout(spoutId3,new FiniteRandomSpout(2,13));
  builder.setBolt(boltId,new MergerBolt()).shuffleGrouping(spoutId1,FiniteRandomSpout.STREAM_PREFIX + 0).shuffleGrouping(spoutId2,FiniteRandomSpout.STREAM_PREFIX + 0).shuffleGrouping(spoutId3,FiniteRandomSpout.STREAM_PREFIX + 0);
  final String[] tokens=this.resultPath.split(":");
  final String outputFile=tokens[tokens.length - 1];
  builder.setBolt(sinkId,new BoltFileSink(outputFile)).shuffleGrouping(boltId);
  final FlinkLocalCluster cluster=FlinkLocalCluster.getLocalCluster();
  cluster.submitTopology(topologyId,null,FlinkTopology.createTopology(builder));
  Utils.sleep(10 * 1000);
  cluster.killTopology(topologyId);
  cluster.shutdown();
}
