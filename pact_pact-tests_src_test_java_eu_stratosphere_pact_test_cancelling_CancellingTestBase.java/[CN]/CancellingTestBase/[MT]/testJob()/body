{
  preSubmit();
  final JobGraph jobGraph;
  try {
    jobGraph=getJobGraph();
  }
 catch (  Exception e) {
    LOG.error(e);
    Assert.fail("Failed to obtain JobGraph!");
    return;
  }
  final JobClient client;
  final JobSubmissionResult submissionResult;
  final long startingTime=System.currentTimeMillis();
  try {
    client=cluster.getJobClient(jobGraph,getJarFilePath());
    client.submitJob();
  }
 catch (  Exception e) {
    LOG.error(e);
    Assert.fail("Job execution failed!");
    return;
  }
  client.getJobProgress();
  postSubmit();
}
