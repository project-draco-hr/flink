{
  try {
    final int[] partitions={4,52,17,1};
    final Set<Integer> allPartitions=new HashSet<>();
    for (    int i : partitions) {
      allPartitions.add(i);
    }
    final int numConsumers=2 * partitions.length + 3;
    for (int i=0; i < numConsumers; i++) {
      List<TopicPartition> parts=FlinkKafkaConsumer.assignPartitions(partitions,"test-topic",numConsumers,i);
      assertNotNull(parts);
      assertTrue(parts.size() <= 1);
      for (      TopicPartition p : parts) {
        assertTrue(allPartitions.remove(p.partition()));
      }
    }
    assertTrue(allPartitions.isEmpty());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
