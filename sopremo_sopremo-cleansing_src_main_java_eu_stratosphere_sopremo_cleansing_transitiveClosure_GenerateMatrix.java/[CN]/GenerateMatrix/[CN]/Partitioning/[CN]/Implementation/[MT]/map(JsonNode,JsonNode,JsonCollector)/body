{
  JsonNode value1=((ArrayNode)value).get(0);
  JsonNode value2=((ArrayNode)value).get(1);
  int id1=((IntNode)((ObjectNode)value1).get("id")).getIntValue();
  int id2=((IntNode)((ObjectNode)value2).get("id")).getIntValue();
  IntNode partition1=new IntNode(id1 % this.numberOfPartitions);
  IntNode partition2=new IntNode(id2 % this.numberOfPartitions);
  if (partition1.compareTo(partition2) <= 0) {
    out.collect(new ArrayNode(partition1,partition2),new ArrayNode(value1,value2));
  }
 else {
    out.collect(new ArrayNode(partition2,partition1),new ArrayNode(value2,value1));
  }
}
