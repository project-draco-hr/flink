{
  AbstractJobVertex upStreamVertex=streamVertices.get(upStreamVertexName);
  AbstractJobVertex downStreamVertex=streamVertices.get(downStreamVertexName);
  StreamConfig config=new StreamConfig(upStreamVertex.getConfiguration());
  if (partitionerObject.getStrategy() == PartitioningStrategy.FORWARD) {
    downStreamVertex.connectNewDataSetAsInput(upStreamVertex,DistributionPattern.POINTWISE);
  }
 else {
    downStreamVertex.connectNewDataSetAsInput(upStreamVertex,DistributionPattern.ALL_TO_ALL);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("CONNECTED: {} - {} -> {}",partitionerObject.getClass().getSimpleName(),upStreamVertexName,downStreamVertexName);
  }
  int outputIndex=upStreamVertex.getNumberOfProducedIntermediateDataSets() - 1;
  config.setOutputName(outputIndex,outEdgeNames.get(lastInChains.get(upStreamVertexName)).get(outputIndex));
  config.setSelectAll(outputIndex,outEdgeSelectAll.get(lastInChains.get(upStreamVertexName)).get(outputIndex));
  config.setPartitioner(outputIndex,partitionerObject);
  config.setNumberOfOutputChannels(outputIndex,vertexParallelism.get(downStreamVertexName));
}
