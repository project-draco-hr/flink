{
  for (  String sourceName : sources) {
    createVertex(sourceName);
  }
  for (  String upStreamVertexName : builtVertices) {
    int i=0;
    List<Integer> outEdgeTypeList=outEdgeIndex.get(lastInChains.get(upStreamVertexName));
    for (    String downStreamVertexName : outEdgeList.get(lastInChains.get(upStreamVertexName))) {
      StreamConfig downStreamVertexConfig=new StreamConfig(streamVertices.get(downStreamVertexName).getConfiguration());
      int inputNumber=downStreamVertexConfig.getNumberOfInputs();
      downStreamVertexConfig.setInputIndex(inputNumber++,outEdgeTypeList.get(i));
      downStreamVertexConfig.setNumberOfInputs(inputNumber);
      connect(upStreamVertexName,downStreamVertexName,outPartitioning.get(lastInChains.get(upStreamVertexName)).get(i));
      i++;
    }
  }
  setSlotSharing();
  setNumberOfJobInputs();
  setNumberOfJobOutputs();
}
