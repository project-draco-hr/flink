{
  byte[] serializedPartitioner=configuration.getBytes("partitionerObject_" + outputNumber,SerializationUtils.serialize((new ShufflePartitioner<OUT>())));
  StreamPartitioner<OUT> outputPartitioner=null;
  try {
    outputPartitioner=deserializeObject(serializedPartitioner);
    RecordWriter<StreamRecord<OUT>> output=new RecordWriter<StreamRecord<OUT>>(this,outputPartitioner);
    outputs.add(output);
    String outputName=configuration.getString("outputName_" + outputNumber,null);
    if (collector != null) {
      collector.addOutput(output,outputName);
    }
    if (LOG.isTraceEnabled()) {
      LOG.trace("Partitioner set: " + outputPartitioner.getClass().getSimpleName() + " with "+ outputNumber+ " outputs");
    }
  }
 catch (  Exception e) {
    throw new StreamComponentException("Cannot deserialize partitioner " + outputPartitioner.getClass().getSimpleName() + " with "+ outputNumber+ " outputs");
  }
}
