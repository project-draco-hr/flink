{
  if (configuration.getBoolean("directedEmit",false)) {
    OutputSelector<OUT> outputSelector=null;
    try {
      outputSelector=(OutputSelector<OUT>)deserializeObject(configuration.getBytes("outputSelector",null));
    }
 catch (    Exception e) {
      throw new StreamComponentException("Cannot deserialize and instantiate OutputSelector",e);
    }
    collector=new DirectedStreamCollector<OUT>(instanceID,outSerializationDelegate,outputSelector);
  }
 else {
    collector=new StreamCollector<OUT>(instanceID,outSerializationDelegate);
  }
  return collector;
}
