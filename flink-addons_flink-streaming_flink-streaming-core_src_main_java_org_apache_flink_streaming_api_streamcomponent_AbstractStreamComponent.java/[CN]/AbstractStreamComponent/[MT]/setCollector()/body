{
  if (configuration.getBoolean("directedEmit",false)) {
    OutputSelector<OUT> outputSelector=null;
    try {
      outputSelector=(OutputSelector<OUT>)deserializeObject(configuration.getBytes("outputSelector",null));
    }
 catch (    Exception e) {
      if (log.isErrorEnabled()) {
        log.error("Cannot instantiate OutputSelector");
      }
    }
    collectorManager=new DirectedStreamCollector<OUT>(instanceID,outSerializationDelegate,outputSelector);
  }
 else {
    collectorManager=new StreamCollector<OUT>(instanceID,outSerializationDelegate);
  }
  return collectorManager;
}
