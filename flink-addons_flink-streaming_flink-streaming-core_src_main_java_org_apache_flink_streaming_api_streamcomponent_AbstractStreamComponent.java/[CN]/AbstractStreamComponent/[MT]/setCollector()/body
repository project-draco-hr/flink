{
  if (configuration.getBoolean("directedEmit",false)) {
    OutputSelector outputSelector=null;
    try {
      outputSelector=(OutputSelector)deserializeObject(configuration.getBytes("outputSelector",null));
    }
 catch (    Exception e) {
      if (log.isErrorEnabled()) {
        log.error("Cannot instantiate OutputSelector");
      }
    }
    collectorManager=new DirectedStreamCollector(instanceID,outSerializationDelegate,outputSelector);
  }
 else {
    collectorManager=new StreamCollector(instanceID,outSerializationDelegate);
  }
  return collectorManager;
}
