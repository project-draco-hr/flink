{
  if (inputs instanceof UnionStreamRecordReader) {
    UnionStreamRecordReader<IN> recordReader=(UnionStreamRecordReader<IN>)inputs;
    while (recordReader.hasNext()) {
      StreamRecord<IN> record=recordReader.next();
      userFunction.invoke(record,collector);
    }
  }
 else   if (inputs instanceof StreamRecordReader) {
    StreamRecordReader<IN> recordReader=(StreamRecordReader<IN>)inputs;
    while (recordReader.hasNext()) {
      StreamRecord<IN> record=recordReader.next();
      userFunction.invoke(record,collector);
    }
  }
}
