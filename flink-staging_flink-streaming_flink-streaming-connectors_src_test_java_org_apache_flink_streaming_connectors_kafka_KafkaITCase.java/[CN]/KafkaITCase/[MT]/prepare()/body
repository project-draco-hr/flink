{
  LOG.info("Starting KafkaITCase.prepare()");
  tmpZkDir=tempFolder.newFolder();
  tmpKafkaDir=tempFolder.newFolder();
  kafkaHost=InetAddress.getLocalHost().getHostName();
  zkPort=NetUtils.getAvailablePort();
  kafkaPort=NetUtils.getAvailablePort();
  zookeeperConnectionString="localhost:" + zkPort;
  zookeeper=null;
  broker1=null;
  try {
    LOG.info("Starting Zookeeper");
    zookeeper=getZookeeper();
    LOG.info("Starting KafkaServer");
    broker1=getKafkaServer(0);
    LOG.info("ZK and KafkaServer started.");
  }
 catch (  Throwable t) {
    LOG.warn("Test failed with exception",t);
    Assert.fail("Test failed with: " + t.getMessage());
  }
}
