{
  KeyValuePair<Key,Value> pair=null;
  LOG.info("Start PACT code: " + this.getEnvironment().getTaskName() + " ("+ (this.getEnvironment().getIndexInSubtaskGroup() + 1)+ "/"+ this.getEnvironment().getCurrentNumberOfSubtasks()+ ")");
  final Iterator<FileInputSplit> splitIterator=getFileInputSplits();
  boolean immutable=config.getMutability() == Config.Mutability.IMMUTABLE;
  while (splitIterator.hasNext()) {
    if (this.taskCanceled) {
      break;
    }
    final FileInputSplit split=splitIterator.next();
    final long start=split.getStart();
    final long length=split.getLength();
    LOG.debug("Opening input split " + split.getPath() + " : "+ this.getEnvironment().getTaskName()+ " ("+ (this.getEnvironment().getIndexInSubtaskGroup() + 1)+ "/"+ this.getEnvironment().getCurrentNumberOfSubtasks()+ ")");
    FileSystem fs=FileSystem.get(split.getPath().toUri(),new org.apache.hadoop.conf.Configuration());
    FSDataInputStream fdis=fs.open(new Path(split.getPath().toUri().toString()));
    format.setInput(new DistributedDataInputStream(fdis),start,length,(1024 * 1024));
    format.open();
    LOG.debug("Starting reader on file " + split.getPath() + " : "+ this.getEnvironment().getTaskName()+ " ("+ (this.getEnvironment().getIndexInSubtaskGroup() + 1)+ "/"+ this.getEnvironment().getCurrentNumberOfSubtasks()+ ")");
    if (!immutable) {
      pair=format.createPair();
    }
    while (!format.reachedEnd() && !this.taskCanceled) {
      if (immutable) {
        pair=format.createPair();
      }
      boolean valid=format.nextPair(pair);
      if (valid) {
        output.collect(pair.getKey(),pair.getValue());
      }
    }
    format.close();
    LOG.debug("Closing input split " + split.getPath() + " : "+ this.getEnvironment().getTaskName()+ " ("+ (this.getEnvironment().getIndexInSubtaskGroup() + 1)+ "/"+ this.getEnvironment().getCurrentNumberOfSubtasks()+ ")");
  }
  if (!this.taskCanceled) {
    LOG.info("Finished PACT code: " + this.getEnvironment().getTaskName() + " ("+ (this.getEnvironment().getIndexInSubtaskGroup() + 1)+ "/"+ this.getEnvironment().getCurrentNumberOfSubtasks()+ ")");
  }
 else {
    LOG.warn("PACT code cancelled: " + this.getEnvironment().getTaskName() + " ("+ (this.getEnvironment().getIndexInSubtaskGroup() + 1)+ "/"+ this.getEnvironment().getCurrentNumberOfSubtasks()+ ")");
  }
}
