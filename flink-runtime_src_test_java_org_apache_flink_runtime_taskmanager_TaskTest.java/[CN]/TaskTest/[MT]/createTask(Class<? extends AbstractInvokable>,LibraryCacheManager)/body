{
  ResultPartitionManager partitionManager=mock(ResultPartitionManager.class);
  ResultPartitionConsumableNotifier consumableNotifier=mock(ResultPartitionConsumableNotifier.class);
  NetworkEnvironment network=mock(NetworkEnvironment.class);
  JobManagerCommunicationFactory jobManagerCommunicationFactory=mock(JobManagerCommunicationFactory.class);
  when(network.getResultPartitionManager()).thenReturn(partitionManager);
  when(network.getDefaultIOMode()).thenReturn(IOManager.IOMode.SYNC);
  when(network.createKvStateTaskRegistry(any(JobID.class),any(JobVertexID.class))).thenReturn(mock(TaskKvStateRegistry.class));
  when(jobManagerCommunicationFactory.createResultPartitionConsumableNotifier(any(Task.class))).thenReturn(consumableNotifier);
  return createTask(invokable,libCache,network,jobManagerCommunicationFactory);
}
