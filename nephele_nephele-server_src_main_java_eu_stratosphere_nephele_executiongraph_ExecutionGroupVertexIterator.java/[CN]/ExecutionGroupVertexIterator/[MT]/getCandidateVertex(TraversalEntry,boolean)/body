{
  while (true) {
    if (forward) {
      if (te.getCurrentLink() >= te.getGroupVertex().getNumberOfForwardLinks()) {
        break;
      }
    }
 else {
      if (te.getCurrentLink() >= te.getGroupVertex().getNumberOfBackwardLinks()) {
        break;
      }
    }
    ExecutionGroupVertex tmp=null;
    if (forward) {
      tmp=te.getGroupVertex().getForwardEdge(te.getCurrentLink()).getTargetVertex();
    }
 else {
      tmp=te.getGroupVertex().getBackwardEdge(te.getCurrentLink()).getSourceVertex();
    }
    te.increaseCurrentLink();
    if (stage >= 0) {
      if (tmp.getStageNumber() != stage) {
        continue;
      }
    }
    if (!alreadyVisited.contains(tmp)) {
      return tmp;
    }
  }
  return null;
}
