{
  if (!this.type.isTupleType()) {
    throw new InvalidProgramException("Specifying order keys via field positions is only valid for tuple data types");
  }
  if (field >= this.type.getArity()) {
    throw new InvalidProgramException("Order key out of tuple bounds.");
  }
  if (this.sortKeyPositions == null) {
    this.sortKeyPositions=new int[]{field};
    this.sortOrders=new Order[]{order};
  }
 else {
    int newLength=this.sortKeyPositions.length + 1;
    this.sortKeyPositions=Arrays.copyOf(this.sortKeyPositions,newLength);
    this.sortOrders=Arrays.copyOf(this.sortOrders,newLength);
    this.sortKeyPositions[newLength - 1]=field;
    this.sortOrders[newLength - 1]=order;
  }
  return this;
}
