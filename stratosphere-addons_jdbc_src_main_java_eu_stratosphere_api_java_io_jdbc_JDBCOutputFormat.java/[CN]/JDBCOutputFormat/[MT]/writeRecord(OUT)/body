{
  try {
    if (query.split("\\?,").length != tuple.getArity()) {
      close();
      throw new IOException("Tuple size does not match columncount");
    }
    if (types == null) {
      extractTypes(tuple);
    }
    addValues(tuple);
    upload.addBatch();
    batchCount++;
    if (batchCount >= batchInterval) {
      upload.executeBatch();
      batchCount=0;
    }
  }
 catch (  SQLException sqe) {
    close();
    throw new IllegalArgumentException("writeRecord() failed",sqe);
  }
catch (  IllegalArgumentException iae) {
    close();
    throw new IllegalArgumentException("writeRecord() failed",iae);
  }
}
