{
  notPartitionedCollectors=new ArrayList<StreamCollector<Tuple>>(batchSizesOfNotPartitioned.length);
  partitionedCollectors=new ArrayList<StreamCollector<Tuple>[]>(batchSizesOfPartitioned.length);
  this.keyPostition=keyPosition;
  for (int i=0; i < batchSizesOfNotPartitioned.length; i++) {
    notPartitionedCollectors.add(new StreamCollector<Tuple>(batchSizesOfNotPartitioned[i],batchTimeout,channelID,serializationDelegate,outputs));
  }
  for (int i=0; i < batchSizesOfPartitioned.length; i++) {
    StreamCollector<Tuple>[] collectors=new StreamCollector[parallelismOfOutput[i]];
    for (int j=0; j < collectors.length; j++) {
      collectors[j]=new StreamCollector<Tuple>(batchSizesOfPartitioned[i],batchTimeout,channelID,serializationDelegate,outputs);
    }
    partitionedCollectors.add(collectors);
  }
}
