{
  if (getType() instanceof BasicArrayTypeInfo || getType() instanceof PrimitiveArrayTypeInfo) {
    return partitionByHash(new KeySelectorUtil.ArrayKeySelector<OUT>(fields));
  }
 else {
    return partitionByHash(new Keys.ExpressionKeys<OUT>(fields,getType()));
  }
}
