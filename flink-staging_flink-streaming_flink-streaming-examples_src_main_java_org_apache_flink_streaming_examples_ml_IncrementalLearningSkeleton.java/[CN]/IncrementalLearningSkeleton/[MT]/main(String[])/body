{
  if (!parseParameters(args)) {
    return;
  }
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.setStreamTimeCharacteristic(TimeCharacteristic.EventTime);
  trainingData=env.addSource(new FiniteTrainingDataSource());
  newData=env.addSource(new FiniteNewDataSource());
  DataStream<Double[]> model=trainingData.extractTimestamp(new LinearTimestamp()).timeWindowAll(Time.of(5000,TimeUnit.MILLISECONDS)).apply(new PartialModelBuilder());
  DataStream<Integer> prediction=newData.connect(model).map(new Predictor());
  if (fileOutput) {
    prediction.writeAsText(outputPath,1);
  }
 else {
    prediction.print();
  }
  env.execute("Streaming Incremental Learning");
}
