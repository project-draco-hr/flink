{
  KafkaConsumer<byte[],byte[]> consumer;
  try {
    consumer=new KafkaConsumer<byte[],byte[]>(properties,null,new ByteArrayDeserializer(),new ByteArrayDeserializer());
  }
 catch (  KafkaException e) {
    throw new RuntimeException("Cannot access the Kafka partition metadata: " + e.getMessage(),e);
  }
  List<PartitionInfo> partitions;
  try {
    partitions=consumer.partitionsFor(topic);
  }
  finally {
    consumer.close();
  }
  if (partitions == null) {
    throw new RuntimeException("The topic " + topic + " does not seem to exist");
  }
  if (partitions.isEmpty()) {
    throw new RuntimeException("The topic " + topic + " does not seem to have any partitions");
  }
  return partitions;
}
