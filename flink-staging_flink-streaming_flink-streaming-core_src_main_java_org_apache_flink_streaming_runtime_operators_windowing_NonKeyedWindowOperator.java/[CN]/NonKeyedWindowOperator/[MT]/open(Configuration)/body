{
  super.open(parameters);
  windows=Maps.newHashMap();
  watermarkTimers=Maps.newHashMap();
  processingTimeTimers=Maps.newHashMap();
  timestampedCollector=new TimestampedCollector<>(output);
  if (inputSerializer == null) {
    throw new IllegalStateException("Input serializer was not set.");
  }
  windowBufferFactory.setRuntimeContext(getRuntimeContext());
  windowBufferFactory.open(parameters);
}
