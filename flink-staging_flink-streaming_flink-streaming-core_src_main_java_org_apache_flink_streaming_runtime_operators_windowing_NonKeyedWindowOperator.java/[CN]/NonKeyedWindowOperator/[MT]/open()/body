{
  super.open();
  windows=new HashMap<>();
  watermarkTimers=new HashMap<>();
  processingTimeTimers=new HashMap<>();
  timestampedCollector=new TimestampedCollector<>(output);
  if (inputSerializer == null) {
    throw new IllegalStateException("Input serializer was not set.");
  }
  windowBufferFactory.setRuntimeContext(getRuntimeContext());
  windowBufferFactory.open(getUserFunctionParameters());
}
