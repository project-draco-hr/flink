{
  timestampedCollector.setTimestamp(window.getEnd());
  Tuple2<WindowBuffer<IN>,TriggerContext> bufferAndTrigger;
  if (purge) {
    bufferAndTrigger=windows.remove(window);
  }
 else {
    bufferAndTrigger=windows.get(window);
  }
  if (bufferAndTrigger == null) {
    LOG.debug("Window {} already gone.",window);
    return;
  }
  userFunction.apply(window,bufferAndTrigger.f0.getUnpackedElements(),timestampedCollector);
}
