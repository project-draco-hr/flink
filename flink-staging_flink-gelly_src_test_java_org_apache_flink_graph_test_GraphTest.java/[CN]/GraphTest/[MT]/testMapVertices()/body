{
  DataSet<Vertex<Integer,Integer>> doubled=graph.mapVertices(new MapFunction<Integer,Integer>(){
    @Override public Integer map(    Integer value) throws Exception {
      return value * 2;
    }
  }
);
  List<Vertex<Integer,Integer>> doubledData=new ArrayList<>();
  doubled.output(new LocalCollectionOutputFormat<>(doubledData));
  DataSet<Vertex<Integer,Integer>> doubledDataset=graph.getVertices().map(new MapFunction<Vertex<Integer,Integer>,Vertex<Integer,Integer>>(){
    @Override public Vertex<Integer,Integer> map(    Vertex<Integer,Integer> v) throws Exception {
      return new Vertex<Integer,Integer>(v.getKey(),v.getValue() * 2);
    }
  }
);
  List<Vertex<Integer,Integer>> originalDataDoubled=new ArrayList<>();
  doubledDataset.output(new LocalCollectionOutputFormat<>(originalDataDoubled));
  assertEquals(doubledData,originalDataDoubled);
}
