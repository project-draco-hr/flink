{
  Collection<Integer> inputIds=transform(transform.getInput());
  if (alreadyTransformed.containsKey(transform)) {
    return alreadyTransformed.get(transform);
  }
  streamGraph.addOperator(transform.getId(),transform.getOperator(),transform.getInputType(),transform.getOutputType(),transform.getName());
  if (transform.getStateKeySelector() != null) {
    streamGraph.setKey(transform.getId(),transform.getStateKeySelector());
  }
  streamGraph.setParallelism(transform.getId(),transform.getParallelism());
  for (  Integer inputId : inputIds) {
    streamGraph.addEdge(inputId,transform.getId(),0);
  }
  return Collections.singleton(transform.getId());
}
