{
  long currentTime=System.currentTimeMillis();
  ValueState<Long> fireState=ctx.getKeyValueState("fire-timestamp",0L);
  long nextFireTimestamp=fireState.value();
  if (nextFireTimestamp == 0) {
    long start=currentTime - (currentTime % interval);
    fireState.update(start + interval);
    ctx.registerProcessingTimeTimer(nextFireTimestamp);
    return TriggerResult.CONTINUE;
  }
  if (currentTime > nextFireTimestamp) {
    long start=currentTime - (currentTime % interval);
    fireState.update(start + interval);
    ctx.registerProcessingTimeTimer(nextFireTimestamp);
    return TriggerResult.FIRE;
  }
  return TriggerResult.CONTINUE;
}
