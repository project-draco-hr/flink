{
  this.flinkKafkaConsumer=requireNonNull(owner);
  this.config=requireNonNull(props,"The config properties cannot be null");
  this.userCodeClassloader=requireNonNull(userCodeClassloader);
  if (initialPartitionsToRead.size() == 0) {
    throw new IllegalArgumentException("List of initial partitions is empty");
  }
  for (  Map.Entry<KafkaTopicPartition,KafkaPartitionState> partitionToRead : initialPartitionsToRead.entrySet()) {
    KafkaTopicPartition ktp=partitionToRead.getKey();
    long offset=partitionToRead.getValue().getOffset();
    if (offset >= 0 && offset != FlinkKafkaConsumerBase.OFFSET_NOT_SET) {
      offset+=1L;
    }
    unassignedPartitions.add(new FetchPartition(ktp.getTopic(),ktp.getPartition(),offset));
  }
  this.taskName=taskName;
  this.error=new AtomicReference<>();
}
