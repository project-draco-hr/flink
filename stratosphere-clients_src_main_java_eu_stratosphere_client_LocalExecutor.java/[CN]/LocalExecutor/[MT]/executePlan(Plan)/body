{
synchronized (this.lock) {
    if (this.nephele == null) {
      throw new IllegalStateException("The local executor has not been started.");
    }
    PactCompiler pc=new PactCompiler(new DataStatistics());
    OptimizedPlan op=pc.compile(plan);
    NepheleJobGraphGenerator jgg=new NepheleJobGraphGenerator();
    JobGraph jobGraph=jgg.compileJobGraph(op);
    JobClient jobClient=this.nephele.getJobClient(jobGraph);
    JobExecutionResult result=jobClient.submitJobAndWait();
    return result;
  }
}
