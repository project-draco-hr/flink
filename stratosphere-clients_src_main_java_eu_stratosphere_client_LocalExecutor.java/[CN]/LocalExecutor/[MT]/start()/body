{
synchronized (this.lock) {
    if (this.nephele == null) {
      this.nephele=new NepheleMiniCluster();
      if (jobManagerRpcPort > 0) {
        nephele.setJobManagerRpcPort(jobManagerRpcPort);
      }
      if (taskManagerRpcPort > 0) {
        nephele.setTaskManagerRpcPort(jobManagerRpcPort);
      }
      if (taskManagerDataPort > 0) {
        nephele.setTaskManagerDataPort(taskManagerDataPort);
      }
      if (configDir != null) {
        nephele.setConfigDir(configDir);
      }
      if (hdfsConfigFile != null) {
        nephele.setHdfsConfigFile(hdfsConfigFile);
      }
      nephele.setDefaultOverwriteFiles(defaultOverwriteFiles);
      nephele.setDefaultAlwaysCreateDirectory(defaultAlwaysCreateDirectory);
      this.nephele.start(numTaskManager);
    }
 else {
      throw new IllegalStateException("The local executor was already started.");
    }
  }
}
