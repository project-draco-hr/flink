{
  final Object lock=context.getCheckpointLock();
  if (currentSplitsToFwd != null) {
synchronized (lock) {
      forwardSplits(currentSplitsToFwd,context);
    }
  }
  currentSplitsToFwd=null;
  if (splitsToFwdOrderedAscByModTime == null) {
    splitsToFwdOrderedAscByModTime=getInputSplitSortedOnModTime(fs);
  }
  Iterator<Tuple2<Long,List<FileInputSplit>>> it=splitsToFwdOrderedAscByModTime.iterator();
  while (it.hasNext()) {
synchronized (lock) {
      currentSplitsToFwd=it.next();
      it.remove();
      forwardSplits(currentSplitsToFwd,context);
    }
  }
  splitsToFwdOrderedAscByModTime=null;
  currentSplitsToFwd=null;
}
