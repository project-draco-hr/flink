{
  FileSystem fileSystem=FileSystem.get(new URI(path));
switch (watchType) {
case PROCESS_CONTINUOUSLY:
    while (isRunning) {
      monitorDirAndForwardSplits(fileSystem,context);
      Thread.sleep(interval);
    }
  isRunning=false;
break;
case PROCESS_ONCE:
monitorDirAndForwardSplits(fileSystem,context);
isRunning=false;
break;
default :
isRunning=false;
throw new RuntimeException("Unknown WatchType" + watchType);
}
}
