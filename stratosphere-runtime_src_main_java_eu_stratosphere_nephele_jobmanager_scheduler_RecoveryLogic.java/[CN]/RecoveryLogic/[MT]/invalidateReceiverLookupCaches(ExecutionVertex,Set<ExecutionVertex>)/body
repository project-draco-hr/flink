{
  final Map<AbstractInstance,Set<ChannelID>> entriesToInvalidate=new HashMap<AbstractInstance,Set<ChannelID>>();
  collectCacheEntriesToInvalidate(failedVertex,entriesToInvalidate);
  for (final Iterator<ExecutionVertex> it=verticesToBeCanceled.iterator(); it.hasNext(); ) {
    collectCacheEntriesToInvalidate(it.next(),entriesToInvalidate);
  }
  final Iterator<Map.Entry<AbstractInstance,Set<ChannelID>>> it=entriesToInvalidate.entrySet().iterator();
  while (it.hasNext()) {
    final Map.Entry<AbstractInstance,Set<ChannelID>> entry=it.next();
    final AbstractInstance instance=entry.getKey();
    try {
      instance.invalidateLookupCacheEntries(entry.getValue());
    }
 catch (    IOException ioe) {
      LOG.error(StringUtils.stringifyException(ioe));
      return false;
    }
  }
  return true;
}
