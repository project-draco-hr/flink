{
  int numSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String output=(args.length > 1 ? args[1] : "");
  GenericDataSource<TableInputFormat> source=new GenericDataSource<TableInputFormat>(new MyTableInputFormat(),"HBase Input");
  source.setParameter(TableInputFormat.INPUT_TABLE,"twitter");
  source.setParameter(TableInputFormat.CONFIG_LOCATION,"/etc/hbase/conf/hbase-site.xml");
  FileDataSink out=new FileDataSink(new CsvOutputFormat(),output,source,"HBase String dump");
  CsvOutputFormat.configureRecordFormat(out).recordDelimiter('\n').fieldDelimiter(' ').field(PactString.class,0).field(PactString.class,1).field(PactString.class,2).field(PactString.class,3);
  Plan plan=new Plan(out,"HBase access Example");
  plan.setDefaultParallelism(numSubTasks);
  return plan;
}
