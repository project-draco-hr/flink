{
  ArrayList<MemorySegment> segments=new ArrayList<MemorySegment>(this.fullSegments.size() + this.blockCount);
  if (getCurrentSegment() != null) {
    segments.add(getCurrentSegment());
    clear();
  }
  moveAll(this.fullSegments,segments);
  if (this.writer != null) {
    this.writer.closeAndDelete();
  }
  return segments;
}
