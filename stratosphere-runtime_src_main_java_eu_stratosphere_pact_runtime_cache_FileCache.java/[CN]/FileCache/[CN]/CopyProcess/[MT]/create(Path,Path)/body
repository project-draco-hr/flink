{
  if (!lfs.exists(localFilePath)) {
    FileSystem dfs=distributedFilePath.getFileSystem();
    if (dfs.getFileStatus(distributedFilePath).isDir()) {
      lfs.mkdirs(localFilePath);
      FileStatus[] contents=dfs.listStatus(distributedFilePath);
      for (      FileStatus content : contents) {
        String distPath=content.getPath().toString();
        if (content.isDir()) {
          distPath=distPath.substring(0,distPath.length() - 1);
        }
        String localPath=localFilePath.toString() + distPath.substring(distPath.lastIndexOf("/"));
        create(content.getPath(),new Path(localPath));
      }
    }
 else {
      FSDataOutputStream lfsOutput=lfs.create(localFilePath,false);
      FSDataInputStream fsInput=dfs.open(distributedFilePath);
      IOUtils.copyBytes(fsInput,lfsOutput);
      new File(localFilePath.toString()).setExecutable(executable);
    }
  }
}
