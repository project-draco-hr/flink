{
  parseParameters(args);
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<String> text=getTextDataSet(env);
  DataSet<WC> counts=text.flatMap(new Tokenizer()).groupBy("word").reduce(new ReduceFunction<WC>(){
    public WC reduce(    WC value1,    WC value2){
      return new WC(value1.word,value1.count + value2.count);
    }
  }
);
  if (fileOutput) {
    counts.writeAsText(outputPath);
  }
 else {
    counts.print();
  }
  env.execute("WordCount with custom data types example");
}
