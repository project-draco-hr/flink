{
  Logger root=Logger.getRootLogger();
  root.removeAllAppenders();
  PatternLayout layout=new PatternLayout("%d{HH:mm:ss,SSS} %-5p %-60c %x - %m%n");
  ConsoleAppender appender=new ConsoleAppender(layout,"System.err");
  root.addAppender(appender);
  root.setLevel(Level.INFO);
  JobGraphBuilder graphBuilder=new JobGraphBuilder("testGraph");
  graphBuilder.setSource("WordCountSource",WordCountDummySource.class);
  graphBuilder.setTask("WordCountSplitter",WordCountSplitter.class,2);
  graphBuilder.setTask("WordCountCounter",WordCountCounter.class,2);
  graphBuilder.setSink("WordCountSink",WordCountSink.class);
  graphBuilder.shuffleConnect("WordCountSource","WordCountSplitter");
  graphBuilder.fieldsConnect("WordCountSplitter","WordCountCounter",0,StringValue.class);
  graphBuilder.shuffleConnect("WordCountCounter","WordCountSink");
  return graphBuilder.getJobGraph();
}
