{
  final int N=17;
  AbstractJobVertex v1=new AbstractJobVertex("vertex1");
  AbstractJobVertex v2=new AbstractJobVertex("vertex2");
  v1.setParallelism(2 * N);
  v2.setParallelism(N);
  v2.connectNewDataSetAsInput(v1,DistributionPattern.POINTWISE);
  List<AbstractJobVertex> ordered=new ArrayList<AbstractJobVertex>(Arrays.asList(v1,v2));
  ExecutionGraph eg=new ExecutionGraph(jobId,jobName,cfg,AkkaUtils.getDefaultTimeout());
  try {
    eg.attachJobGraph(ordered);
  }
 catch (  JobException e) {
    e.printStackTrace();
    fail("Job failed with exception: " + e.getMessage());
  }
  ExecutionJobVertex target=eg.getAllVertices().get(v2.getID());
  for (  ExecutionVertex ev : target.getTaskVertices()) {
    assertEquals(1,ev.getNumberOfInputs());
    ExecutionEdge[] inEdges=ev.getInputEdges(0);
    assertEquals(2,inEdges.length);
    assertEquals(ev.getParallelSubtaskIndex() * 2,inEdges[0].getSource().getPartitionNumber());
    assertEquals(ev.getParallelSubtaskIndex() * 2 + 1,inEdges[1].getSource().getPartitionNumber());
  }
}
