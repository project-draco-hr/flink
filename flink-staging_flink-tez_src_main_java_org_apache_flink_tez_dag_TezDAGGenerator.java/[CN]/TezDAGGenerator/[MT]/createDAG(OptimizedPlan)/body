{
  LOG.info("Creating Tez DAG");
  this.vertices=new HashMap<PlanNode,FlinkVertex>();
  this.edges=new ArrayList<FlinkEdge>();
  program.accept(this);
  DAG dag=DAG.create(program.getJobName());
  for (  FlinkVertex v : vertices.values()) {
    dag.addVertex(v.createVertex(new TezConfiguration(tezConf)));
  }
  for (  FlinkEdge e : edges) {
    dag.addEdge(e.createEdge(new TezConfiguration(tezConf)));
  }
  if (containsSelfJoins()) {
    throw new CompilerException("Dual-input operators with the same input (self-joins) are not yet supported");
  }
  this.vertices=null;
  this.edges=null;
  LOG.info("Tez DAG created");
  return dag;
}
