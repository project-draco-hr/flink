{
  try {
    if (node instanceof SourcePlanNode) {
      return;
    }
    final Iterator<Channel> inConns=node.getInputs().iterator();
    if (!inConns.hasNext()) {
      throw new CompilerException("Bug: Found a non-source task with no input.");
    }
    int inputIndex=0;
    FlinkVertex targetVertex=this.vertices.get(node);
    TezTaskConfig targetVertexConfig=targetVertex.getConfig();
    while (inConns.hasNext()) {
      Channel input=inConns.next();
      inputIndex+=translateChannel(input,inputIndex,targetVertex,targetVertexConfig,false);
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw new CompilerException("An error occurred while translating the optimized plan to a Tez DAG: " + e.getMessage(),e);
  }
}
