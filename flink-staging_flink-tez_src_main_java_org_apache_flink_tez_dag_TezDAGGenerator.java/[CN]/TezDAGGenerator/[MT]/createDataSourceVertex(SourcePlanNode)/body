{
  final String taskName=node.getNodeName();
  int dop=node.getParallelism();
  final TezTaskConfig config=new TezTaskConfig(new Configuration());
  config.setStubWrapper(node.getProgramOperator().getUserCodeWrapper());
  config.setStubParameters(node.getProgramOperator().getParameters());
  InputFormat format=node.getDataSourceNode().getOperator().getFormatWrapper().getUserCodeObject();
  config.setInputFormat(format);
  InputSplit[] splits=format.createInputSplits((dop > 0) ? dop : 1);
  dop=splits.length;
  LOG.info("Creating data source vertex " + taskName + " with parallelism "+ dop);
  return new FlinkDataSourceVertex(taskName,dop,config);
}
