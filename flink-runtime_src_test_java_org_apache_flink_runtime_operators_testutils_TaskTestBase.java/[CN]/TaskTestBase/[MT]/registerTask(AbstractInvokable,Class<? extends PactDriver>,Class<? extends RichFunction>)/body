{
  final TaskConfig config=new TaskConfig(this.mockEnv.getTaskConfiguration());
  config.setDriver(driver);
  config.setStubWrapper(new UserCodeClassWrapper<RichFunction>(stubClass));
  task.setEnvironment(this.mockEnv);
  if (task instanceof RegularPactTask<?,?>) {
    ((RegularPactTask<?,?>)task).setUserCodeClassLoader(getClass().getClassLoader());
  }
  task.registerInputOutput();
}
