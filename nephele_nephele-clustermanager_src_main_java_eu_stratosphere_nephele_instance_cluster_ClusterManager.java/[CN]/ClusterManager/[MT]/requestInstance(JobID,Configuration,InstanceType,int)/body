{
  for (int i=0; i < count; i++) {
    for (    ClusterInstance host : registeredHosts.values()) {
      final AllocatedSlice slice=host.createSlice(instanceType,jobID);
      if (slice != null) {
        List<AllocatedSlice> allocatedSlices=this.slicesOfJobs.get(jobID);
        if (allocatedSlices == null) {
          allocatedSlices=new ArrayList<AllocatedSlice>();
          this.slicesOfJobs.put(jobID,allocatedSlices);
        }
        allocatedSlices.add(slice);
        if (this.instanceListener != null) {
          ClusterInstanceNotifier clusterInstanceNotifier=new ClusterInstanceNotifier(this.instanceListener,slice);
          clusterInstanceNotifier.start();
        }
        return;
      }
    }
  }
  throw new InstanceException("Could not find a suitable instance");
}
