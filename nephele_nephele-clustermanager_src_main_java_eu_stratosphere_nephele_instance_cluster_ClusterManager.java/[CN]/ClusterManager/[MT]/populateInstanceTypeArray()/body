{
  final List<InstanceType> instanceTypes=new ArrayList<InstanceType>();
  int count=1;
  while (true) {
    final String key=INSTANCE_TYPE_PREFIX_KEY + Integer.toString(count);
    String descr=GlobalConfiguration.getString(key,null);
    if (descr == null) {
      if (count == 1) {
        LOG.error("Configuration does not contain at least one definition for an instance type, " + "using default instance type: " + ConfigConstants.DEFAULT_INSTANCE_TYPE);
        descr=ConfigConstants.DEFAULT_INSTANCE_TYPE;
      }
 else {
        break;
      }
    }
    try {
      final InstanceType instanceType=InstanceTypeFactory.constructFromDescription(descr);
      LOG.info("Loaded instance type " + instanceType.getIdentifier() + " from the configuration");
      instanceTypes.add(instanceType);
    }
 catch (    Throwable t) {
      LOG.error("Error parsing " + key + ":"+ descr+ ". Using default using default instance type: "+ ConfigConstants.DEFAULT_INSTANCE_TYPE+ " for instance type "+ count+ ".",t);
      break;
    }
    ++count;
  }
  return instanceTypes.toArray(new InstanceType[instanceTypes.size()]);
}
