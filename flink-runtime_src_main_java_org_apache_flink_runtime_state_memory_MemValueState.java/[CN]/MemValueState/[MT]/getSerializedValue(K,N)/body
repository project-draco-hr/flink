{
  Preconditions.checkNotNull(key,"Key");
  Preconditions.checkNotNull(namespace,"Namespace");
  Map<K,V> stateByKey=state.get(namespace);
  V value=stateByKey != null ? stateByKey.get(key) : stateDesc.getDefaultValue();
  if (value != null) {
    return KvStateRequestSerializer.serializeValue(value,stateDesc.getSerializer());
  }
 else {
    return KvStateRequestSerializer.serializeValue(stateDesc.getDefaultValue(),stateDesc.getSerializer());
  }
}
