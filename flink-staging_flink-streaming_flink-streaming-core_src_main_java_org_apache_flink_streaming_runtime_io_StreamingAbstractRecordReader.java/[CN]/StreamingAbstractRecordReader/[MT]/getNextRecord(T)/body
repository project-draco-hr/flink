{
  if (isFinished) {
    return false;
  }
  while (true) {
    if (currentRecordDeserializer != null) {
      DeserializationResult result=currentRecordDeserializer.getNextRecord(target);
      if (result.isBufferConsumed()) {
        Buffer currentBuffer=currentRecordDeserializer.getCurrentBuffer();
        currentBuffer.recycle();
        currentRecordDeserializer=null;
      }
      if (result.isFullRecord()) {
        return true;
      }
    }
    final BufferOrEvent bufferOrEvent=barrierBuffer.getNextNonBlocked();
    if (bufferOrEvent.isBuffer()) {
      currentRecordDeserializer=recordDeserializers[bufferOrEvent.getChannelIndex()];
      currentRecordDeserializer.setNextBuffer(bufferOrEvent.getBuffer());
    }
 else {
      final AbstractEvent event=bufferOrEvent.getEvent();
      if (event instanceof StreamingSuperstep) {
        barrierBuffer.processSuperstep(bufferOrEvent);
      }
 else {
        if (handleEvent(event)) {
          if (inputGate.isFinished()) {
            if (!barrierBuffer.isEmpty()) {
              throw new RuntimeException("BarrierBuffer should be empty at this point");
            }
            isFinished=true;
            return false;
          }
 else           if (hasReachedEndOfSuperstep()) {
            return false;
          }
        }
      }
    }
  }
}
