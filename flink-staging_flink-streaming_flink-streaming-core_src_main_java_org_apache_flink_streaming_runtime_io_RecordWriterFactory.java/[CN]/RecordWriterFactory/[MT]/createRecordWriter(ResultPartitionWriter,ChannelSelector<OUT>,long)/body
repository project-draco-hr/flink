{
  RecordWriter<OUT> output;
  if (bufferTimeout >= 0) {
    output=new StreamRecordWriter<OUT>(bufferWriter,channelSelector,bufferTimeout);
    if (LOG.isTraceEnabled()) {
      LOG.trace("StreamRecordWriter initiated with {} bufferTimeout.",bufferTimeout);
    }
  }
 else {
    output=new RecordWriter<OUT>(bufferWriter,channelSelector);
    if (LOG.isTraceEnabled()) {
      LOG.trace("RecordWriter initiated.");
    }
  }
  return output;
}
