{
  Configuration configuration=jobGraph.getJobConfiguration();
  NepheleMiniCluster exec=new NepheleMiniCluster();
  exec.setMemorySize(memorySize);
  exec.setNumTaskTracker(numberOfTaskTrackers);
  Client client=new Client(new InetSocketAddress("localhost",6498),configuration);
  if (log.isInfoEnabled()) {
    log.info("Running on mini cluster");
  }
  try {
    exec.start();
    client.run(jobGraph,true);
    exec.stop();
  }
 catch (  Exception e) {
    throw new RuntimeException(e.getMessage());
  }
}
