{
  super.open(configuration);
  if (serializedInitialValue == null) {
    throw new RuntimeException("No initial value was serialized for the fold " + "operator. Probably the setOutputType method was not called.");
  }
  ByteArrayInputStream bais=new ByteArrayInputStream(serializedInitialValue);
  InputViewDataInputStreamWrapper in=new InputViewDataInputStreamWrapper(new DataInputStream(bais));
  initialValue=outTypeSerializer.deserialize(in);
  values=runtimeContext.getOperatorState("flink_internal_fold_values",new HashMap<Object,OUT>(),false);
}
