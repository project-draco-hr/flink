{
  if (input < -1 || input > 0)   throw new IndexOutOfBoundsException();
  if (this.implOpMode == null) {
    return null;
  }
switch (this.implOpMode) {
case Copy:
    if (this.explProjections != null) {
      return FieldSetOperations.unionSets(this.explProjections,this.explWrites);
    }
 else {
      return null;
    }
case Projection:
  if (this.explCopies != null) {
    if (this.input.size() > 1)     throw new UnsupportedOperationException("Must be adapted to union case");
    OptimizerNode pred=this.input.get(0).getSourcePact();
    return FieldSetOperations.unionSets(FieldSetOperations.setDifference(pred.outputSchema,this.explCopies),this.explWrites);
  }
 else {
    return null;
  }
default :
return null;
}
}
