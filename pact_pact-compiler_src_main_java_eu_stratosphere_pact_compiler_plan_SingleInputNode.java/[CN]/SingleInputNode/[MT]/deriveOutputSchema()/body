{
  if (implOpMode == null) {
    this.outputSchema=null;
  }
 else {
    if (this.input.size() > 1)     throw new UnsupportedOperationException("Must be adapted to union case");
    OptimizerNode pred=this.input.get(0).getSourcePact();
switch (implOpMode) {
case Copy:
      if (this.explProjections != null && this.explWrites != null) {
        this.outputSchema=FieldSetOperations.unionSets(FieldSetOperations.setDifference(pred.getOutputSchema(),this.explProjections),this.explWrites);
      }
 else {
        this.outputSchema=null;
      }
    break;
case Projection:
  if (this.explCopies != null && this.explWrites != null) {
    this.outputSchema=FieldSetOperations.unionSets(this.explCopies,this.explWrites);
  }
 else {
    this.outputSchema=null;
  }
break;
}
}
}
