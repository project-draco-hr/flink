{
  if (inputNodes.size() != 1)   throw new IllegalArgumentException("SingleInputNode must have exactly one input");
  if (implOpMode == null) {
    return null;
  }
 else {
switch (implOpMode) {
case Copy:
      if (this.explProjections != null && this.explWrites != null) {
        return FieldSetOperations.unionSets(FieldSetOperations.setDifference(inputNodes.get(0).getOutputSchema(),this.explProjections),this.explWrites);
      }
 else {
        return null;
      }
case Projection:
    if (this.explCopies != null && this.explWrites != null) {
      return FieldSetOperations.unionSets(this.explCopies,this.explWrites);
    }
 else {
      return null;
    }
default :
  return null;
}
}
}
