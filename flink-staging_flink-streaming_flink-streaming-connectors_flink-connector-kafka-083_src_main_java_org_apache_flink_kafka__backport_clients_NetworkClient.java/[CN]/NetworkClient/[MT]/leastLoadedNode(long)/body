{
  List<Node> nodes=this.metadata.fetch().nodes();
  int inflight=Integer.MAX_VALUE;
  Node found=null;
  for (int i=0; i < nodes.size(); i++) {
    int idx=Utils.abs((this.nodeIndexOffset + i) % nodes.size());
    Node node=nodes.get(idx);
    int currInflight=this.inFlightRequests.inFlightRequestCount(node.idString());
    if (currInflight == 0 && this.connectionStates.isConnected(node.idString())) {
      return node;
    }
 else     if (!this.connectionStates.isBlackedOut(node.idString(),now) && currInflight < inflight) {
      inflight=currInflight;
      found=node;
    }
  }
  return found;
}
