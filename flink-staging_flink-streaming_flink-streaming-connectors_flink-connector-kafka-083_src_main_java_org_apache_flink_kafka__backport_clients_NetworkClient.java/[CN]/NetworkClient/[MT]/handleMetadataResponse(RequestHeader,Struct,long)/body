{
  this.metadataFetchInProgress=false;
  MetadataResponse response=new MetadataResponse(body);
  Cluster cluster=response.cluster();
  if (response.errors().size() > 0) {
    log.warn("Error while fetching metadata with correlation id {} : {}",header.correlationId(),response.errors());
  }
  if (cluster.nodes().size() > 0) {
    this.metadata.update(cluster,now);
  }
 else {
    log.trace("Ignoring empty metadata response with correlation id {}.",header.correlationId());
    this.metadata.failedUpdate(now);
  }
}
