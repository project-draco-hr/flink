{
  Plan p=createProgramPlan("unnamed job");
  p.setDefaultParallelism(getDegreeOfParallelism());
  registerCachedFiles(p);
  PlanExecutor executor=PlanExecutor.createLocalExecutor();
  initLogging();
  return executor.getOptimizerPlanAsJSON(p);
}
