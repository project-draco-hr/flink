{
  final StringValue fromNode=rec2.getField(0,StringValue.class);
  final StringValue toNode=rec1.getField(1,StringValue.class);
  if (fromNode.equals(toNode))   return;
  outputRecord.setField(0,fromNode);
  outputRecord.setField(1,toNode);
  length.setValue(rec1.getField(2,IntValue.class).getValue() + rec2.getField(2,IntValue.class).getValue());
  outputRecord.setField(2,length);
  int hops=rec1.getField(3,IntValue.class).getValue() + 1 + rec2.getField(3,IntValue.class).getValue();
  hopCnt.setValue(hops);
  outputRecord.setField(3,hopCnt);
  StringBuilder sb=new StringBuilder();
  sb.append(rec2.getField(4,StringValue.class).getValue());
  sb.append(" ");
  sb.append(rec1.getField(0,StringValue.class).getValue());
  sb.append(" ");
  sb.append(rec1.getField(4,StringValue.class).getValue());
  hopList.setValue(sb.toString().trim());
  outputRecord.setField(4,hopList);
  out.collect(outputRecord);
}
