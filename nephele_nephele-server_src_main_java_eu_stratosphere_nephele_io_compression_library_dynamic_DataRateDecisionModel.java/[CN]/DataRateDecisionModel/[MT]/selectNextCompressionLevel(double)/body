{
  int nextCompressionLevel=this.currentSelection;
  this.callCount++;
  final double diff=currentDataRate - this.lastDataRate;
  final boolean diffIsPositive=(diff > 0);
  final boolean diffWithinBounds=Math.abs(diff) < (DELTA * this.lastDataRate);
  if (diffWithinBounds) {
    if (this.callCount >= (int)(Math.pow(2.0f,this.backoff[this.currentSelection]))) {
      if (this.currentSelection == 0) {
        this.increasedCompressionLevel=true;
      }
      if (this.currentSelection == this.numberOfAvailableCompressionLibraries - 1) {
        this.increasedCompressionLevel=false;
      }
      if (this.increasedCompressionLevel) {
        ++nextCompressionLevel;
      }
 else {
        --nextCompressionLevel;
      }
      this.callCount=0;
    }
  }
 else {
    if (diffIsPositive) {
      this.backoff[nextCompressionLevel]++;
    }
 else {
      this.backoff[nextCompressionLevel]=0;
      if (this.increasedCompressionLevel) {
        --nextCompressionLevel;
      }
 else {
        ++nextCompressionLevel;
      }
    }
    this.callCount=0;
  }
  if (nextCompressionLevel < 0) {
    nextCompressionLevel=0;
  }
 else   if (nextCompressionLevel == numberOfAvailableCompressionLibraries) {
    nextCompressionLevel=this.numberOfAvailableCompressionLibraries - 1;
  }
  return nextCompressionLevel;
}
