{
  int recordsLeft=this.numRecords;
  int currentMemSeg=0;
  while (recordsLeft > 0) {
    final MemorySegment currentIndexSegment=this.sortIndex.get(currentMemSeg++);
    int offset=0;
    if (recordsLeft >= this.indexEntriesPerSegment) {
      for (; offset <= this.lastIndexEntryOffset; offset+=this.indexEntrySize) {
        final long pointer=currentIndexSegment.getPointer(offset);
        this.recordBuffer.setReadPosition(pointer);
        this.serializer.copy(this.recordBuffer,output);
      }
      recordsLeft-=this.indexEntriesPerSegment;
    }
 else {
      for (; recordsLeft > 0; recordsLeft--, offset+=this.indexEntrySize) {
        final long pointer=currentIndexSegment.getPointer(offset);
        this.recordBuffer.setReadPosition(pointer);
        this.serializer.copy(this.recordBuffer,output);
      }
    }
  }
}
