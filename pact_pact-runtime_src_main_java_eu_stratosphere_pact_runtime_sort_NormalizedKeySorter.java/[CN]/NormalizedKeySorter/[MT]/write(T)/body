{
  if (this.currentSortIndexOffset > this.lastIndexEntryOffset) {
    if (memoryAvailable()) {
      this.currentSortIndexSegment=nextMemorySegment();
      this.sortIndex.add(this.currentSortIndexSegment);
      this.currentSortIndexOffset=0;
    }
 else     return false;
  }
  this.currentSortIndexSegment.putLong(this.currentSortIndexOffset,this.currentDataBufferOffset);
  this.accessors.putNormalizedKey(record,this.currentSortIndexSegment.getBackingArray(),this.currentSortIndexSegment.translateOffset(this.currentSortIndexOffset + OFFSET_LEN),this.numKeyBytes);
  long bytes=this.accessors.serialize(record,this.recordBuffers.get(this.recordBuffers.size() - 1).outputView,this.memorySource,this.recordBuffers);
  if (bytes >= 0) {
    this.currentSortIndexOffset+=indexEntrySize;
    this.currentDataBufferOffset+=bytes;
    this.numRecords++;
    return true;
  }
 else   return false;
}
