{
  try {
    LOG.info("Starting job " + this.jobInfo.getJobId());
    final long runtime=executePlan(plan);
switch (this.jobInfo.getInitialRequest().getMode()) {
case RUN:
      if (runtime != -1)       this.jobInfo.setStatusAndDetail(ExecutionState.FINISHED,"");
    break;
case RUN_WITH_STATISTICS:
  if (runtime != -1)   gatherStatistics(plan,runtime);
break;
}
LOG.info(String.format("Finished job %s in %s ms",this.jobInfo.getJobId(),runtime));
}
 catch (Throwable ex) {
LOG.error("Cannot process plan " + this.jobInfo.getJobId(),ex);
this.jobInfo.setStatusAndDetail(ExecutionState.ERROR,"Cannot process plan: " + StringUtils.stringifyException(ex));
}
}
