{
  try {
switch (this.jobInfo.getInitialRequest().getMode()) {
case RUN:
      if (executePlan(plan) != -1)       this.jobInfo.setStatusAndDetail(ExecutionState.FINISHED,"");
    break;
case RUN_WITH_STATISTICS:
  final long runtime=executePlan(plan);
if (runtime != -1) gatherStatistics(plan,runtime);
break;
}
}
 catch (Throwable ex) {
this.jobInfo.setStatusAndDetail(ExecutionState.ERROR,"Cannot process plan: " + StringUtils.stringifyException(ex));
}
}
