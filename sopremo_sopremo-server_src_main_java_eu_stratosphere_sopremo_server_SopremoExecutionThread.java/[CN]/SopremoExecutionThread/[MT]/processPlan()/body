{
  try {
    LOG.info("Starting job " + this.jobInfo.getJobId());
    SopremoPlan plan=this.jobInfo.getInitialRequest().getQuery();
    final long runtime=executePlan(plan);
    if (runtime != -1) {
switch (this.jobInfo.getInitialRequest().getMode()) {
case RUN:
        this.jobInfo.setStatusAndDetail(ExecutionState.FINISHED,"");
      break;
case RUN_WITH_STATISTICS:
    gatherStatistics(plan,runtime);
  break;
}
LOG.info(String.format("Finished job %s in %s ms",this.jobInfo.getJobId(),runtime));
}
}
 catch (Throwable ex) {
LOG.error("Cannot process plan " + this.jobInfo.getJobId(),ex);
this.jobInfo.setStatusAndDetail(ExecutionState.ERROR,"Cannot process plan: " + StringUtils.stringifyException(ex));
}
}
