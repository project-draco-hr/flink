{
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  env.setDegreeOfParallelism(4);
  DataSet<String> text=env.fromElements("To be","or not to be","or to be still","and certainly not to be not at all","is that the question?");
  DataSet<WC> tokenized=text.flatMap(new Tokenizer());
  DataSet<WC> result=tokenized.groupBy(new KeySelector<WC,String>(){
    public String getKey(    WC v){
      return v.word;
    }
  }
).reduce(new ReduceFunction<WC>(){
    public WC reduce(    WC value1,    WC value2){
      return new WC(value1.word,value1.count + value2.count);
    }
  }
);
  result.print();
  env.execute();
}
