{
  Operator previous=this.translated.get(dataSet);
  if (previous != null) {
    return previous;
  }
  Operator dataFlowOp;
  if (dataSet instanceof DataSource) {
    dataFlowOp=((DataSource<?>)dataSet).translateToDataFlow();
  }
 else   if (dataSet instanceof SingleInputOperator) {
    SingleInputOperator<?,?,?> op=(SingleInputOperator<?,?,?>)dataSet;
    Operator input=translate(op.getInput());
    dataFlowOp=op.translateToDataFlow(input);
    if (dataSet instanceof UdfOperator<?>) {
      Configuration opParams=((UdfOperator<?>)op).getParameters();
      if (opParams != null) {
        dataFlowOp.getParameters().addAll(opParams);
      }
    }
  }
 else   if (dataSet instanceof TwoInputOperator) {
    TwoInputOperator<?,?,?,?> op=(TwoInputOperator<?,?,?,?>)dataSet;
    Operator input1=translate(op.getInput1());
    Operator input2=translate(op.getInput2());
    dataFlowOp=op.translateToDataFlow(input1,input2);
    if (dataSet instanceof UdfOperator<?>) {
      Configuration opParams=((UdfOperator<?>)op).getParameters();
      if (opParams != null) {
        dataFlowOp.getParameters().addAll(opParams);
      }
    }
  }
 else   if (dataSet instanceof BulkIterationResultSet<?>) {
    dataFlowOp=translateBulkIteration((BulkIterationResultSet<?>)dataSet);
  }
 else   if (dataSet instanceof DeltaIterationResultSet<?,?>) {
    dataFlowOp=translateDeltaIteration((DeltaIterationResultSet<?,?>)dataSet);
  }
 else {
    throw new RuntimeException("Error while creating the data flow plan for the program: Unknown operator or data set type: " + dataSet);
  }
  this.translated.put(dataSet,dataFlowOp);
  translateBcVariables(dataSet,dataFlowOp);
  return dataFlowOp;
}
