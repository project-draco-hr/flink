{
  Operator previous=this.translated.get(dataSet);
  if (previous != null) {
    return previous;
  }
  Operator dataFlowOp;
  if (dataSet instanceof DataSource) {
    dataFlowOp=((DataSource<?>)dataSet).translateToDataFlow();
  }
 else   if (dataSet instanceof SingleInputOperator) {
    SingleInputOperator<?,?,?> op=(SingleInputOperator<?,?,?>)dataSet;
    Operator input=translate(op.getInput());
    eu.stratosphere.api.common.operators.SingleInputOperator<?> singleInDataFlowOp=op.translateToDataFlow(input);
    dataFlowOp=singleInDataFlowOp;
    if (dataSet instanceof UdfOperator<?>) {
      SingleInputUdfOperator<?,?,?> udfOp=(SingleInputUdfOperator<?,?,?>)op;
      Configuration opParams=udfOp.getParameters();
      if (opParams != null) {
        singleInDataFlowOp.getParameters().addAll(opParams);
      }
      SingleInputSemanticProperties props=udfOp.getSematicProperties();
      if (props != null) {
        singleInDataFlowOp.setSemanticProperties(props);
      }
    }
  }
 else   if (dataSet instanceof TwoInputOperator) {
    TwoInputOperator<?,?,?,?> op=(TwoInputOperator<?,?,?,?>)dataSet;
    Operator input1=translate(op.getInput1());
    Operator input2=translate(op.getInput2());
    eu.stratosphere.api.common.operators.DualInputOperator<?> binaryDataFlowOp=op.translateToDataFlow(input1,input2);
    dataFlowOp=binaryDataFlowOp;
    if (dataSet instanceof UdfOperator<?>) {
      TwoInputUdfOperator<?,?,?,?> udfOp=(TwoInputUdfOperator<?,?,?,?>)op;
      Configuration opParams=udfOp.getParameters();
      if (opParams != null) {
        dataFlowOp.getParameters().addAll(opParams);
      }
      DualInputSemanticProperties props=udfOp.getSematicProperties();
      if (props != null) {
        binaryDataFlowOp.setSemanticProperties(props);
      }
    }
  }
 else   if (dataSet instanceof BulkIterationResultSet<?>) {
    dataFlowOp=translateBulkIteration((BulkIterationResultSet<?>)dataSet);
  }
 else   if (dataSet instanceof DeltaIterationResultSet<?,?>) {
    dataFlowOp=translateDeltaIteration((DeltaIterationResultSet<?,?>)dataSet);
  }
 else {
    throw new RuntimeException("Error while creating the data flow plan for the program: Unknown operator or data set type: " + dataSet);
  }
  this.translated.put(dataSet,dataFlowOp);
  translateBcVariables(dataSet,dataFlowOp);
  return dataFlowOp;
}
