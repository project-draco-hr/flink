{
  try {
    final InputStream inputStream=this.clientSocket.getInputStream();
    final OutputStream outputStream=this.clientSocket.getOutputStream();
    final byte[] buffer=new byte[BlobServer.BUFFER_SIZE];
    while (true) {
      final int operation=inputStream.read();
      if (operation < 0) {
        return;
      }
switch (operation) {
case BlobServer.PUT_OPERATION:
        put(inputStream,outputStream,buffer);
      break;
case BlobServer.GET_OPERATION:
    get(inputStream,outputStream,buffer);
  break;
case BlobServer.DELETE_OPERATION:
delete(inputStream,buffer);
break;
default :
throw new IOException("Unknown operation " + operation);
}
}
}
 catch (IOException ioe) {
if (LOG.isErrorEnabled()) {
LOG.error("Error while executing BLOB connection.",ioe);
}
}
 finally {
closeSilently(this.clientSocket);
}
}
