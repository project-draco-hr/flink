{
synchronized (state) {
    if (out != null) {
      StateHandle<DataInputView> handle=out.closeAndGetHandle();
      state.pendingHandles.put(checkpointId,new Tuple2<>(timestamp,handle));
      out=null;
    }
  }
}
