{
synchronized (state) {
    StreamTaskState taskState=super.snapshotOperatorState(checkpointId,timestamp);
    saveHandleInState(checkpointId,timestamp);
    taskState.setFunctionState(state);
    return taskState;
  }
}
