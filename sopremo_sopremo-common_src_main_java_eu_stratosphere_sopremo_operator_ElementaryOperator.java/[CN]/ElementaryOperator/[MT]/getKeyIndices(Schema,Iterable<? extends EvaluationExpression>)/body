{
  if (keyExpressions.equals(ALL_KEYS)) {
    final int[] allSchema=new int[globalSchema.getPactSchema().length];
    for (int index=0; index < allSchema.length; index++)     allSchema[index]=index;
    return allSchema;
  }
  IntSet keyIndices=new IntOpenHashSet();
  for (  EvaluationExpression expression : keyExpressions)   keyIndices.addAll(globalSchema.indicesOf(expression));
  if (keyIndices.isEmpty()) {
    if (keyExpressions.iterator().hasNext())     throw new IllegalStateException(String.format("Operator %s did not specify key expression that it now requires",this.getClass()));
    throw new IllegalStateException(String.format("Needs to specify key expressions: %s",this.getClass()));
  }
  return keyIndices.toIntArray();
}
