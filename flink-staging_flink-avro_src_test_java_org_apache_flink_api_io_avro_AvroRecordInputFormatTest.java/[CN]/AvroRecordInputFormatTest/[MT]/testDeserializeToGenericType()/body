{
  DatumReader<GenericData.Record> datumReader=new GenericDatumReader<GenericData.Record>(userSchema);
  FileReader<GenericData.Record> dataFileReader=DataFileReader.openReader(testFile,datumReader);
  GenericData.Record rec=new GenericData.Record(userSchema);
  dataFileReader.next(rec);
  assertNotNull(rec);
  assertEquals("name not equal",TEST_NAME,rec.get("name").toString());
  assertEquals("enum not equal",TEST_ENUM_COLOR.toString(),rec.get("type_enum").toString());
  assertEquals(null,rec.get("type_long_test"));
  TypeInformation<GenericData.Record> te=(TypeInformation<GenericData.Record>)TypeExtractor.createTypeInfo(GenericData.Record.class);
  TypeSerializer<GenericData.Record> tser=te.createSerializer();
  ComparatorTestBase.TestOutputView target=new ComparatorTestBase.TestOutputView();
  tser.serialize(rec,target);
  GenericData.Record newRec=tser.deserialize(target.getInputView());
  assertNotNull(newRec);
  assertEquals("enum not equal",TEST_ENUM_COLOR.toString(),newRec.get("type_enum").toString());
  assertEquals("name not equal",TEST_NAME,newRec.get("name").toString());
  assertEquals(null,newRec.get("type_long_test"));
}
