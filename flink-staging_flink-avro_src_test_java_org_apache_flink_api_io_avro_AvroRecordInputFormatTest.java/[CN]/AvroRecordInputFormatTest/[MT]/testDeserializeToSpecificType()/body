{
  DatumReader<User> datumReader=new SpecificDatumReader<User>(userSchema);
  FileReader<User> dataFileReader=DataFileReader.openReader(testFile,datumReader);
  User rec=dataFileReader.next();
  assertNotNull(rec);
  assertEquals("name not equal",TEST_NAME,rec.get("name").toString());
  assertEquals("enum not equal",TEST_ENUM_COLOR.toString(),rec.get("type_enum").toString());
  TypeInformation<User> te=(TypeInformation<User>)TypeExtractor.createTypeInfo(User.class);
  TypeSerializer<User> tser=te.createSerializer();
  ComparatorTestBase.TestOutputView target=new ComparatorTestBase.TestOutputView();
  tser.serialize(rec,target);
  User newRec=tser.deserialize(target.getInputView());
  assertNotNull(newRec);
  assertEquals("name not equal",TEST_NAME,newRec.getName().toString());
  assertEquals("enum not equal",TEST_ENUM_COLOR.toString(),newRec.getTypeEnum().toString());
}
