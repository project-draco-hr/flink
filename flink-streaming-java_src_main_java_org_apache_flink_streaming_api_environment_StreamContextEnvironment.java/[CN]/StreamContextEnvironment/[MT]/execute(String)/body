{
  Preconditions.checkNotNull("Streaming Job name should not be null.");
  StreamGraph streamGraph=this.getStreamGraph();
  streamGraph.setJobName(jobName);
  transformations.clear();
  if (wait) {
    return client.runBlocking(streamGraph,jars,classpaths,userCodeClassLoader);
  }
 else {
    JobSubmissionResult result=client.runDetached(streamGraph,jars,classpaths,userCodeClassLoader);
    LOG.warn("Job was executed in detached mode, the results will be available on completion.");
    return JobExecutionResult.fromJobSubmissionResult(result);
  }
}
