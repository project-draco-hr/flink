{
  try {
    Partitioner<?> partitioner=new MockPartitioner();
    GlobalProperties gp=new GlobalProperties();
    gp.setCustomPartitioned(new FieldList(2,3),partitioner);
    OptimizerNode node=mock(OptimizerNode.class);
    when(node.isFieldConstant(Matchers.anyInt(),Matchers.anyInt())).thenReturn(true);
    GlobalProperties filtered=gp.filterByNodesConstantSet(node,0);
    assertTrue(filtered.isPartitionedOnFields(new FieldSet(2,3)));
    assertEquals(PartitioningProperty.CUSTOM_PARTITIONING,filtered.getPartitioning());
    assertEquals(partitioner,filtered.getCustomPartitioner());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
