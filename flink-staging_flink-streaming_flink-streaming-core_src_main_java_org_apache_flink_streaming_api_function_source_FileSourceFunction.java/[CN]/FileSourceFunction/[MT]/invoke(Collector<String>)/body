{
  final TypeSerializer<String> serializer=typeInfo.createSerializer(getRuntimeContext().getExecutionConfig());
  final Iterator<InputSplit> splitIterator=getInputSplits();
  @SuppressWarnings("unchecked") final InputFormat<String,InputSplit> format=(InputFormat<String,InputSplit>)this.inputFormat;
  try {
    while (splitIterator.hasNext()) {
      final InputSplit split=splitIterator.next();
      String record=serializer.createInstance();
      format.open(split);
      try {
        while (!format.reachedEnd()) {
          if ((record=format.nextRecord(record)) != null) {
            collector.collect(record);
          }
        }
      }
  finally {
        format.close();
      }
    }
    collector.close();
  }
 catch (  Exception ex) {
    ex.printStackTrace();
  }
}
