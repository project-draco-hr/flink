{
  Long ts=completedCheckpoints.remove(checkpointId);
  if (ts == null) {
    LOG.warn("Complete notification for missing checkpoint: " + checkpointId);
    ts=0L;
  }
  if (compactEvery > 0 && compact && checkpointId % compactEvery == 0) {
    try {
      for (      Connection c : connections.connections()) {
        dbAdapter.compactKvStates(kvStateId,c,0,ts);
      }
      if (LOG.isDebugEnabled()) {
        LOG.debug("State succesfully compacted for {}.",kvStateId);
      }
    }
 catch (    SQLException e) {
      LOG.warn("State compaction failed due: {}",e);
    }
  }
}
