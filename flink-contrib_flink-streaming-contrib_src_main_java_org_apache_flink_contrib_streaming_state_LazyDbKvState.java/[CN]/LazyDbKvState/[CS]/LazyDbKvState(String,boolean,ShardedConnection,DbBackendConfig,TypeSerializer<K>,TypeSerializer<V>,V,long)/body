{
  this.kvStateId=kvStateId;
  this.compact=compact;
  this.keySerializer=keySerializer;
  this.valueSerializer=valueSerializer;
  this.defaultValue=defaultValue;
  this.maxInsertBatchSize=conf.getMaxKvInsertBatchSize();
  this.conf=conf;
  this.connections=cons;
  this.dbAdapter=conf.getDbAdapter();
  this.compactEvery=conf.getKvStateCompactionFrequency();
  this.numSqlRetries=conf.getMaxNumberOfSqlRetries();
  this.sqlRetrySleep=conf.getSleepBetweenSqlRetries();
  this.nextTs=nextTs;
  this.cache=new StateCache(conf.getKvCacheSize(),conf.getNumElementsToEvict());
  initDB(this.connections);
  batchInsert=new BatchInserter(connections.getNumShards());
  if (LOG.isDebugEnabled()) {
    LOG.debug("Lazy database kv-state ({}) successfully initialized",kvStateId);
  }
}
