{
  K k=next.getKey();
  V v=next.getValue().orNull();
  toInsert.add(Tuple2.of(InstantiationUtil.serializeToByteArray(keySerializer,k),v != null ? InstantiationUtil.serializeToByteArray(valueSerializer,v) : null));
  if (toInsert.size() == maxInsertBatchSize) {
    flush(checkpointId);
  }
}
