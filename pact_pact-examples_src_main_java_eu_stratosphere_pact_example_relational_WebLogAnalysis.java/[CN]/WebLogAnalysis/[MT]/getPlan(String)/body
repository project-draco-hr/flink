{
  if (args.length != 5) {
    args=new String[5];
    args[0]="1";
    args[1]="hdfs://localhost:9000/examples/webLog/docs";
    args[2]="hdfs://localhost:9000/examples/webLog/ranks";
    args[3]="hdfs://localhost:9000/examples/webLog/visits";
    args[4]="hdfs://localhost:9000/examples/results/webLog";
  }
  int noSubTasks=Integer.parseInt(args[0]);
  String docsInput=args[1];
  String ranksInput=args[2];
  String visitsInput=args[3];
  String output=args[4];
  DataSourceContract<PactString,Tuple> docs=new DataSourceContract<PactString,Tuple>(StringTupleDataInFormat.class,docsInput,"Documents");
  docs.setFormatParameter(TextInputFormat.FORMAT_PAIR_DELIMITER,"\n");
  docs.setDegreeOfParallelism(noSubTasks);
  docs.setOutputContract(UniqueKey.class);
  DataSourceContract<PactString,Tuple> ranks=new DataSourceContract<PactString,Tuple>(StringTupleDataInFormat.class,ranksInput,"Ranks");
  ranks.setFormatParameter(TextInputFormat.FORMAT_PAIR_DELIMITER,"\n");
  ranks.setDegreeOfParallelism(noSubTasks);
  DataSourceContract<PactString,Tuple> visits=new DataSourceContract<PactString,Tuple>(StringTupleDataInFormat.class,visitsInput,"Visits");
  visits.setFormatParameter(TextInputFormat.FORMAT_PAIR_DELIMITER,"\n");
  visits.setDegreeOfParallelism(noSubTasks);
  MapContract<PactString,Tuple,PactString,Tuple> filterDocs=new MapContract<PactString,Tuple,PactString,Tuple>(FilterDocs.class,"Filter Docs");
  filterDocs.setDegreeOfParallelism(noSubTasks);
  filterDocs.getCompilerHints().setSelectivity(0.15f);
  filterDocs.getCompilerHints().setAvgBytesPerRecord(60);
  MapContract<PactString,Tuple,PactString,Tuple> filterRanks=new MapContract<PactString,Tuple,PactString,Tuple>(FilterRanks.class,"Filter Ranks");
  filterRanks.setDegreeOfParallelism(noSubTasks);
  filterRanks.getCompilerHints().setSelectivity(0.25f);
  MapContract<PactString,Tuple,PactString,Tuple> filterVisits=new MapContract<PactString,Tuple,PactString,Tuple>(FilterVisits.class,"Filter Visits");
  filterVisits.setDegreeOfParallelism(noSubTasks);
  filterVisits.getCompilerHints().setAvgBytesPerRecord(60);
  filterVisits.getCompilerHints().setSelectivity(0.2f);
  MatchContract<PactString,Tuple,Tuple,PactString,Tuple> joinDocsRanks=new MatchContract<PactString,Tuple,Tuple,PactString,Tuple>(JoinDocRanks.class,"Join DocRanks");
  joinDocsRanks.setDegreeOfParallelism(noSubTasks);
  joinDocsRanks.getCompilerHints().setSelectivity(0.15f);
  CoGroupContract<PactString,Tuple,Tuple,PactString,Tuple> antiJoinVisits=new CoGroupContract<PactString,Tuple,Tuple,PactString,Tuple>(AntiJoinVisits.class,"Antijoin DocsVisits");
  antiJoinVisits.setDegreeOfParallelism(noSubTasks);
  DataSinkContract<PactString,Tuple> result=new DataSinkContract<PactString,Tuple>(StringTupleDataOutFormat.class,output,"Result");
  result.setDegreeOfParallelism(noSubTasks);
  filterDocs.setInput(docs);
  filterRanks.setInput(ranks);
  filterVisits.setInput(visits);
  joinDocsRanks.setFirstInput(filterDocs);
  joinDocsRanks.setSecondInput(filterDocs);
  antiJoinVisits.setFirstInput(filterVisits);
  antiJoinVisits.setSecondInput(joinDocsRanks);
  result.setInput(antiJoinVisits);
  return new Plan(result,"Weblog Analysis");
}
