{
  try {
    final long SIZE=2048;
    final long TOTAL=2 * SIZE;
    File tempDir=new File(System.getProperty("java.io.tmpdir"));
    File f;
    do {
      f=new File(tempDir,TestFileUtils.randomFileName(""));
    }
 while (f.exists());
    assertTrue(f.mkdirs());
    f.deleteOnExit();
    File child1=new File(f,"dataFile1.txt");
    File child2=new File(f,"another_file.bin");
    File luigiFile=new File(f,"_luigi");
    File success=new File(f,"_SUCCESS");
    File[] files={child1,child2,luigiFile,success};
    for (    File child : files) {
      child.deleteOnExit();
      BufferedOutputStream out=new BufferedOutputStream(new FileOutputStream(child));
      try {
        for (long bytes=SIZE; bytes > 0; bytes--) {
          out.write(0);
        }
      }
  finally {
        out.close();
      }
    }
    final DummyFileInputFormat format=new DummyFileInputFormat();
    format.setFilePath(f.toURI().toString());
    format.configure(new Configuration());
    BaseStatistics stats=format.getStatistics(null);
    Assert.assertEquals(TOTAL,stats.getTotalInputSize());
  }
 catch (  Exception e) {
    System.err.println(e.getMessage());
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}
