{
  FileDataSource initialInput=new FileDataSource(new PointInFormat(),input,"Input");
  initialInput.setDegreeOfParallelism(1);
  BulkIteration iteration=new BulkIteration("Loop");
  iteration.setInput(initialInput);
  iteration.setMaximumNumberOfIterations(2);
  MapOperator map2=MapOperator.builder(new IdentityMapper()).input(iteration.getPartialSolution()).name("map").build();
  map2.addInput(iteration.getPartialSolution());
  iteration.setNextPartialSolution(map2);
  FileDataSink finalResult=new FileDataSink(new PointOutFormat(),output,iteration,"Output");
  Job plan=new Job(finalResult,"Iteration with union test");
  plan.setDefaultParallelism(numSubTasks);
  return plan;
}
