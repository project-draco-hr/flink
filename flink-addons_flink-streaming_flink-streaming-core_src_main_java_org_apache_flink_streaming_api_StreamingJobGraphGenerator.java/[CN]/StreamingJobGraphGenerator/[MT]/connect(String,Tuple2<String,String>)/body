{
  String upStreamVertexName=edge.f0;
  String downStreamVertexName=edge.f1;
  int outputIndex=streamGraph.getOutEdges(upStreamVertexName).indexOf(downStreamVertexName);
  AbstractJobVertex headVertex=streamVertices.get(headOfChain);
  AbstractJobVertex downStreamVertex=streamVertices.get(downStreamVertexName);
  StreamConfig downStreamConfig=new StreamConfig(downStreamVertex.getConfiguration());
  StreamConfig upStreamConfig=new StreamConfig(headVertex.getConfiguration());
  List<Integer> outEdgeIndexList=streamGraph.getOutEdgeTypes(upStreamVertexName);
  int numOfInputs=downStreamConfig.getNumberOfInputs();
  downStreamConfig.setInputIndex(numOfInputs++,outEdgeIndexList.get(outputIndex));
  downStreamConfig.setNumberOfInputs(numOfInputs);
  StreamPartitioner<?> partitioner=streamGraph.getOutPartitioner(upStreamVertexName,outputIndex);
  upStreamConfig.setPartitioner(downStreamVertexName,partitioner);
  if (partitioner.getStrategy() == PartitioningStrategy.FORWARD) {
    downStreamVertex.connectNewDataSetAsInput(headVertex,DistributionPattern.POINTWISE);
  }
 else {
    downStreamVertex.connectNewDataSetAsInput(headVertex,DistributionPattern.ALL_TO_ALL);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("CONNECTED: {} - {} -> {}",partitioner.getClass().getSimpleName(),headOfChain,downStreamVertexName);
  }
  upStreamConfig.setOutputNames(downStreamVertexName,streamGraph.getSelectedNames(upStreamVertexName,outputIndex));
  upStreamConfig.setSelectAll(downStreamVertexName,streamGraph.isSelectAll(upStreamVertexName,outputIndex));
}
