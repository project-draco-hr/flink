{
synchronized (partitionQueue.queue) {
    return (partitionQueue.isFinished() && partitionQueue.queue.isEmpty()) || partitionQueue.hasBeenDiscarded;
  }
}
