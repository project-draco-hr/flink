{
synchronized (partitionQueue.queue) {
    if (isConsumed() || !partitionQueue.queue.isEmpty()) {
      return false;
    }
    if (partitionQueue.listener == null) {
      partitionQueue.listener=listener;
      return true;
    }
    throw new AlreadySubscribedException();
  }
}
