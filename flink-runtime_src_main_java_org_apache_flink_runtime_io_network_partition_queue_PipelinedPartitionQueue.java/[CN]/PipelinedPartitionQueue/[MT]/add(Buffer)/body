{
synchronized (queue) {
    if (!hasFinishedProduce) {
      queue.add(buffer);
      maybeNotifyListener();
    }
 else     if (!buffer.isRecycled()) {
      buffer.recycle();
    }
  }
}
