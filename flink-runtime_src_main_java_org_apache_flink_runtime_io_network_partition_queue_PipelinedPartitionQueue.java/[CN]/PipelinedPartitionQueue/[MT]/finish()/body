{
synchronized (queue) {
    if (hasFinishedProduce) {
      return;
    }
    queue.add(EventSerializer.toBuffer(EndOfPartitionEvent.INSTANCE));
    hasFinishedProduce=true;
    maybeNotifyListener();
  }
}
