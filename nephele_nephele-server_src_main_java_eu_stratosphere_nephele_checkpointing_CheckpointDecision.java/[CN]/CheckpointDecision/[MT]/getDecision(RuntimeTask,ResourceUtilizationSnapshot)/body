{
switch (CheckpointUtils.getCheckpointMode()) {
case NEVER:
    return false;
case ALWAYS:
  return true;
case NETWORK:
return isNetworkTask(task);
}
if (rus.getForced() != null) {
LOG.info("Checkpoint decision was forced to " + rus.getForced());
return rus.getForced();
}
final double CPlower=CheckpointUtils.getCPLower();
final double CPupper=CheckpointUtils.getCPUpper();
if (rus.getPactRatio() >= 0.0 && CheckpointUtils.usePACT()) {
LOG.info("Ratio = " + rus.getPactRatio());
if (rus.getPactRatio() >= CPlower) {
return true;
}
if (rus.getPactRatio() <= CPupper) {
return false;
}
}
 else {
if (rus.isDam()) {
LOG.info("is Dam");
if (rus.getAverageOutputRecordSize() != 0) {
  LOG.info("avg ratio " + rus.getAverageInputRecordSize() / rus.getAverageOutputRecordSize());
}
if (rus.getAverageOutputRecordSize() != 0 && rus.getAverageInputRecordSize() / rus.getAverageOutputRecordSize() >= CPlower) {
  return true;
}
if (rus.getAverageOutputRecordSize() != 0 && rus.getAverageInputRecordSize() / rus.getAverageOutputRecordSize() <= CPupper) {
  return false;
}
}
 else {
LOG.info("out " + rus.getTotalOutputAmount() + " in "+ rus.getTotalInputAmount());
if (rus.getTotalInputAmount() != 0) {
  LOG.info("Selectivity is " + (double)rus.getTotalOutputAmount() / rus.getTotalInputAmount());
}
if (rus.getTotalOutputAmount() != 0 && ((double)rus.getTotalInputAmount() / rus.getTotalOutputAmount() >= CPlower)) {
  LOG.info(task.getEnvironment().getTaskName() + " Checkpoint too large selectivity " + ((double)rus.getTotalInputAmount() / rus.getTotalOutputAmount()));
  return false;
}
if (rus.getTotalOutputAmount() != 0 && ((double)rus.getTotalInputAmount() / rus.getTotalOutputAmount() <= CPupper)) {
  LOG.info(task.getEnvironment().getTaskName() + " Checkpoint small selectivity " + ((double)rus.getTotalInputAmount() / rus.getTotalOutputAmount()));
  return true;
}
}
}
if (rus.getUserCPU() >= 90) {
LOG.info(task.getEnvironment().getTaskName() + "CPU-Bottleneck");
return true;
}
LOG.info("Checkpoint decision false by default");
return false;
}
