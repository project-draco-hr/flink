{
  Object key=keySelector.getKey(nextObject);
  IN currentValue=values.get(key);
  if (currentValue != null) {
    IN reduced=((ReduceFunction<IN>)userFunction).reduce(copy(currentValue),nextObject);
    values.put(key,reduced);
    collector.collect(reduced);
  }
 else {
    values.put(key,nextObject);
    collector.collect(nextObject);
  }
}
