{
  Object key=keySelector.getKey(element.getValue());
  IN currentValue=values.value().get(key);
  if (currentValue != null) {
    IN reduced=userFunction.reduce(currentValue,element.getValue());
    values.value().put(key,reduced);
    output.collect(element.replace(reduced));
  }
 else {
    values.value().put(key,element.getValue());
    output.collect(element.replace(element.getValue()));
  }
}
