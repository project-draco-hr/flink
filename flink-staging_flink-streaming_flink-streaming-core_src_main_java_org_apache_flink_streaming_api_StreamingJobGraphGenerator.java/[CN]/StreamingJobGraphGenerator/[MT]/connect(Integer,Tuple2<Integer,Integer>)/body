{
  Integer upStreamvertexID=edge.f0;
  Integer downStreamvertexID=edge.f1;
  int outputIndex=streamGraph.getOutEdges(upStreamvertexID).indexOf(downStreamvertexID);
  AbstractJobVertex headVertex=streamVertices.get(headOfChain);
  AbstractJobVertex downStreamVertex=streamVertices.get(downStreamvertexID);
  StreamConfig downStreamConfig=new StreamConfig(downStreamVertex.getConfiguration());
  StreamConfig upStreamConfig=headOfChain.equals(upStreamvertexID) ? new StreamConfig(headVertex.getConfiguration()) : chainedConfigs.get(headOfChain).get(upStreamvertexID);
  int numOfInputs=downStreamConfig.getNumberOfInputs();
  downStreamConfig.setInputIndex(numOfInputs++,streamGraph.getEdge(upStreamvertexID,downStreamvertexID).getTypeNumber());
  downStreamConfig.setNumberOfInputs(numOfInputs);
  StreamPartitioner<?> partitioner=streamGraph.getEdge(upStreamvertexID,downStreamvertexID).getPartitioner();
  upStreamConfig.setPartitioner(downStreamvertexID,partitioner);
  if (partitioner.getStrategy() == PartitioningStrategy.FORWARD) {
    downStreamVertex.connectNewDataSetAsInput(headVertex,DistributionPattern.POINTWISE);
  }
 else {
    downStreamVertex.connectNewDataSetAsInput(headVertex,DistributionPattern.ALL_TO_ALL);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("CONNECTED: {} - {} -> {}",partitioner.getClass().getSimpleName(),headOfChain,downStreamvertexID);
  }
}
