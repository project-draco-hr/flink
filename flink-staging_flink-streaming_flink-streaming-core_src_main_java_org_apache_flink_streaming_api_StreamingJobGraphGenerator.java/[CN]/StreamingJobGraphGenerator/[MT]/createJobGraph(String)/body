{
  jobGraph=new JobGraph(jobName);
  jobGraph.setScheduleMode(ScheduleMode.ALL);
  jobGraph.setJobType(JobGraph.JobType.STREAMING);
  jobGraph.setMonitoringEnabled(streamGraph.isCheckpointingEnabled());
  jobGraph.setMonitorInterval(streamGraph.getCheckpointingInterval());
  if (jobGraph.isMonitoringEnabled()) {
    int executionRetries=streamGraph.getExecutionConfig().getNumberOfExecutionRetries();
    if (executionRetries != -1) {
      jobGraph.setNumberOfExecutionRetries(executionRetries);
    }
 else {
      jobGraph.setNumberOfExecutionRetries(Integer.MAX_VALUE);
    }
  }
  init();
  setChaining();
  setPhysicalEdges();
  setSlotSharing();
  return jobGraph;
}
