{
  if (!builtVertices.contains(startNode)) {
    List<Tuple2<Integer,Integer>> transitiveOutEdges=new ArrayList<Tuple2<Integer,Integer>>();
    List<Integer> chainableOutputs=new ArrayList<Integer>();
    List<Integer> nonChainableOutputs=new ArrayList<Integer>();
    for (    Integer outName : streamGraph.getOutEdges(current)) {
      if (isChainable(current,outName)) {
        chainableOutputs.add(outName);
      }
 else {
        nonChainableOutputs.add(outName);
      }
    }
    for (    Integer chainable : chainableOutputs) {
      transitiveOutEdges.addAll(createChain(startNode,chainable));
    }
    for (    Integer nonChainable : nonChainableOutputs) {
      transitiveOutEdges.add(new Tuple2<Integer,Integer>(current,nonChainable));
      createChain(nonChainable,nonChainable);
    }
    chainedNames.put(current,createChainedName(current,chainableOutputs));
    StreamConfig config=current.equals(startNode) ? createProcessingVertex(startNode) : new StreamConfig(new Configuration());
    setVertexConfig(current,config,chainableOutputs,nonChainableOutputs);
    if (current.equals(startNode)) {
      config.setChainStart();
      config.setOutEdgesInOrder(transitiveOutEdges);
      for (      Tuple2<Integer,Integer> edge : transitiveOutEdges) {
        connect(startNode,edge);
      }
      config.setTransitiveChainedTaskConfigs(chainedConfigs.get(startNode));
    }
 else {
      Map<Integer,StreamConfig> chainedConfs=chainedConfigs.get(startNode);
      if (chainedConfs == null) {
        chainedConfigs.put(startNode,new HashMap<Integer,StreamConfig>());
      }
      chainedConfigs.get(startNode).put(current,config);
    }
    return transitiveOutEdges;
  }
 else {
    return new ArrayList<Tuple2<Integer,Integer>>();
  }
}
