{
  Queue<QueueElem> instanceSplitList=this.instanceMap.get(instance);
  if (instanceSplitList == null) {
    instanceSplitList=new PriorityQueue<LocatableInputSplitList.QueueElem>();
    final Iterator<LocatableInputSplit> it=this.masterSet.iterator();
    while (it.hasNext()) {
      final LocatableInputSplit split=it.next();
      final String[] hostnames=split.getHostnames();
      if (hostnames == null) {
        instanceSplitList.add(new QueueElem(split,Integer.MAX_VALUE));
      }
 else {
        int minDistance=Integer.MAX_VALUE;
        for (int i=0; i < hostnames.length; ++i) {
          final int distance=instance.getDistance(hostnames[i]);
          if (LOG.isDebugEnabled()) {
            LOG.debug("Distance between " + instance + " and "+ hostnames[i]+ " is "+ distance);
          }
          if (distance < minDistance) {
            minDistance=distance;
          }
        }
        instanceSplitList.add(new QueueElem(split,minDistance));
      }
    }
    this.instanceMap.put(instance,instanceSplitList);
  }
  return instanceSplitList;
}
