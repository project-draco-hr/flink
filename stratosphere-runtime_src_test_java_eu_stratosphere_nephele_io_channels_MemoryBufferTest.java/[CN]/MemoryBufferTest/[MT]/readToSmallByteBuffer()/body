{
  MemoryBuffer buf=new MemoryBuffer(INT_COUNT * INT_SIZE,new MemorySegment(new byte[INT_COUNT * INT_SIZE]),bufferPoolConnector);
  fillBuffer(buf);
  ByteBuffer target=ByteBuffer.allocate(INT_SIZE);
  ByteBuffer largeTarget=ByteBuffer.allocate(INT_COUNT * INT_SIZE);
  int i=0;
  while (buf.hasRemaining()) {
    buf.read(target);
    target.rewind();
    largeTarget.put(target);
    target.rewind();
    if (i++ >= INT_COUNT) {
      fail("There were too many elements in the buffer");
    }
  }
  assertEquals(-1,buf.read(target));
  target.rewind();
  validateByteBuffer(largeTarget);
}
