{
  Properties properties=new Properties();
  properties.put("metadata.broker.list",brokerList);
  properties.put("request.required.acks","-1");
  properties.put("message.send.max.retries","10");
  properties.put("serializer.class",DefaultEncoder.class.getCanonicalName());
  properties.put("key.serializer.class",DefaultEncoder.class.getCanonicalName());
  for (  Map.Entry<Object,Object> propertiesEntry : userDefinedProperties.entrySet()) {
    properties.put(propertiesEntry.getKey(),propertiesEntry.getValue());
  }
  if (partitioner != null) {
    properties.put("partitioner.class",PartitionerWrapper.class.getCanonicalName());
    properties.put(PartitionerWrapper.SERIALIZED_WRAPPER_NAME,partitioner);
  }
  if (partitionerClass != null) {
    properties.put("partitioner.class",partitionerClass);
  }
  ProducerConfig config=new ProducerConfig(properties);
  try {
    producer=new Producer<IN,byte[]>(config);
  }
 catch (  NullPointerException e) {
    throw new RuntimeException("Cannot connect to Kafka broker " + brokerList,e);
  }
}
