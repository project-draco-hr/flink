{
  Integer numOfTuples=record.getNumOfTuples();
  Integer numOfFeatures=((Double[])record.getField(1)).length;
  double[][] x=new double[numOfTuples][numOfFeatures];
  double[] y=new double[numOfTuples];
  for (int i=0; i < numOfTuples; i++) {
    Tuple t=record.getTuple(i);
    Double[] x_i=(Double[])t.getField(1);
    y[i]=(Double)t.getField(0);
    for (int j=0; j < numOfFeatures; j++) {
      x[i][j]=x_i[j];
    }
  }
  OLSMultipleLinearRegression ols=new OLSMultipleLinearRegression();
  ols.newSampleData(y,x);
  return new StreamRecord(new Tuple2<Boolean,Double[]>(true,(Double[])ArrayUtils.toObject(ols.estimateRegressionParameters())));
}
