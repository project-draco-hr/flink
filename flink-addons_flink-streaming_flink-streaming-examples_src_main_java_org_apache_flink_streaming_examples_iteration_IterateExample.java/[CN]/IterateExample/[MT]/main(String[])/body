{
  List<Tuple2<Double,Integer>> input=new ArrayList<Tuple2<Double,Integer>>();
  for (int i=0; i < 100; i++) {
    input.add(new Tuple2<Double,Integer>(0.,0));
  }
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment().setBufferTimeout(1);
  IterativeDataStream<Tuple2<Double,Integer>> it=env.fromCollection(input).iterate().setMaxWaitTime(3000);
  SplitDataStream<Tuple2<Double,Integer>> step=it.map(new Step()).shuffle().split(new MySelector());
  it.closeWith(step.select("iterate"));
  step.select("output").project(1).types(Integer.class).print();
  env.execute();
}
