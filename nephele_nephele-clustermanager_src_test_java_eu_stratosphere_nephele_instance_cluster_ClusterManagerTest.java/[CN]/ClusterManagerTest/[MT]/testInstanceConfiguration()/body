{
  GlobalConfiguration.loadConfiguration(System.getProperty(USER_DIR_KEY) + CORRECT_CONF_DIR);
  final MyInstanceListener dummyInstanceListener=new MyInstanceListener();
  final ClusterManager cm=new ClusterManager();
  cm.setInstanceListener(dummyInstanceListener);
  try {
    final InstanceType defaultIT=cm.getDefaultInstanceType();
    assertNotNull(defaultIT);
    assertEquals(SMALL_INSTANCE_TYPE_NAME,defaultIT.getIdentifier());
    assertEquals(2,defaultIT.getNumberOfComputeUnits());
    assertEquals(2,defaultIT.getNumberOfCores());
    assertEquals(2048,defaultIT.getMemorySize());
    assertEquals(10,defaultIT.getDiskCapacity());
    assertEquals(10,defaultIT.getPricePerHour());
    final List<InstanceTypeDescription> instanceTypeDescriptions=cm.getListOfAvailableInstanceTypes();
    assertEquals(3,instanceTypeDescriptions.size());
  }
  finally {
    if (cm != null) {
      cm.shutdown();
    }
  }
}
