{
  if (consistency == ConsistencyLevel.EXACTLY_ONCE) {
    return committer == null ? new CassandraSink<>(input.transform("Cassandra Sink",null,new CassandraIdempotentExactlyOnceSink<>(query,serializer,builder,jobID,new CassandraCommitter(builder)))) : new CassandraSink<>(input.transform("Cassandra Sink",null,new CassandraIdempotentExactlyOnceSink<>(query,serializer,builder,jobID,committer)));
  }
 else {
    return new CassandraSink<>(input.addSink(new CassandraTupleAtLeastOnceSink<IN>(query,builder)).name("Cassandra Sink"));
  }
}
