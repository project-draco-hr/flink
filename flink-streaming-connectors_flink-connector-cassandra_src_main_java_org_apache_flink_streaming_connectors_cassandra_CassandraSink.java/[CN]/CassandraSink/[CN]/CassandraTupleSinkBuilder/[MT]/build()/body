{
  if (consistency == ConsistencyLevel.EXACTLY_ONCE) {
    return committer == null ? new CassandraSink<>(input.transform("Cassandra Sink",null,new CassandraIdempotentExactlyOnceSink<>(query,serializer,builder,jobID,new CassandraCommitter(builder)))) : new CassandraSink<>(input.transform("Cassandra Sink",null,new CassandraIdempotentExactlyOnceSink<>(query,serializer,builder,jobID,committer)));
  }
 else {
    throw new IllegalArgumentException("There is currently no dedicated support for at-least-once guarantees.");
  }
}
