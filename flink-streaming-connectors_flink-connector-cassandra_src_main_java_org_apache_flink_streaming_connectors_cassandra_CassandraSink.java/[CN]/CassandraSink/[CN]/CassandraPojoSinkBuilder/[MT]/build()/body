{
  if (consistency == ConsistencyLevel.EXACTLY_ONCE) {
    throw new IllegalArgumentException("Exactly-once guarantees can only be provided for tuple types.");
  }
  if (consistency == ConsistencyLevel.At_LEAST_ONCE) {
    return new CassandraSink<>(input.addSink(new CassandraPojoAtLeastOnceSink<>(typeInfo.getTypeClass(),builder)).name("Cassandra Sink"));
  }
  throw new IllegalArgumentException("No consistency level was specified.");
}
