{
  @SuppressWarnings("unchecked") BinarySparseMatrix<JsonNode> matrix=(BinarySparseMatrix<JsonNode>)genMatrix;
  final Set<JsonNode> remainingRows=new HashSet<JsonNode>(matrix.getRows());
  while (!remainingRows.isEmpty()) {
    final ArrayNode cluster=new ArrayNode(null);
    final JsonNode row=remainingRows.iterator().next();
    cluster.add(row);
    for (    final JsonNode column : matrix.get(row))     cluster.add(column);
    for (    JsonNode element : cluster)     remainingRows.remove(element);
    out.collect(key,cluster);
  }
}
