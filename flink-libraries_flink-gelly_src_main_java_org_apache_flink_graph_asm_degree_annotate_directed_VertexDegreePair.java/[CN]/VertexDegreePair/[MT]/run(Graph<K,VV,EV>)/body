{
  DataSet<Vertex<K,LongValue>> outDegree=input.run(new VertexOutDegree<K,VV,EV>().setIncludeZeroDegreeVertices(false));
  DataSet<Vertex<K,LongValue>> inDegree=input.run(new VertexInDegree<K,VV,EV>().setIncludeZeroDegreeVertices(false));
  DataSet<Vertex<K,Tuple2<LongValue,LongValue>>> degree=outDegree.fullOuterJoin(inDegree).where(0).equalTo(0).with(new JoinVertexDegreeWithVertexDegree<K>()).setParallelism(parallelism).name("Join out- and in-degree");
  if (includeZeroDegreeVertices) {
    degree=input.getVertices().leftOuterJoin(degree).where(0).equalTo(0).with(new JoinVertexWithVertexDegrees<K,VV>()).setParallelism(parallelism).name("Join zero degree vertices");
  }
  return degree;
}
