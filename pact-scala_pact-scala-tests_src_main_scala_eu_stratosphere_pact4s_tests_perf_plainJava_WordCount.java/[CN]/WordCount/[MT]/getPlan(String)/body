{
  int numSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String dataInput=(args.length > 1 ? args[1] : "");
  String output=(args.length > 2 ? args[2] : "");
  FileDataSource source=new FileDataSource(TextInputFormat.class,dataInput,"Input Lines");
  source.setParameter(TextInputFormat.CHARSET_NAME,"ASCII");
  MapContract mapper=MapContract.builder(TokenizeLine.class).input(source).name("Tokenize Lines").build();
  ReduceContract reducer=new ReduceContract.Builder(CountWords.class,PactString.class,0).input(mapper).name("Count Words").build();
  FileDataSink out=new FileDataSink(RecordOutputFormat.class,output,reducer,"Word Counts");
  RecordOutputFormat.configureRecordFormat(out).lenient(true).recordDelimiter('\n').fieldDelimiter(' ').field(PactString.class,0).field(PactInteger.class,1);
  Plan plan=new Plan(out,"WordCount");
  plan.setDefaultParallelism(numSubTasks);
  return plan;
}
