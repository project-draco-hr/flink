{
  Buffer boe=mock(Buffer.class);
  MockNotificationListener listener=new MockNotificationListener();
  IntermediateResultPartitionQueueIterator iterator=queue.getQueueIterator(Optional.<BufferProvider>absent());
  assertNull(iterator.getNextBuffer());
  assertFalse(iterator.isConsumed());
  assertTrue(iterator.subscribe(listener));
  assertEquals(0,listener.getNumberOfNotifications());
  queue.add(boe);
  assertEquals(1,listener.getNumberOfNotifications());
  assertNotNull(iterator.getNextBuffer());
  assertNull(iterator.getNextBuffer());
  assertFalse(iterator.isConsumed());
  queue.add(boe);
  assertFalse(iterator.subscribe(listener));
  assertEquals(1,listener.getNumberOfNotifications());
}
