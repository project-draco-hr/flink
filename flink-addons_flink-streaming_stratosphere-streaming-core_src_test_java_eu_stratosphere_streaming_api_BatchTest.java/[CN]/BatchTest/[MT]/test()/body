{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment();
  DataStream<Tuple1<String>> dataStream1=env.addSource(new MySource(),SOURCE_PARALELISM).flatMap(new MyMap(),PARALLELISM).batch(4).flatMap(new MyMap(),PARALLELISM).batch(2).flatMap(new MyMap(),PARALLELISM).batch(5).flatMap(new MyMap(),PARALLELISM).batch(4).addSink(new MySink());
  DataStream<Tuple1<String>> dataStream2=env.addSource(new MySource(),SOURCE_PARALELISM).flatMap(new MyMap(),PARALLELISM).batch(4).partitionBy(0).addSink(new MyPartitionSink(),SINK_PARALELISM);
  env.execute();
  assertEquals(20,count);
  assertTrue(partitionCorrect);
}
