{
  super.open(parameters);
  this.keyIndex=parameters.getInteger(KEY_INDEX_PARAM_KEY,-1);
  if (this.keyIndex < 0)   throw new Exception("Invalid setup for ReduceWithKey: Key position has not been encoded in the config.");
  final Class<? extends Value>[] types=getDataTypes();
  if (types == null) {
    throw new Exception("Data types of the function's input could not be determined.");
  }
  if (this.keyIndex >= types.length) {
    throw new Exception("The specified position of the key is out of the range for the data types.");
  }
  this.keyVal=InstantiationUtil.instantiate(types[this.keyIndex],Value.class);
  if (!(this.keyVal instanceof CopyableValue)) {
    throw new Exception("Invalid setup for ReduceWithKey: Key type must implement " + CopyableValue.class.getName());
  }
}
