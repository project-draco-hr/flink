{
  if (!parseParameters(args)) {
    return;
  }
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment().setParallelism(4);
  @SuppressWarnings({"unused","serial"}) DataStream<String> stream1=env.addSource(new SourceFunction<String>(){
    @Override public void run(    Object checkpointLock,    Collector<String> collector) throws Exception {
      for (int i=0; i < 20; i++) {
        collector.collect("message #" + i);
        Thread.sleep(100L);
      }
      collector.collect("q");
    }
    @Override public void cancel(){
    }
  }
).addSink(new KafkaSink<String>(host + ":" + port,topic,new JavaDefaultStringSchema())).setParallelism(3);
  env.execute();
}
