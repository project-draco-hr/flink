{
  if (!parseParameters(args)) {
    return;
  }
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment().setParallelism(4);
  @SuppressWarnings({"unused","serial"}) DataStream<String> stream1=env.addSource(new SourceFunction<String>(){
    private int index=0;
    @Override public boolean reachedEnd() throws Exception {
      return index >= 20;
    }
    @Override public String next() throws Exception {
      if (index < 20) {
        String result="message #" + index;
        index++;
        return result;
      }
      return "q";
    }
  }
).addSink(new KafkaSink<String>(host + ":" + port,topic,new JavaDefaultStringSchema())).setParallelism(3);
  env.execute();
}
