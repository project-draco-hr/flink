{
  hadoopInputFormatName=in.readUTF();
  if (jobConf == null) {
    jobConf=new JobConf();
  }
  jobConf.readFields(in);
  try {
    this.hadoopInputFormat=(org.apache.hadoop.mapred.InputFormat<K,V>)Class.forName(this.hadoopInputFormatName).newInstance();
  }
 catch (  Exception e) {
    throw new RuntimeException("Unable to instantiate the hadoop input format",e);
  }
  ReflectionUtils.setConf(hadoopInputFormat,jobConf);
  converter=(HadoopTypeConverter<K,V>)in.readObject();
}
