{
  byte[] header=new byte[LZ4_MAX_HEADER_LENGTH];
  bufferOffset=6;
  if (in.read(header,0,bufferOffset) != bufferOffset) {
    throw new IOException(PREMATURE_EOS);
  }
  if (MAGIC != Utils.readUnsignedIntLE(header,bufferOffset - 6)) {
    throw new IOException(NOT_SUPPORTED);
  }
  flg=FLG.fromByte(header[bufferOffset - 2]);
  bd=BD.fromByte(header[bufferOffset - 1]);
  byte hash=(byte)((checksum.hash(header,0,bufferOffset,0) >> 8) & 0xFF);
  header[bufferOffset++]=(byte)in.read();
  if (hash != header[bufferOffset - 1]) {
    throw new IOException(DESCRIPTOR_HASH_MISMATCH);
  }
}
