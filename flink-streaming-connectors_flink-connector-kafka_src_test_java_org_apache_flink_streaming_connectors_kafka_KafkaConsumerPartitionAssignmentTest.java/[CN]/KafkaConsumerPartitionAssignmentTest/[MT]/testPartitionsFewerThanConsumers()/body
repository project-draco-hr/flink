{
  try {
    List<KafkaTopicPartitionLeader> inPartitions=new ArrayList<>();
    inPartitions.add(new KafkaTopicPartitionLeader(new KafkaTopicPartition("test-topic",4),fake));
    inPartitions.add(new KafkaTopicPartitionLeader(new KafkaTopicPartition("test-topic",52),fake));
    inPartitions.add(new KafkaTopicPartitionLeader(new KafkaTopicPartition("test-topic",17),fake));
    inPartitions.add(new KafkaTopicPartitionLeader(new KafkaTopicPartition("test-topic",1),fake));
    final Set<KafkaTopicPartitionLeader> allPartitions=new HashSet<>();
    allPartitions.addAll(inPartitions);
    final int numConsumers=2 * inPartitions.size() + 3;
    for (int i=0; i < numConsumers; i++) {
      List<KafkaTopicPartitionLeader> parts=FlinkKafkaConsumer.assignPartitions(inPartitions,numConsumers,i);
      assertNotNull(parts);
      assertTrue(parts.size() <= 1);
      for (      KafkaTopicPartitionLeader p : parts) {
        assertTrue(allPartitions.remove(p));
      }
    }
    assertTrue(allPartitions.isEmpty());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
