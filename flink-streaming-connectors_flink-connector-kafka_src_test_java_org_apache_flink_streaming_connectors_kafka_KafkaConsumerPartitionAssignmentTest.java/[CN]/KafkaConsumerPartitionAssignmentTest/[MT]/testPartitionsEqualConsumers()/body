{
  try {
    List<KafkaTopicPartitionLeader> inPartitions=new ArrayList<>();
    inPartitions.add(new KafkaTopicPartitionLeader(new KafkaTopicPartition("test-topic",4),fake));
    inPartitions.add(new KafkaTopicPartitionLeader(new KafkaTopicPartition("test-topic",52),fake));
    inPartitions.add(new KafkaTopicPartitionLeader(new KafkaTopicPartition("test-topic",17),fake));
    inPartitions.add(new KafkaTopicPartitionLeader(new KafkaTopicPartition("test-topic",1),fake));
    for (int i=0; i < inPartitions.size(); i++) {
      List<KafkaTopicPartitionLeader> parts=FlinkKafkaConsumer.assignPartitions(inPartitions,inPartitions.size(),i);
      assertNotNull(parts);
      assertEquals(1,parts.size());
      assertTrue(contains(inPartitions,parts.get(0).getTopicPartition().getPartition()));
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
