{
  LOG.debug("Invoking {}",getName());
  boolean operatorOpen=false;
  try {
    openAllOperators();
    operatorOpen=true;
    isRunning=true;
    run();
    if (LOG.isDebugEnabled()) {
      LOG.debug("Finished task {}",getName());
    }
    this.isRunning=false;
synchronized (checkpointLock) {
    }
    closeAllOperators();
    operatorOpen=false;
    outputHandler.flushOutputs();
  }
  finally {
    this.isRunning=false;
    try {
      if (operatorOpen) {
        closeAllOperators();
      }
    }
 catch (    Throwable t) {
      LOG.error("Error closing stream operators after an exception.",t);
    }
 finally {
      if (outputHandler != null) {
        outputHandler.releaseOutputs();
      }
      try {
        cleanup();
      }
 catch (      Throwable t) {
        LOG.error("Error during cleanup of stream task.");
      }
    }
  }
}
