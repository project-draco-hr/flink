{
  this.userClassLoader=getUserCodeClassLoader();
  this.configuration=new StreamConfig(getTaskConfiguration());
  this.stateHandleProvider=getStateHandleProvider();
  outputHandler=new OutputHandler<OUT>(this);
  streamOperator=configuration.getStreamOperator(userClassLoader);
  if (streamOperator != null) {
    headContext=createRuntimeContext(configuration);
    this.contexts.add(headContext);
    streamOperator.setup(outputHandler.getOutput(),headContext);
  }
  hasChainedOperators=!outputHandler.getChainedOperators().isEmpty();
}
