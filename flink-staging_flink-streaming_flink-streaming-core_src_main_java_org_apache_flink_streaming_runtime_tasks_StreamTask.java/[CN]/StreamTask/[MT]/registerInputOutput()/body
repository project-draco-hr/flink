{
  this.userClassLoader=getUserCodeClassLoader();
  this.configuration=new StreamConfig(getTaskConfiguration());
  this.context=createRuntimeContext(getEnvironment().getTaskName());
  this.stateHandleProvider=getStateHandleProvider();
  outputHandler=new OutputHandler<OUT>(this);
  streamOperator=configuration.getStreamOperator(userClassLoader);
  if (streamOperator != null) {
    streamOperator.setup(outputHandler.getOutput(),this.context);
  }
  hasChainedOperators=!outputHandler.getChainedOperators().isEmpty();
}
