{
  this.userClassLoader=getUserCodeClassLoader();
  this.configuration=new StreamConfig(getTaskConfiguration());
  streamOperator=configuration.getStreamOperator(userClassLoader);
  outputHandler=new OutputHandler<OUT>(this);
  if (streamOperator != null) {
    headContext=createRuntimeContext(configuration);
    this.contexts.add(headContext);
    streamOperator.setup(outputHandler.getOutput(),headContext);
  }
  hasChainedOperators=!(outputHandler.getChainedOperators().size() == 1);
}
