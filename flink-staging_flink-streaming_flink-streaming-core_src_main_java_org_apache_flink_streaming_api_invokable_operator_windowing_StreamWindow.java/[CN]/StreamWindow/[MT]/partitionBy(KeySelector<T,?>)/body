{
  Map<Object,StreamWindow<T>> partitions=new HashMap<Object,StreamWindow<T>>();
  for (  T value : this) {
    Object key=keySelector.getKey(value);
    StreamWindow<T> window=partitions.get(key);
    if (window == null) {
      window=new StreamWindow<T>(this.windowID,this.transformationID,0);
      partitions.put(key,window);
    }
    window.add(value);
  }
  List<StreamWindow<T>> output=new ArrayList<StreamWindow<T>>();
  int numkeys=partitions.size();
  for (  StreamWindow<T> window : partitions.values()) {
    output.add(window.setNumberOfParts(numkeys));
  }
  return output;
}
