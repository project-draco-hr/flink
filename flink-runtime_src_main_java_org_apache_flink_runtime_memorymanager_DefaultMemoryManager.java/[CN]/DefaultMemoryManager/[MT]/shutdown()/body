{
synchronized (this.lock) {
    if (!this.isShutDown) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Shutting down MemoryManager instance " + this);
      }
      this.isShutDown=true;
      this.freeSegments.clear();
      this.numNonAllocatedPages=0;
      for (      Set<DefaultMemorySegment> segments : this.allocatedSegments.values()) {
        for (        DefaultMemorySegment seg : segments) {
          seg.destroy();
        }
      }
    }
  }
}
