{
  if (currentIteration > 1) {
    double rank=pageWithRank.getField(1,PactDouble.class).getValue();
    if (currentIteration != failingIteration + 1) {
      rank/=stats.rank();
    }
 else {
      if (workerIndex == failingWorker) {
        rank=uniformRank;
      }
 else {
        rank*=rescaleFactor;
      }
    }
    pageWithRank.setField(1,new PactDouble(rank));
  }
  out.collect(pageWithRank);
}
