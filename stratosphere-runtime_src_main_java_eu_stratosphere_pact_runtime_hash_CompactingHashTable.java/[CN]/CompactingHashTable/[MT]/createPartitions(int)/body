{
  this.partitions.clear();
  ListMemorySegmentSource memSource=new ListMemorySegmentSource(this.availableMemory);
  this.pageSizeInBits=MathUtils.log2strict(this.segmentSize);
  for (int i=0; i < numPartitions; i++) {
    this.partitions.add(new InMemoryPartition<BT>(this.buildSideSerializer,i,memSource,this.segmentSize,pageSizeInBits));
  }
  this.compactionMemory=new InMemoryPartition<BT>(this.buildSideSerializer,-1,memSource,this.segmentSize,pageSizeInBits);
}
