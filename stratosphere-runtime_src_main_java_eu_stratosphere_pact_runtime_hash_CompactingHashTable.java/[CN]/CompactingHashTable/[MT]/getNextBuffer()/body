{
  int s=this.availableMemory.size();
  if (s > 0) {
    return this.availableMemory.remove(s - 1);
  }
 else {
    throw new RuntimeException("Memory ran out. numPartitions: " + this.partitions.size() + " minPartition: "+ getMinPartition()+ " maxPartition: "+ getMaxPartition()+ " number of overflow segments: "+ getOverflowSegmentCount()+ " bucketSize: "+ this.buckets.length);
  }
}
