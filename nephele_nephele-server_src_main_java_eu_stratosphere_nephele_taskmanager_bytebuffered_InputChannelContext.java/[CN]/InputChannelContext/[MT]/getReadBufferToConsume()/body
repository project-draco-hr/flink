{
  TransferEnvelope transferEnvelope=null;
synchronized (this.queuedEnvelopes) {
    this.taskHasStartedToReadChannel=true;
    this.queuedEnvelopes.notify();
    if (this.queuedEnvelopes.isEmpty()) {
      return null;
    }
    transferEnvelope=this.queuedEnvelopes.peek();
    if (transferEnvelope.getBuffer() == null) {
      this.queuedEnvelopes.poll();
    }
  }
  if (transferEnvelope.getBuffer() == null) {
    final EventList eventList=transferEnvelope.getEventList();
    if (!eventList.isEmpty()) {
      final Iterator<AbstractEvent> it=eventList.iterator();
      while (it.hasNext()) {
        this.byteBufferedInputChannel.processEvent(it.next());
      }
    }
    return null;
  }
  final BufferPairResponse response=new BufferPairResponse(null,transferEnvelope.getBuffer());
  final EventList eventList=transferEnvelope.getEventList();
  if (!eventList.isEmpty()) {
    final Iterator<AbstractEvent> it=eventList.iterator();
    while (it.hasNext()) {
      this.byteBufferedInputChannel.processEvent(it.next());
    }
  }
  return response;
}
