{
  Configuration conf=new Configuration();
  Assert.assertEquals(800,Utils.calculateHeapSize(1000,conf));
  Assert.assertEquals(9300,Utils.calculateHeapSize(10000,conf));
  Assert.assertEquals(3300,Utils.calculateHeapSize(4000,conf));
  conf.setString(ConfigConstants.YARN_HEAP_LIMIT_CAP,"1000");
  conf.setString(ConfigConstants.YARN_HEAP_CUTOFF_RATIO,"0.3");
  Assert.assertEquals(3000,Utils.calculateHeapSize(4000,conf));
  conf.setString(ConfigConstants.YARN_HEAP_LIMIT_CAP,"6000000");
  Assert.assertEquals(1200,Utils.calculateHeapSize(4000,conf));
}
