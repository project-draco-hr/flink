{
  super(new Struct(CURRENT_SCHEMA));
  Map<String,Map<Integer,PartitionData>> topicsData=CollectionUtils.groupDataByTopic(fetchData);
  struct.set(REPLICA_ID_KEY_NAME,replicaId);
  struct.set(MAX_WAIT_KEY_NAME,maxWait);
  struct.set(MIN_BYTES_KEY_NAME,minBytes);
  List<Struct> topicArray=new ArrayList<Struct>();
  for (  Map.Entry<String,Map<Integer,PartitionData>> topicEntry : topicsData.entrySet()) {
    Struct topicData=struct.instance(TOPICS_KEY_NAME);
    topicData.set(TOPIC_KEY_NAME,topicEntry.getKey());
    List<Struct> partitionArray=new ArrayList<Struct>();
    for (    Map.Entry<Integer,PartitionData> partitionEntry : topicEntry.getValue().entrySet()) {
      PartitionData fetchPartitionData=partitionEntry.getValue();
      Struct partitionData=topicData.instance(PARTITIONS_KEY_NAME);
      partitionData.set(PARTITION_KEY_NAME,partitionEntry.getKey());
      partitionData.set(FETCH_OFFSET_KEY_NAME,fetchPartitionData.offset);
      partitionData.set(MAX_BYTES_KEY_NAME,fetchPartitionData.maxBytes);
      partitionArray.add(partitionData);
    }
    topicData.set(PARTITIONS_KEY_NAME,partitionArray.toArray());
    topicArray.add(topicData);
  }
  struct.set(TOPICS_KEY_NAME,topicArray.toArray());
  this.replicaId=replicaId;
  this.maxWait=maxWait;
  this.minBytes=minBytes;
  this.fetchData=fetchData;
}
