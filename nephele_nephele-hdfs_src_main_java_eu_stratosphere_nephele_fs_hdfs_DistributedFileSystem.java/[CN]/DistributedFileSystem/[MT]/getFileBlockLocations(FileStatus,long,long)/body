{
  if (!(file instanceof DistributedFileStatus)) {
    throw new IOException("file is not an instance of DistributedFileStatus");
  }
  final DistributedFileStatus f=(DistributedFileStatus)file;
  final org.apache.hadoop.fs.BlockLocation[] blkLocations=fs.getFileBlockLocations(f.getInternalFileStatus(),start,len);
  final DistributedBlockLocation[] distBlkLocations=new DistributedBlockLocation[blkLocations.length];
  for (int i=0; i < distBlkLocations.length; i++) {
    distBlkLocations[i]=new DistributedBlockLocation(blkLocations[i]);
  }
  return distBlkLocations;
}
