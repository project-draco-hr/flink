{
  try {
    final FieldList keysLeft=new FieldList(1,4);
    final FieldList keysRight=new FieldList(3,1);
    CoGroupDescriptor descr=new CoGroupDescriptor(keysLeft,keysRight);
{
      RequestedGlobalProperties reqLeft=new RequestedGlobalProperties();
      reqLeft.setHashPartitioned(keysLeft);
      RequestedGlobalProperties reqRight=new RequestedGlobalProperties();
      reqRight.setHashPartitioned(keysRight);
      GlobalProperties propsLeft=new GlobalProperties();
      propsLeft.setHashPartitioned(keysLeft);
      GlobalProperties propsRight=new GlobalProperties();
      propsRight.setHashPartitioned(keysRight);
      assertTrue(descr.areCompatible(reqLeft,reqRight,propsLeft,propsRight));
    }
{
      Partitioner<Object> part=new Partitioner<Object>(){
        @Override public int partition(        Object key,        int numPartitions){
          return 0;
        }
      }
;
      RequestedGlobalProperties reqLeft=new RequestedGlobalProperties();
      reqLeft.setCustomPartitioned(keysLeft,part);
      RequestedGlobalProperties reqRight=new RequestedGlobalProperties();
      reqRight.setCustomPartitioned(keysRight,part);
      GlobalProperties propsLeft=new GlobalProperties();
      propsLeft.setCustomPartitioned(keysLeft,part);
      GlobalProperties propsRight=new GlobalProperties();
      propsRight.setCustomPartitioned(keysRight,part);
      assertTrue(descr.areCompatible(reqLeft,reqRight,propsLeft,propsRight));
    }
{
      Partitioner<Object> part=new Partitioner<Object>(){
        @Override public int partition(        Object key,        int numPartitions){
          return 0;
        }
      }
;
      RequestedGlobalProperties reqLeft=new RequestedGlobalProperties();
      reqLeft.setAnyPartitioning(keysLeft);
      RequestedGlobalProperties reqRight=new RequestedGlobalProperties();
      reqRight.setAnyPartitioning(keysRight);
      GlobalProperties propsLeft=new GlobalProperties();
      propsLeft.setCustomPartitioned(keysLeft,part);
      GlobalProperties propsRight=new GlobalProperties();
      propsRight.setCustomPartitioned(keysRight,part);
      assertTrue(descr.areCompatible(reqLeft,reqRight,propsLeft,propsRight));
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
