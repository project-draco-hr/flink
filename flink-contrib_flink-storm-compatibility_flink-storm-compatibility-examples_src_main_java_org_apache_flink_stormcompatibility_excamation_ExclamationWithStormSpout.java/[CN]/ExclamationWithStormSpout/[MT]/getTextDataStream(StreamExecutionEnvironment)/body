{
  if (fileOutput) {
    final String[] tokens=textPath.split(":");
    final String inputFile=tokens[tokens.length - 1];
    StormConfig config=new StormConfig();
    config.put(FiniteStormFileSpout.INPUT_FILE_PATH,inputFile);
    env.getConfig().setGlobalJobParameters(config);
    return env.addSource(new FiniteStormSpoutWrapper<String>(new FiniteStormFileSpout(),new String[]{Utils.DEFAULT_STREAM_ID}),TypeExtractor.getForClass(String.class)).setParallelism(1);
  }
  return env.addSource(new FiniteStormSpoutWrapper<String>(new FiniteStormInMemorySpout(WordCountData.WORDS),new String[]{Utils.DEFAULT_STREAM_ID}),TypeExtractor.getForClass(String.class)).setParallelism(1);
}
