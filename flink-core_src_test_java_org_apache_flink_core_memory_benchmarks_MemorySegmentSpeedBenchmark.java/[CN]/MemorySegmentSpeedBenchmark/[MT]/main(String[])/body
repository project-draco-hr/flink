{
  final int SMALL_SEGMENT_SIZE=32 * 1024;
  final int LARGE_SEGMENT_SIZE=1024 * 1024 * 1024;
  final int SMALL_SEGMENTS_ROUNDS=100000;
  final int LARGE_SEGMENT_ROUNDS=10;
  final byte[] largeSegment=new byte[LARGE_SEGMENT_SIZE];
  final byte[] smallSegment=new byte[SMALL_SEGMENT_SIZE];
  final ByteBuffer largeOffHeap=ByteBuffer.allocateDirect(LARGE_SEGMENT_SIZE);
  final ByteBuffer smallOffHeap=ByteBuffer.allocateDirect(SMALL_SEGMENT_SIZE);
  System.out.println("testing access of individual bytes");
  testPutBytes(smallSegment,smallOffHeap,SMALL_SEGMENT_SIZE,SMALL_SEGMENTS_ROUNDS);
  testGetBytes(smallSegment,smallOffHeap,SMALL_SEGMENT_SIZE,SMALL_SEGMENTS_ROUNDS);
  testPutBytes(largeSegment,largeOffHeap,LARGE_SEGMENT_SIZE,LARGE_SEGMENT_ROUNDS);
  testGetBytes(largeSegment,largeOffHeap,LARGE_SEGMENT_SIZE,LARGE_SEGMENT_ROUNDS);
  System.out.println("testing access of byte arrays");
  testPutByteArrays1024(smallSegment,smallOffHeap,SMALL_SEGMENT_SIZE / 1024,SMALL_SEGMENTS_ROUNDS);
  testGetByteArrays1024(smallSegment,smallOffHeap,SMALL_SEGMENT_SIZE / 1024,SMALL_SEGMENTS_ROUNDS);
  testPutByteArrays1024(largeSegment,largeOffHeap,LARGE_SEGMENT_SIZE / 1024,LARGE_SEGMENT_ROUNDS);
  testGetByteArrays1024(largeSegment,largeOffHeap,LARGE_SEGMENT_SIZE / 1024,LARGE_SEGMENT_ROUNDS);
  System.out.println("testing access of longs");
  testPutLongs(smallSegment,smallOffHeap,SMALL_SEGMENT_SIZE / 8,SMALL_SEGMENTS_ROUNDS);
  testGetLongs(smallSegment,smallOffHeap,SMALL_SEGMENT_SIZE / 8,SMALL_SEGMENTS_ROUNDS);
  testPutLongs(largeSegment,largeOffHeap,LARGE_SEGMENT_SIZE / 8,LARGE_SEGMENT_ROUNDS);
  testGetLongs(largeSegment,largeOffHeap,LARGE_SEGMENT_SIZE / 8,LARGE_SEGMENT_ROUNDS);
  System.out.println("testing access of ints");
  testPutInts(smallSegment,smallOffHeap,SMALL_SEGMENT_SIZE / 4,SMALL_SEGMENTS_ROUNDS);
  testGetInts(smallSegment,smallOffHeap,SMALL_SEGMENT_SIZE / 4,SMALL_SEGMENTS_ROUNDS);
  testPutInts(largeSegment,largeOffHeap,LARGE_SEGMENT_SIZE / 4,LARGE_SEGMENT_ROUNDS);
  testGetInts(largeSegment,largeOffHeap,LARGE_SEGMENT_SIZE / 4,LARGE_SEGMENT_ROUNDS);
}
