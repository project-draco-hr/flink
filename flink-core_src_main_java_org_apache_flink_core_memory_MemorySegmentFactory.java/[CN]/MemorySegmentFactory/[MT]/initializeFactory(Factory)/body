{
  if (f == null) {
    throw new NullPointerException();
  }
synchronized (MemorySegmentFactory.class) {
    if (factory == null) {
      factory=f;
    }
 else {
      throw new IllegalStateException("Factory has already been initialized");
    }
  }
}
