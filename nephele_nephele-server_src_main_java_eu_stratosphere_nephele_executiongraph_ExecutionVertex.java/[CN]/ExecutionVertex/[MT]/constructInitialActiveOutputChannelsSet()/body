{
  final SerializableHashSet<ChannelID> activeOutputChannels=new SerializableHashSet<ChannelID>();
synchronized (this) {
    final int numberOfOutputGates=this.environment.getNumberOfOutputGates();
    for (int i=0; i < numberOfOutputGates; ++i) {
      final OutputGate<? extends Record> outputGate=this.environment.getOutputGate(i);
      final ChannelType channelType=outputGate.getChannelType();
      final int numberOfOutputChannels=outputGate.getNumberOfOutputChannels();
      for (int j=0; j < numberOfOutputChannels; ++j) {
        final AbstractOutputChannel<? extends Record> outputChannel=outputGate.getOutputChannel(j);
        if (channelType == ChannelType.FILE) {
          continue;
        }
        if (channelType == ChannelType.INMEMORY) {
          activeOutputChannels.add(outputChannel.getID());
          continue;
        }
        if (channelType == ChannelType.NETWORK) {
          final ExecutionVertex connectedVertex=this.executionGraph.getVertexByChannelID(outputChannel.getConnectedChannelID());
          final ExecutionState state=connectedVertex.getExecutionState();
          if (state == ExecutionState.READY || state == ExecutionState.STARTING || state == ExecutionState.RUNNING) {
            activeOutputChannels.add(outputChannel.getID());
          }
        }
      }
    }
  }
  return activeOutputChannels;
}
