{
  Configuration config=new Configuration();
  config.setInteger(FixedLengthStringParser.STRING_LENGTH,5);
  parser.configure(config);
  byte[] recBytes="abcde|efghi|jklmn|".getBytes();
  PactString s=new PactString();
  int startPos=0;
  startPos=parser.parseField(recBytes,startPos,recBytes.length,'|',s);
  assertTrue(startPos == 6);
  assertTrue(s.getValue().equals("abcde"));
  startPos=parser.parseField(recBytes,startPos,recBytes.length,'|',s);
  assertTrue(startPos == 12);
  assertTrue(s.getValue().equals("efghi"));
  startPos=parser.parseField(recBytes,startPos,recBytes.length,'|',s);
  assertTrue(startPos == 18);
  assertTrue(s.getValue().equals("jklmn"));
  recBytes="abcde".getBytes();
  startPos=0;
  startPos=parser.parseField(recBytes,startPos,recBytes.length,'|',s);
  assertTrue(startPos == 5);
  assertTrue(s.getValue().equals("abcde"));
  recBytes="abcdef|".getBytes();
  startPos=0;
  startPos=parser.parseField(recBytes,startPos,recBytes.length,'|',s);
  assertTrue(startPos == -1);
  config.setString(FixedLengthStringParser.STRING_ENCAPSULATOR,"'");
  config.setInteger(FixedLengthStringParser.STRING_LENGTH,7);
  parser.configure(config);
  recBytes="'abcde'|'efghi'|'jklmn|".getBytes();
  startPos=0;
  startPos=parser.parseField(recBytes,startPos,recBytes.length,'|',s);
  assertTrue(startPos == 8);
  assertTrue(s.getValue().equals("abcde"));
  startPos=parser.parseField(recBytes,startPos,recBytes.length,'|',s);
  assertTrue(startPos == 16);
  assertTrue(s.getValue().equals("efghi"));
  startPos=parser.parseField(recBytes,startPos,recBytes.length,'|',s);
  assertTrue(startPos == -1);
  recBytes="'abcde'".getBytes();
  startPos=0;
  startPos=parser.parseField(recBytes,startPos,recBytes.length,'|',s);
  assertTrue(startPos == 7);
  assertTrue(s.getValue().equals("abcde"));
  recBytes="'abcdef'|".getBytes();
  startPos=0;
  startPos=parser.parseField(recBytes,startPos,recBytes.length,'|',s);
  assertTrue(startPos == -1);
}
