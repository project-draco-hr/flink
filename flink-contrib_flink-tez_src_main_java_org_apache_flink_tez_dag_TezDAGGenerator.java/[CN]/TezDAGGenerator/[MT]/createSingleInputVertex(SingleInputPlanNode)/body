{
  final String taskName=node.getNodeName();
  final DriverStrategy ds=node.getDriverStrategy();
  final int dop=node.getParallelism();
  final TezTaskConfig config=new TezTaskConfig(new Configuration());
  config.setDriver(ds.getDriverClass());
  config.setDriverStrategy(ds);
  config.setStubWrapper(node.getProgramOperator().getUserCodeWrapper());
  config.setStubParameters(node.getProgramOperator().getParameters());
  for (int i=0; i < ds.getNumRequiredComparators(); i++) {
    config.setDriverComparator(node.getComparator(i),i);
  }
  assignDriverResources(node,config);
  return new FlinkProcessorVertex(taskName,dop,config);
}
