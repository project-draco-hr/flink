{
  final long availableMemory=this.config.getMemorySize();
  if (availableMemory < MIN_REQUIRED_MEMORY) {
    throw new RuntimeException("The temp task was initialized with too little memory: " + availableMemory + ". Required is at least "+ MIN_REQUIRED_MEMORY+ " bytes.");
  }
  final MemoryManager memoryManager=getEnvironment().getMemoryManager();
  final IOManager ioManager=getEnvironment().getIOManager();
  this.memory=memoryManager.allocatePages(this,availableMemory);
  this.buffer=new SpillingBuffer(ioManager,new ListMemorySegmentSource(this.memory),memoryManager.getPageSize());
}
