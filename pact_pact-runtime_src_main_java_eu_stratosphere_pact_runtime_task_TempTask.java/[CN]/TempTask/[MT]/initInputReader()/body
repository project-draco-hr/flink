{
  RecordDeserializer<KeyValuePair<Key,Value>> deserializer=new KeyValuePairDeserializer<Key,Value>(this.stub.getOutKeyType(),this.stub.getOutValueType());
  DistributionPattern dp=null;
switch (config.getInputShipStrategy(0)) {
case FORWARD:
    dp=new PointwiseDistributionPattern();
  break;
case PARTITION_HASH:
dp=new BipartiteDistributionPattern();
break;
case BROADCAST:
dp=new BipartiteDistributionPattern();
break;
case SFR:
dp=new BipartiteDistributionPattern();
break;
default :
throw new RuntimeException("Unsupported ship strategy in TempTask.");
}
this.reader=new RecordReader<KeyValuePair<Key,Value>>(this,deserializer,dp);
}
