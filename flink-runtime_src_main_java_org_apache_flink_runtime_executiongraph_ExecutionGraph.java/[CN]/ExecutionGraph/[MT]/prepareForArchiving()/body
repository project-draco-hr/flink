{
  if (!state.isGloballyTerminalState()) {
    throw new IllegalStateException("Can only archive the job from a terminal state");
  }
  restartStrategy=null;
  scheduler=null;
  checkpointCoordinator=null;
  executionContext=null;
  kvStateLocationRegistry=null;
  for (  ExecutionJobVertex vertex : verticesInCreationOrder) {
    vertex.prepareForArchiving();
  }
  intermediateResults.clear();
  currentExecutions.clear();
  requiredJarFiles.clear();
  jobStatusListeners.clear();
  executionListeners.clear();
  isArchived=true;
}
