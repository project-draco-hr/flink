{
  if (!state.isTerminalState()) {
    throw new IllegalStateException("Can only archive the job from a terminal state");
  }
  userClassLoader=null;
  scheduler=null;
  checkpointCoordinator=null;
  for (  ExecutionJobVertex vertex : verticesInCreationOrder) {
    vertex.prepareForArchiving();
  }
  intermediateResults.clear();
  currentExecutions.clear();
  requiredJarFiles.clear();
  jobStatusListenerActors.clear();
  executionListenerActors.clear();
}
