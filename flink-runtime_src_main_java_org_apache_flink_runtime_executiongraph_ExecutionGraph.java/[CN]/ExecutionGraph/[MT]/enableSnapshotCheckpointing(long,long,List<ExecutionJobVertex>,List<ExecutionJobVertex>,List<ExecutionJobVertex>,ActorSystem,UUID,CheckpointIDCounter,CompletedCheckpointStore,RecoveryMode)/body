{
  if (interval < 10 || checkpointTimeout < 10) {
    throw new IllegalArgumentException();
  }
  if (state != JobStatus.CREATED) {
    throw new IllegalStateException("Job must be in CREATED state");
  }
  ExecutionVertex[] tasksToTrigger=collectExecutionVertices(verticesToTrigger);
  ExecutionVertex[] tasksToWaitFor=collectExecutionVertices(verticesToWaitFor);
  ExecutionVertex[] tasksToCommitTo=collectExecutionVertices(verticesToCommitTo);
  disableSnaphotCheckpointing();
  snapshotCheckpointsEnabled=true;
  checkpointCoordinator=new CheckpointCoordinator(jobID,checkpointTimeout,tasksToTrigger,tasksToWaitFor,tasksToCommitTo,userClassLoader,checkpointIDCounter,completedCheckpointStore,recoveryMode);
  registerJobStatusListener(checkpointCoordinator.createJobStatusListener(actorSystem,interval,leaderSessionID));
}
