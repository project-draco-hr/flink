{
  if (bufferSize > this.bufferSizeInBytes) {
    LOG.error("buffer of " + bufferSize + " requested, but maximum buffer size is "+ this.bufferSizeInBytes);
  }
synchronized (this.emptyWriteBuffers) {
    if (this.emptyWriteBuffers.isEmpty()) {
      sendOutOfWriteBuffersNotification();
      return null;
    }
    return BufferFactory.createFromMemory(bufferSize,this.emptyWriteBuffers.poll(),this.emptyWriteBuffers,false);
  }
}
