{
synchronized (this.emptyWriteBuffers) {
    while (this.emptyWriteBuffers.size() < bufferPairRequest.getNumberOfRequestedByteBuffers()) {
      sendOutOfWriteBuffersNotification();
      this.emptyWriteBuffers.wait();
    }
    Buffer compressedDataBuffer=null;
    Buffer uncompressedDataBuffer=null;
    if (bufferPairRequest.getCompressedDataBufferSize() >= 0) {
      compressedDataBuffer=BufferFactory.createFromMemory(bufferPairRequest.getCompressedDataBufferSize(),this.emptyWriteBuffers.poll(),this.emptyWriteBuffers,false);
    }
    if (bufferPairRequest.getUncompressedDataBufferSize() >= 0) {
      uncompressedDataBuffer=BufferFactory.createFromMemory(bufferPairRequest.getUncompressedDataBufferSize(),this.emptyWriteBuffers.poll(),this.emptyWriteBuffers,false);
    }
    return new BufferPairResponse(compressedDataBuffer,uncompressedDataBuffer);
  }
}
