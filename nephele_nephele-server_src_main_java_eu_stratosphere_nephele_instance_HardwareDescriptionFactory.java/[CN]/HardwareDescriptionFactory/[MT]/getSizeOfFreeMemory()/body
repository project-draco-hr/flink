{
  final MemoryPoolMXBean tenuredpool=findTenuredGenPool();
  if (tenuredpool != null) {
    final MemoryUsage usage=tenuredpool.getUsage();
    long tenuredSize=usage.getMax() - usage.getUsed();
    LOG.info("found tenured gen pool. Max: " + tenuredSize + " used: "+ usage.getUsed()+ ".");
    return (long)(tenuredSize * TENURED_POOL_THRESHOLD);
  }
  LOG.info("could not determine tenured gen pool. Using JVM Runtime information instead.");
  Runtime r=Runtime.getRuntime();
  final long maximum=r.maxMemory();
  return (long)(RUNTIME_MEMORY_THRESHOLD * (maximum - r.totalMemory() + r.freeMemory()));
}
