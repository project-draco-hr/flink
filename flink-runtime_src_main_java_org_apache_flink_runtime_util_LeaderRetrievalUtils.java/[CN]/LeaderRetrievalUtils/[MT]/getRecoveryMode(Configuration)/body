{
  String mode=config.getString(ConfigConstants.RECOVERY_MODE,ConfigConstants.DEFAULT_RECOVERY_MODE).toUpperCase();
switch (mode) {
case "STANDALONE":
    return RecoveryMode.STANDALONE;
case "ZOOKEEPER":
  return RecoveryMode.ZOOKEEPER;
default :
throw new IllegalConfigurationException("The value for '" + ConfigConstants.RECOVERY_MODE + "' is unknown: "+ mode);
}
}
