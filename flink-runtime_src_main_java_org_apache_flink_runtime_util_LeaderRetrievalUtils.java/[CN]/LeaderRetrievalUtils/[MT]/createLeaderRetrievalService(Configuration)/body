{
  RecoveryMode recoveryMode=getRecoveryMode(configuration);
switch (recoveryMode) {
case STANDALONE:
    return StandaloneUtils.createLeaderRetrievalService(configuration);
case ZOOKEEPER:
  return ZooKeeperUtils.createLeaderRetrievalService(configuration);
default :
throw new Exception("Recovery mode " + recoveryMode + " is not supported.");
}
}
