{
  RecoveryMode recoveryMode=getRecoveryMode(configuration);
switch (recoveryMode) {
case STANDALONE:
    String akkaUrl=standaloneRef.path().toSerializationFormat();
  return new StandaloneLeaderRetrievalService(akkaUrl);
case ZOOKEEPER:
return ZooKeeperUtils.createLeaderRetrievalService(configuration);
default :
throw new Exception("Recovery mode " + recoveryMode + " is not supported.");
}
}
