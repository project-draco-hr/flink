{
  try {
    Collection<MemorySegment> freeSegments=memoryManager.allocate(new DummyInvokable(),NUMBER_OF_SEGMENTS,SEGMENT_SIZE);
    ChannelWriter channelWriter=ioManager.createChannelWriter(channelID,freeSegments);
    generator.reset();
    int writtenPairs=0;
    while (writtenPairs < NUMBER_OF_PAIRS) {
      channelWriter.write(generator.next());
      writtenPairs++;
    }
    memoryManager.release(channelWriter.close());
    return writtenPairs;
  }
 catch (  MemoryAllocationException maex) {
    Assert.fail("Memory for channel writers could not be allocated.");
    return 0;
  }
catch (  IOException ioex) {
    Assert.fail("IO error occurred while writing to the channel: " + ioex.getMessage());
    return 0;
  }
}
