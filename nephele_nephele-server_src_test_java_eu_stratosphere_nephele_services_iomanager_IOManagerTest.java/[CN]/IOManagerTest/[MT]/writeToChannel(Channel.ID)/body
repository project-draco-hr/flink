{
  Collection<MemorySegment> freeSegments=memoryManager.allocate(NUMBER_OF_SEGMENTS,SEGMENT_SIZE);
  ChannelWriter channelWriter=ioManager.createChannelWriter(channelID,freeSegments);
  generator.reset();
  int writtenPairs=0;
  while (writtenPairs < NUMBER_OF_PAIRS) {
    channelWriter.write(generator.next());
    writtenPairs++;
  }
  memoryManager.release(channelWriter.close());
  return writtenPairs;
}
