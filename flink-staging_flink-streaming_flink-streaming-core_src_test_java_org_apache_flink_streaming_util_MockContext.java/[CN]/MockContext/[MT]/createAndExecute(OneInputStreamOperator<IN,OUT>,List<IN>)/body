{
  MockContext<IN,OUT> mockContext=new MockContext<IN,OUT>(inputs);
  StreamingRuntimeContext runtimeContext=new StreamingRuntimeContext("MockTask",new MockEnvironment(3 * 1024 * 1024,new MockInputSplitProvider(),1024),null,new ExecutionConfig(),null,null);
  operator.setup(mockContext.output,runtimeContext);
  try {
    operator.open(null);
    StreamRecord<IN> nextRecord;
    while ((nextRecord=mockContext.getIterator().next()) != null) {
      operator.processElement(nextRecord.getObject());
    }
    operator.close();
  }
 catch (  Exception e) {
    throw new RuntimeException("Cannot invoke operator.",e);
  }
  return mockContext.getOutputs();
}
