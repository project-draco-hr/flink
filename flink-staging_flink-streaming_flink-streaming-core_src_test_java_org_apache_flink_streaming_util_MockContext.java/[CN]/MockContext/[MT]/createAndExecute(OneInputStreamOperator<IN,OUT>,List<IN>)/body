{
  MockContext<IN,OUT> mockContext=new MockContext<IN,OUT>(inputs);
  StreamingRuntimeContext runtimeContext=new StreamingRuntimeContext(new MockEnvironment("MockTask",3 * 1024 * 1024,new MockInputSplitProvider(),1024),new ExecutionConfig(),null,null,new HashMap<String,Accumulator<?,?>>(),null);
  operator.setup(mockContext.output,runtimeContext);
  try {
    operator.open(null);
    StreamRecord<IN> nextRecord;
    for (    IN in : inputs) {
      operator.processElement(new StreamRecord<IN>(in));
    }
    operator.close();
  }
 catch (  Exception e) {
    throw new RuntimeException("Cannot invoke operator.",e);
  }
  return mockContext.getOutputs();
}
