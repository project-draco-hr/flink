{
  final KeyGroupedIterator<IT> it=new KeyGroupedIterator<IT>(this.closeableInput.getIterator(),this.serializer,this.comparator);
  while (this.running && it.nextKey()) {
switch (this.crossMode) {
case FULL_CROSS:
      fullCross(it.getValues(),output);
    break;
case TRIANGLE_CROSS_INCL_DIAG:
  diagInclTriangleCross(it.getValues(),output);
break;
case TRIANGLE_CROSS_EXCL_DIAG:
diagExclTriangleCross(it.getValues(),output);
break;
default :
throw new IllegalArgumentException("Invalid Cross Mode");
}
}
}
