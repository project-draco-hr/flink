{
  final Queue<Buffer> buffersToRecycle=new ArrayDeque<Buffer>();
synchronized (this.queuedEnvelopes) {
    while (!this.queuedEnvelopes.isEmpty()) {
      final TransferEnvelope envelope=this.queuedEnvelopes.poll();
      if (envelope.getBuffer() != null) {
        buffersToRecycle.add(envelope.getBuffer());
      }
    }
  }
  if (this.uncompressedDataBuffer != null) {
    buffersToRecycle.add(this.uncompressedDataBuffer);
    this.uncompressedDataBuffer=null;
  }
  while (!buffersToRecycle.isEmpty()) {
    buffersToRecycle.poll().recycleBuffer();
  }
}
