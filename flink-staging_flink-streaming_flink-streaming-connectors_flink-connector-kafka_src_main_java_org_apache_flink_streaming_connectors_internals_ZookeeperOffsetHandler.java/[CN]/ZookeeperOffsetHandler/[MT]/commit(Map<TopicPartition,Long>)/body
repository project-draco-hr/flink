{
  for (  Map.Entry<TopicPartition,Long> entry : offsetsToCommit.entrySet()) {
    TopicPartition tp=entry.getKey();
    long offset=entry.getValue();
    if (offset >= 0) {
      setOffsetInZooKeeper(zkClient,groupId,tp.topic(),tp.partition(),offset);
    }
  }
}
