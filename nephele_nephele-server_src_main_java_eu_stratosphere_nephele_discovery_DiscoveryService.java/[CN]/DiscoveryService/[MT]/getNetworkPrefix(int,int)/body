{
  if (networkPrefixLength <= 0 || networkPrefixLength >= addressLength) {
    throw new IllegalArgumentException("Invalid networkPrefixLength");
  }
  byte[] netmask=new byte[addressLength / 8];
  for (int byteNr=0; byteNr < netmask.length; ++byteNr) {
    int onesInThisByte=Math.min(networkPrefixLength,8);
    networkPrefixLength-=onesInThisByte;
    netmask[byteNr]=(byte)~((1 << (8 - onesInThisByte)) - 1);
  }
  return netmask;
}
