{
  final byte[] data=packet.getData();
  if (data == null) {
    return null;
  }
  if (packet.getLength() < PAYLOAD_OFFSET + 8) {
    return null;
  }
  final int len=NumberUtils.byteArrayToInteger(data,PAYLOAD_OFFSET);
  final byte[] addr=new byte[len];
  System.arraycopy(data,PAYLOAD_OFFSET + 4,addr,0,len);
  InetAddress inetAddress=null;
  try {
    inetAddress=InetAddress.getByAddress(addr);
  }
 catch (  UnknownHostException e) {
    return null;
  }
  return inetAddress;
}
