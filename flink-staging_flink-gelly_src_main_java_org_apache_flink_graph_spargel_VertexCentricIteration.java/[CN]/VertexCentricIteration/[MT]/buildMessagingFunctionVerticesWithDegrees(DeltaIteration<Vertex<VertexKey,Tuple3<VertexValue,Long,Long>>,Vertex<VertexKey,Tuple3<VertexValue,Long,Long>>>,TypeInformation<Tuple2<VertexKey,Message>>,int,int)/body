{
  CoGroupOperator<?,?,Tuple2<VertexKey,Message>> messages;
  MessagingUdfWithEdgeValues<VertexKey,Tuple3<VertexValue,Long,Long>,VertexValue,Message,EdgeValue> messenger=new MessagingUdfWithEdgeValuesVertexValueWithDegrees<VertexKey,VertexValue,Message,EdgeValue>(messagingFunction,messageTypeInfo);
  messages=this.edgesWithValue.coGroup(iteration.getWorkset()).where(whereArg).equalTo(equalToArg).with(messenger);
  messages=messages.name("Messaging");
  if (this.configuration != null) {
    for (    Tuple2<String,DataSet<?>> e : this.configuration.getMessagingBcastVars()) {
      messages=messages.withBroadcastSet(e.f1,e.f0);
    }
  }
  return messages;
}
