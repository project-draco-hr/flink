{
  final Configuration conf=getEnvironment().getTaskConfiguration();
  final String outputPathString=conf.getString(JobFileOutputVertex.PATH_PROPERTY,null);
  Path outputPath=new Path(outputPathString);
  FileSystem fs=FileSystem.get(outputPath.toUri());
  if (fs.exists(outputPath)) {
    FileStatus status=fs.getFileStatus(outputPath);
    if (status.isDir()) {
      outputPath=new Path(outputPath.toUri().toString() + "/file_" + getIndexInSubtaskGroup()+ ".txt");
    }
  }
  final FSDataOutputStream outputStream=fs.create(outputPath,true);
  while (this.input.hasNext()) {
    StringRecord record=this.input.next();
    byte[] recordByte=(record.toString() + "\r\n").getBytes();
    outputStream.write(recordByte,0,recordByte.length);
  }
  outputStream.close();
}
