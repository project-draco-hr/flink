{
  @SuppressWarnings("unchecked") final Class<? extends Value>[] types=new Class[numFields];
  for (int i=0; i < numFields; i++) {
    Class<? extends Value> type=schema.getType(i);
    if (type == null) {
      throw new MissingFieldTypeInfoException(i);
    }
 else {
      types[i]=type;
    }
  }
  return new ArrayRecordSerializerFactory(types);
}
