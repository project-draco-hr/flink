{
  Key key=null;
  try {
    key=keyClass.newInstance();
  }
 catch (  InstantiationException e) {
    e.printStackTrace();
  }
catch (  IllegalAccessException e) {
    e.printStackTrace();
  }
  key=keyClass.cast(record.getField(keyPosition));
  return new int[]{Math.abs(key.hashCode()) % numberOfOutputChannels};
}
