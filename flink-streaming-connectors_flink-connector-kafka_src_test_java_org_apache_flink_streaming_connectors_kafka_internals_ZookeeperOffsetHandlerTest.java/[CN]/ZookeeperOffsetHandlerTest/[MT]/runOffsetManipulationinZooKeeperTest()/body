{
  try {
    final String topicName="ZookeeperOffsetHandlerTest-Topic";
    final String groupId="ZookeeperOffsetHandlerTest-Group";
    final long offset=(long)(Math.random() * Long.MAX_VALUE);
    CuratorFramework curatorFramework=createZookeeperClient();
{
      ZkClient zkClient=new ZkClient(standardCC.zkConnect(),standardCC.zkSessionTimeoutMs(),standardCC.zkConnectionTimeoutMs(),new ZooKeeperStringSerializer());
      AdminUtils.createTopic(zkClient,topicName,3,2,new Properties());
      zkClient.close();
    }
    ZookeeperOffsetHandler.setOffsetInZooKeeper(curatorFramework,groupId,topicName,0,offset);
    long fetchedOffset=ZookeeperOffsetHandler.getOffsetFromZooKeeper(curatorFramework,groupId,topicName,0);
    curatorFramework.close();
    assertEquals(offset,fetchedOffset);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
