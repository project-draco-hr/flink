{
  StreamPartitioner<OUT> outputPartitioner=null;
  try {
    outputPartitioner=configuration.getPartitioner(outputNumber);
  }
 catch (  Exception e) {
    throw new StreamComponentException("Cannot deserialize partitioner for " + streamComponent.getName() + " with "+ outputNumber+ " outputs",e);
  }
  RecordWriter<SerializationDelegate<StreamRecord<OUT>>> output;
  if (bufferTimeout > 0) {
    output=new StreamRecordWriter<SerializationDelegate<StreamRecord<OUT>>>(streamComponent,outputPartitioner,bufferTimeout);
  }
 else {
    output=new RecordWriter<SerializationDelegate<StreamRecord<OUT>>>(streamComponent,outputPartitioner);
  }
  outputs.add(output);
  List<String> outputName=configuration.getOutputName(outputNumber);
  boolean isSelectAllOutput=configuration.getSelectAll(outputNumber);
  if (collector != null) {
    collector.addOutput(output,outputName,isSelectAllOutput);
  }
  if (LOG.isTraceEnabled()) {
    LOG.trace("Partitioner set: {} with {} outputs",outputPartitioner.getClass().getSimpleName(),outputNumber);
  }
}
