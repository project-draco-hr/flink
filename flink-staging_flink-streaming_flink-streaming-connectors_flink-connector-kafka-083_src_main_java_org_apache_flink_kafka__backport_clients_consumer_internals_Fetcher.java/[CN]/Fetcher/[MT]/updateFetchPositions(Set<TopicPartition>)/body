{
  for (  TopicPartition tp : partitions) {
    if (subscriptions.fetched(tp) != null)     continue;
    if (subscriptions.isOffsetResetNeeded(tp)) {
      resetOffset(tp);
    }
 else     if (subscriptions.committed(tp) == null) {
      subscriptions.needOffsetReset(tp);
      resetOffset(tp);
    }
 else {
      log.debug("Resetting offset for partition {} to the committed offset {}",tp,subscriptions.committed(tp));
      subscriptions.seek(tp,subscriptions.committed(tp));
    }
  }
}
