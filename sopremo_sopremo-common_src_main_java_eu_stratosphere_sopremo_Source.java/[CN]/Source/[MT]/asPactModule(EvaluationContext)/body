{
  String inputName=this.inputName, name=this.inputName;
  if (this.type == PersistenceType.ADHOC) {
    try {
      final File tempFile=File.createTempFile("Adhoc","source");
      writeValues(tempFile);
      inputName="file://localhost:80" + tempFile.getAbsolutePath();
      SopremoUtil.LOG.info("temp file " + inputName);
      name="Adhoc";
    }
 catch (    IOException e) {
      throw new IllegalStateException("Cannot create adhoc source",e);
    }
  }
  final PactModule pactModule=new PactModule(this.toString(),0,1);
  final FileDataSourceContract<PactJsonObject.Key,PactJsonObject> contract=new FileDataSourceContract<PactJsonObject.Key,PactJsonObject>(JsonInputFormat.class,inputName,name);
  pactModule.getOutput(0).setInput(contract);
  return pactModule;
}
