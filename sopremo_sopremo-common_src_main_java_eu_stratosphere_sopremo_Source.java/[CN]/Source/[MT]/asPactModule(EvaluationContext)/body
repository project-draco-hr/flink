{
  String inputName=this.inputName, name=this.inputName;
  if (this.type == PersistenceType.ADHOC)   try {
    final File tempFile=File.createTempFile("Adhoc","source");
    this.writeValues(tempFile);
    inputName="file://localhost" + tempFile.getAbsolutePath();
    SopremoUtil.LOG.info("temp file " + inputName);
    name="Adhoc";
  }
 catch (  final IOException e) {
    throw new IllegalStateException("Cannot create adhoc source",e);
  }
  final PactModule pactModule=new PactModule(this.toString(),0,1);
  final FileDataSourceContract<PactJsonObject.Key,PactJsonObject> contract=new FileDataSourceContract<PactJsonObject.Key,PactJsonObject>(this.inputFormat,inputName,name);
  if (this.inputFormat == JsonInputFormat.class)   contract.setDegreeOfParallelism(1);
  for (  final Entry<String,Object> parameter : this.parameters.entrySet())   if (parameter.getValue() instanceof Serializable)   SopremoUtil.serialize(contract.getParameters(),parameter.getKey(),(Serializable)parameter.getValue());
  pactModule.getOutput(0).setInput(contract);
  return pactModule;
}
