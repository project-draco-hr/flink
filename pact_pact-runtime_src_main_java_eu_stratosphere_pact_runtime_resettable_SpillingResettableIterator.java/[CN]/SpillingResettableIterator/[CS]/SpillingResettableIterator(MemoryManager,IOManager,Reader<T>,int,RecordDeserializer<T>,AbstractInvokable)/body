{
  this.memoryManager=memoryManager;
  this.ioManager=ioManager;
  this.recordReader=reader;
  this.deserializer=deserializer;
  memorySegments=new ArrayList<MemorySegment>(nrOfBuffers);
  for (int i=0; i < nrOfBuffers; ++i)   memorySegments.add(this.memoryManager.allocate(parentTask,availableMemory / nrOfBuffers));
  currentBuffer=0;
  LOG.debug("Iterator initalized using " + availableMemory + " bytes of IO buffer.");
}
