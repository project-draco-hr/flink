{
  MockNotificationListener listener=new MockNotificationListener();
  int currentNumber=0;
  try {
    while (true) {
      Buffer buffer=iterator.getNextBuffer();
      if (slowConsumer) {
        Thread.sleep(SLEEP_TIME_MS);
      }
      if (buffer == null) {
        if (iterator.subscribe(listener)) {
          listener.waitForNotification();
        }
 else         if (iterator.isConsumed()) {
          break;
        }
      }
 else {
        try {
          if (buffer.isBuffer()) {
            currentNumber=verifyBufferFilledWithAscendingNumbers(buffer,currentNumber);
          }
        }
  finally {
          buffer.recycle();
        }
      }
    }
  }
 catch (  Throwable t) {
    error.compareAndSet(null,t);
    return false;
  }
  return true;
}
