{
  Preconditions.checkNotNull(data,"Collection must not be null");
  if (data.isEmpty()) {
    throw new IllegalArgumentException("Collection must not be empty");
  }
  TypeInformation<OUT> typeInfo=TypeExtractor.getForObject(data.iterator().next());
  SourceFunction<OUT> function=new FromElementsFunction<OUT>(typeInfo.createSerializer(getConfig()),data);
  checkCollection(data,typeInfo.getTypeClass());
  return addSource(function,"Collection Source").returns(typeInfo);
}
