{
  if (typeInfo == null) {
    if (function instanceof ResultTypeQueryable) {
      typeInfo=((ResultTypeQueryable<OUT>)function).getProducedType();
    }
 else {
      try {
        typeInfo=TypeExtractor.createTypeInfo(SourceFunction.class,function.getClass(),0,null,null);
      }
 catch (      final InvalidTypesException e) {
        typeInfo=(TypeInformation<OUT>)new MissingTypeInfo(sourceName,e);
      }
    }
  }
  boolean isParallel=function instanceof ParallelSourceFunction;
  clean(function);
  StreamOperator<OUT> sourceOperator=new StreamSource<OUT>(function);
  return new DataStreamSource<OUT>(this,sourceName,typeInfo,sourceOperator,isParallel,sourceName);
}
