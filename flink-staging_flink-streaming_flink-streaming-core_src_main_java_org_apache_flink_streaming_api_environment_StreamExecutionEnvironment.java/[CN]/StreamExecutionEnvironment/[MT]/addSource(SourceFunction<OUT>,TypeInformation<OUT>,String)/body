{
  if (outTypeInfo == null) {
    if (function instanceof GenericSourceFunction) {
      outTypeInfo=((GenericSourceFunction<OUT>)function).getType();
    }
 else {
      outTypeInfo=TypeExtractor.createTypeInfo(SourceFunction.class,function.getClass(),0,null,null);
    }
  }
  boolean isParallel=function instanceof ParallelSourceFunction;
  int parallelism=isParallel ? getParallelism() : 1;
  ClosureCleaner.clean(function,true);
  StreamInvokable<OUT,OUT> sourceInvokable=new SourceInvokable<OUT>(function);
  DataStreamSource<OUT> returnStream=new DataStreamSource<OUT>(this,sourceName,outTypeInfo,sourceInvokable,isParallel);
  streamGraph.addSourceVertex(returnStream.getId(),sourceInvokable,null,outTypeInfo,sourceName,parallelism);
  return returnStream;
}
