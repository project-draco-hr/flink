{
  if (outTypeInfo == null) {
    if (function instanceof GenericSourceFunction) {
      outTypeInfo=((GenericSourceFunction<OUT>)function).getType();
    }
 else {
      outTypeInfo=TypeExtractor.createTypeInfo(SourceFunction.class,function.getClass(),0,null,null);
    }
  }
  boolean isParallel=function instanceof ParallelSourceFunction;
  ClosureCleaner.clean(function,true);
  StreamInvokable<OUT,OUT> sourceInvokable=new SourceInvokable<OUT>(function);
  return new DataStreamSource<OUT>(this,sourceName,outTypeInfo,sourceInvokable,isParallel,sourceName);
}
