{
  if (mode == null) {
    throw new NullPointerException("checkpoint mode must not be null");
  }
  if (interval <= 0) {
    throw new IllegalArgumentException("the checkpoint interval must be positive");
  }
  streamGraph.setCheckpointingEnabled(true);
  streamGraph.setCheckpointingInterval(interval);
  streamGraph.setCheckpointingMode(mode);
  if (force) {
    streamGraph.forceCheckpoint();
  }
  return this;
}
