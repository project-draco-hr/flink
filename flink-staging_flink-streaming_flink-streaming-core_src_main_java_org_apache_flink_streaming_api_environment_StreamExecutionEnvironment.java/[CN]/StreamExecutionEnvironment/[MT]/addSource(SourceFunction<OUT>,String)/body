{
  TypeInformation<OUT> outTypeInfo;
  if (function instanceof GenericSourceFunction) {
    outTypeInfo=((GenericSourceFunction<OUT>)function).getType();
  }
 else {
    try {
      outTypeInfo=TypeExtractor.createTypeInfo(SourceFunction.class,function.getClass(),0,null,null);
    }
 catch (    InvalidTypesException e) {
      outTypeInfo=(TypeInformation<OUT>)new MissingTypeInfo("Custom source",e);
    }
  }
  boolean isParallel=function instanceof ParallelSourceFunction;
  ClosureCleaner.clean(function,true);
  StreamOperator<OUT,OUT> sourceOperator=new StreamSource<OUT>(function);
  return new DataStreamSource<OUT>(this,sourceName,outTypeInfo,sourceOperator,isParallel,sourceName);
}
