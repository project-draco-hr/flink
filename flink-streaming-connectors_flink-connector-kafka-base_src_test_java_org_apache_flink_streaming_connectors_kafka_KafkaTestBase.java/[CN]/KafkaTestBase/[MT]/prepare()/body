{
  LOG.info("-------------------------------------------------------------------------");
  LOG.info("    Starting KafkaITCase ");
  LOG.info("-------------------------------------------------------------------------");
  Class<?> clazz=Class.forName("org.apache.flink.streaming.connectors.kafka.KafkaTestEnvironmentImpl");
  kafkaServer=(KafkaTestEnvironment)InstantiationUtil.instantiate(clazz);
  LOG.info("Starting KafkaITCase.prepare() for Kafka " + kafkaServer.getVersion());
  kafkaServer.prepare(NUMBER_OF_KAFKA_SERVERS);
  standardProps=kafkaServer.getStandardProperties();
  brokerConnectionStrings=kafkaServer.getBrokerConnectionString();
  Configuration flinkConfig=new Configuration();
  flinkConfig.setInteger(ConfigConstants.LOCAL_NUMBER_TASK_MANAGER,1);
  flinkConfig.setInteger(ConfigConstants.TASK_MANAGER_NUM_TASK_SLOTS,8);
  flinkConfig.setInteger(ConfigConstants.TASK_MANAGER_MEMORY_SIZE_KEY,16);
  flinkConfig.setString(ConfigConstants.EXECUTION_RETRY_DELAY_KEY,"0 s");
  flink=new ForkableFlinkMiniCluster(flinkConfig,false);
  flink.start();
  flinkPort=flink.getLeaderRPCPort();
}
