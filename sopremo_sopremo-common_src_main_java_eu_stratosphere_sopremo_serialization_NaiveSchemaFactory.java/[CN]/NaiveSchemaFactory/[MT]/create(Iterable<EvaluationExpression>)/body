{
  List<ObjectAccess> accesses=new ArrayList<ObjectAccess>();
  List<EvaluationExpression> mappings=new ArrayList<EvaluationExpression>();
  for (  EvaluationExpression evaluationExpression : keyExpressions) {
    mappings.add(evaluationExpression);
    if (evaluationExpression instanceof ObjectAccess) {
      accesses.add((ObjectAccess)evaluationExpression);
    }
  }
  if (mappings.isEmpty())   return new DirectSchema();
  if (accesses.size() == mappings.size()) {
    ObjectSchema schema=new ObjectSchema();
    schema.setMappingsWithAccesses(accesses);
    return schema;
  }
 else {
    return new GeneralSchema(mappings);
  }
}
