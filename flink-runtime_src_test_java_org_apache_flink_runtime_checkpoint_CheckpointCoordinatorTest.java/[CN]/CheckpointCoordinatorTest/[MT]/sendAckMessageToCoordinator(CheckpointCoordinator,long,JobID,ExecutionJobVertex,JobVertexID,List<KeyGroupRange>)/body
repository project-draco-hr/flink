{
  for (int index=0; index < jobVertex.getParallelism(); index++) {
    ChainedStateHandle<StreamStateHandle> state=generateStateForVertex(jobVertexID,index);
    List<KeyGroupsStateHandle> keyGroupState=generateKeyGroupState(jobVertexID,keyGroupPartitions.get(index));
    AcknowledgeCheckpoint acknowledgeCheckpoint=new AcknowledgeCheckpoint(jid,jobVertex.getTaskVertices()[index].getCurrentExecutionAttempt().getAttemptId(),checkpointId,state,keyGroupState);
    coord.receiveAcknowledgeMessage(acknowledgeCheckpoint);
  }
}
