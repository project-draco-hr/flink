{
  for (int i=0; i < executionJobVertex.getParallelism(); i++) {
    ChainedStateHandle<StreamStateHandle> expectNonPartitionedState=generateStateForVertex(jobVertexID,i);
    ChainedStateHandle<StreamStateHandle> actualNonPartitionedState=executionJobVertex.getTaskVertices()[i].getCurrentExecutionAttempt().getChainedStateHandle();
    assertEquals(expectNonPartitionedState.get(0),actualNonPartitionedState.get(0));
    ChainedStateHandle<OperatorStateHandle> expectedPartitionableState=generateChainedPartitionableStateHandle(jobVertexID,i,2,8);
    List<Collection<OperatorStateHandle>> actualPartitionableState=executionJobVertex.getTaskVertices()[i].getCurrentExecutionAttempt().getChainedPartitionableStateHandle();
    assertEquals(expectedPartitionableState.get(0),actualPartitionableState.get(0).iterator().next());
    List<KeyGroupsStateHandle> expectPartitionedKeyGroupState=generateKeyGroupState(jobVertexID,keyGroupPartitions.get(i));
    List<KeyGroupsStateHandle> actualPartitionedKeyGroupState=executionJobVertex.getTaskVertices()[i].getCurrentExecutionAttempt().getKeyGroupsStateHandles();
    compareKeyPartitionedState(expectPartitionedKeyGroupState,actualPartitionedKeyGroupState);
  }
}
