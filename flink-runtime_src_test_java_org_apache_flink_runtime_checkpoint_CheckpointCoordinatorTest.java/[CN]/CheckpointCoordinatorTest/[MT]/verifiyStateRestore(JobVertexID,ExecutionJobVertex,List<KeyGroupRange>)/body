{
  for (int i=0; i < executionJobVertex.getParallelism(); i++) {
    ChainedStateHandle<StreamStateHandle> expectNonPartitionedState=generateStateForVertex(jobVertexID,i);
    ChainedStateHandle<StreamStateHandle> actualNonPartitionedState=executionJobVertex.getTaskVertices()[i].getCurrentExecutionAttempt().getChainedStateHandle();
    assertEquals(expectNonPartitionedState.get(0),actualNonPartitionedState.get(0));
    List<KeyGroupsStateHandle> expectPartitionedKeyGroupState=generateKeyGroupState(jobVertexID,keyGroupPartitions.get(i));
    List<KeyGroupsStateHandle> actualPartitionedKeyGroupState=executionJobVertex.getTaskVertices()[i].getCurrentExecutionAttempt().getKeyGroupsStateHandles();
    comparePartitionedState(expectPartitionedKeyGroupState,actualPartitionedKeyGroupState);
  }
}
