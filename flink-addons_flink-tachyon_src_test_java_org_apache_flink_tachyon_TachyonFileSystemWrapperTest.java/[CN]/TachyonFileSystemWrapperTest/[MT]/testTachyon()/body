{
  try {
    org.apache.flink.configuration.Configuration addHDConfToFlinkConf=new org.apache.flink.configuration.Configuration();
    addHDConfToFlinkConf.setString(ConfigConstants.HDFS_DEFAULT_CONFIG,HADOOP_CONFIG_PATH.toString());
    GlobalConfiguration.includeConfiguration(addHDConfToFlinkConf);
    new DopOneTestEnvironment();
    WordCount.main(new String[]{input,output});
    TachyonFile resultFile=client.getFile("/" + TACHYON_TEST_OUT_FILE_NAME);
    Assert.assertNotNull("Result file has not been created",resultFile);
    InStream inStream=resultFile.getInStream(ReadType.CACHE);
    Assert.assertNotNull("Result file has not been created",inStream);
    StringWriter writer=new StringWriter();
    IOUtils.copy(inStream,writer);
    String resultString=writer.toString();
    Assert.assertEquals("hello 10\n" + "tachyon 10\n",resultString);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail("Test failed with exception: " + e.getMessage());
  }
}
