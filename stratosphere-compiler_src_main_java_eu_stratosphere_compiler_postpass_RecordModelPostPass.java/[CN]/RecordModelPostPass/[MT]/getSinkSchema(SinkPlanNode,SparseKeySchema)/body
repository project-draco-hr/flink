{
  GenericDataSinkBase<?> sink=sinkPlanNode.getSinkNode().getPactContract();
  Ordering partitioning=sink.getPartitionOrdering();
  Ordering sorting=sink.getLocalOrder();
  try {
    if (partitioning != null) {
      addOrderingToSchema(partitioning,schema);
    }
    if (sorting != null) {
      addOrderingToSchema(sorting,schema);
    }
  }
 catch (  ConflictingFieldTypeInfoException ex) {
    throw new CompilerPostPassException("Conflicting information found when adding data sink types. " + "Probable reason is contradicting type infos for partitioning and sorting ordering.");
  }
}
