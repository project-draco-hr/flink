{
  this.transferEnvelopeDispatcher=transferEnvelopeDispatcher;
  this.writeBufferProvider=writeBufferProvider;
  this.commonChannelType=commonChannelType;
  if (commonChannelType == ChannelType.FILE) {
    this.ephemeralCheckpoint=EphemeralCheckpoint.forFileChannel(checkpointManager,executionVertexID);
  }
 else   if (commonChannelType == ChannelType.NETWORK) {
    this.ephemeralCheckpoint=EphemeralCheckpoint.forNetworkChannel(checkpointManager,executionVertexID);
  }
 else {
    this.ephemeralCheckpoint=null;
  }
  if (this.ephemeralCheckpoint != null) {
    this.writeBufferProvider.registerOutOfWriteBuffersListener(this.ephemeralCheckpoint);
  }
}
