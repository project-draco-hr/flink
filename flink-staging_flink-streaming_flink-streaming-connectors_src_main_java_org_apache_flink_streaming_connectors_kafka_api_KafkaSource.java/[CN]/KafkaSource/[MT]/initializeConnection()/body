{
  Properties props=new Properties();
  props.put("zookeeper.connect",zookeeperHost);
  props.put("group.id",groupId);
  props.put("zookeeper.session.timeout.ms","10000");
  props.put("zookeeper.sync.time.ms",Long.toString(zookeeperSyncTimeMillis));
  props.put("auto.commit.interval.ms","1000");
  consumer=Consumer.createJavaConsumerConnector(new ConsumerConfig(props));
  Map<String,List<KafkaStream<byte[],byte[]>>> consumerMap=consumer.createMessageStreams(Collections.singletonMap(topicId,1));
  List<KafkaStream<byte[],byte[]>> streams=consumerMap.get(topicId);
  KafkaStream<byte[],byte[]> stream=streams.get(0);
  consumerIterator=stream.iterator();
}
