{
  while (consumerIterator.hasNext()) {
    OUT out=schema.deserialize(consumerIterator.next().message());
    if (schema.isEndOfStream(out)) {
      break;
    }
    collector.collect(out);
  }
  consumer.shutdown();
}
