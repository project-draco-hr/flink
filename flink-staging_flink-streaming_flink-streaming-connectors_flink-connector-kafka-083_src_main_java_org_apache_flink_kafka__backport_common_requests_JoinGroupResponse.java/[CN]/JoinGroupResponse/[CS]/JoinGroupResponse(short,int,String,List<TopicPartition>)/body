{
  super(new Struct(CURRENT_SCHEMA));
  Map<String,List<Integer>> partitionsByTopic=CollectionUtils.groupDataByTopic(assignedPartitions);
  struct.set(ERROR_CODE_KEY_NAME,errorCode);
  struct.set(GENERATION_ID_KEY_NAME,generationId);
  struct.set(CONSUMER_ID_KEY_NAME,consumerId);
  List<Struct> topicArray=new ArrayList<Struct>();
  for (  Map.Entry<String,List<Integer>> entries : partitionsByTopic.entrySet()) {
    Struct topicData=struct.instance(ASSIGNED_PARTITIONS_KEY_NAME);
    topicData.set(TOPIC_KEY_NAME,entries.getKey());
    topicData.set(PARTITIONS_KEY_NAME,entries.getValue().toArray());
    topicArray.add(topicData);
  }
  struct.set(ASSIGNED_PARTITIONS_KEY_NAME,topicArray.toArray());
  this.errorCode=errorCode;
  this.generationId=generationId;
  this.consumerId=consumerId;
  this.assignedPartitions=assignedPartitions;
}
