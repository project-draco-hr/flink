{
  if (!current.hasNext()) {
    throw new Exception("Error: Id not encountered before.");
  }
  Record old=current.next();
  long oldId=old.getField(1,LongValue.class).getValue();
  long minimumComponentID=Long.MAX_VALUE;
  while (candidates.hasNext()) {
    long candidateComponentID=candidates.next().getField(1,LongValue.class).getValue();
    if (candidateComponentID < minimumComponentID) {
      minimumComponentID=candidateComponentID;
    }
  }
  if (minimumComponentID < oldId) {
    newComponentId.setValue(minimumComponentID);
    old.setField(1,newComponentId);
    out.collect(old);
  }
}
