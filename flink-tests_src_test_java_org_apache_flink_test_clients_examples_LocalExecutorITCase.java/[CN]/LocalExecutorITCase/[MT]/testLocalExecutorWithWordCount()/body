{
  try {
    File inFile=File.createTempFile("wctext",".in");
    File outFile=File.createTempFile("wctext",".out");
    inFile.deleteOnExit();
    outFile.deleteOnExit();
    FileWriter fw=new FileWriter(inFile);
    fw.write(WordCountData.TEXT);
    fw.close();
    WordCount wc=new WordCount();
    LocalExecutor executor=new LocalExecutor();
    executor.setDefaultOverwriteFiles(true);
    executor.setTaskManagerNumSlots(parallelism);
    executor.setPrintStatusDuringExecution(false);
    executor.start();
    Plan wcPlan=wc.getPlan(Integer.valueOf(parallelism).toString(),inFile.toURI().toString(),outFile.toURI().toString());
    wcPlan.setExecutionConfig(new ExecutionConfig());
    executor.executePlan(wcPlan);
    executor.stop();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}
