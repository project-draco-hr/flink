{
  UserPayload payload=getContext().getUserPayload();
  Configuration conf=TezUtils.createConfFromUserPayload(payload);
  this.config=(TezTaskConfig)EncodingUtils.decodeObjectFromString(conf.get(TezTaskConfig.TEZ_TASK_CONFIG),getClass().getClassLoader());
  config.setTaskName(getContext().getTaskVertexName());
  this.runtimeEnvironment=new TezRuntimeEnvironment((long)(0.7 * this.getContext().getTotalMemoryAvailableToTask()));
  this.inputTypeSerializerFactory=this.config.getInputSerializer(0,this.userCodeClassLoader);
  initOutputFormat();
}
