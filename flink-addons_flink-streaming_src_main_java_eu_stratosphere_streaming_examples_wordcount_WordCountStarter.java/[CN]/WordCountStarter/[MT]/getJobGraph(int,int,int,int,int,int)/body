{
  JobGraphBuilder graphBuilder=new JobGraphBuilder("testGraph",FaultToleranceType.NONE);
  graphBuilder.setSource("WordCountSourceSplitter",WordCountSourceSplitter.class,sourceSubtasks,sourceSubtasksPerInstance);
  graphBuilder.setTask("WordCountCounter",WordCountCounter.class,counterSubtasks,counterSubtasksPerInstance);
  graphBuilder.setSink("WordCountSink",WordCountSink.class,sinkSubtasks,sinkSubtasksPerInstance);
  graphBuilder.fieldsConnect("WordCountSourceSplitter","WordCountCounter",0);
  graphBuilder.shuffleConnect("WordCountCounter","WordCountSink");
  return graphBuilder.getJobGraph();
}
