{
  partitionRequestHandler.removeInputChannel(inputChannel);
  if (closeReferenceCounter.decrement()) {
    tcpChannel.close();
    clientFactory.destroyPartitionRequestClient(connectionId,this);
  }
 else {
    partitionRequestHandler.cancelRequestFor(inputChannel.getInputChannelId());
  }
}
