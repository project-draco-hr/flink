{
  partitionRequestHandler.addInputChannel(inputChannel);
  tcpChannel.writeAndFlush(new PartitionRequest(partitionId,requestedQueueIndex,inputChannel.getInputChannelId())).addListener(new ChannelFutureListener(){
    @Override public void operationComplete(    ChannelFuture future) throws Exception {
      if (!future.isSuccess()) {
        partitionRequestHandler.removeInputChannel(inputChannel);
        inputChannel.onError(future.cause());
      }
    }
  }
);
}
