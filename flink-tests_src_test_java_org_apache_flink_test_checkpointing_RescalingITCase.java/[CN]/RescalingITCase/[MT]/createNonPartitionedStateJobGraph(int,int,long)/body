{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.setParallelism(parallelism);
  env.getConfig().setMaxParallelism(maxParallelism);
  env.enableCheckpointing(checkpointInterval);
  env.setRestartStrategy(RestartStrategies.noRestart());
  NonPartitionedStateSource.workStartedLatch=new CountDownLatch(1);
  DataStream<Integer> input=env.addSource(new NonPartitionedStateSource());
  input.addSink(new DiscardingSink<Integer>());
  return env.getStreamGraph().getJobGraph();
}
