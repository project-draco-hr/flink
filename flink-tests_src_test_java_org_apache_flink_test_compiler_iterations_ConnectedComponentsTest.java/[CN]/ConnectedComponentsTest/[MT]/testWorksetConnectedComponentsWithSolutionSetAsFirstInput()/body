{
  Plan plan=getPlanForWorksetConnectedComponentsWithSolutionSetAsFirstInput(DEFAULT_PARALLELISM,IN_FILE,IN_FILE,OUT_FILE,100);
  OptimizedPlan optPlan=compileNoStats(plan);
  OptimizerPlanNodeResolver or=getOptimizerPlanNodeResolver(optPlan);
  if (PRINT_PLAN) {
    PlanJSONDumpGenerator dumper=new PlanJSONDumpGenerator();
    String json=dumper.getOptimizerPlanAsJSON(optPlan);
    System.out.println(json);
  }
  SourcePlanNode vertexSource=or.getNode(VERTEX_SOURCE);
  SourcePlanNode edgesSource=or.getNode(EDGES_SOURCE);
  SinkPlanNode sink=or.getNode(SINK);
  WorksetIterationPlanNode iter=or.getNode(ITERATION_NAME);
  DualInputPlanNode neighborsJoin=or.getNode(JOIN_NEIGHBORS_MATCH);
  SingleInputPlanNode minIdReducer=or.getNode(MIN_ID_REDUCER);
  SingleInputPlanNode minIdCombiner=(SingleInputPlanNode)minIdReducer.getPredecessor();
  DualInputPlanNode updatingMatch=or.getNode(UPDATE_ID_MATCH);
  Assert.assertEquals(DriverStrategy.NONE,sink.getDriverStrategy());
  Assert.assertEquals(DriverStrategy.NONE,vertexSource.getDriverStrategy());
  Assert.assertEquals(DriverStrategy.NONE,edgesSource.getDriverStrategy());
  Assert.assertEquals(DriverStrategy.HYBRIDHASH_BUILD_SECOND_CACHED,neighborsJoin.getDriverStrategy());
  Assert.assertTrue(!neighborsJoin.getInput1().getTempMode().isCached());
  Assert.assertTrue(!neighborsJoin.getInput2().getTempMode().isCached());
  Assert.assertEquals(set0,neighborsJoin.getKeysForInput1());
  Assert.assertEquals(set0,neighborsJoin.getKeysForInput2());
  Assert.assertEquals(DriverStrategy.HYBRIDHASH_BUILD_FIRST,updatingMatch.getDriverStrategy());
  Assert.assertEquals(set0,updatingMatch.getKeysForInput1());
  Assert.assertEquals(set0,updatingMatch.getKeysForInput2());
  Assert.assertEquals(ShipStrategyType.FORWARD,sink.getInput().getShipStrategy());
  Assert.assertEquals(ShipStrategyType.PARTITION_HASH,iter.getInitialSolutionSetInput().getShipStrategy());
  Assert.assertEquals(set0,iter.getInitialSolutionSetInput().getShipStrategyKeys());
  Assert.assertEquals(ShipStrategyType.PARTITION_HASH,iter.getInitialWorksetInput().getShipStrategy());
  Assert.assertEquals(set0,iter.getInitialWorksetInput().getShipStrategyKeys());
  Assert.assertEquals(ShipStrategyType.FORWARD,neighborsJoin.getInput1().getShipStrategy());
  Assert.assertEquals(ShipStrategyType.PARTITION_HASH,neighborsJoin.getInput2().getShipStrategy());
  Assert.assertEquals(set0,neighborsJoin.getInput2().getShipStrategyKeys());
  Assert.assertEquals(ShipStrategyType.PARTITION_HASH,minIdReducer.getInput().getShipStrategy());
  Assert.assertEquals(set0,minIdReducer.getInput().getShipStrategyKeys());
  Assert.assertEquals(ShipStrategyType.FORWARD,minIdCombiner.getInput().getShipStrategy());
  Assert.assertEquals(ShipStrategyType.FORWARD,updatingMatch.getInput1().getShipStrategy());
  Assert.assertEquals(ShipStrategyType.FORWARD,updatingMatch.getInput2().getShipStrategy());
  Assert.assertEquals(LocalStrategy.NONE,sink.getInput().getLocalStrategy());
  Assert.assertEquals(LocalStrategy.NONE,iter.getInitialSolutionSetInput().getLocalStrategy());
  Assert.assertEquals(LocalStrategy.NONE,iter.getInitialWorksetInput().getLocalStrategy());
  Assert.assertEquals(LocalStrategy.NONE,neighborsJoin.getInput1().getLocalStrategy());
  Assert.assertEquals(LocalStrategy.NONE,neighborsJoin.getInput2().getLocalStrategy());
  Assert.assertEquals(LocalStrategy.COMBININGSORT,minIdReducer.getInput().getLocalStrategy());
  Assert.assertEquals(set0,minIdReducer.getInput().getLocalStrategyKeys());
  Assert.assertEquals(LocalStrategy.NONE,minIdCombiner.getInput().getLocalStrategy());
  Assert.assertEquals(LocalStrategy.NONE,updatingMatch.getInput1().getLocalStrategy());
  Assert.assertEquals(LocalStrategy.NONE,updatingMatch.getInput2().getLocalStrategy());
  Assert.assertTrue(TempMode.PIPELINE_BREAKER == iter.getInitialWorksetInput().getTempMode() || LocalStrategy.SORT == iter.getInitialWorksetInput().getLocalStrategy());
  JobGraphGenerator jgg=new JobGraphGenerator();
  jgg.compileJobGraph(optPlan);
}
