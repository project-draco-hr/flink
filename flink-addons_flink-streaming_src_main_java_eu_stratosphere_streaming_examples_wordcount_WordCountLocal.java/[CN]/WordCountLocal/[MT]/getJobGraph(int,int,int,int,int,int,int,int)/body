{
  JobGraphBuilder graphBuilder=new JobGraphBuilder("testGraph");
  graphBuilder.setSource("WordCountSource",WordCountSource.class,sourceSubtasks,sourceSubtasksPerInstance);
  graphBuilder.setTask("WordCountSplitter",WordCountSplitter.class,splitterSubtasks,splitterSubtasksPerInstance);
  graphBuilder.setTask("WordCountCounter",WordCountCounter.class,counterSubtasks,counterSubtasksPerInstance);
  graphBuilder.setSink("WordCountSink",WordCountSink.class,sinkSubtasks,sinkSubtasksPerInstance);
  graphBuilder.shuffleConnect("WordCountSource","WordCountSplitter");
  graphBuilder.fieldsConnect("WordCountSplitter","WordCountCounter",0);
  graphBuilder.shuffleConnect("WordCountCounter","WordCountSink");
  return graphBuilder.getJobGraph();
}
