{
  if (LOG.isDebugEnabled()) {
    LOG.debug("SOURCE " + name + " invoked with instance id "+ instanceID);
  }
  outputHandler.initializeOutputSerializers();
  StreamRecord<OUT> nextRecord;
  while (true) {
    if (shouldWait) {
      nextRecord=dataChannel.poll(iterationWaitTime,TimeUnit.MILLISECONDS);
    }
 else {
      nextRecord=dataChannel.take();
    }
    if (nextRecord == null) {
      break;
    }
    for (    RecordWriter<SerializationDelegate<StreamRecord<OUT>>> output : outputHandler.getOutputs()) {
      outSerializationDelegate.setInstance(nextRecord);
      output.emit(outSerializationDelegate);
    }
  }
  outputHandler.flushOutputs();
}
