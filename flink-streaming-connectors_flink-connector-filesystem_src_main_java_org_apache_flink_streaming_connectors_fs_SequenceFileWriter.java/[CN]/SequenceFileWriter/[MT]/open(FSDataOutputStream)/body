{
  if (outputStream != null) {
    throw new IllegalStateException("SequenceFileWriter has already been opened.");
  }
  if (keyClass == null) {
    throw new IllegalStateException("Key Class has not been initialized.");
  }
  if (valueClass == null) {
    throw new IllegalStateException("Value Class has not been initialized.");
  }
  this.outputStream=outStream;
  CompressionCodec codec=null;
  if (!compressionCodecName.equals("None")) {
    CompressionCodecFactory codecFactory=new CompressionCodecFactory(new Configuration());
    codec=codecFactory.getCodecByName(compressionCodecName);
    if (codec == null) {
      throw new RuntimeException("Codec " + compressionCodecName + " not found.");
    }
  }
  writer=SequenceFile.createWriter(new Configuration(),outStream,keyClass,valueClass,compressionType,codec);
}
