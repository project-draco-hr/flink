{
  final MutableObjectIterator<Record> iterator=sorter.getIterator();
  int pairsEmitted=1;
  int windowTransitions=0;
  Record rec1=new Record();
  Record rec2=new Record();
  LOG.debug("Checking results...");
  Assert.assertTrue((rec1=iterator.next(rec1)) != null);
  while ((rec2=iterator.next(rec2)) != null) {
    final TestData.Key k1=rec1.getField(0,TestData.Key.class);
    final TestData.Key k2=rec2.getField(0,TestData.Key.class);
    pairsEmitted++;
    if (k1.compareTo(k2) > 0) {
      windowTransitions++;
    }
    Record tmp=rec1;
    rec1=rec2;
    k1.setKey(k2.getKey());
    rec2=tmp;
  }
  sorter.close();
  Assert.assertEquals("Sorter did not return the expected number of result records.",expectedNumResultRecords,pairsEmitted);
  Assert.assertEquals("The partial sorter made an unexpected number of window transitions.",expectedNumWindowTransitions,windowTransitions);
}
