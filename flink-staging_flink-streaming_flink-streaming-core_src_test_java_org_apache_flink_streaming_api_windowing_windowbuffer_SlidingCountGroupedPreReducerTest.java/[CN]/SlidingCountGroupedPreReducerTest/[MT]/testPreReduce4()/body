{
  TestOutput<StreamWindow<Integer>> collector=new TestOutput<StreamWindow<Integer>>();
  SlidingCountGroupedPreReducer<Integer> preReducer=new SlidingCountGroupedPreReducer<Integer>(reducer,serializer,key,5,1,2);
  preReducer.store(1);
  preReducer.evict(1);
  preReducer.store(1);
  preReducer.evict(1);
  preReducer.store(1);
  preReducer.emitWindow(collector);
  preReducer.store(2);
  preReducer.emitWindow(collector);
  preReducer.store(3);
  preReducer.emitWindow(collector);
  preReducer.store(4);
  preReducer.emitWindow(collector);
  preReducer.store(5);
  preReducer.emitWindow(collector);
  preReducer.evict(1);
  preReducer.store(6);
  preReducer.emitWindow(collector);
  preReducer.evict(1);
  preReducer.store(7);
  preReducer.emitWindow(collector);
  preReducer.evict(1);
  preReducer.store(8);
  preReducer.emitWindow(collector);
  preReducer.evict(1);
  List<StreamWindow<Integer>> expected=new ArrayList<StreamWindow<Integer>>();
  expected.add(StreamWindow.fromElements(1));
  expected.add(StreamWindow.fromElements(1,2));
  expected.add(StreamWindow.fromElements(4,2));
  expected.add(StreamWindow.fromElements(4,6));
  expected.add(StreamWindow.fromElements(9,6));
  expected.add(StreamWindow.fromElements(8,12));
  expected.add(StreamWindow.fromElements(15,10));
  expected.add(StreamWindow.fromElements(12,18));
  checkResults(expected,collector.getCollected());
}
