{
  super(flinkConfig);
  this.akkaDuration=AkkaUtils.getTimeout(flinkConfig);
  this.akkaTimeout=Timeout.durationToTimeout(akkaDuration);
  this.clusterDescriptor=clusterDescriptor;
  this.yarnClient=yarnClient;
  this.hadoopConfig=yarnClient.getConfig();
  this.sessionFilesDir=sessionFilesDir;
  this.appReport=appReport;
  this.appId=appReport.getApplicationId();
  this.trackingURL=appReport.getTrackingUrl();
  this.perJobCluster=perJobCluster;
  this.applicationClient=new LazApplicationClientLoader();
  pollingRunner=new PollingThread(yarnClient,appId);
  pollingRunner.setDaemon(true);
  pollingRunner.start();
  Runtime.getRuntime().addShutdownHook(clientShutdownHook);
}
