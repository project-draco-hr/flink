{
  try {
    while (running) {
      try {
        Thread.sleep(commitInterval);
        HashMap<KafkaTopicPartition,Long> currentOffsets=(HashMap<KafkaTopicPartition,Long>)consumer.lastOffsets.clone();
        commitOffsets(currentOffsets,this.consumer);
      }
 catch (      InterruptedException e) {
        if (running) {
          throw e;
        }
      }
    }
  }
 catch (  Throwable t) {
    LOG.warn("Periodic checkpoint committer is stopping the fetcher because of an error",t);
    consumer.fetcher.stopWithError(t);
  }
}
