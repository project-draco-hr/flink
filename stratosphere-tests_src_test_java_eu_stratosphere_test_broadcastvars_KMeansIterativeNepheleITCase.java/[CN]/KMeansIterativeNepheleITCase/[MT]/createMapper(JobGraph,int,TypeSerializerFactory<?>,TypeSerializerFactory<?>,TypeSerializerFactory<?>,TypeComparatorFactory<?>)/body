{
  JobTaskVertex mapper=JobGraphUtils.createTask(IterationIntermediatePactTask.class,"Map (Select nearest center)",jobGraph,numSubTasks,numSubTasks);
  TaskConfig intermediateConfig=new TaskConfig(mapper.getConfiguration());
  intermediateConfig.setIterationId(ITERATION_ID);
  intermediateConfig.setDriver(CollectorMapDriver.class);
  intermediateConfig.setDriverStrategy(DriverStrategy.COLLECTOR_MAP);
  intermediateConfig.addInputToGroup(0);
  intermediateConfig.setInputSerializer(inputSerializer,0);
  intermediateConfig.setOutputSerializer(outputSerializer);
  intermediateConfig.addOutputShipStrategy(ShipStrategyType.PARTITION_HASH);
  intermediateConfig.setOutputComparator(outputComparator,0);
  intermediateConfig.setBroadcastInputName("centers",0);
  intermediateConfig.addBroadcastInputToGroup(0);
  intermediateConfig.setBroadcastInputSerializer(broadcastVarSerializer,0);
  intermediateConfig.setStubWrapper(new UserCodeObjectWrapper<SelectNearestCenter>(new SelectNearestCenter()));
  return mapper;
}
