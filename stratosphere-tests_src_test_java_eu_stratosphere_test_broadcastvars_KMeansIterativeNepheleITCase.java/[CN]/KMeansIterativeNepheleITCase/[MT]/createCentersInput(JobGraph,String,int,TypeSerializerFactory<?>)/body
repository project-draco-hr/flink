{
  @SuppressWarnings("unchecked") CsvInputFormat modelsInFormat=new CsvInputFormat('|',IntValue.class,DoubleValue.class,DoubleValue.class,DoubleValue.class);
  JobInputVertex modelsInput=JobGraphUtils.createInput(modelsInFormat,centersPath,"[Models]",jobGraph,numSubTasks,numSubTasks);
{
    TaskConfig taskConfig=new TaskConfig(modelsInput.getConfiguration());
    taskConfig.addOutputShipStrategy(ShipStrategyType.FORWARD);
    taskConfig.setOutputSerializer(serializer);
    TaskConfig chainedMapper=new TaskConfig(new Configuration());
    chainedMapper.setDriverStrategy(DriverStrategy.COLLECTOR_MAP);
    chainedMapper.setStubWrapper(new UserCodeObjectWrapper<PointBuilder>(new PointBuilder()));
    chainedMapper.addOutputShipStrategy(ShipStrategyType.FORWARD);
    chainedMapper.setOutputSerializer(serializer);
    taskConfig.addChainedTask(ChainedCollectorMapDriver.class,chainedMapper,"Build centers");
  }
  return modelsInput;
}
