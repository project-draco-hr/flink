{
  double sum=0;
  while (values.hasNext()) {
    Tuple v=values.next();
    if (v.getNumberOfColumns() > 1) {
      long val=Math.round(Double.parseDouble(v.getStringValueAt(0)) * (1 - Double.parseDouble(v.getStringValueAt(1))) * 10000);
      sum+=(((double)val) / 10000d);
    }
 else {
      sum+=Double.parseDouble(v.getStringValueAt(0));
    }
  }
  Tuple summed=new Tuple();
  summed.addAttribute(FORMATTER.format(sum));
  LOGGER.info("Output: " + key);
  out.collect(key,summed);
}
