{
  StreamRecord record1=new ArrayStreamRecord(1).setTuple(0,new Tuple1<String>("R1")).setId(1);
  UID id=record1.getId();
  buffer.add(record1);
  assertEquals((Integer)3,buffer.ackCounter.get(id));
  buffer.ack(id,1);
  assertEquals((Integer)2,buffer.ackCounter.get(id));
  buffer.ack(id,1);
  assertEquals((Integer)1,buffer.ackCounter.get(id));
  buffer.ack(id,1);
  assertFalse(buffer.ackCounter.containsKey(id));
  assertFalse(buffer.recordBuffer.containsKey(id));
  assertFalse(buffer.recordTimestamps.containsKey(id));
}
