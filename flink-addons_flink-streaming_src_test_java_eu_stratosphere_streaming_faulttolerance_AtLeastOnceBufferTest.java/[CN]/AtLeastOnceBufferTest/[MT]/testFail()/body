{
  StreamRecord record1=new StreamRecord(new Tuple1<String>("R1")).setId("1");
  String id1=record1.getId();
  buffer.add(record1);
  buffer.ack(id1,1);
  buffer.ack(id1,1);
  assertEquals(1,buffer.recordBuffer.size());
  assertEquals(1,buffer.recordTimestamps.size());
  assertEquals(1,buffer.ackCounter.size());
  StreamRecord failed=buffer.fail(id1);
  String id2=failed.getId();
  assertFalse(buffer.ackCounter.containsKey(id1));
  assertFalse(buffer.recordBuffer.containsKey(id1));
  assertFalse(buffer.recordTimestamps.containsKey(id1));
  assertTrue(buffer.ackCounter.containsKey(id2));
  assertTrue(buffer.recordBuffer.containsKey(id2));
  assertTrue(buffer.recordTimestamps.containsKey(id2));
  assertEquals(1,buffer.recordBuffer.size());
  assertEquals(1,buffer.recordTimestamps.size());
  assertEquals(1,buffer.ackCounter.size());
}
