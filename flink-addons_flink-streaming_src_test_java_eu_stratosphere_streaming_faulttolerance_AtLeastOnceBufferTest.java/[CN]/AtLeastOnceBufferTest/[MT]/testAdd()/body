{
  StreamRecord record1=new StreamRecord(new StringValue("R1")).setId("1");
  String id1=record1.getId();
  Long nt=System.nanoTime();
  buffer.add(record1);
  System.out.println("ADD - " + " exec. time (ns): " + (System.nanoTime() - nt));
  record1.setRecord(new StringValue("R2"));
  record1.setId("1");
  String id2=record1.getId();
  try {
    Thread.sleep(10);
  }
 catch (  InterruptedException e) {
  }
  buffer.add(record1);
  assertEquals((Integer)3,buffer.ackCounter.get(id1));
  assertEquals((Integer)3,buffer.ackCounter.get(id2));
  assertEquals(new StringValue("R1"),buffer.recordBuffer.get(id1).getField(0));
  assertEquals(id1,buffer.recordBuffer.get(id1).getId());
  assertEquals(new StringValue("R2"),buffer.recordBuffer.get(id2).getField(0));
  assertEquals(id2,buffer.recordBuffer.get(id2).getId());
  assertEquals(2,buffer.recordTimestamps.size());
  assertEquals(2,buffer.recordsByTime.size());
  assertEquals(2,buffer.recordBuffer.size());
  assertEquals(2,buffer.ackCounter.size());
}
