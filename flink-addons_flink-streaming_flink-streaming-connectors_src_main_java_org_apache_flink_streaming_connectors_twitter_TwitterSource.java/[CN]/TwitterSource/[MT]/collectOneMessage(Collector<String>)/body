{
  if (client.isDone()) {
    if (LOG.isErrorEnabled()) {
      LOG.error("Client connection closed unexpectedly: {}",client.getExitEvent().getMessage());
    }
  }
  try {
    String msg=queue.poll(waitSec,TimeUnit.SECONDS);
    if (msg != null) {
      collector.collect(msg);
    }
 else {
      if (LOG.isInfoEnabled()) {
        LOG.info("Did not receive a message in {} seconds",waitSec);
      }
    }
  }
 catch (  InterruptedException e) {
    new RuntimeException("'Waiting for tweet' thread is interrupted",e);
  }
}
