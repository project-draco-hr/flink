{
  RecordLinkageInput recordLinkageInput=this.recordLinkageInput.clone();
  EvaluationExpression resultProjection=recordLinkageInput.getResultProjection(), idProjection=EvaluationExpression.VALUE;
  if (resultProjection != EvaluationExpression.VALUE && !recordLinkageInput.getResultProjection().equals(recordLinkageInput.getIdProjection())) {
    if (recordLinkageInput.getIdProjection() == EvaluationExpression.VALUE)     recordLinkageInput.setResultProjection(EvaluationExpression.VALUE);
 else {
      recordLinkageInput.setResultProjection(new ArrayCreation(recordLinkageInput.getIdProjection(),recordLinkageInput.getResultProjection()));
      idProjection=new ArrayAccess(0);
      resultProjection=new ArrayAccess(1);
    }
  }
  Operator allPairs=this.algorithm.getDuplicatePairStream(this.similarityCondition,Arrays.asList(recordLinkageInput,recordLinkageInput));
  Operator orderedPairs=new Selection(new ComparativeExpression(new PathExpression(new ArrayAccess(0),idProjection),BinaryOperator.LESS,new PathExpression(new ArrayAccess(1),idProjection)),allPairs);
  return new Projection(resultProjection,orderedPairs);
}
