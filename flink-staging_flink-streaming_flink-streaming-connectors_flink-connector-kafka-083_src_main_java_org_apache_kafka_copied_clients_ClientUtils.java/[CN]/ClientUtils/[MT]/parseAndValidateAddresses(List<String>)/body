{
  List<InetSocketAddress> addresses=new ArrayList<InetSocketAddress>();
  for (  String url : urls) {
    if (url != null && url.length() > 0) {
      String host=getHost(url);
      Integer port=getPort(url);
      if (host == null || port == null)       throw new ConfigException("Invalid url in " + CommonClientConfigs.BOOTSTRAP_SERVERS_CONFIG + ": "+ url);
      try {
        InetSocketAddress address=new InetSocketAddress(host,port);
        if (address.isUnresolved())         throw new ConfigException("DNS resolution failed for url in " + CommonClientConfigs.BOOTSTRAP_SERVERS_CONFIG + ": "+ url);
        addresses.add(address);
      }
 catch (      NumberFormatException e) {
        throw new ConfigException("Invalid port in " + CommonClientConfigs.BOOTSTRAP_SERVERS_CONFIG + ": "+ url);
      }
    }
  }
  if (addresses.size() < 1)   throw new ConfigException("No bootstrap urls given in " + CommonClientConfigs.BOOTSTRAP_SERVERS_CONFIG);
  return addresses;
}
