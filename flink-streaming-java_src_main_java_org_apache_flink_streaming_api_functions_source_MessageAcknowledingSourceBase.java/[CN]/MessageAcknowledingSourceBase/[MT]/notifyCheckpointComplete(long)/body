{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Committing Messages externally for checkpoint {}",checkpointId);
  }
  for (Iterator<Tuple2<Long,List<Id>>> iter=pendingCheckpoints.iterator(); iter.hasNext(); ) {
    Tuple2<Long,List<Id>> checkpoint=iter.next();
    long id=checkpoint.f0;
    if (id <= checkpointId) {
      if (LOG.isTraceEnabled()) {
        LOG.trace("Committing Messages with following IDs {}",checkpoint.f1);
      }
      acknowledgeIDs(checkpoint.f1);
      iter.remove();
    }
 else {
      break;
    }
  }
}
