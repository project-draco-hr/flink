{
  pendingCheckpoints.addLast(new Tuple2<Long,List<Id>>(checkpointId,idsForCurrentCheckpoint));
  idsForCurrentCheckpoint=new ArrayList<>(64);
  return SerializedCheckpointData.fromDeque(pendingCheckpoints,idSerializer);
}
