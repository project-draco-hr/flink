{
  double sum=0;
  while (records.hasNext()) {
    record=records.next();
    key=record.getField(0,key);
    v=record.getField(1,v);
    if (v.getNumberOfColumns() > 1) {
      long val=Math.round(Double.parseDouble(v.getStringValueAt(0)) * (1 - Double.parseDouble(v.getStringValueAt(1))) * 10000);
      sum+=(((double)val) / 10000d);
    }
 else {
      sum+=Double.parseDouble(v.getStringValueAt(0));
    }
  }
  Tuple summed=new Tuple();
  summed.addAttribute(FORMATTER.format(sum));
  LOGGER.info("Output: " + key);
  record.setField(1,summed);
  out.collect(record);
}
