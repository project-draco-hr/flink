{
  JobGraph jobGraph=new JobGraph("Compression Test Job");
  JobFileInputVertex input=new JobFileInputVertex("Input 1",jobGraph);
  input.setFileInputClass(DirectoryReader.class);
  input.setFilePath(new Path("file:///home/akli/trainingfiles"));
  JobTaskVertex task1=new JobTaskVertex("Task 1",jobGraph);
  task1.setTaskClass(CompressionTestTask.class);
  JobFileOutputVertex output=new JobFileOutputVertex("Output 1",jobGraph);
  output.setFileOutputClass(DirectoryWriter.class);
  output.setFilePath(new Path("file:///home/akli/compOutput"));
  try {
    input.connectTo(task1,ChannelType.FILE,CompressionLevel.MEDIUM_COMPRESSION);
    task1.connectTo(output,ChannelType.FILE,CompressionLevel.MEDIUM_COMPRESSION);
  }
 catch (  JobGraphDefinitionException e) {
    e.printStackTrace();
    return;
  }
  jobGraph.addJar(new Path("file:///home/akli/Compression.jar"));
  Configuration clientConfiguration=new Configuration();
  clientConfiguration.setString("jobmanager.rpc.port","6023");
  clientConfiguration.setString("jobmanager.rpc.address","192.168.2.111");
  try {
    JobClient jobClient=new JobClient(jobGraph,clientConfiguration);
    jobClient.submitJobAndWait();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
