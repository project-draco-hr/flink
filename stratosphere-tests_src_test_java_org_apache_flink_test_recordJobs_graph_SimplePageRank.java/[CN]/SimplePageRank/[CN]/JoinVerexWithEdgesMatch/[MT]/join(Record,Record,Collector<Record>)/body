{
  rank=pageWithRank.getField(1,rank);
  adjacentNeighbors=edges.getField(1,adjacentNeighbors);
  int numNeighbors=adjacentNeighbors.size();
  double rankToDistribute=rank.getValue() / (double)numNeighbors;
  partialRank.setValue(rankToDistribute);
  record.setField(1,partialRank);
  for (int n=0; n < numNeighbors; n++) {
    vertexID.setValue(adjacentNeighbors.getQuick(n));
    record.setField(0,vertexID);
    out.collect(record);
  }
}
