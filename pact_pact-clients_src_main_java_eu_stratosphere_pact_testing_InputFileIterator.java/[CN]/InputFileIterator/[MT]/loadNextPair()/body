{
  try {
    do {
      while (this.currentFormat != null && this.currentFormat.reachedEnd())       if (this.formatIterator.hasNext())       this.currentFormat=this.formatIterator.next();
 else {
        this.nextPair=(KeyValuePair<K,V>)NO_MORE_PAIR;
        return;
      }
      if (!this.reusePair)       this.nextPair=this.currentFormat.createPair();
 else       this.nextPair=this.buffer[this.bufferIndex++ % 2];
    }
 while (!this.currentFormat.nextRecord(this.nextPair));
  }
 catch (  final IOException e) {
    this.nextPair=(KeyValuePair<K,V>)NO_MORE_PAIR;
    Assert.fail("reading expected values " + StringUtils.stringifyException(e));
  }
}
