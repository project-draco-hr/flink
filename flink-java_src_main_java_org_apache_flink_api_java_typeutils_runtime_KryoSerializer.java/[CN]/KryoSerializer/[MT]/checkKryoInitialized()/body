{
  if (this.kryo == null) {
    this.kryo=new ScalaKryoInstantiator().newKryo();
    this.kryo.addDefaultSerializer(Throwable.class,new JavaSerializer());
    for (    Map.Entry<Class<?>,Serializer<?>> e : registeredSerializers.entrySet()) {
      this.kryo.addDefaultSerializer(e.getKey(),e.getValue());
    }
    for (    Map.Entry<Class<?>,Class<? extends Serializer<?>>> e : registeredSerializersClasses.entrySet()) {
      this.kryo.addDefaultSerializer(e.getKey(),e.getValue());
    }
    this.kryo.setRegistrationRequired(false);
    this.kryo.register(type);
    this.kryo.setClassLoader(Thread.currentThread().getContextClassLoader());
  }
}
