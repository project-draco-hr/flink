{
  env=ExecutionEnvironment.getExecutionEnvironment();
  int split=0;
  for (int x=0; x < args.length; x++) {
    if (args[x].compareTo("-") == 0) {
      split=x;
    }
  }
  try {
    prepareFiles(Arrays.copyOfRange(args,0,split == 0 ? 1 : split));
    startPython(Arrays.copyOfRange(args,split == 0 ? args.length : split + 1,args.length));
    receivePlan();
    if (env instanceof LocalEnvironment) {
      FLINK_HDFS_PATH="file:/tmp/flink";
    }
    distributeFiles(env);
    env.execute();
    close();
  }
 catch (  Exception e) {
    close();
    throw e;
  }
}
