{
  PactRecord rec=new PactRecord();
  PactLong cid=new PactLong();
  PactBoolean updated=new PactBoolean();
  long newCid=Long.MAX_VALUE;
  boolean wasUpdated=false;
  while (records.hasNext()) {
    rec=records.next();
    cid=rec.getField(1,cid);
    updated=rec.getField(2,updated);
    if (cid.getValue() < newCid) {
      newCid=cid.getValue();
      wasUpdated=updated.isValue();
    }
 else     if (wasUpdated && !updated.isValue() && cid.getValue() == newCid) {
      wasUpdated=false;
    }
  }
  cid.setValue(newCid);
  rec.setField(1,cid);
  updated.setValue(wasUpdated);
  rec.setField(2,updated);
  out.collect(rec);
}
