{
  while (!finished) {
    try {
      LeaderRetrievalService lrService=LeaderRetrievalUtils.createLeaderRetrievalService(cluster.configuration());
      ActorGateway jobManagerGateway=LeaderRetrievalUtils.retrieveLeaderGateway(lrService,clientActorSystem,timeout);
      JobClient.submitJobAndWait(clientActorSystem,jobManagerGateway,graph,timeout,false,getClass().getClassLoader());
      finished=true;
    }
 catch (    JobExecutionException e) {
    }
catch (    LeaderRetrievalException e) {
    }
catch (    Exception e) {
      e.printStackTrace();
      fail("Caught unexpected exception in job submission test case.");
    }
  }
}
