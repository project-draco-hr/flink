{
  final MapContract map=new MapContract(IdentityMap.class,"Map");
  TestPlan testPlan=new TestPlan(map);
  testPlan.getInput().add(new PactInteger(1),new PactString("test1")).add(new PactInteger(2),new PactString("test2"));
  testPlan.run();
  testPlan.getInput().setSchema(IntStringPair);
  assertEquals("input and output should be equal in identity map",testPlan.getInput(),testPlan.getActualOutput());
  Iterator<PactRecord> outputIterator=testPlan.getActualOutput().iterator();
  Iterator<PactRecord> inputIterator=testPlan.getInput().iterator();
  for (int index=0; index < 2; index++) {
    assertTrue("too few actual output values",outputIterator.hasNext());
    assertTrue("too few input values",outputIterator.hasNext());
    try {
      assertTrue(PactRecordEqualer.recordsEqual(inputIterator.next(),outputIterator.next(),IntStringPair));
    }
 catch (    AssertionFailedError e) {
      throw new ArrayComparisonFailure("Could not verify output values",e,index);
    }
  }
  assertFalse("too few actual output values",outputIterator.hasNext());
  assertFalse("too few input values",outputIterator.hasNext());
}
