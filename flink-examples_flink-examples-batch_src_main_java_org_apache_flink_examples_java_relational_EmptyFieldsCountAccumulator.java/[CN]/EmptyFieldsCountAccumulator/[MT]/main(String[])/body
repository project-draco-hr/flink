{
  if (!parseParameters(args)) {
    return;
  }
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  final DataSet<Tuple> file=getDataSet(env);
  final DataSet<Tuple> filteredLines=file.filter(new EmptyFieldFilter());
  JobExecutionResult result;
  if (outputPath == null) {
    filteredLines.print();
    result=env.getLastJobExecutionResult();
  }
 else {
    filteredLines.writeAsCsv(outputPath);
    result=env.execute("Accumulator example");
  }
  final List<Integer> emptyFields=result.getAccumulatorResult(EMPTY_FIELD_ACCUMULATOR);
  System.out.format("Number of detected empty fields per column: %s\n",emptyFields);
}
