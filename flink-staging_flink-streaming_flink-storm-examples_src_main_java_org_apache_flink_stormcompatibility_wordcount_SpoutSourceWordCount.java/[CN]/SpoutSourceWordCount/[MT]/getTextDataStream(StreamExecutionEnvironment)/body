{
  if (fileOutput) {
    final String[] tokens=textPath.split(":");
    final String localFile=tokens[tokens.length - 1];
    final DataStream<String> stream=env.addSource(new StormFiniteSpoutWrapper<String>(new StormFileSpout(localFile),true),TypeExtractor.getForClass(String.class)).setParallelism(1);
    return stream;
  }
  return env.addSource(new StormFiniteSpoutWrapper<String>(new StormInMemorySpout(),true),TypeExtractor.getForClass(String.class));
}
