{
  final File testfile=new File(CommonTestUtils.getTempDir() + File.separator + CommonTestUtils.getRandomFilename());
  final Path pathtotestfile=new Path(testfile.toURI().getPath());
  try {
    PrintWriter pw=new PrintWriter(testfile,"UTF8");
    for (int i=0; i < 100; i++) {
      pw.append("line\n");
    }
    pw.close();
    LocalFileSystem lfs=new LocalFileSystem();
    FSDataInputStream fis=lfs.open(pathtotestfile);
    final LineReader lr=new LineReader(fis,0,testfile.length(),256);
    byte[] buffer;
    int linecount=0;
    while ((buffer=lr.readLine()) != null) {
      assertEquals(new String(buffer,"UTF8"),"line");
      linecount++;
    }
    assertEquals(linecount,100);
  }
 catch (  Exception e) {
    fail(e.toString());
    e.printStackTrace();
  }
 finally {
    testfile.delete();
  }
}
