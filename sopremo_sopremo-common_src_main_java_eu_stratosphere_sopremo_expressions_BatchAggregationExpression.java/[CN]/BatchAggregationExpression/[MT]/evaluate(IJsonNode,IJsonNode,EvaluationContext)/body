{
  if (this.lastInputCounter == context.getInputCounter())   return this.results;
  this.results=SopremoUtil.reinitializeTarget(target,ArrayNode.class);
  this.lastInputCounter=context.getInputCounter();
  for (int index=0; index < this.lastAggregators.size(); index++)   this.lastAggregators.set(index,this.partials.get(index).getFunction().initialize(this.lastAggregators.get(index)));
  for (  final IJsonNode input : (ArrayNode)node)   for (int index=0; index < this.partials.size(); index++) {
    AggregationExpression partial=this.partials.get(index);
    final IJsonNode preprocessedValue=partial.getPreprocessing().evaluate(input,this.lastPreprocessingResults.get(index),context);
    this.lastAggregators.set(index,partial.getFunction().aggregate(preprocessedValue,this.lastAggregators.get(index),context));
  }
  for (int index=0; index < this.partials.size(); index++) {
    final IJsonNode partialResult=this.partials.get(index).getFunction().getFinalAggregate(this.lastAggregators.get(index),this.results.get(index));
    this.results.set(index,partialResult);
  }
  return this.results;
}
