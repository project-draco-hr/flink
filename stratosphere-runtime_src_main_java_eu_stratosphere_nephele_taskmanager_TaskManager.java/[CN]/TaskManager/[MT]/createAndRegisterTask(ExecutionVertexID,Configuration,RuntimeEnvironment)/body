{
  if (id == null) {
    throw new IllegalArgumentException("Argument id is null");
  }
  if (environment == null) {
    throw new IllegalArgumentException("Argument environment is null");
  }
  Task task;
synchronized (this) {
    final Task runningTask=this.runningTasks.get(id);
    boolean registerTask=true;
    if (runningTask == null) {
      task=new Task(id,environment,this);
    }
 else {
      if (runningTask instanceof Task) {
        return null;
      }
 else {
        task=runningTask;
        registerTask=false;
      }
    }
    if (registerTask) {
      this.channelManager.register(task);
      boolean enableProfiling=false;
      if (this.profiler != null && jobConfiguration.getBoolean(ProfilingUtils.PROFILE_JOB_KEY,true)) {
        enableProfiling=true;
      }
      if (enableProfiling) {
        task.registerProfiler(this.profiler,jobConfiguration);
      }
      this.runningTasks.put(id,task);
    }
  }
  return task;
}
