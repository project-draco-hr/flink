{
  if (!(this.format instanceof FileOutputFormat<?>)) {
    return -1;
  }
  final FileOutputFormat<?> fileOutputFormat=(FileOutputFormat<?>)this.format;
  final Path path=fileOutputFormat.getOutputFilePath();
  final WriteMode writeMode=fileOutputFormat.getWriteMode();
  final OutputDirectoryMode outDirMode=fileOutputFormat.getOutputDirectoryMode();
  try {
    int dop=getTaskConfiguration().getInteger(DEGREE_OF_PARALLELISM_KEY,-1);
    final FileSystem fs=path.getFileSystem();
    if (dop == 1 && outDirMode == OutputDirectoryMode.PARONLY) {
      if (fs.isDistributedFS()) {
        if (!fs.initOutPathDistFS(path,writeMode,false)) {
          throw new IOException("Output path could not be initialized.");
        }
      }
      return 1;
    }
 else {
      if (fs.isDistributedFS()) {
        if (!fs.initOutPathDistFS(path,writeMode,true)) {
          throw new IOException("Output directory could not be created.");
        }
      }
      return -1;
    }
  }
 catch (  IOException e) {
    LOG.error("Could not access the file system to detemine the status of the output.",e);
    throw new RuntimeException("I/O Error while accessing file",e);
  }
}
