{
  if (!(this.format instanceof FileOutputFormat<?>)) {
    return -1;
  }
  final String pathName=this.config.getStubParameter(FileOutputFormat.FILE_PARAMETER_KEY,null);
  final WriteMode writeMode=((FileOutputFormat<?>)this.format).getWriteMode();
  final OutputDirectoryMode outDirMode=((FileOutputFormat<?>)this.format).getOutDirMode();
  final Path path;
  if (pathName == null) {
    return 0;
  }
  try {
    path=new Path(pathName);
  }
 catch (  Throwable t) {
    return 0;
  }
  try {
    int dop=getTaskConfiguration().getInteger(DEGREE_OF_PARALLELISM_KEY,-1);
    final FileSystem fs=path.getFileSystem();
    if (dop == 1 && outDirMode == OutputDirectoryMode.PARONLY) {
      if (fs.isDistributedFS()) {
        if (!fs.initOutPathDistFS(path,writeMode,false)) {
          throw new IOException("Output path could not be initialized.");
        }
      }
      return 1;
    }
 else {
      if (fs.isDistributedFS()) {
        if (!fs.initOutPathDistFS(path,writeMode,true)) {
          throw new IOException("Output directory could not be created.");
        }
      }
      return -1;
    }
  }
 catch (  IOException e) {
    LOG.error("Could not access the file system to detemine the status of the output.",e);
    throw new RuntimeException("I/O Error while accessing file",e);
  }
}
