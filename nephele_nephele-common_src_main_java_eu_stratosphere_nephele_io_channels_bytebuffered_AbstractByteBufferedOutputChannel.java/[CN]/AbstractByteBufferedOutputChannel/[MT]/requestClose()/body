{
  if (!this.closeRequested) {
    this.closeRequested=true;
    if (this.serializationBuffer.dataLeftFromPreviousSerialization()) {
      flush();
    }
    if (getType() == ChannelType.INMEMORY || !isBroadcastChannel() || getChannelIndex() == 0) {
      transferEvent(new ByteBufferedChannelCloseEvent());
      flush();
    }
  }
}
