{
  InputStream is=getHDFSProvider().getHdfsInputStream(getHDFSProvider().getHdfsHome() + "/result.txt");
  BufferedReader reader=new BufferedReader(new InputStreamReader(is));
  String line=reader.readLine();
  Assert.assertNotNull("No output computed",line);
  PriorityQueue<String> computedResult=new PriorityQueue<String>();
  while (line != null) {
    computedResult.add(line);
    line=reader.readLine();
  }
  reader.close();
  PriorityQueue<String> expectedResult=new PriorityQueue<String>();
  StringTokenizer st=new StringTokenizer(CROSS_RESULT,"\n");
  while (st.hasMoreElements()) {
    expectedResult.add(st.nextToken());
  }
  System.out.println("Expected: " + expectedResult);
  System.out.println("Computed: " + computedResult);
  Assert.assertEquals("Computed and expected results have different size",expectedResult.size(),computedResult.size());
  while (!expectedResult.isEmpty()) {
    String expectedLine=expectedResult.poll();
    String computedLine=computedResult.poll();
    System.out.println("expLine: <" + expectedLine + ">\t\t: compLine: <"+ computedLine+ ">");
    Assert.assertEquals("Computed and expected lines differ",expectedLine,computedLine);
  }
  getHDFSProvider().delete(getHDFSProvider().getHdfsHome() + "/result.txt",false);
  getHDFSProvider().delete(getHDFSProvider().getHdfsHome() + "/cross_left",true);
  getHDFSProvider().delete(getHDFSProvider().getHdfsHome() + "/cross_right",true);
}
