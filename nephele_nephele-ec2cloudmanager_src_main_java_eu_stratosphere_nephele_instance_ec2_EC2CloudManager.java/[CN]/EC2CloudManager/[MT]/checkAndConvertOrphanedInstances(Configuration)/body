{
  if (this.orphanedTMs.size() == 0) {
    return;
  }
  final String awsAccessId=conf.getString("job.cloud.awsaccessid",null);
  final String awsSecretKey=conf.getString("job.cloud.awssecretkey",null);
  LOG.debug("Checking orphaned Instances... " + this.orphanedTMs.size() + " orphaned instances listed.");
  final AmazonEC2Client ec2client=EC2ClientFactory.getEC2Client(awsAccessId,awsSecretKey);
  final DescribeInstancesRequest request=new DescribeInstancesRequest();
  final DescribeInstancesResult result=ec2client.describeInstances(request);
  for (  final Reservation r : result.getReservations()) {
    for (    final Instance t : r.getInstances()) {
      InstanceType type=null;
      for (int i=0; i < this.availableInstanceTypes.length; i++) {
        if (this.availableInstanceTypes[i].getIdentifier().equals(t.getInstanceType())) {
          type=this.availableInstanceTypes[i];
          break;
        }
      }
      InetAddress inetAddress=null;
      try {
        inetAddress=InetAddress.getByName(t.getPrivateIpAddress());
      }
 catch (      UnknownHostException e) {
        LOG.error("Cannot resolve " + t.getPrivateDnsName() + " into an IP address: "+ StringUtils.stringifyException(e));
        continue;
      }
      final Iterator<InstanceConnectionInfo> it=this.orphanedTMs.iterator();
      while (it.hasNext()) {
        final InstanceConnectionInfo oi=it.next();
        if (oi.getAddress().equals(inetAddress) && type != null) {
          LOG.info("Orphaned Instance " + oi + " converted into floating instance.");
          FloatingInstance floatinginstance=new FloatingInstance(t.getInstanceId(),oi,t.getLaunchTime().getTime(),type,awsAccessId,awsSecretKey);
          this.floatingInstances.put(oi,floatinginstance);
          it.remove();
          break;
        }
      }
    }
  }
}
