{
  final int parallelism=args.length > 0 ? Integer.parseInt(args[0]) : 1;
  final String pageViewsFile="hdfs://cloud-7.dima.tu-berlin.de:40010/pigmix/pigmix625k/page_views";
  final String wideRowFile="hdfs://cloud-7.dima.tu-berlin.de:40010/pigmix/pigmix625k/widerow";
  FileDataSource pageViews=new FileDataSource(TextInputFormat.class,pageViewsFile,"Read PageViews");
  pageViews.setDegreeOfParallelism(parallelism);
  FileDataSource wideRow=new FileDataSource(TextInputFormat.class,wideRowFile,"Read WideRow");
  wideRow.setDegreeOfParallelism(parallelism);
  MapContract projectPageViews=new MapContract(ProjectPageViews.class,pageViews,"Project Page Views");
  projectPageViews.setDegreeOfParallelism(parallelism);
  MapContract projectWideRow=new MapContract(ProjectWideRow.class,pageViews,"Project Page Views");
  projectWideRow.setDegreeOfParallelism(parallelism);
  ReduceContract distinctPageView=new ReduceContract(Distinct.class,PactString.class,0,projectPageViews,"Distinct PageView");
  distinctPageView.setDegreeOfParallelism(40);
  ReduceContract distinctWideRow=new ReduceContract(Distinct.class,PactString.class,0,projectWideRow,"Distinct Wide Row");
  distinctWideRow.setDegreeOfParallelism(40);
  CoGroupContract unionDistinct=new CoGroupContract(UnionDistinct.class,PactString.class,0,0,distinctPageView,distinctWideRow,"Join");
  unionDistinct.setDegreeOfParallelism(40);
  FileDataSink sink=new FileDataSink(RecordOutputFormat.class,"hdfs://cloud-7.dima.tu-berlin.de:40010/pigmix/result_L11",unionDistinct,"Result");
  sink.setDegreeOfParallelism(parallelism);
  sink.getParameters().setInteger(RecordOutputFormat.NUM_FIELDS_PARAMETER,2);
  sink.getParameters().setClass(RecordOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 0,PactInteger.class);
  sink.getParameters().setClass(RecordOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 1,PactDouble.class);
  Plan plan=new Plan(sink,"L11 distinct, union and widerow");
  return plan;
}
