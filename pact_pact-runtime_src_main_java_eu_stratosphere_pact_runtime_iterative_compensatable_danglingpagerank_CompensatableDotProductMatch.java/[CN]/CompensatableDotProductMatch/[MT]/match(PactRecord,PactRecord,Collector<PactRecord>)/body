{
  rank=pageWithRank.getField(1,rank);
  adjacentNeighbors=adjacencyList.getField(1,adjacentNeighbors);
  int numNeighbors=adjacentNeighbors.size();
  double rankToDistribute=rank.getValue() / (double)numNeighbors;
  partialRank.setValue(rankToDistribute);
  record.setField(1,partialRank);
  boolean isFailure=currentIteration == failingIteration && failingWorkers.contains(workerIndex);
  for (int n=0; n < numNeighbors; n++) {
    vertexID.setValue(adjacentNeighbors.getQuick(n));
    record.setField(0,vertexID);
    if (isFailure) {
      if (random.nextDouble() >= messageLoss) {
        collector.collect(record);
      }
    }
 else {
      collector.collect(record);
    }
  }
}
