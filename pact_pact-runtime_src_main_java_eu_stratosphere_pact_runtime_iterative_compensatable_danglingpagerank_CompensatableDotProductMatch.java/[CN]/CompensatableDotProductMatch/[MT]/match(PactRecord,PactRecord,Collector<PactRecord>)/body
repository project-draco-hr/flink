{
  double rank=pageWithRank.getField(1,PactDouble.class).getValue();
  long[] adjacentNeighbors=adjacencyList.getField(1,PactLongArray.class).values();
  double rankToDistribute=rank / (double)adjacentNeighbors.length;
  partialRank.setValue(rankToDistribute);
  record.setField(1,partialRank);
  boolean isFailure=currentIteration == failingIteration && workerIndex == failingWorker;
  for (int n=0; n < adjacentNeighbors.length; n++) {
    vertexID.setValue(adjacentNeighbors[n]);
    record.setField(0,vertexID);
    if (isFailure) {
      if (random.nextDouble() >= messageLoss) {
        collector.collect(record);
      }
    }
 else {
      collector.collect(record);
    }
  }
}
