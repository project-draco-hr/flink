{
  DeltaIteration<Tuple2<K,VV>,Tuple2<K,VV>> iteration=this.vertices.iterateDelta(this.vertices,maxIterations,0);
  DataSet<Tuple2<K,MsgT>> p=iteration.getWorkset().coGroup(this.edges).where(0).equalTo(0).with(cog);
  DataSet<Tuple2<K,MsgT>> g=p.groupBy(0).reduceGroup(gred);
  DataSet<Tuple2<K,VV>> a=g.join(iteration.getSolutionSet()).where(0).equalTo(0).with(fjoin);
  DataSet<Tuple2<K,VV>> result=iteration.closeWith(a,a);
  return new Graph<>(result,this.edges,this.context);
}
