{
  TypeInformation<K> keyType=((TupleTypeInfo<?>)edges.getType()).getTypeAt(0);
  DataSet<Edge<K,NV>> mappedEdges=edges.map(new ApplyMapperToEdgeWithType<K,EV,NV>(mapper,keyType));
  return new Graph<K,VV,NV>(this.vertices,mappedEdges,this.context);
}
