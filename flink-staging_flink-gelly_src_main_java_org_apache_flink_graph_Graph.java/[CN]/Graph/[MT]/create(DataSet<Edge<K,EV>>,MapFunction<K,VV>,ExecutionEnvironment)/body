{
  TypeInformation<K> keyType=((TupleTypeInfo<?>)edges.getType()).getTypeAt(0);
  DataSet<Vertex<K,VV>> vertices=edges.flatMap(new EmitSrcAndTargetAsTuple1<K,EV>()).distinct().map(new ApplyMapperToVertexValuesWithType<K,VV>(mapper,keyType));
  return new Graph<K,VV,EV>(vertices,edges,context);
}
