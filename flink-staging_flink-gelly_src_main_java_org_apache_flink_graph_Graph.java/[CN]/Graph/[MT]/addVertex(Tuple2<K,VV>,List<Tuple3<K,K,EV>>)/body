{
  DataSet<Tuple2<K,VV>> newVertex=this.context.fromCollection(Arrays.asList(vertex));
  if (edges.isEmpty()) {
    return Graph.create(getVertices().union(newVertex),getEdges(),context);
  }
  DataSet<Tuple2<K,VV>> oldVertices=getVertices();
  DataSet<Tuple2<K,VV>> newVertices=getVertices().union(newVertex).distinct();
  if (oldVertices.equals(newVertices)) {
    return this;
  }
  DataSet<Tuple3<K,K,EV>> newEdges=getEdges().union(context.fromCollection(edges));
  return Graph.create(newVertices,newEdges,context);
}
