{
  if (this.isUndirected) {
    throw new UnsupportedOperationException("");
  }
 else {
    DataSet<Tuple3<K,K,EV>> undirectedEdges=edges.flatMap(new FlatMapFunction<Tuple3<K,K,EV>,Tuple3<K,K,EV>>(){
      public void flatMap(      Tuple3<K,K,EV> edge,      Collector<Tuple3<K,K,EV>> out){
        out.collect(edge);
        out.collect(new Tuple3<K,K,EV>(edge.f1,edge.f0,edge.f2));
      }
    }
);
    return new Graph<K,VV,EV>(vertices,(DataSet<Tuple3<K,K,EV>>)undirectedEdges,this.context,true);
  }
}
