{
  if (this.isUndirected) {
    throw new UnsupportedOperationException("");
  }
 else {
    DataSet<Edge<K,EV>> undirectedEdges=edges.map(new MapFunction<Edge<K,EV>,Edge<K,EV>>(){
      public Edge<K,EV> map(      Edge<K,EV> edge){
        return edge.reverse();
      }
    }
);
    return new Graph<K,VV,EV>(vertices,(DataSet<Edge<K,EV>>)undirectedEdges,true);
  }
}
