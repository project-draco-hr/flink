{
  if (this.isUndirected) {
    throw new UnsupportedOperationException("The graph is already undirected.");
  }
 else {
    DataSet<Edge<K,EV>> undirectedEdges=edges.map(new ReverseEdgesMap<K,EV>());
    return new Graph<K,VV,EV>(vertices,(DataSet<Edge<K,EV>>)undirectedEdges,this.context,true);
  }
}
