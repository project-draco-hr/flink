{
  TypeInformation<K> keyType=((TupleTypeInfo<?>)vertices.getType()).getTypeAt(0);
  DataSet<Vertex<K,NV>> mappedVertices=vertices.map(new ApplyMapperToVertexWithType<K,VV,NV>(mapper,keyType));
  return new Graph<K,NV,EV>(mappedVertices,this.getEdges(),this.context);
}
