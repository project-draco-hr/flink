{
  DataSet<Tuple2<K,VV>> filteredVertices=this.vertices.filter(new ApplyVertexFilter<K,VV>(vertexFilter));
  DataSet<Tuple3<K,K,EV>> remainingEdges=this.edges.join(filteredVertices).where(0).equalTo(0).with(new ProjectEdge<K,VV,EV>()).join(filteredVertices).where(1).equalTo(0).with(new ProjectEdge<K,VV,EV>());
  DataSet<Tuple3<K,K,EV>> filteredEdges=remainingEdges.filter(new ApplyEdgeFilter<K,EV>(edgeFilter));
  return new Graph<K,VV,EV>(filteredVertices,filteredEdges,this.context);
}
