{
  SerializationFactory<TestData.Key> keySerialization=new WritableSerializationFactory<TestData.Key>(TestData.Key.class);
  Comparator<TestData.Key> keyComparator=new TestData.KeyComparator();
  Deserializer<TestData.Key> keyDeserializer=keySerialization.getDeserializer();
  Serializer<TestData.Key> keySerializer=keySerialization.getSerializer();
  RawComparator rawComparator=new DeserializerComparator<TestData.Key>(keyDeserializer,keyComparator);
  TestData.Key key1=new TestData.Key(10);
  TestData.Key key2=new TestData.Key(20);
  ByteArrayOutputStream buffer1=new ByteArrayOutputStream();
  DataOutputStream dataOutput1=new DataOutputStream(buffer1);
  keySerializer.open(dataOutput1);
  keySerializer.serialize(key1);
  byte[] key1bytes=buffer1.toByteArray();
  ByteArrayOutputStream buffer2=new ByteArrayOutputStream();
  DataOutputStream dataOutput2=new DataOutputStream(buffer2);
  keySerializer.open(dataOutput2);
  keySerializer.serialize(key2);
  byte[] key2bytes=buffer2.toByteArray();
  Assert.assertTrue(rawComparator.compare(key1bytes,key2bytes,0,0,key1bytes.length,key2bytes.length) < 0);
  Assert.assertTrue(rawComparator.compare(key2bytes,key1bytes,0,0,key2bytes.length,key1bytes.length) > 0);
  Assert.assertTrue(rawComparator.compare(key1bytes,key1bytes,0,0,key1bytes.length,key1bytes.length) == 0);
}
