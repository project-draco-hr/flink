{
  super.close();
  for (  Map.Entry<K,Map<W,Context>> entry : windows.entrySet()) {
    Map<W,Context> keyWindows=entry.getValue();
    for (    Context window : keyWindows.values()) {
      emitWindow(window);
    }
  }
  windows.clear();
  windowBufferFactory.close();
}
