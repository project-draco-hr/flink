{
  super.open();
  timestampedCollector=new TimestampedCollector<>(output);
  if (inputSerializer == null) {
    throw new IllegalStateException("Input serializer was not set.");
  }
  if (watermarkTimers == null) {
    watermarkTimers=new HashSet<>();
    watermarkTimersQueue=new PriorityQueue<>(100);
  }
  if (processingTimeTimers == null) {
    processingTimeTimers=new HashSet<>();
    processingTimeTimersQueue=new PriorityQueue<>(100);
  }
  context=new Context(null,null);
  if (windowAssigner instanceof MergingWindowAssigner) {
    mergingWindowsByKey=new HashMap<>();
  }
}
