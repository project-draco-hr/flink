{
  this.type=type;
  this.initPos=buffer.position();
  this.numRecords=0;
  this.writtenUncompressed=0;
  if (type != CompressionType.NONE) {
    buffer.position(initPos + Records.LOG_OVERHEAD + Record.RECORD_OVERHEAD);
  }
  bufferStream=new ByteBufferOutputStream(buffer);
  appendStream=wrapForOutput(bufferStream,type,blockSize);
}
