{
  try {
switch (type) {
case NONE:
      return new DataInputStream(buffer);
case GZIP:
    return new DataInputStream(new GZIPInputStream(buffer));
case SNAPPY:
  try {
    Class<?> inputStreamClass=Class.forName("org.xerial.snappy.SnappyInputStream");
    InputStream stream=(InputStream)inputStreamClass.getConstructor(InputStream.class).newInstance(buffer);
    return new DataInputStream(stream);
  }
 catch (  Exception e) {
    throw new KafkaException(e);
  }
case LZ4:
try {
  Class<?> inputStreamClass=Class.forName("org.apache.KafkaLZ4BlockInputStream");
  InputStream stream=(InputStream)inputStreamClass.getConstructor(InputStream.class).newInstance(buffer);
  return new DataInputStream(stream);
}
 catch (Exception e) {
  throw new KafkaException(e);
}
default :
throw new IllegalArgumentException("Unknown compression type: " + type);
}
}
 catch (IOException e) {
throw new KafkaException(e);
}
}
