{
  JobExecutionResult execResult;
  try {
    execResult=client.run(program,parallelism,wait);
  }
 catch (  ProgramInvocationException e) {
    return handleError(e);
  }
 finally {
    program.deleteExtractedLibraries();
  }
  if (wait) {
    if (execResult != null) {
      System.out.println("Job Runtime: " + execResult.getNetRuntime());
      Map<String,Object> accumulatorsResult=execResult.getAllAccumulatorResults();
      if (accumulatorsResult.size() > 0) {
        System.out.println("Accumulator Results: ");
        System.out.println(AccumulatorHelper.getResultsFormated(accumulatorsResult));
      }
    }
    return 0;
  }
 else {
    System.out.println("Job successfully submitted. Use -w (or --wait) option to track the progress here.");
    if (webFrontendAddress != null) {
      System.out.println("JobManager web interface: http://" + webFrontendAddress);
    }
    return 0;
  }
}
