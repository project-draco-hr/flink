{
  if (LOG.isDebugEnabled()) {
    LOG.debug(this.taskContext.formatLogString("Reducer preprocessing done. Running Reducer code."));
  }
  final KeyGroupedIterator<T> iter=new KeyGroupedIterator<T>(this.input,this.serializer,this.comparator);
  final GenericReduce<T> stub=this.taskContext.getStub();
  final Collector<T> output=this.taskContext.getOutputCollector();
  while (this.running && iter.nextKey()) {
    ValuesIterator vIter=iter.getValues();
    T curr=(T)vIter.next();
    while (running & vIter.hasNext()) {
      curr=stub.reduce(curr,(T)vIter.next());
    }
    output.collect(curr);
  }
}
