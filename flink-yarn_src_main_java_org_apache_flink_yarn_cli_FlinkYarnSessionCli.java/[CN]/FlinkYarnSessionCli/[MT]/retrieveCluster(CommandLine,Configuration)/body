{
  if (cmdLine.hasOption(APPLICATION_ID.getOpt())) {
    String applicationID=cmdLine.getOptionValue(APPLICATION_ID.getOpt());
    AbstractYarnClusterDescriptor yarnDescriptor=getClusterDescriptor();
    yarnDescriptor.setFlinkConfiguration(config);
    return yarnDescriptor.retrieve(applicationID);
  }
 else {
    String applicationId=loadYarnPropertiesFile(cmdLine,config);
    if (applicationId != null) {
      AbstractYarnClusterDescriptor yarnDescriptor=getClusterDescriptor();
      yarnDescriptor.setFlinkConfiguration(config);
      return yarnDescriptor.retrieve(applicationId);
    }
  }
  throw new UnsupportedOperationException("Could not resume a Yarn cluster.");
}
