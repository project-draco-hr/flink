{
  try {
    return retry(new Callable<V>(){
      public V call() throws Exception {
        ByteArrayOutputStream baos=new ByteArrayOutputStream();
        DataOutputViewStreamWrapper out=new DataOutputViewStreamWrapper(baos);
        keySerializer.serialize(key.f0,out);
        namespaceSerializer.serialize(key.f1,out);
        out.close();
        byte[] serializedVal=dbAdapter.lookupKey(kvStateId,selectStatements.getForKey(key.f0),baos.toByteArray(),nextTs);
        return serializedVal != null ? InstantiationUtil.deserializeFromByteArray(valueSerializer,serializedVal) : null;
      }
    }
,numSqlRetries,sqlRetrySleep);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
