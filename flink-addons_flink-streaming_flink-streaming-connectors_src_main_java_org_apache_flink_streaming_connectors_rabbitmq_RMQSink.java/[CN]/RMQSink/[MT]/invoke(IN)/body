{
  if (!initDone) {
    initializeConnection();
  }
  try {
    channel.queueDeclare(queueName,false,false,false,null);
    byte[] msg=serialize(tuple);
    channel.basicPublish("",queueName,null,msg);
  }
 catch (  IOException e) {
    if (LOG.isErrorEnabled()) {
      LOG.error("Cannot send RMQ message to " + queueName + " at "+ hostName);
    }
  }
  if (close) {
    try {
      channel.close();
      connection.close();
    }
 catch (    IOException e) {
      if (LOG.isWarnEnabled()) {
        LOG.warn("Cannot close RMQ connection: " + queueName + " at "+ hostName);
      }
    }
  }
}
