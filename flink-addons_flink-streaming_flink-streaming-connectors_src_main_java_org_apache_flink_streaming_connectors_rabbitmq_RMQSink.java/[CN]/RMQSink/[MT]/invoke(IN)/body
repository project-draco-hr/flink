{
  if (!initDone) {
    initializeConnection();
  }
  try {
    channel.queueDeclare(QUEUE_NAME,false,false,false,null);
    byte[] msg=serialize(tuple);
    if (!closeWithoutSend) {
      channel.basicPublish("",QUEUE_NAME,null,msg);
    }
  }
 catch (  IOException e) {
    if (LOG.isErrorEnabled()) {
      LOG.error("Cannot send RMQ message " + QUEUE_NAME + " at "+ HOST_NAME);
    }
  }
  if (sendAndClose) {
    closeChannel();
  }
}
