{
  if (!initDone) {
    initializeConnection();
  }
  try {
    channel.queueDeclare(queueName,false,false,false,null);
    byte[] msg=serialize(tuple);
    channel.basicPublish("",queueName,null,msg);
  }
 catch (  IOException e1) {
    if (log.isErrorEnabled()) {
      log.error("Cannot send message to RMQ " + queueName + " at "+ hostName);
    }
  }
  if (close) {
    try {
      channel.close();
      connection.close();
    }
 catch (    IOException e) {
      if (log.isWarnEnabled()) {
        log.warn("Cannot close RMQ connection: " + queueName + " at "+ hostName);
      }
    }
  }
}
