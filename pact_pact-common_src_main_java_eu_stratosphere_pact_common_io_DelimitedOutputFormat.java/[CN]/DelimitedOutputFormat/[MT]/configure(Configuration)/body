{
  super.configure(config);
  String delim=config.getString(RECORD_DELIMITER,"\n");
  if (delim == null) {
    throw new IllegalArgumentException("The delimiter in the DelimitedOutputFormat must not be null.");
  }
  this.delimiter=delim.getBytes();
  this.bufferSize=config.getInteger(WRITE_BUFFER_SIZE,DEFAULT_WRITE_BUFFER_SIZE);
  if (this.bufferSize < MIN_WRITE_BUFFER_SIZE) {
    throw new IllegalArgumentException("The write buffer size must not be less than " + MIN_WRITE_BUFFER_SIZE + " bytes.");
  }
}
