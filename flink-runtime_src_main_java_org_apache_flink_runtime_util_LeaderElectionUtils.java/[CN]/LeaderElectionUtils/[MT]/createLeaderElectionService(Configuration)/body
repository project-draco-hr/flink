{
  RecoveryMode recoveryMode=RecoveryMode.valueOf(configuration.getString(ConfigConstants.RECOVERY_MODE,ConfigConstants.DEFAULT_RECOVERY_MODE).toUpperCase());
  LeaderElectionService leaderElectionService;
switch (recoveryMode) {
case STANDALONE:
    leaderElectionService=new StandaloneLeaderElectionService();
  break;
case ZOOKEEPER:
leaderElectionService=ZooKeeperUtils.createLeaderElectionService(configuration);
break;
default :
throw new Exception("Unknown RecoveryMode " + recoveryMode);
}
return leaderElectionService;
}
