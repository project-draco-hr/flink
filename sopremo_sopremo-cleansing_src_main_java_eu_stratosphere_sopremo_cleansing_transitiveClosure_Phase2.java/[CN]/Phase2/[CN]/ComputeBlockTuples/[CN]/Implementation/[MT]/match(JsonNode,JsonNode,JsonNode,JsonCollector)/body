{
  JsonNode oldKeyPrimary=key;
  JsonNode oldKeyCurrent=((ArrayNode)value2).get(0);
  BinarySparseMatrix current=(BinarySparseMatrix)((ArrayNode)value2).get(1);
  if (oldKeyPrimary.equals(((ArrayNode)oldKeyCurrent).get(1))) {
    TransitiveClosure.warshall(current,(BinarySparseMatrix)value1,current);
  }
 else {
    TransitiveClosure.warshall((BinarySparseMatrix)value1,current,current);
  }
  out.collect(oldKeyCurrent,current);
}
