{
  JsonNode oldKeyPrimary=key;
  JsonNode oldKeyCurrent=((ArrayNode)value2).get(0);
  BinarySparseMatrix current=(BinarySparseMatrix)((ArrayNode)value2).get(1);
  if (oldKeyPrimary.equals(((ArrayNode)oldKeyCurrent).get(1))) {
    current=current.transpose();
  }
  TransitiveClosure.warshall((BinarySparseMatrix)value1,current);
  if (oldKeyPrimary.equals(((ArrayNode)oldKeyCurrent).get(1))) {
    current=current.transpose();
  }
  out.collect(oldKeyCurrent,current);
}
