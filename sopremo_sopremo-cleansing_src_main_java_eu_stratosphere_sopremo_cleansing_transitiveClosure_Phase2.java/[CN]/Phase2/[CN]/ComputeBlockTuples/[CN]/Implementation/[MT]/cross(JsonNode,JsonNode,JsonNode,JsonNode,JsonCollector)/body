{
  JsonNode itStep=((ArrayNode)key1).get(0);
  BinarySparseMatrix current=(BinarySparseMatrix)value2;
  if (itStep.equals(((ArrayNode)key2).get(1))) {
    TransitiveClosure.warshall(current,(BinarySparseMatrix)value1,current);
  }
 else {
    TransitiveClosure.warshall((BinarySparseMatrix)value1,current,current);
  }
  out.collect(key2,current);
}
