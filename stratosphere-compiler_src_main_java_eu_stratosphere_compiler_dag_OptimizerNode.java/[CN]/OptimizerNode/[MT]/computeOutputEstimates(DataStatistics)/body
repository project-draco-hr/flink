{
  for (  PactConnection c : getIncomingConnections()) {
    if (c.getSource() == null) {
      throw new CompilerException("Bug: Estimate computation called before inputs have been set.");
    }
  }
  computeOperatorSpecificDefaultEstimates(statistics);
  if (getPactContract() == null || getPactContract().getCompilerHints() == null) {
    return;
  }
  CompilerHints hints=getPactContract().getCompilerHints();
  if (hints.getOutputSize() >= 0) {
    this.estimatedOutputSize=hints.getOutputSize();
  }
  if (hints.getOutputCardinality() >= 0) {
    this.estimatedNumRecords=hints.getOutputCardinality();
  }
  if (hints.getFilterFactor() >= 0.0f) {
    if (this instanceof SingleInputNode) {
      OptimizerNode pred=((SingleInputNode)this).getPredecessorNode();
      if (pred != null && pred.getEstimatedNumRecords() >= 0) {
        this.estimatedNumRecords=(long)(pred.getEstimatedNumRecords() * hints.getFilterFactor());
      }
    }
  }
  if (hints.getAvgBytesPerOutputRecord() >= 1) {
    if (this.estimatedNumRecords == -1 && this.estimatedOutputSize >= 0) {
      this.estimatedNumRecords=(long)(this.estimatedOutputSize / hints.getAvgBytesPerOutputRecord());
    }
 else     if (this.estimatedOutputSize == -1 && this.estimatedNumRecords >= 0) {
      this.estimatedOutputSize=(long)(this.estimatedNumRecords * hints.getAvgBytesPerOutputRecord());
    }
  }
}
