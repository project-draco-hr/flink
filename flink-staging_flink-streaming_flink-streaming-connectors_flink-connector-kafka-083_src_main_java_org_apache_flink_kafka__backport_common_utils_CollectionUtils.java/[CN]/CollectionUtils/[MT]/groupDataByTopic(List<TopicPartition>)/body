{
  Map<String,List<Integer>> partitionsByTopic=new HashMap<String,List<Integer>>();
  for (  TopicPartition tp : partitions) {
    String topic=tp.topic();
    List<Integer> topicData=partitionsByTopic.get(topic);
    if (topicData == null) {
      topicData=new ArrayList<Integer>();
      partitionsByTopic.put(topic,topicData);
    }
    topicData.add(tp.partition());
  }
  return partitionsByTopic;
}
