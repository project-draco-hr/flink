{
  tmpDir=CommonTestUtils.createTempDirectory();
  ClassLoader classLoader=CassandraIdempotentExactlyOnceSink.class.getClassLoader();
  File file=new File(classLoader.getResource("cassandra.yaml").getFile());
  File tmp=new File(tmpDir.getAbsolutePath() + File.separator + "cassandra.yaml");
  tmp.createNewFile();
  BufferedWriter b=new BufferedWriter(new FileWriter(tmp));
  Scanner scanner=new Scanner(file);
  while (scanner.hasNextLine()) {
    String line=scanner.nextLine();
    line=line.replace("$PATH","'" + tmp.getParentFile());
    b.write(line + "\n");
    b.flush();
  }
  scanner.close();
  System.setProperty("cassandra.config","file:" + File.separator + File.separator+ File.separator+ tmp.getAbsolutePath());
  if (EMBEDDED) {
    cassandra=new EmbeddedCassandraService();
    cassandra.start();
  }
  try {
    Thread.sleep(1000 * 10);
  }
 catch (  InterruptedException e) {
  }
  cluster=Cluster.builder().addContactPoint("127.0.0.1").build();
  session=cluster.connect();
  session.execute(CREATE_KEYSPACE_QUERY);
  session.execute(CREATE_TABLE_QUERY);
}
