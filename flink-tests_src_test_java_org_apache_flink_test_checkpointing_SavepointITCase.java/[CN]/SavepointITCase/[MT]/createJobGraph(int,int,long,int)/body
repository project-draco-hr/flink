{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.setParallelism(parallelism);
  env.enableCheckpointing(checkpointingInterval);
  env.disableOperatorChaining();
  env.getConfig().setRestartStrategy(RestartStrategies.fixedDelayRestart(numberOfRetries,restartDelay));
  env.getConfig().disableSysoutLogging();
  DataStream<Integer> stream=env.addSource(new InfiniteTestSource()).shuffle().map(new StatefulCounter());
  stream.addSink(new SinkFunction<Integer>(){
    private static final long serialVersionUID=-8671189807690005893L;
    @Override public void invoke(    Integer value) throws Exception {
    }
  }
);
  return env.getStreamGraph().getJobGraph();
}
