{
  final AtomicInteger nonTerminatedHeadsCounter=new AtomicInteger(numberOfConnectedHeads());
  listenToTermination(new Callback<TerminationEvent>(){
    @Override public void execute(    TerminationEvent event) throws Exception {
      int numNonTerminatedHeads=nonTerminatedHeadsCounter.decrementAndGet();
      if (numNonTerminatedHeads == 0) {
        terminated=true;
      }
    }
  }
);
  while (!terminated) {
    log.info("starting iteration [" + numIterations + "] ["+ System.currentTimeMillis()+ "]");
    if (numIterations > 0) {
      reinstantiateDriver();
    }
    super.invoke();
    log.info("signaling that all workers are done in iteration [" + numIterations + "] "+ "["+ System.currentTimeMillis()+ "]");
    signalAllWorkersDone();
    log.info("finishing iteration [" + numIterations + "] ["+ System.currentTimeMillis()+ "]");
    numIterations++;
  }
}
