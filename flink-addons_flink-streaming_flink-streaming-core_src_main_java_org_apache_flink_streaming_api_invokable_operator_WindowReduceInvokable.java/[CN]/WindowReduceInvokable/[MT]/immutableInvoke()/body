{
  List<IN> tupleBatch=new ArrayList<IN>();
  boolean batchStart;
  long startTime=System.currentTimeMillis();
  while (loadNextRecord() != null) {
    batchStart=true;
    do {
      if (batchStart) {
        batchStart=false;
      }
 else {
        reuse=loadNextRecord();
        if (reuse == null) {
          break;
        }
      }
      tupleBatch.add(reuse.getTuple());
      resetReuse();
    }
 while (System.currentTimeMillis() - startTime < windowSize);
    reducer.reduce(tupleBatch.iterator(),collector);
    tupleBatch.clear();
    startTime=System.currentTimeMillis();
  }
}
