{
  ArrayList<StreamRecord<IN>> list;
  if (nextRecordTime > startTime + granularity - 1) {
    list=new ArrayList<StreamRecord<IN>>();
    startTime+=granularity;
  }
 else {
    list=new ArrayList<StreamRecord<IN>>(listSize);
    list.add(reuse);
    resetReuse();
    while ((reuse=recordIterator.next(reuse)) != null && batchNotFull()) {
      list.add(reuse);
      resetReuse();
    }
  }
  state.pushBack(list);
}
