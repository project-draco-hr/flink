{
  PactModule sourceModule=new Source(sourceFile).asPactModule(jsonToCsv.getContext());
  Contract source=sourceModule.getOutput(0).getInput();
  MapContract<Key,JsonNode,Key,PactString> jsonToString=new MapContract<Key,JsonNode,Key,PactString>(JsonToString.class);
  jsonToString.getParameters().setString("separator",jsonToCsv.getSeparator());
  SopremoUtil.setContext(jsonToString.getParameters(),jsonToCsv.getContext());
  SopremoUtil.serialize(jsonToString.getParameters(),"extractionExpressions",(Serializable)jsonToCsv.getExtractionExpressions());
  jsonToString.setInput(source);
  FileDataSinkContract<Key,PactString> target=new FileDataSinkContract<Key,PactString>(StringOutputFormat.class,targetFile);
  target.setInput(jsonToString);
  return target;
}
