{
  int noSubtasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String ordersPath=(args.length > 1 ? args[1] : "");
  String customerPath=(args.length > 2 ? args[2] : "");
  String output=(args.length > 3 ? args[3] : "");
  FileDataSourceContract<PactInteger,Tuple> orders=new FileDataSourceContract<PactInteger,Tuple>(IntTupleDataInFormat.class,ordersPath,"Orders");
  orders.setParameter(TextInputFormat.RECORD_DELIMITER,"\n");
  orders.setDegreeOfParallelism(noSubtasks);
  orders.setOutputContract(UniqueKey.class);
  orders.getCompilerHints().setAvgNumValuesPerKey(1);
  FileDataSourceContract<PactInteger,Tuple> customers=new FileDataSourceContract<PactInteger,Tuple>(IntTupleDataInFormat.class,customerPath,"Customers");
  customers.setParameter(TextInputFormat.RECORD_DELIMITER,"\n");
  customers.setDegreeOfParallelism(noSubtasks);
  customers.setOutputContract(UniqueKey.class);
  MapContract<PactInteger,Tuple,PactInteger,PactNull> projectO=new MapContract<PactInteger,Tuple,PactInteger,PactNull>(ProjectOrder.class,"ProjectO");
  projectO.setDegreeOfParallelism(noSubtasks);
  projectO.getCompilerHints().setAvgBytesPerRecord(5);
  projectO.getCompilerHints().setAvgNumValuesPerKey(10);
  MapContract<PactInteger,Tuple,PactInteger,PactString> projectC=new MapContract<PactInteger,Tuple,PactInteger,PactString>(ProjectCust.class,"ProjectC");
  projectC.setDegreeOfParallelism(noSubtasks);
  projectC.getCompilerHints().setAvgNumValuesPerKey(1);
  projectC.getCompilerHints().setAvgBytesPerRecord(20);
  MatchContract<PactInteger,PactNull,PactString,PactString,PactInteger> joinCO=new MatchContract<PactInteger,PactNull,PactString,PactString,PactInteger>(JoinCO.class,"JoinCO");
  joinCO.setDegreeOfParallelism(noSubtasks);
  joinCO.getCompilerHints().setAvgBytesPerRecord(17);
  ReduceContract<PactString,PactInteger,PactString,PactInteger> aggCO=new ReduceContract<PactString,PactInteger,PactString,PactInteger>(AggCO.class,"AggCo");
  aggCO.setDegreeOfParallelism(noSubtasks);
  aggCO.getCompilerHints().setAvgBytesPerRecord(17);
  aggCO.getCompilerHints().setAvgNumValuesPerKey(1);
  FileDataSinkContract<PactString,PactInteger> result=new FileDataSinkContract<PactString,PactInteger>(StringIntOutFormat.class,output,"Output");
  result.setDegreeOfParallelism(noSubtasks);
  result.addInput(aggCO);
  aggCO.addInput(joinCO);
  joinCO.addFirstInput(projectO);
  projectO.addInput(orders);
  joinCO.addSecondInput(projectC);
  projectC.addInput(customers);
  return new Plan(result,"TPCH Asterix");
}
