{
  final File tmpDir=getTmpDir();
  final File confFile1=createRandomFile(tmpDir,".xml");
  final File confFile2=createRandomFile(tmpDir,".xml");
  try {
    try {
      final PrintWriter pw1=new PrintWriter(confFile1);
      final PrintWriter pw2=new PrintWriter(confFile2);
      pw1.append("<configuration>");
      pw2.append("<configuration>");
      pw1.append("<property><key>mykey1</key><value>myvalue1</value></property>");
      pw1.append("<property></property>");
      pw1.append("<property><key></key><value></value></property>");
      pw1.append("<property><key>hello</key><value></value></property>");
      pw1.append("<property><key>mykey2</key><value>myvalue2</value></property>");
      pw2.append("<property><key>mykey3</key><value>myvalue3</value></property>");
      pw2.append("<property><key>mykey4</key><value>myvalue4</value></property>");
      pw1.append("</configuration>");
      pw2.append("</configuration>");
      pw1.close();
      pw2.close();
    }
 catch (    FileNotFoundException e) {
      fail(e.getMessage());
    }
    GlobalConfiguration.loadConfiguration(tmpDir.getAbsolutePath());
    final Configuration co=GlobalConfiguration.getConfiguration();
    assertEquals(co.getString("mykey1","null"),"myvalue1");
    assertEquals(co.getString("mykey2","null"),"myvalue2");
    assertEquals(co.getString("mykey3","null"),"myvalue3");
    assertEquals(co.getString("mykey4","null"),"myvalue4");
    final Configuration newconf=new Configuration();
    newconf.setInteger("mynewinteger",1000);
    GlobalConfiguration.includeConfiguration(newconf);
    assertEquals(GlobalConfiguration.getInteger("mynewinteger",0),1000);
  }
  finally {
    confFile1.delete();
    confFile2.delete();
    tmpDir.delete();
  }
}
