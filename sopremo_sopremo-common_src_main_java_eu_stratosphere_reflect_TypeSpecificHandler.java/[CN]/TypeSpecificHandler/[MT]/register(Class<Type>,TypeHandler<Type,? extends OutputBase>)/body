{
  handlers.put(type,(Handler)handler);
  Method[] methods=handler.getClass().getMethods();
  for (  Method method : methods) {
    if (method.getDeclaringClass() == handler.getClass()) {
      method.setAccessible(true);
      callbacks.put(handler.getClass(),method);
    }
  }
  if (outputBase == null) {
    BoundType bounds=ReflectUtil.getBindingOfSuperclass(handler.getClass(),TypeHandler.class);
    outputBase=bounds.getParameters()[1].getType();
  }
}
