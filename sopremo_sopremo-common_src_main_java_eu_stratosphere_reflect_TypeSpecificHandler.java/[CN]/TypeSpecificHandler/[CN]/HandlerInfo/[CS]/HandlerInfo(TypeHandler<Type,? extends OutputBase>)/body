{
  this.handler=(Handler)handler;
  Class<?> handlerClass=handler.getClass();
  Method[] methods=handlerClass.getMethods();
  for (  Method method : methods)   if (method.getDeclaringClass() == handler.getClass()) {
    method.setAccessible(true);
    callback=method;
    break;
  }
  AppendChildren annotation=getAnnotation(handlerClass,callback,AppendChildren.class);
  if (annotation != null)   appendIndex=annotation.fromIndex();
  stopRecursion=getAnnotation(handlerClass,callback,Leaf.class) != null;
}
