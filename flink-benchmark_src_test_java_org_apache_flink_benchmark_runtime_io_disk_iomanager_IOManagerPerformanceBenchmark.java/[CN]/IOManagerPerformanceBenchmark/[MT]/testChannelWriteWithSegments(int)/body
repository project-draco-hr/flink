{
  final List<MemorySegment> memory=this.memManager.allocatePages(memoryOwner,numSegments);
  final FileIOChannel.ID channel=this.ioManager.createChannel();
  BlockChannelWriter<MemorySegment> writer=null;
  try {
    writer=this.ioManager.createBlockChannelWriter(channel);
    final ChannelWriterOutputView out=new ChannelWriterOutputView(writer,memory,this.memManager.getPageSize());
    int valsLeft=NUM_INTS_WRITTEN;
    while (valsLeft-- > 0) {
      out.writeInt(valsLeft);
    }
    fileIOChannel=channel;
    out.close();
    numBlocks=out.getBlockCount();
    writer.close();
    writer=null;
    memManager.release(memory);
  }
  finally {
    if (writer != null) {
      writer.closeAndDelete();
    }
  }
}
