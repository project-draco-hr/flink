{
switch (this.comparison.getBinaryOperator()) {
case EQUAL:
    final boolean leftOuter=this.getLeftJoinKey().removeTag(ExpressionTag.PRESERVE);
  final boolean rightOuter=this.getRightJoinKey().removeTag(ExpressionTag.PRESERVE);
if (leftOuter || rightOuter) return new OuterJoinStub(left,leftOuter,right,rightOuter);
return new InnerJoinStub(left,right);
default :
return new ThetaJoinStub(left,this.comparison,right);
}
}
