{
switch (this.comparison.getBinaryOperator()) {
case EQUAL:
    final boolean leftOuter=this.getLeftJoinKey().find(InputSelection.class).hasTag(ExpressionTag.RETAIN);
  final boolean rightOuter=this.getRightJoinKey().find(InputSelection.class).hasTag(ExpressionTag.RETAIN);
if (leftOuter || rightOuter) return new OuterJoinStub(leftOuter,rightOuter).withInputs(left,right);
return new InnerJoinStub().withInputs(left,right);
default :
return new ThetaJoinStub(this.comparison).withInputs(left,right);
}
}
