{
  if (!(condition instanceof BinaryBooleanExpression))   throw new IllegalArgumentException(String.format("Can only join over binary conditions: %s",condition));
  BinaryBooleanExpression binaryCondition=(BinaryBooleanExpression)condition;
  List<EvaluationExpression> inputSelections=condition.findAll(new IsInstancePredicate(InputSelection.class));
  if (inputSelections.size() != 2)   throw new IllegalArgumentException(String.format("Condition must refer to two source: %s",condition));
  return new TwoSourceJoin().withCondition(binaryCondition).withInputs(module.getInput(((InputSelection)inputSelections.get(0)).getIndex()),module.getInput(((InputSelection)inputSelections.get(1)).getIndex()));
}
