{
  TaskConfig dsConfig=new TaskConfig(this.mockEnv.getTaskConfiguration());
  outputFormat.setOutputFilePath(new Path(outPath));
  outputFormat.setWriteMode(WriteMode.OVERWRITE);
  dsConfig.setStubWrapper(new UserCodeObjectWrapper<FileOutputFormat>(outputFormat));
  outTask.setEnvironment(this.mockEnv);
  if (outTask instanceof DataSinkTask<?>) {
    ((DataSinkTask<?>)outTask).setUserCodeClassLoader(getClass().getClassLoader());
  }
  outTask.registerInputOutput();
}
