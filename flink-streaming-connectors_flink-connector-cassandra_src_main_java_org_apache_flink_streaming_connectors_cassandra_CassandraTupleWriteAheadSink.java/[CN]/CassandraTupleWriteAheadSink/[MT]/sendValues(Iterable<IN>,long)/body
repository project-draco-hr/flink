{
  if (exception != null) {
    throw new Exception(exception);
  }
  for (  IN value : values) {
    for (int x=0; x < value.getArity(); x++) {
      fields[x]=value.getField(x);
    }
    BoundStatement s=preparedStatement.bind(fields);
    s.setDefaultTimestamp(timestamp);
    ResultSetFuture result=session.executeAsync(s);
    updatesSent++;
    if (result != null) {
      Futures.addCallback(result,callback);
    }
  }
  try {
    while (updatesSent != updatesConfirmed.get()) {
      Thread.sleep(100);
    }
  }
 catch (  InterruptedException e) {
  }
  updatesSent=0;
  updatesConfirmed.set(0);
}
