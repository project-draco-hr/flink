{
  long completeMemorySize=config.getMemorySize();
  long hashjoinMemorySize=(long)(completeMemorySize * config.getWorksetHashjoinMemoryFraction());
  config.setMemorySize(completeMemorySize - hashjoinMemorySize);
  TypeSerializer<IT1> probesideSerializer=instantiateTypeSerializer(config.getWorksetHashjoinProbesideSerializerFactoryClass(userCodeClassLoader));
  TypeSerializer<IT2> buildsideSerializer=instantiateTypeSerializer(config.getWorksetHashjoinBuildsideSerializerFactoryClass(userCodeClassLoader));
  TypeComparator<IT1> probesideComparator=instantiateTypeComparator(config.getWorksetHashJoinProbeSideComparatorFactoryClass(userCodeClassLoader),config.getWorksetHashjoinBuildsideComparatorPrefix());
  TypeComparator<IT2> buildSideComparator=instantiateTypeComparator(config.getWorksetHashJoinBuildSideComparatorFactoryClass(userCodeClassLoader),config.getWorksetHashjoinProbesideComparatorPrefix());
  TypePairComparatorFactory<IT1,IT2> pairComparatorFactory=(TypePairComparatorFactory<IT1,IT2>)instantiateTypePairComparator(config.getWorksetHashJoinTypePairComparatorFactoryClass(userCodeClassLoader));
  List<MemorySegment> memSegments=getMemoryManager().allocatePages(getOwningNepheleTask(),config.getMemorySize());
  MutableHashTable hashJoin=new MutableHashTable(buildsideSerializer,probesideSerializer,buildSideComparator,probesideComparator,pairComparatorFactory.createComparator12(probesideComparator,buildSideComparator),memSegments,getIOManager());
  Broker<MutableHashTable> solutionsetBroker=SolutionsetBroker.instance();
  solutionsetBroker.handIn(brokerKey(),hashJoin);
  return hashJoin;
}
