{
  this.deserializer.clear();
  if (this.dataBuffer != null) {
    releasedConsumedReadBuffer();
  }
  if (this.getType() == ChannelType.NETWORK || this.getType() == ChannelType.INMEMORY) {
    while (!this.brokerAggreedToCloseChannel) {
      requestReadBufferFromBroker();
      if (this.dataBuffer != null) {
        releasedConsumedReadBuffer();
        continue;
      }
      Thread.sleep(200);
    }
  }
  final ChannelType type=getType();
  if (type == ChannelType.NETWORK || type == ChannelType.INMEMORY) {
    transferEvent(new ByteBufferedChannelCloseEvent());
  }
}
