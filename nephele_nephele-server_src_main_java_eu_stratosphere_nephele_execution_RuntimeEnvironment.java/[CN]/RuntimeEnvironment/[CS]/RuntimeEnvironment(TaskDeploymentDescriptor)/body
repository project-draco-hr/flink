{
  this.jobID=tdd.getJobID();
  this.taskName=tdd.getTaskName();
  this.invokableClass=tdd.getInvokableClass();
  this.jobConfiguration=tdd.getJobConfiguration();
  this.taskConfiguration=tdd.getTaskConfiguration();
  this.indexInSubtaskGroup=tdd.getIndexInSubtaskGroup();
  this.currentNumberOfSubtasks=tdd.getCurrentNumberOfSubtasks();
  this.invokable=this.invokableClass.newInstance();
  this.invokable.setEnvironment(this);
  this.invokable.registerInputOutput();
  if (!this.unboundOutputGateIDs.isEmpty() && LOG.isErrorEnabled()) {
    LOG.error("Inconsistency: " + this.unboundOutputGateIDs.size() + " unbound output gate IDs left");
  }
  if (!this.unboundInputGateIDs.isEmpty() && LOG.isErrorEnabled()) {
    LOG.error("Inconsistency: " + this.unboundInputGateIDs.size() + " unbound output gate IDs left");
  }
  final int noogdd=tdd.getNumberOfOutputGateDescriptors();
  for (int i=0; i < noogdd; ++i) {
    final GateDeploymentDescriptor gdd=tdd.getOutputGateDescriptor(i);
    final OutputGate og=this.outputGates.get(i);
    final ChannelType channelType=gdd.getChannelType();
    final CompressionLevel compressionLevel=gdd.getCompressionLevel();
    og.setChannelType(channelType);
    final int nocdd=gdd.getNumberOfChannelDescriptors();
    for (int j=0; j < nocdd; ++j) {
      final ChannelDeploymentDescriptor cdd=gdd.getChannelDescriptor(j);
      AbstractOutputChannel<? extends Record> outputChannel;
switch (channelType) {
case FILE:
        outputChannel=og.createFileOutputChannel(og,cdd.getOutputChannelID(),compressionLevel);
      break;
case NETWORK:
    outputChannel=og.createNetworkOutputChannel(og,cdd.getOutputChannelID(),compressionLevel);
  break;
case INMEMORY:
outputChannel=og.createInMemoryOutputChannel(og,cdd.getOutputChannelID(),compressionLevel);
break;
default :
throw new IllegalStateException("Unknown channel type");
}
outputChannel.setConnectedChannelID(cdd.getInputChannelID());
}
}
final int noigdd=tdd.getNumberOfInputGateDescriptors();
for (int i=0; i < noigdd; ++i) {
final GateDeploymentDescriptor gdd=tdd.getInputGateDescriptor(i);
final InputGate ig=this.inputGates.get(i);
final ChannelType channelType=gdd.getChannelType();
final CompressionLevel compressionLevel=gdd.getCompressionLevel();
ig.setChannelType(channelType);
final int nicdd=gdd.getNumberOfChannelDescriptors();
for (int j=0; j < nicdd; ++j) {
final ChannelDeploymentDescriptor cdd=gdd.getChannelDescriptor(j);
AbstractInputChannel<? extends Record> inputChannel;
switch (channelType) {
case FILE:
inputChannel=ig.createFileInputChannel(ig,cdd.getInputChannelID(),compressionLevel);
break;
case NETWORK:
inputChannel=ig.createNetworkInputChannel(ig,cdd.getInputChannelID(),compressionLevel);
break;
case INMEMORY:
inputChannel=ig.createInMemoryInputChannel(ig,cdd.getInputChannelID(),compressionLevel);
break;
default :
throw new IllegalStateException("Unknown channel type");
}
inputChannel.setConnectedChannelID(cdd.getOutputChannelID());
}
}
}
