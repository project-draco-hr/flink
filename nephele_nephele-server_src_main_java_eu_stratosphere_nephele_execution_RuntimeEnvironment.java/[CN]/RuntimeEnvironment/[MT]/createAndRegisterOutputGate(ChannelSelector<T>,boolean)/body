{
  if (this.unboundOutputGates == null) {
    final RuntimeOutputGate<T> rog=new RuntimeOutputGate<T>(getJobID(),null,getNumberOfOutputGates(),ChannelType.NETWORK,CompressionLevel.NO_COMPRESSION,selector,isBroadcast,null);
    this.outputGates.add(rog);
    return rog;
  }
  final GateDeploymentDescriptor gdd=this.unboundOutputGates.poll();
  if (gdd == null) {
    throw new IllegalStateException("No unbound output gate deployment descriptor left");
  }
  RecordSerializerFactory<T> serializerFactory;
  if (gdd.spanningRecordsAllowed()) {
    serializerFactory=new SpanningRecordSerializerFactory<T>();
  }
 else {
    serializerFactory=new DefaultRecordSerializerFactory<T>();
  }
  final RuntimeOutputGate<T> rog=new RuntimeOutputGate<T>(getJobID(),gdd.getGateID(),getNumberOfInputGates(),gdd.getChannelType(),gdd.getCompressionLevel(),selector,isBroadcast,serializerFactory);
  this.outputGates.add(rog);
  return rog;
}
