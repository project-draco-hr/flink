{
  if (this.unboundInputGates == null) {
    final RuntimeInputGate<T> rig=new RuntimeInputGate<T>(getJobID(),null,getNumberOfInputGates(),ChannelType.NETWORK,CompressionLevel.NO_COMPRESSION,null);
    this.inputGates.add(rig);
    return rig;
  }
  final GateDeploymentDescriptor gdd=this.unboundInputGates.poll();
  if (gdd == null) {
    throw new IllegalStateException("No unbound input gate deployment descriptor left");
  }
  RecordDeserializerFactory<T> deserializerFactory;
  if (gdd.spanningRecordsAllowed()) {
    deserializerFactory=new SpanningRecordDeserializerFactory<T>(recordFactory);
  }
 else {
    deserializerFactory=new DefaultRecordDeserializerFactory<T>(recordFactory);
  }
  final RuntimeInputGate<T> rig=new RuntimeInputGate<T>(getJobID(),gdd.getGateID(),getNumberOfInputGates(),gdd.getChannelType(),gdd.getCompressionLevel(),deserializerFactory);
  this.inputGates.add(rig);
  return rig;
}
