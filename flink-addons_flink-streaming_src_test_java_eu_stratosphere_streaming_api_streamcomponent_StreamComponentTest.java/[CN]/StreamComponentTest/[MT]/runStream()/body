{
  LogUtils.initializeDefaultConsoleLogger(Level.DEBUG,Level.INFO);
  JobGraphBuilder graphBuilder=new JobGraphBuilder("testGraph",FaultToleranceType.NONE);
  graphBuilder.setSource("MySource",MySource.class);
  graphBuilder.setTask("MyTask",MyTask.class,2,2);
  graphBuilder.setSink("MySink",MySink.class);
  graphBuilder.shuffleConnect("MySource","MyTask");
  graphBuilder.shuffleConnect("MyTask","MySink");
  JobGraph jG=graphBuilder.getJobGraph();
  Configuration configuration=jG.getJobConfiguration();
  NepheleMiniCluster exec=new NepheleMiniCluster();
  try {
    exec.start();
    Client client=new Client(new InetSocketAddress("localhost",6498),configuration);
    client.run(jG,true);
    exec.stop();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
