{
  if (children.size() < 2) {
    throw new IllegalArgumentException();
  }
  BinaryUnionNode lastUnion=null;
  for (int i=1; i < children.size(); i++) {
    if (i == 1) {
      OptimizerNode in1=contractToNode.get(children.get(0));
      OptimizerNode in2=contractToNode.get(children.get(1));
      lastUnion=new BinaryUnionNode(in1,in2,preSet);
    }
 else {
      OptimizerNode nextIn=contractToNode.get(children.get(i));
      lastUnion=new BinaryUnionNode(lastUnion,nextIn);
      lastUnion.getFirstIncomingConnection().setShipStrategy(ShipStrategyType.FORWARD);
      if (preSet != null) {
        lastUnion.getSecondIncomingConnection().setShipStrategy(preSet);
      }
    }
    lastUnion.setDegreeOfParallelism(getDegreeOfParallelism());
    lastUnion.setSubtasksPerInstance(getSubtasksPerInstance());
    lastUnion.SetId(this.id);
    this.id++;
  }
  return lastUnion;
}
