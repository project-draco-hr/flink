{
  Preconditions.checkNotNull(inputFormat,"Unspecified file input format.");
  Preconditions.checkNotNull(typeInfo,"Unspecified output type information.");
  Preconditions.checkNotNull(sourceName,"Unspecified name for the source.");
  Preconditions.checkNotNull(watchType,"Unspecified watchtype.");
  Preconditions.checkNotNull(pathFilter,"Unspecified path name filtering function.");
  Preconditions.checkArgument(watchType.equals(FileProcessingMode.PROCESS_ONCE) || interval >= ContinuousFileMonitoringFunction.MIN_MONITORING_INTERVAL,"The path monitoring interval cannot be less than 100 ms.");
  ContinuousFileMonitoringFunction<OUT> monitoringFunction=new ContinuousFileMonitoringFunction<>(inputFormat,inputFormat.getFilePath().toString(),pathFilter,watchType,getParallelism(),interval);
  ContinuousFileReaderOperator<OUT,?> reader=new ContinuousFileReaderOperator<>(inputFormat);
  SingleOutputStreamOperator<OUT> source=addSource(monitoringFunction,sourceName).transform("FileSplitReader_" + sourceName,typeInfo,reader);
  return new DataStreamSource<>(source);
}
