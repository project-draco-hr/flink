{
  super(out);
  compressor=LZ4Factory.fastestInstance().fastCompressor();
  checksum=XXHashFactory.fastestInstance().hash32();
  bd=new BD(blockSize);
  flg=new FLG(blockChecksum);
  bufferOffset=0;
  maxBlockSize=bd.getBlockMaximumSize();
  buffer=new byte[maxBlockSize];
  compressedBuffer=new byte[compressor.maxCompressedLength(maxBlockSize)];
  finished=false;
  writeHeader();
}
