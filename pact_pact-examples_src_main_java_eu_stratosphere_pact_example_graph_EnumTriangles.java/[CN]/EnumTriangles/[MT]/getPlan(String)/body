{
  int noSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String edgeInput=(args.length > 1 ? args[1] : "");
  String output=(args.length > 2 ? args[2] : "");
  FileDataSourceContract<Edge,PactNull> edges=new FileDataSourceContract<Edge,PactNull>(EdgeListInFormat.class,edgeInput,"Input RDF Triples");
  edges.setParameter(TextInputFormat.RECORD_DELIMITER,"\n");
  edges.setDegreeOfParallelism(noSubTasks);
  edges.setOutputContract(UniqueKey.class);
  MapContract<Edge,PactNull,PactString,Edge> assignKeys=new MapContract<Edge,PactNull,PactString,Edge>(AssignKeys.class,"Assign Keys");
  assignKeys.setDegreeOfParallelism(noSubTasks);
  MatchContract<PactString,Edge,Edge,Edge,EdgeList> buildTriads=new MatchContract<PactString,Edge,Edge,Edge,EdgeList>(BuildTriads.class,"Build Triads");
  buildTriads.setDegreeOfParallelism(noSubTasks);
  MatchContract<Edge,EdgeList,PactNull,PactNull,EdgeList> closeTriads=new MatchContract<Edge,EdgeList,PactNull,PactNull,EdgeList>(CloseTriads.class,"Close Triads");
  closeTriads.setDegreeOfParallelism(noSubTasks);
  FileDataSinkContract<PactNull,EdgeList> triangles=new FileDataSinkContract<PactNull,EdgeList>(EdgeListOutFormat.class,output,"Triangles");
  triangles.setDegreeOfParallelism(noSubTasks);
  triangles.setInput(closeTriads);
  closeTriads.addSecondInput(edges);
  closeTriads.addFirstInput(buildTriads);
  buildTriads.addFirstInput(assignKeys);
  buildTriads.addSecondInput(assignKeys);
  assignKeys.addInput(edges);
  return new Plan(triangles,"Enumerate Triangles");
}
