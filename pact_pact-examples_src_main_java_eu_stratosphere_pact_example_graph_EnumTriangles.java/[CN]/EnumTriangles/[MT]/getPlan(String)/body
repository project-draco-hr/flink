{
  int noSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String edgeInput=(args.length > 1 ? args[1] : "");
  String output=(args.length > 2 ? args[2] : "");
  FileDataSource edges=new FileDataSource(EdgeInFormat.class,edgeInput,"BTC Edges");
  ReduceContract buildTriads=new ReduceContract.Builder(BuildTriads.class,PactString.class,0).name("Build Triads").build();
  MatchContract closeTriads=new MatchContract.Builder(CloseTriads.class).keyField(PactString.class,1,0).keyField(PactString.class,2,1).name("Close Triads").build();
  closeTriads.setParameter("INPUT_LEFT_SHIP_STRATEGY","SHIP_REPARTITION");
  closeTriads.setParameter("INPUT_RIGHT_SHIP_STRATEGY","SHIP_REPARTITION");
  closeTriads.setParameter("LOCAL_STRATEGY","LOCAL_STRATEGY_HASH_BUILD_SECOND");
  FileDataSink triangles=new FileDataSink(RecordOutputFormat.class,output,"Output");
  triangles.getParameters().setString(RecordOutputFormat.RECORD_DELIMITER_PARAMETER,"\n");
  triangles.getParameters().setString(RecordOutputFormat.FIELD_DELIMITER_PARAMETER," ");
  triangles.getParameters().setInteger(RecordOutputFormat.NUM_FIELDS_PARAMETER,3);
  triangles.getParameters().setClass(RecordOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 0,PactString.class);
  triangles.getParameters().setClass(RecordOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 1,PactString.class);
  triangles.getParameters().setClass(RecordOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 2,PactString.class);
  triangles.setInput(closeTriads);
  closeTriads.setSecondInput(edges);
  closeTriads.setFirstInput(buildTriads);
  buildTriads.setInput(edges);
  Plan plan=new Plan(triangles,"Enumerate Triangles");
  plan.setDefaultParallelism(noSubTasks);
  return plan;
}
