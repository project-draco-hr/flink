{
  value1.getFieldInto(0,joinVertex);
  value1.getFieldInto(1,endVertex1);
  value2.getFieldInto(1,endVertex2);
  if (endVertex1.compareTo(endVertex2) <= 0) {
    value1.setField(2,endVertex2);
    out.collect(value1);
  }
 else {
    value2.setField(2,endVertex1);
    out.collect(value2);
  }
}
