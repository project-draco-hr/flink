{
  cellID=record.getInteger(0);
  timeStamp=record.getLong(1);
  numOfFields=record.getNumOfFields();
  if (numOfFields == 2) {
    engine.put(cellID,timeStamp);
    outputRecord.setString(0,cellID + " " + timeStamp);
    emit(outputRecord);
  }
 else   if (numOfFields == 3) {
    lastMillis=record.getInteger(2);
    outputRecord.setString(0,String.valueOf(engine.get(timeStamp,lastMillis,cellID)));
    emit(outputRecord);
  }
}
