{
  emitted.clear();
  for (  Collector<OUT> output : selectAllOutputs) {
    output.collect(record);
    emitted.add(output);
  }
  for (  OutputSelector<OUT> outputSelector : outputSelectors) {
    Iterable<String> outputNames=outputSelector.select(record);
    for (    String outputName : outputNames) {
      List<Collector<OUT>> outputList=outputMap.get(outputName);
      if (outputList == null) {
        if (LOG.isErrorEnabled()) {
          String format=String.format("Cannot emit because no output is selected with the name: %s",outputName);
          LOG.error(format);
        }
      }
 else {
        for (        Collector<OUT> output : outputList) {
          if (!emitted.contains(output)) {
            output.collect(record);
            emitted.add(output);
          }
        }
      }
    }
  }
}
