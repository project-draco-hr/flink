{
  setDeserializers();
  int numberOfInputs=configuration.getNumberOfInputs();
  ArrayList<InputGate> inputList1=new ArrayList<InputGate>();
  ArrayList<InputGate> inputList2=new ArrayList<InputGate>();
  for (int i=0; i < numberOfInputs; i++) {
    int inputType=configuration.getInputIndex(i);
    InputGate reader=getEnvironment().getInputGate(i);
switch (inputType) {
case 1:
      inputList1.add(reader);
    break;
case 2:
  inputList2.add(reader);
break;
default :
throw new RuntimeException("Invalid input type number: " + inputType);
}
}
final InputGate reader1=inputList1.size() == 1 ? inputList1.get(0) : new UnionInputGate(inputList1.toArray(new InputGate[inputList1.size()]));
final InputGate reader2=inputList2.size() == 1 ? inputList2.get(0) : new UnionInputGate(inputList2.toArray(new InputGate[inputList2.size()]));
coReader=new CoRecordReader<DeserializationDelegate<StreamRecord<IN1>>,DeserializationDelegate<StreamRecord<IN2>>>(reader1,reader2);
}
