{
  final int WINDOW_SIZE=3000;
  TypeInformation<Tuple2<String,Integer>> inputType=TypeInfoParser.parse("Tuple2<String, Integer>");
  TumblingEventTimeWindows windowAssigner=TumblingEventTimeWindows.of(Time.milliseconds(WINDOW_SIZE));
  WindowingTestHarness<String,Tuple2<String,Integer>,TimeWindow> testHarness=new WindowingTestHarness<>(new ExecutionConfig(),windowAssigner,BasicTypeInfo.STRING_TYPE_INFO,inputType,new TupleKeySelector(),EventTimeTrigger.create(),0);
  testHarness.processElement(new Tuple2<>("key2",1),3999);
  testHarness.processElement(new Tuple2<>("key2",1),3000);
  testHarness.processElement(new Tuple2<>("key1",1),20);
  testHarness.processElement(new Tuple2<>("key1",1),0);
  testHarness.processElement(new Tuple2<>("key1",1),999);
  testHarness.processElement(new Tuple2<>("key2",1),1998);
  testHarness.processElement(new Tuple2<>("key2",1),1999);
  testHarness.processElement(new Tuple2<>("key2",1),1000);
  testHarness.processWatermark(999);
  testHarness.addExpectedWatermark(999);
  testHarness.compareActualToExpectedOutput("Output was not correct.");
  testHarness.processWatermark(1999);
  testHarness.addExpectedWatermark(1999);
  testHarness.compareActualToExpectedOutput("Output was not correct.");
  StreamTaskState snapshot=testHarness.snapshot(0L,0L);
  testHarness.close();
  testHarness.restore(snapshot,10L);
  testHarness.processWatermark(2999);
  testHarness.addExpectedElement(new Tuple2<>("key1",1),2999);
  testHarness.addExpectedElement(new Tuple2<>("key1",1),2999);
  testHarness.addExpectedElement(new Tuple2<>("key1",1),2999);
  testHarness.addExpectedElement(new Tuple2<>("key2",1),2999);
  testHarness.addExpectedElement(new Tuple2<>("key2",1),2999);
  testHarness.addExpectedElement(new Tuple2<>("key2",1),2999);
  testHarness.addExpectedWatermark(2999);
  testHarness.compareActualToExpectedOutput("Output was not correct.");
  testHarness.processWatermark(3999);
  testHarness.addExpectedWatermark(3999);
  testHarness.compareActualToExpectedOutput("Output was not correct.");
  testHarness.processWatermark(4999);
  testHarness.addExpectedWatermark(4999);
  testHarness.compareActualToExpectedOutput("Output was not correct.");
  testHarness.processWatermark(5999);
  testHarness.addExpectedElement(new Tuple2<>("key2",1),5999);
  testHarness.addExpectedElement(new Tuple2<>("key2",1),5999);
  testHarness.addExpectedWatermark(5999);
  testHarness.compareActualToExpectedOutput("Output was not correct.");
  testHarness.processWatermark(6999);
  testHarness.processWatermark(7999);
  testHarness.addExpectedWatermark(6999);
  testHarness.addExpectedWatermark(7999);
  testHarness.compareActualToExpectedOutput("Output was not correct.");
}
