{
  int numSubtasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String ordersPath=(args.length > 1 ? args[1] : "");
  String customerPath=(args.length > 2 ? args[2] : "");
  String output=(args.length > 3 ? args[3] : "");
  FileDataSource orders=new FileDataSource(new CsvInputFormat(),ordersPath,"Orders");
  orders.setParallelism(numSubtasks);
  CsvInputFormat.configureRecordFormat(orders).recordDelimiter('\n').fieldDelimiter('|').field(IntValue.class,1);
  FileDataSource customers=new FileDataSource(new CsvInputFormat(),customerPath,"Customers");
  customers.setParallelism(numSubtasks);
  CsvInputFormat.configureRecordFormat(customers).recordDelimiter('\n').fieldDelimiter('|').field(IntValue.class,0).field(StringValue.class,6);
  JoinOperator joinCO=JoinOperator.builder(new JoinCO(),IntValue.class,0,0).name("JoinCO").build();
  joinCO.setParallelism(numSubtasks);
  ReduceOperator aggCO=ReduceOperator.builder(new AggCO(),StringValue.class,1).name("AggCo").build();
  aggCO.setParallelism(numSubtasks);
  FileDataSink result=new FileDataSink(new CsvOutputFormat(),output,"Output");
  result.setParallelism(numSubtasks);
  CsvOutputFormat.configureRecordFormat(result).recordDelimiter('\n').fieldDelimiter('|').field(IntValue.class,0).field(StringValue.class,1);
  result.setInput(aggCO);
  aggCO.setInput(joinCO);
  joinCO.setFirstInput(orders);
  joinCO.setSecondInput(customers);
  return new Plan(result,"TPCH Asterix");
}
