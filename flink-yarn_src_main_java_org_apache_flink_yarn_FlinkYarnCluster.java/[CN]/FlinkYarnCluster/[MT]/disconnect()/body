{
  if (!isConnected) {
    throw new IllegalStateException("Can not disconnect from an unconnected cluster.");
  }
  LOG.info("Disconnecting FlinkYarnCluster from ApplicationMaster");
  if (!Runtime.getRuntime().removeShutdownHook(clientShutdownHook)) {
    LOG.warn("Error while removing the shutdown hook. The YARN session might be killed unintentionally");
  }
  applicationClient.tell(Messages.getLocalUnregisterClient(),applicationClient);
  try {
    actorRunner.join(1000);
  }
 catch (  InterruptedException e) {
    LOG.warn("Shutdown of the actor runner was interrupted",e);
    Thread.currentThread().interrupt();
  }
  try {
    pollingRunner.stopRunner();
    pollingRunner.join(1000);
  }
 catch (  InterruptedException e) {
    LOG.warn("Shutdown of the polling runner was interrupted",e);
    Thread.currentThread().interrupt();
  }
  isConnected=false;
}
