{
  if (detached) {
    throw new IllegalArgumentException("The cluster has been started in detached mode." + "Can not request cluster status");
  }
  if (pollingRunner == null) {
    LOG.warn("FlinkYarnCluster.hasFailed() has been called on an uninitialized cluster." + "The system might be in an erroneous state");
  }
  ApplicationReport lastReport=pollingRunner.getLastReport();
  if (lastReport == null) {
    LOG.warn("FlinkYarnCluster.hasFailed() has been called on a cluster. that didn't receive a status so far." + "The system might be in an erroneous state");
    return false;
  }
 else {
    YarnApplicationState appState=lastReport.getYarnApplicationState();
    boolean status=(appState == YarnApplicationState.FAILED || appState == YarnApplicationState.KILLED);
    if (status) {
      LOG.warn("YARN reported application state {}",appState);
      LOG.warn("Diagnostics: {}",lastReport.getDiagnostics());
    }
    return status;
  }
}
