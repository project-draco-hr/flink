{
  if (this.rewritten.containsKey(expression))   return this.rewritten.get(expression);
  MacroBase macro=ExpressionRewriter.this.matchRules(expression);
  if (macro != null) {
    EvaluationExpression rewrittenExpression=macro.call(new EvaluationExpression[]{expression},this.context);
    this.rewritten.put(expression,rewrittenExpression);
    return rewrittenExpression;
  }
  return expression;
}
