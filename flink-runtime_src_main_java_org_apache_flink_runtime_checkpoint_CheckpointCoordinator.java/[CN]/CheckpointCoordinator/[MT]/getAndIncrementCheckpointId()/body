{
  try {
    return checkpointIdCounter.getAndIncrement();
  }
 catch (  Throwable t) {
    int numUnsuccessful=++numUnsuccessfulCheckpointsTriggers;
    LOG.warn("Failed to trigger checkpoint (" + numUnsuccessful + " consecutive failed attempts so far)",t);
    return -1;
  }
}
