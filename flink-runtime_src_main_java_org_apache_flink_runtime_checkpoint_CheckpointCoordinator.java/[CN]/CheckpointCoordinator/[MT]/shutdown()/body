{
synchronized (lock) {
    if (shutdown) {
      return;
    }
    shutdown=true;
    timeoutTimer.cancel();
    for (    PendingCheckpoint pending : pendingCheckpoints.values()) {
      pending.discard();
    }
    pendingCheckpoints.clear();
    for (    SuccessfulCheckpoint checkpoint : completedCheckpoints) {
      checkpoint.dispose();
    }
    completedCheckpoints.clear();
  }
}
