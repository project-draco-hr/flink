{
synchronized (lock) {
    if (shutdown) {
      return;
    }
    shutdown=true;
    LOG.info("Stopping checkpoint coordinator for job " + job);
    timer.cancel();
    if (jobStatusListener != null) {
      jobStatusListener.tell(PoisonPill.getInstance(),ActorRef.noSender());
      jobStatusListener=null;
    }
    if (periodicScheduler != null) {
      periodicScheduler.cancel();
      periodicScheduler=null;
    }
    for (    PendingCheckpoint pending : pendingCheckpoints.values()) {
      pending.discard(userClassLoader,true);
    }
    pendingCheckpoints.clear();
    for (    SuccessfulCheckpoint checkpoint : completedCheckpoints) {
      checkpoint.dispose(userClassLoader);
    }
    completedCheckpoints.clear();
  }
}
