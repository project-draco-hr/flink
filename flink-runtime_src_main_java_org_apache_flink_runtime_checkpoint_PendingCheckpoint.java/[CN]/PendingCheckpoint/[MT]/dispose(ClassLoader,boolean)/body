{
synchronized (lock) {
    discarded=true;
    numAcknowledgedTasks=-1;
    if (releaseState) {
      for (      StateForTask state : collectedStates) {
        state.discard(userClassLoader);
      }
    }
    collectedStates.clear();
    notYetAcknowledgedTasks.clear();
  }
}
