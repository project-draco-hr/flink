{
  final int keyCnt=100;
  final int valCnt=20;
  addInput(new UniformRecordGenerator(keyCnt,valCnt,false));
  setOutput(new DiscardingOutputCollector<Record>());
  final CollectorMapDriver<Record,Record> testTask=new CollectorMapDriver<Record,Record>();
  try {
    testDriver(testTask,MockFailingMapStub.class);
    Assert.fail("Function exception was not forwarded.");
  }
 catch (  ExpectedTestException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
    Assert.fail("Exception in test.");
  }
}
