{
  final AbstractTaggableRecord taggableRecord=(AbstractTaggableRecord)record;
  final StreamingTag tag=(StreamingTag)taggableRecord.getTag();
  if (tag != null) {
    final long timestamp=System.currentTimeMillis();
    final JobID jobID=this.listenerContext.getJobID();
    final ExecutionVertexID vertexID=this.listenerContext.getVertexID();
    final ChannelLatency cl=new ChannelLatency(jobID,tag.getSourceID(),vertexID,timestamp - tag.getTimestamp());
    try {
      this.listenerContext.sendDataAsynchronously(cl);
    }
 catch (    InterruptedException e) {
      LOG.warn(StringUtils.stringifyException(e));
    }
    this.lastTimestamp=timestamp;
  }
}
