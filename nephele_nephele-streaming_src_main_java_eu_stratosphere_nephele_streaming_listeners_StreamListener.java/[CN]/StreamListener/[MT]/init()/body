{
  final String listenerKey=this.taskConfiguration.getString(StreamListenerContext.CONTEXT_CONFIGURATION_KEY,null);
  if (listenerKey == null) {
    throw new RuntimeException("Stream listener is unable to retrieve context key");
  }
  this.listenerContext=StreamingTaskManagerPlugin.getStreamingListenerContext(listenerKey);
  final Map<ChannelID,AbstractOutputChannel<? extends Record>> tmpMap=new HashMap<ChannelID,AbstractOutputChannel<? extends Record>>();
  final Iterator<StreamingOutputGate<? extends Record>> it=this.outputGateMap.values().iterator();
  while (it.hasNext()) {
    final StreamingOutputGate<? extends Record> outputGate=it.next();
    final int numberOfOutputChannels=outputGate.getNumberOfOutputChannels();
    for (int i=0; i < numberOfOutputChannels; ++i) {
      final AbstractOutputChannel<? extends Record> outputChannel=outputGate.getOutputChannel(i);
      tmpMap.put(outputChannel.getID(),outputChannel);
    }
  }
  this.outputChannelMap=Collections.unmodifiableMap(tmpMap);
}
