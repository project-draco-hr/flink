{
  @SuppressWarnings("rawtypes") final TypeComparator[] finalFieldComparators=Arrays.copyOf(fieldComparators,comparatorHelperIndex);
  final int[] finalLogicalKeyFields=Arrays.copyOf(logicalKeyFields,comparatorHelperIndex);
  int maxKey=0;
  for (  int key : finalLogicalKeyFields) {
    maxKey=Math.max(maxKey,key);
  }
  TypeSerializer<?>[] fieldSerializers=new TypeSerializer<?>[maxKey + 1];
  for (int i=0; i <= maxKey; i++) {
    fieldSerializers[i]=types[i].createSerializer(executionConfig);
  }
  if (finalFieldComparators.length == 0 || finalLogicalKeyFields.length == 0 || fieldSerializers.length == 0 || finalFieldComparators.length != finalLogicalKeyFields.length) {
    throw new IllegalArgumentException("Tuple comparator creation has a bug");
  }
  return new TupleComparator<T>(finalLogicalKeyFields,finalFieldComparators,fieldSerializers);
}
