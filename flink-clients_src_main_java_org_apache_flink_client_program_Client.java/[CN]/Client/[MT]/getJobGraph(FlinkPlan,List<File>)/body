{
  JobGraph job=null;
  if (optPlan instanceof StreamingPlan) {
    job=((StreamingPlan)optPlan).getJobGraph();
  }
 else {
    NepheleJobGraphGenerator gen=new NepheleJobGraphGenerator();
    job=gen.compileJobGraph((OptimizedPlan)optPlan);
  }
  for (  File jar : jarFiles) {
    job.addJar(new Path(jar.getAbsolutePath()));
  }
  return job;
}
