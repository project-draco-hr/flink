{
  JobGraph job;
  if (optPlan instanceof StreamingPlan) {
    job=((StreamingPlan)optPlan).getJobGraph();
  }
 else {
    JobGraphGenerator gen=new JobGraphGenerator(this.configuration);
    job=gen.compileJobGraph((OptimizedPlan)optPlan);
  }
  for (  File jar : jarFiles) {
    job.addJar(new Path(jar.getAbsolutePath()));
  }
  return job;
}
