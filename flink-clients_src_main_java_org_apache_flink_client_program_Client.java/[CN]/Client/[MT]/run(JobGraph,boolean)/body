{
  JobClient client;
  try {
    client=new JobClient(jobGraph,configuration,this.userCodeClassLoader);
  }
 catch (  IOException e) {
    throw new ProgramInvocationException("Could not open job manager: " + e.getMessage());
  }
  client.setConsoleStreamForReporting(this.printStatusDuringExecution ? System.out : null);
  try {
    if (wait) {
      return client.submitJobAndWait();
    }
 else {
      JobSubmissionResult result=client.submitJob();
      if (result.returnCode() != JobResult.SUCCESS()) {
        throw new ProgramInvocationException("The job was not successfully submitted to the nephele job manager" + (result.description() == null ? "." : ": " + result.description()));
      }
    }
  }
 catch (  IOException e) {
    throw new ProgramInvocationException("Could not submit job to job manager: " + e.getMessage());
  }
catch (  JobExecutionException jex) {
    if (jex.isJobCanceledByUser()) {
      throw new ProgramInvocationException("The program has been canceled");
    }
 else {
      throw new ProgramInvocationException("The program execution failed: " + jex.getMessage());
    }
  }
  return new JobExecutionResult(-1,null);
}
