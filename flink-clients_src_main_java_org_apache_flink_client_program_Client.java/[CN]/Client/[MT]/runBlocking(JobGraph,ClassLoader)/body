{
  LOG.info("Checking and uploading JAR files");
  try {
    JobClient.uploadJarFiles(jobGraph,jobManagerGateway,timeout);
  }
 catch (  IOException e) {
    throw new ProgramInvocationException("Could not upload the program's JAR files to the JobManager.",e);
  }
  try {
    this.lastJobID=jobGraph.getJobID();
    return JobClient.submitJobAndWait(actorSystem,jobManagerGateway,jobGraph,timeout,printStatusDuringExecution,classLoader);
  }
 catch (  JobExecutionException e) {
    throw new ProgramInvocationException("The program execution failed: " + e.getMessage(),e);
  }
}
