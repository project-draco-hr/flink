{
  LeaderRetrievalService leaderRetrievalService;
  try {
    leaderRetrievalService=LeaderRetrievalUtils.createLeaderRetrievalService(config);
  }
 catch (  Exception e) {
    throw new ProgramInvocationException("Could not create the leader retrieval service.",e);
  }
  try {
    this.lastJobID=jobGraph.getJobID();
    return JobClient.submitJobAndWait(actorSystem,leaderRetrievalService,jobGraph,timeout,printStatusDuringExecution,classLoader);
  }
 catch (  JobExecutionException e) {
    throw new ProgramInvocationException("The program execution failed: " + e.getMessage(),e);
  }
}
