{
  final FiniteDuration timeout=AkkaUtils.getTimeout(configuration);
  ActorSystem actorSystem;
  try {
    actorSystem=JobClient.startJobClientActorSystem(configuration);
  }
 catch (  Exception e) {
    throw new ProgramInvocationException("Could start client actor system.",e);
  }
  ActorRef jobManager;
  try {
    jobManager=JobManager.getJobManagerRemoteReference(jobManagerAddress,actorSystem,timeout);
  }
 catch (  Exception e) {
    throw new ProgramInvocationException("Error getting the remote actor reference for the job manager.",e);
  }
  Future<Object> response;
  try {
    ActorGateway jobManagerGateway=JobManager.getJobManagerGateway(jobManager,timeout);
    response=jobManagerGateway.ask(new JobManagerMessages.CancelJob(jobId),timeout);
  }
 catch (  Exception e) {
    throw new ProgramInvocationException("Failed to query the job manager gateway.",e);
  }
  Object result=Await.result(response,timeout);
  if (result instanceof JobManagerMessages.CancellationSuccess) {
    LOG.debug("Job cancellation with ID " + jobId + " succeeded.");
  }
 else   if (result instanceof JobManagerMessages.CancellationFailure) {
    Throwable t=((JobManagerMessages.CancellationFailure)result).cause();
    LOG.debug("Job cancellation with ID " + jobId + " failed.",t);
    throw new Exception("Failed to cancel the job because of \n" + t.getMessage());
  }
 else {
    throw new Exception("Unknown message received while cancelling.");
  }
}
