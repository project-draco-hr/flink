{
  LOG.info("Checking and uploading JAR files");
  try {
    JobClient.uploadJarFiles(jobGraph,jobManagerGateway,timeout);
  }
 catch (  IOException e) {
    throw new ProgramInvocationException("Could not upload the program's JAR files to the JobManager.",e);
  }
  try {
    this.lastJobID=jobGraph.getJobID();
    JobClient.submitJobDetached(jobManagerGateway,jobGraph,timeout,classLoader);
    return new JobSubmissionResult(jobGraph.getJobID());
  }
 catch (  JobExecutionException e) {
    throw new ProgramInvocationException("The program execution failed: " + e.getMessage(),e);
  }
}
