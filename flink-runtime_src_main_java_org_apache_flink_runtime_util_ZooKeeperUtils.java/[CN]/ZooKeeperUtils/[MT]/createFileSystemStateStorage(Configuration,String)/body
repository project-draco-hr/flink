{
  String rootPath=configuration.getString(ConfigConstants.ZOOKEEPER_HA_PATH,"");
  if (rootPath.isEmpty()) {
    rootPath=configuration.getString(ConfigConstants.ZOOKEEPER_RECOVERY_PATH,"");
  }
  if (rootPath.equals("")) {
    throw new IllegalConfigurationException("Missing recovery path. Specify via " + "configuration key '" + ConfigConstants.ZOOKEEPER_HA_PATH + "'.");
  }
 else {
    return new FileSystemStateStorageHelper<T>(rootPath,prefix);
  }
}
