{
  checkNotNull(configuration,"Configuration");
  String checkpointsPath=getConfiguredStringValue(configuration,ConfigConstants.HA_ZOOKEEPER_CHECKPOINTS_PATH,ConfigConstants.ZOOKEEPER_CHECKPOINTS_PATH,ConfigConstants.DEFAULT_ZOOKEEPER_CHECKPOINTS_PATH);
  StateStorageHelper<CompletedCheckpoint> stateStorage=createFileSystemStateStorage(configuration,"completedCheckpoint");
  checkpointsPath+=ZooKeeperSubmittedJobGraphStore.getPathForJob(jobId);
  return new ZooKeeperCompletedCheckpointStore(maxNumberOfCheckpointsToRetain,userClassLoader,client,checkpointsPath,stateStorage);
}
