{
  checkNotNull(configuration,"Configuration");
  StateHandleProvider<CompletedCheckpoint> stateHandleProvider=StateHandleProviderFactory.createRecoveryFileStateHandleProvider(configuration);
  String completedCheckpointsPath=configuration.getString(ConfigConstants.ZOOKEEPER_CHECKPOINTS_PATH,ConfigConstants.DEFAULT_ZOOKEEPER_CHECKPOINTS_PATH);
  completedCheckpointsPath+=ZooKeeperSubmittedJobGraphStore.getPathForJob(jobId);
  return new ZooKeeperCompletedCheckpointStore(maxNumberOfCheckpointsToRetain,userClassLoader,client,completedCheckpointsPath,stateHandleProvider);
}
