{
  checkNotNull(configuration,"Configuration");
  StateHandleProvider<SubmittedJobGraph> stateHandleProvider=StateHandleProviderFactory.createRecoveryFileStateHandleProvider(configuration);
  String zooKeeperSubmittedJobsPath=configuration.getString(ConfigConstants.ZOOKEEPER_JOBGRAPHS_PATH,ConfigConstants.DEFAULT_ZOOKEEPER_JOBGRAPHS_PATH);
  return new ZooKeeperSubmittedJobGraphStore(client,zooKeeperSubmittedJobsPath,stateHandleProvider);
}
