{
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<Long> ds=env.generateSequence(1,3000);
  DataSet<Tuple2<Integer,Integer>> uniqLongs=ds.filter(new Filter1()).rebalance().map(new PartitionIndexMapper()).groupBy(0).reduce(new Reducer1()).map(new Mapper1());
  uniqLongs.writeAsText(resultPath);
  env.execute();
  StringBuilder result=new StringBuilder();
  int numPerPartition=2220 / env.getDegreeOfParallelism() / 10;
  for (int i=0; i < env.getDegreeOfParallelism(); i++) {
    result.append('(').append(i).append(',').append(numPerPartition).append(")\n");
  }
  expected=result.toString();
}
