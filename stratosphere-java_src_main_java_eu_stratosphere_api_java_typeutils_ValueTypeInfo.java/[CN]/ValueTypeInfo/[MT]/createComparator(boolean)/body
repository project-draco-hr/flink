{
  if (!isKeyType()) {
    throw new RuntimeException("The type " + type.getName() + " is not Comparable.");
  }
  if (CopyableValue.class.isAssignableFrom(type)) {
    return (TypeComparator<T>)createCopyableValueComparator(type,sortOrderAscending);
  }
 else {
    return (TypeComparator<T>)createValueComparator(type,sortOrderAscending);
  }
}
