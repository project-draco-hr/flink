{
  final int outputCnt=this.config.getInteger(NUM_OUTPUTS,-1);
  if (outputCnt < 1) {
    throw new CorruptConfigurationException("No output ship strategies are specified in the configuration.");
  }
  if (outputId < 0 || outputId >= outputCnt) {
    throw new IllegalArgumentException("Invalid index for output shipping strategy.");
  }
  final int strategy=this.config.getInteger(OUTPUT_SHIP_STRATEGY_PREFIX + outputId,-1);
  if (strategy == -1) {
    throw new CorruptConfigurationException("No output shipping strategy in configuration for output " + outputId);
  }
 else   if (strategy < 0 || strategy >= ShipStrategyType.values().length) {
    throw new CorruptConfigurationException("Illegal output shipping strategy in configuration for output " + outputId + ": "+ strategy);
  }
 else {
    return ShipStrategyType.values()[strategy];
  }
}
