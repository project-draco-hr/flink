{
  final Class<? extends TypeSerializerFactory<OT>> serializerFactoryClass;
  try {
    serializerFactoryClass=config.getSerializerFactoryForOutput(userCodeClassLoader);
  }
 catch (  ClassNotFoundException e) {
    throw new RuntimeException("The class registered as output serializer factory could not be loaded.",e);
  }
  final TypeSerializerFactory<OT> serializerFactory;
  if (serializerFactoryClass == null) {
    @SuppressWarnings("unchecked") TypeSerializerFactory<OT> pf=(TypeSerializerFactory<OT>)PactRecordSerializerFactory.get();
    serializerFactory=pf;
  }
 else {
    serializerFactory=InstantiationUtil.instantiate(serializerFactoryClass,TypeSerializerFactory.class);
  }
  return serializerFactory.getSerializer();
}
