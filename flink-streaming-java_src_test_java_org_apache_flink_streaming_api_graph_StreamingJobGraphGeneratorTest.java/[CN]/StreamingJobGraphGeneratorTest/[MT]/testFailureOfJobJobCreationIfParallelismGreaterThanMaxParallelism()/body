{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.getConfig().setMaxParallelism(42);
  DataStream<Integer> input=env.fromElements(1,2,3,4);
  DataStream<Integer> result=input.map(new NoOpIntMap()).setParallelism(43);
  result.addSink(new DiscardingSink<Integer>());
  env.getStreamGraph().getJobGraph();
  fail("The JobGraph should not have been created because the parallelism is greater than " + "the max parallelism.");
}
