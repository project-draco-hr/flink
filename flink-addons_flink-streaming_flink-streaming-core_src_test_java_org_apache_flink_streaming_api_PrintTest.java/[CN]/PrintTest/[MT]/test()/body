{
  LocalStreamEnvironment env=StreamExecutionEnvironment.createLocalEnvironment(1);
  List<Tuple2<String,Integer>> input=new ArrayList<Tuple2<String,Integer>>();
  env.fromElements(1,2,3,4,5,6,7,8,9).window(Time.of(2,TimeUnit.MILLISECONDS).withTimeStamp(new TimeStamp<Integer>(){
    /** 
 */
    private static final long serialVersionUID=1L;
    @Override public long getTimestamp(    Integer value){
      return value;
    }
    @Override public long getStartTime(){
      return 1;
    }
  }
,new Extractor<Long,Integer>(){
    private static final long serialVersionUID=1L;
    @Override public Integer extract(    Long in){
      return in.intValue();
    }
  }
)).every(Count.of(2)).reduceGroup(new GroupReduceFunction<Integer,String>(){
    @Override public void reduce(    Iterable<Integer> values,    Collector<String> out) throws Exception {
      String o="|";
      for (      Integer v : values) {
        o=o + v + "|";
      }
      out.collect(o);
    }
  }
).print();
  env.executeTest(MEMORYSIZE);
}
