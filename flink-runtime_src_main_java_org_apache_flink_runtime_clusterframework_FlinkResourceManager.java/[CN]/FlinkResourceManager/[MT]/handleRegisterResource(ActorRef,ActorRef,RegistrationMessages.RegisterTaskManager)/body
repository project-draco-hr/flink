{
  ResourceID resourceID=msg.resourceId();
  try {
    Preconditions.checkNotNull(resourceID);
    WorkerType oldWorker=registeredWorkers.get(resourceID);
    if (oldWorker != null) {
      LOG.debug("TaskManager {} had been registered before.",resourceID);
    }
 else {
      WorkerType newWorker=workerRegistered(resourceID);
      registeredWorkers.put(resourceID,newWorker);
      LOG.info("TaskManager {} has registered.",resourceID);
    }
    jobManager.tell(decorateMessage(new RegisterResourceSuccessful(taskManager,msg)),self());
  }
 catch (  Exception e) {
    LOG.warn("TaskManager resource registration failed for {}",resourceID,e);
    String eStr=ExceptionUtils.stringifyException(e);
    sender().tell(decorateMessage(new RegisterResourceFailed(taskManager,resourceID,eStr)),self());
  }
}
