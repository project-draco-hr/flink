{
  final TaskConfig config=this.taskContext.getTaskConfig();
  final long availableMemory=config.getMemorySize();
  if (availableMemory < MIN_REQUIRED_MEMORY) {
    throw new RuntimeException("The temp task was initialized with too little memory: " + availableMemory + ". Required is at least "+ MIN_REQUIRED_MEMORY+ " bytes.");
  }
  final MemoryManager memoryManager=this.taskContext.getMemoryManager();
  final IOManager ioManager=this.taskContext.getIOManager();
  this.memory=memoryManager.allocatePages(this.taskContext.getOwningNepheleTask(),availableMemory);
  this.buffer=new SpillingBuffer(ioManager,new ListMemorySegmentSource(this.memory),memoryManager.getPageSize());
}
