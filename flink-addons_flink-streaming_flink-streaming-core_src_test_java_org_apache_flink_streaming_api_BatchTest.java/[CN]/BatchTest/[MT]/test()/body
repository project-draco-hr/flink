{
  LocalStreamEnvironment env=StreamExecutionEnvironment.createLocalEnvironment(SINK_PARALLELISM);
  @SuppressWarnings("unused") DataStream<Tuple1<String>> dataStream1=env.addSource(new MySource(),SOURCE_PARALLELISM).flatMap(new MyMap()).setParallelism(1).batch(2).flatMap(new MyMap()).setParallelism(1).batch(5).addSink(new MySink()).setParallelism(1);
  @SuppressWarnings("unused") DataStream<Tuple1<String>> dataStream2=env.addSource(new MySource(),SOURCE_PARALLELISM).flatMap(new MyMap()).setParallelism(1).batch(4).partitionBy(0).addSink(new MyPartitionSink()).setParallelism(SINK_PARALLELISM);
  env.executeTest(MEMORYSIZE);
  assertEquals(20,count);
  assertTrue(partitionCorrect);
}
