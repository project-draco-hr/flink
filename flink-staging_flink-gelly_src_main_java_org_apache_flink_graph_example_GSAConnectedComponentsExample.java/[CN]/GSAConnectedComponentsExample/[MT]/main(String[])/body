{
  if (!parseParameters(args)) {
    return;
  }
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<Edge<Long,NullValue>> edges=getEdgeDataSet(env);
  DataSet<Vertex<Long,Long>> vertices=edges.flatMap(new InitVerticesMapper()).distinct();
  Graph<Long,Long,NullValue> graph=Graph.fromDataSet(vertices,edges,env);
  GatherFunction<Long,NullValue,Long> gather=new ConnectedComponentsGather();
  SumFunction<Long,NullValue,Long> sum=new ConnectedComponentsSum();
  ApplyFunction<Long,NullValue,Long> apply=new ConnectedComponentsApply();
  Graph<Long,Long,NullValue> result=graph.runGatherSumApplyIteration(gather,sum,apply,maxIterations);
  DataSet<Vertex<Long,Long>> connectedComponents=result.getVertices();
  if (fileOutput) {
    connectedComponents.writeAsCsv(outputPath,"\n"," ");
  }
 else {
    connectedComponents.print();
  }
  env.execute("GSA Connected Components");
}
