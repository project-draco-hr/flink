{
  if (this.sinks.isEmpty()) {
    throw new RuntimeException("No data sinks have been created yet. A program needs at least one sink that consumes data. Examples are writing the data set or printing it.");
  }
  if (jobName == null) {
    jobName=getDefaultName();
  }
  OperatorTranslation translator=new OperatorTranslation();
  JavaPlan plan=translator.translateToPlan(this.sinks,jobName);
  if (getDegreeOfParallelism() > 0) {
    plan.setDefaultParallelism(getDegreeOfParallelism());
  }
  plan.setNumberOfExecutionRetries(this.numberOfExecutionRetries);
  try {
    registerCachedFilesWithPlan(plan);
  }
 catch (  Exception e) {
    throw new RuntimeException("Error while registering cached files: " + e.getMessage(),e);
  }
  this.sinks.clear();
  return plan;
}
