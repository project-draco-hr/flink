{
  if (bufferTimeouts.get(iterationTail) == 0) {
    throw new RuntimeException("Buffer timeout 0 at iteration tail is not supported.");
  }
  addVertex(vertexID,StreamIterationTail.class,null,null,getParallelism(iterationTail));
  iterationIds.put(vertexID,iterationID);
  iterationIDtoTailID.put(iterationID,vertexID);
  setSerializersFrom(iterationTail,vertexID);
  iterationTimeouts.put(iterationIDtoTailID.get(iterationID),waitTime);
  setParallelism(iterationIDtoHeadID.get(iterationID),getParallelism(iterationTail));
  setBufferTimeout(iterationIDtoHeadID.get(iterationID),bufferTimeouts.get(iterationTail));
  if (LOG.isDebugEnabled()) {
    LOG.debug("ITERATION SINK: {}",vertexID);
  }
}
