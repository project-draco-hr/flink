{
  Map<String,OperatorState<?>> states=operatorStates.get(vertexName);
  if (states == null) {
    states=new HashMap<String,OperatorState<?>>();
    states.put(stateName,state);
  }
 else {
    if (states.containsKey(stateName)) {
      throw new RuntimeException("State has already been registered with this name: " + stateName);
    }
 else {
      states.put(stateName,state);
    }
  }
  operatorStates.put(vertexName,states);
}
