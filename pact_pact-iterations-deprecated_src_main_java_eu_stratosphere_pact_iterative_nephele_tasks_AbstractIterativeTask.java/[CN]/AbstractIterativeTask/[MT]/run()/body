{
  Preconditions.checkNotNull(inputs,"Inputs cannot be null");
  Preconditions.checkNotNull(stateListeners,"stateListeners cannot be null");
  Preconditions.checkState(inputs.length > 0 && stateListeners.length == inputs.length,"Must have at least one input");
  MutableObjectIterator<Value> input=inputs[0];
  ChannelStateTracker stateListener=stateListeners[0];
  IterationIterator iterationIter=new IterationIterator(input,stateListener);
  while (!iterationIter.checkTermination()) {
    publishState(ChannelState.OPEN,iterStateGates);
    runIteration(iterationIter);
    Preconditions.checkState(stateListener.getState() == ChannelState.CLOSED,"Illegal state after iteration call");
    publishState(ChannelState.CLOSED,iterStateGates);
  }
}
