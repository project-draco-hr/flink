{
  DataStream<Long> stream=env.addSource(new GeneratingSourceFunction(NUM_LONGS));
  stream.filter(new LongRichFilterFunction()).connect(stream).flatMap(new LeftIdentityCoRichFlatMapFunction()).map(new IdentityMapFunction()).startNewChain().keyBy(0).reduce(new OnceFailingReducer(NUM_LONGS)).addSink(new SinkFunction<Tuple1<Long>>(){
    @Override public void invoke(    Tuple1<Long> value){
    }
  }
);
}
