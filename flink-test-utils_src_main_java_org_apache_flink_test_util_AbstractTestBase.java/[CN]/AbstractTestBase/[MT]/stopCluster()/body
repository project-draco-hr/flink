{
  try {
    if (this.executor != null) {
      this.executor.stop();
      this.executor=null;
      FileSystem.closeAll();
      System.gc();
    }
  }
  finally {
    deleteAllTempFiles();
  }
  Assert.assertEquals("Not all broadcast variables were released.",0,BroadcastVariableManager.INSTANCE.getNumberOfVariablesWithReferences());
}
