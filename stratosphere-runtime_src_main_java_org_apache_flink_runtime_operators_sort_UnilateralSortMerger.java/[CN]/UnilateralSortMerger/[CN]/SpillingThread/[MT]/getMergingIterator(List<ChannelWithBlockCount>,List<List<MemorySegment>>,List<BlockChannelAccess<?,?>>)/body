{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Performing merge of " + channelIDs.size() + " sorted streams.");
  }
  final List<MutableObjectIterator<E>> iterators=new ArrayList<MutableObjectIterator<E>>(channelIDs.size());
  for (int i=0; i < channelIDs.size(); i++) {
    final ChannelWithBlockCount channel=channelIDs.get(i);
    final List<MemorySegment> segsForChannel=inputSegments.get(i);
    final BlockChannelReader reader=segsForChannel.size() >= 4 ? this.ioManager.createBlockChannelReader(channel.getChannel(),segsForChannel.size() / 2) : this.ioManager.createBlockChannelReader(channel.getChannel());
    readerList.add(reader);
    registerOpenChannelToBeRemovedAtShudown(reader);
    unregisterChannelToBeRemovedAtShudown(channel.getChannel());
    final ChannelReaderInputView inView=new ChannelReaderInputView(reader,segsForChannel,channel.getBlockCount(),false);
    iterators.add(new ChannelReaderInputViewIterator<E>(inView,null,this.serializer));
  }
  return new MergeIterator<E>(iterators,this.serializer,this.comparator);
}
