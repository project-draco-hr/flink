{
  long progress=value.f1;
  if (initTimestamp == -1) {
    initTimestamp=progress;
    nextTimestamp=initTimestamp + computeGranularity;
    tempTupleArray=new ArrayList<Tuple2<Integer,Long>>();
  }
 else {
    if (progress >= nextTimestamp) {
      if (window.isFull()) {
        ArrayList<Tuple2<Integer,Long>> expiredTupleArray=window.popFront();
        incrementCompute(tempTupleArray);
        decrementCompute(expiredTupleArray);
        window.pushBack(tempTupleArray);
        if (window.isEmittable()) {
          produceOutput(progress,out);
        }
      }
 else {
        incrementCompute(tempTupleArray);
        window.pushBack(tempTupleArray);
        if (window.isFull()) {
          produceOutput(progress,out);
        }
      }
      initTimestamp=nextTimestamp;
      nextTimestamp=initTimestamp + computeGranularity;
      tempTupleArray=new ArrayList<Tuple2<Integer,Long>>();
    }
  }
  tempTupleArray.add(value);
}
