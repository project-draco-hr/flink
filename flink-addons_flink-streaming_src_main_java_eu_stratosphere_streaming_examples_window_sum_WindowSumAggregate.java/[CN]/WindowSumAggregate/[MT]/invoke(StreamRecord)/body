{
  if (window.isFull()) {
    StreamRecord expiredRecord=window.popFront();
    incrementCompute(record);
    decrementCompute(expiredRecord);
    window.pushBack(record);
    if (window.isComputable()) {
      outRecord.setInteger(0,sum.get("sum"));
      outRecord.setInteger(1,record.getInteger(1));
      emit(outRecord);
    }
  }
 else {
    incrementCompute(record);
    window.pushBack(record);
    if (window.isFull()) {
      outRecord.setInteger(0,sum.get("sum"));
      outRecord.setInteger(1,record.getInteger(1));
      emit(outRecord);
    }
  }
}
