{
  if (!parseParameters(args)) {
    return;
  }
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<Vertex<Long,Double>> vertices=getVertexDataSet(env);
  DataSet<Edge<Long,Double>> edges=getEdgeDataSet(env);
  Graph<Long,Double,Double> graph=Graph.fromDataSet(vertices,edges,env);
  GatherFunction<Double,Double,HashSet<Double>> gather=new GreedyGraphColoringGather();
  SumFunction<Double,Double,HashSet<Double>> sum=new GreedyGraphColoringSum();
  ApplyFunction<Double,Double,HashSet<Double>> apply=new GreedyGraphColoringApply();
  GatherSumApplyIteration<Long,Double,Double,HashSet<Double>> iteration=graph.createGatherSumApplyIteration(gather,sum,apply,maxIterations);
  Graph<Long,Double,Double> result=graph.runGatherSumApplyIteration(iteration);
  DataSet<Vertex<Long,Double>> greedyGraphColoring=result.getVertices();
  if (fileOutput) {
    greedyGraphColoring.writeAsCsv(outputPath,"\n"," ");
  }
 else {
    greedyGraphColoring.print();
  }
  env.execute("GSA Greedy Graph Coloring");
}
