{
  if (streamBatch.miniBatchInProgress()) {
    streamBatch.addToBuffer();
  }
  if (streamBatch.minibatchCounter >= 0) {
    for (long i=0; i < (numberOfBatches1 - streamBatch.minibatchCounter); i++) {
      streamBatch.circularBuffer.remove();
    }
    if (!streamBatch.circularBuffer.isEmpty()) {
      reduce1(streamBatch);
    }
  }
}
