{
  while (true) {
    int next=recordIterator.next(reuse1,reuse2);
    if (next == 0) {
      reduceLastBatch1();
      reduceLastBatch2();
      break;
    }
 else     if (next == 1) {
      handleStream1();
      resetReuse1();
    }
 else {
      handleStream2();
      resetReuse2();
    }
  }
}
