{
  MapContract<PactNull,PactJsonObject,Key,PactJsonObject> extractionMap=new MapContract<PactNull,PactJsonObject,Key,PactJsonObject>(KeyExtractionStub.class);
  int inputIndex=0;
  if (expr instanceof PathExpression) {
    inputIndex=getInputIndex((PathExpression)expr);
    expr=new PathExpression(expr);
    ((PathExpression)expr).replace(new PathExpression(new InputSelection(inputIndex)),new PathExpression());
  }
 else   if (expr instanceof InputSelection) {
    inputIndex=((InputSelection)expr).getIndex();
    expr=EvaluableExpression.IDENTITY;
  }
  extractionMap.setInput(module.getInput(inputIndex));
  SopremoUtil.setTransformationAndContext(extractionMap.getStubParameters(),expr,context);
  return extractionMap;
}
