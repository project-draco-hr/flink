{
  PlanNode source=channel.getSource();
  Operator javaOp=source.getPactContract();
  TypeInformation<?> type=null;
  if (javaOp instanceof JavaPlanNode<?>) {
    JavaPlanNode<?> javaNode=(JavaPlanNode<?>)javaOp;
    type=javaNode.getReturnType();
  }
 else   if (javaOp instanceof BulkIteration.PartialSolutionPlaceHolder) {
    BulkIteration.PartialSolutionPlaceHolder partialSolutionPlaceHolder=(BulkIteration.PartialSolutionPlaceHolder)javaOp;
    type=((PlanBulkIterationOperator<?>)partialSolutionPlaceHolder.getContainingBulkIteration()).getReturnType();
  }
  channel.setSerializer(createSerializer(type));
  if (channel.getShipStrategy().requiresComparator()) {
    channel.setShipStrategyComparator(createComparator(type,channel.getShipStrategyKeys(),getSortOrders(channel.getShipStrategyKeys(),channel.getShipStrategySortOrder())));
  }
  if (channel.getLocalStrategy().requiresComparator()) {
    channel.setLocalStrategyComparator(createComparator(type,channel.getLocalStrategyKeys(),getSortOrders(channel.getLocalStrategyKeys(),channel.getLocalStrategySortOrder())));
  }
  traverse(channel.getSource());
}
