{
  PlanNode source=channel.getSource();
  Operator javaOp=source.getPactContract();
  TypeInformation<?> type=null;
  if (javaOp instanceof PlanGroupReduceOperator && source.getDriverStrategy().equals(DriverStrategy.PARTIAL_GROUP)) {
    PlanGroupReduceOperator<?,?> groupNode=(PlanGroupReduceOperator<?,?>)javaOp;
    type=groupNode.getInputType();
  }
 else   if (javaOp instanceof PlanUnwrappingReduceGroupOperator && source.getDriverStrategy().equals(DriverStrategy.PARTIAL_GROUP)) {
    PlanUnwrappingReduceGroupOperator<?,?,?> groupNode=(PlanUnwrappingReduceGroupOperator<?,?,?>)javaOp;
    type=groupNode.getInputType();
  }
 else   if (javaOp instanceof JavaPlanNode<?>) {
    JavaPlanNode<?> javaNode=(JavaPlanNode<?>)javaOp;
    type=javaNode.getReturnType();
  }
 else   if (javaOp instanceof BulkIteration.PartialSolutionPlaceHolder) {
    BulkIteration.PartialSolutionPlaceHolder partialSolutionPlaceHolder=(BulkIteration.PartialSolutionPlaceHolder)javaOp;
    type=((PlanBulkIterationOperator<?>)partialSolutionPlaceHolder.getContainingBulkIteration()).getReturnType();
  }
 else   if (javaOp instanceof DeltaIteration.SolutionSetPlaceHolder) {
    DeltaIteration.SolutionSetPlaceHolder solutionSetPlaceHolder=(DeltaIteration.SolutionSetPlaceHolder)javaOp;
    type=((PlanDeltaIterationOperator<?,?>)solutionSetPlaceHolder.getContainingWorksetIteration()).getReturnType();
  }
 else   if (javaOp instanceof DeltaIteration.WorksetPlaceHolder) {
    DeltaIteration.WorksetPlaceHolder worksetPlaceHolder=(DeltaIteration.WorksetPlaceHolder)javaOp;
    type=((PlanDeltaIterationOperator<?,?>)worksetPlaceHolder.getContainingWorksetIteration()).getReturnType();
  }
 else   if (javaOp instanceof NoOpUnaryUdfOp) {
    NoOpUnaryUdfOp op=(NoOpUnaryUdfOp)javaOp;
    if (op.getInput() instanceof JavaPlanNode<?>) {
      JavaPlanNode<?> javaNode=(JavaPlanNode<?>)op.getInput();
      type=javaNode.getReturnType();
    }
  }
 else   if (javaOp instanceof Union) {
    Operator op=channel.getSource().getInputs().next().getSource().getPactContract();
    if (op instanceof JavaPlanNode<?>) {
      JavaPlanNode<?> javaNode=(JavaPlanNode<?>)op;
      type=javaNode.getReturnType();
    }
  }
  channel.setSerializer(createSerializer(type));
  if (channel.getShipStrategy().requiresComparator()) {
    channel.setShipStrategyComparator(createComparator(type,channel.getShipStrategyKeys(),getSortOrders(channel.getShipStrategyKeys(),channel.getShipStrategySortOrder())));
  }
  if (channel.getLocalStrategy().requiresComparator()) {
    channel.setLocalStrategyComparator(createComparator(type,channel.getLocalStrategyKeys(),getSortOrders(channel.getLocalStrategyKeys(),channel.getLocalStrategySortOrder())));
  }
  traverse(channel.getSource());
}
