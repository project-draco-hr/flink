{
  PlanNode source=channel.getSource();
  Operator javaOp=source.getPactContract();
  if (!(javaOp instanceof JavaPlanNode)) {
    throw new RuntimeException("Wrong operator type found in post pass.");
  }
  JavaPlanNode<?> javaNode=(JavaPlanNode<?>)javaOp;
  TypeInformation<?> type=javaNode.getReturnType();
  channel.setSerializer(createSerializer(type));
  if (channel.getShipStrategy().requiresComparator()) {
    channel.setShipStrategyComparator(createComparator(type,channel.getShipStrategyKeys(),getSortOrders(channel.getShipStrategyKeys(),channel.getShipStrategySortOrder())));
  }
  if (channel.getLocalStrategy().requiresComparator()) {
    channel.setLocalStrategyComparator(createComparator(type,channel.getLocalStrategyKeys(),getSortOrders(channel.getLocalStrategyKeys(),channel.getLocalStrategySortOrder())));
  }
  traverse(channel.getSource());
}
