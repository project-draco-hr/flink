{
  LogUtils.initializeDefaultConsoleLogger(Level.OFF,Level.OFF);
  expected.add("a");
  expected.add("b");
  expected.add("c");
  expected.add("1");
  expected.add("2");
  expected.add("3");
  expected.add("4");
  result=new HashSet<String>();
  LocalStreamEnvironment env=StreamExecutionEnvironment.createLocalEnvironment(1);
  DataStream<Integer> ds1=env.fromElements(1,3);
  @SuppressWarnings("unchecked") DataStream<Integer> ds2=env.fromElements(2,4).connectWith(ds1);
  DataStream<String> ds3=env.fromElements("a","b");
  @SuppressWarnings({"unused","unchecked"}) DataStream<Boolean> ds4=env.fromElements("c").connectWith(ds3).coMapWith(new MyCoMap(),ds2).addSink(new EmptySink());
  env.executeTest(32);
  Assert.assertEquals(expected,result);
}
