{
  try {
    final FileSystem fs=path.getFileSystem();
    Path p=this.path;
    if (fs.exists(this.path) && fs.getFileStatus(this.path).isDir()) {
      p=this.path.suffix("/" + this.taskIndex);
    }
    final FSDataOutputStream stream=fs.create(p,true);
synchronized (this.lock) {
      if (canceled) {
        try {
          stream.close();
        }
 catch (        Throwable t) {
        }
      }
 else {
        this.fdos=stream;
      }
      this.lock.notifyAll();
    }
  }
 catch (  Exception t) {
synchronized (this.lock) {
      this.exception=t;
      this.lock.notifyAll();
    }
  }
catch (  Throwable t) {
synchronized (this.lock) {
      this.exception=new Exception(t);
      this.lock.notifyAll();
    }
  }
}
