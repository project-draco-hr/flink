{
  checkForDeleted(bufferSize);
  long time=timestampWrapper.getTimestamp(datapoint);
  long threshold=time - granularity;
  int counter=deleteAndCountExpired(threshold);
  buffer.add(time);
  return counter;
}
