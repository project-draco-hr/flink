{
  while (bufferSize < this.buffer.size()) {
    this.buffer.removeFirst();
  }
  int counter=0;
  long threshold=timestamp.getTimestamp(datapoint) - granularity;
  while (!buffer.isEmpty()) {
    if (timestamp.getTimestamp(buffer.getFirst()) < threshold) {
      buffer.removeFirst();
      counter++;
    }
 else {
      break;
    }
  }
  if (!isFake) {
    buffer.add(datapoint);
  }
  return counter;
}
