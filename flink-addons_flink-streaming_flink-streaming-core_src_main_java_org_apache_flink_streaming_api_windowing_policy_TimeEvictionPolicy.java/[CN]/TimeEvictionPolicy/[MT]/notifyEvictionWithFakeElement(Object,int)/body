{
  checkForDeleted(bufferSize);
  long threshold;
  try {
    threshold=(Long)datapoint - granularity;
  }
 catch (  ClassCastException e) {
    threshold=timestamp.getTimestamp((DATA)datapoint) - granularity;
  }
  return deleteAndCountExpired(threshold);
}
