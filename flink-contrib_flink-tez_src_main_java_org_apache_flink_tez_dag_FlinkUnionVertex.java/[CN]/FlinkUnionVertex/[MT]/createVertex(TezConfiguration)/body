{
  try {
    this.writeInputPositionsToConfig();
    this.writeSubTasksInOutputToConfig();
    conf.set(TezTaskConfig.TEZ_TASK_CONFIG,EncodingUtils.encodeObjectToString(taskConfig));
    ProcessorDescriptor descriptor=ProcessorDescriptor.create(UnionProcessor.class.getName());
    descriptor.setUserPayload(TezUtils.createUserPayloadFromConf(conf));
    cached=Vertex.create(this.getUniqueName(),descriptor,getParallelism());
    return cached;
  }
 catch (  IOException e) {
    throw new CompilerException("An error occurred while creating a Tez Vertex: " + e.getMessage(),e);
  }
}
