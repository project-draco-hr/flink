{
  String input1Path=config.getString("UnionTest#Input1Path","").equals("empty") ? emptyInPath : inPath;
  String input2Path=config.getString("UnionTest#Input2Path","").equals("empty") ? emptyInPath : inPath;
  FileDataSource input1=new FileDataSource(new ContractITCaseInputFormat(),input1Path);
  DelimitedInputFormat.configureDelimitedFormat(input1).recordDelimiter('\n');
  input1.setDegreeOfParallelism(config.getInteger("UnionTest#NoSubtasks",1));
  FileDataSource input2=new FileDataSource(new ContractITCaseInputFormat(),input2Path);
  DelimitedInputFormat.configureDelimitedFormat(input2).recordDelimiter('\n');
  input2.setDegreeOfParallelism(config.getInteger("UnionTest#NoSubtasks",1));
  MapOperator testMapper=MapOperator.builder(new TestMapper()).build();
  testMapper.setDegreeOfParallelism(config.getInteger("UnionTest#NoSubtasks",1));
  FileDataSink output=new FileDataSink(new ContractITCaseOutputFormat(),resultPath);
  output.setDegreeOfParallelism(1);
  output.setInput(testMapper);
  testMapper.addInput(input1);
  testMapper.addInput(input2);
  return new Plan(output);
}
