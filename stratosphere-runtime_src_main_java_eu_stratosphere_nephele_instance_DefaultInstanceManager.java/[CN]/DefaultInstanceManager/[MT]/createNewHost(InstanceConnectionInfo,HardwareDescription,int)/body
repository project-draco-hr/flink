{
  String instanceName=instanceConnectionInfo.hostname();
  NetworkNode parentNode=this.networkTopology.getRootNode();
  NetworkNode currentStubNode=null;
  while (true) {
    currentStubNode=this.networkTopology.getNodeByName(instanceName);
    if (currentStubNode != null) {
      break;
    }
    final int pos=instanceName.lastIndexOf('.');
    if (pos == -1) {
      break;
    }
    instanceName=instanceName.substring(0,pos);
  }
  if (currentStubNode == null) {
    instanceName=instanceConnectionInfo.address().toString();
    instanceName=instanceName.replaceAll("/","");
    currentStubNode=this.networkTopology.getNodeByName(instanceName);
  }
  if (currentStubNode != null) {
    if (currentStubNode.getParentNode() != null) {
      parentNode=currentStubNode.getParentNode();
    }
    currentStubNode.remove();
  }
  LOG.info("Creating instance for " + instanceConnectionInfo + ", parent is "+ parentNode.getName());
  final Instance host=new Instance(instanceConnectionInfo,parentNode,this.networkTopology,hardwareDescription,numberOfSlots);
  return host;
}
