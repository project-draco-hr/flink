{
  for (  Map.Entry<KafkaTopicPartition,Long> entry : offsetsToCommit.entrySet()) {
    KafkaTopicPartition tp=entry.getKey();
    long offset=entry.getValue();
    if (offset >= 0) {
      setOffsetInZooKeeper(zkClient,groupId,tp.getTopic(),tp.getPartition(),offset);
    }
  }
}
