{
  LocalDistributedExecutor lde=new LocalDistributedExecutor();
  try {
    File points=File.createTempFile("kmeans_points",".in");
    File clusters=File.createTempFile("kmeans_clusters",".in");
    File outFile=File.createTempFile("kmeans_result",".out");
    points.deleteOnExit();
    clusters.deleteOnExit();
    outFile.deleteOnExit();
    outFile.delete();
    FileWriter fwPoints=new FileWriter(points);
    fwPoints.write(KMeansData.DATAPOINTS);
    fwPoints.close();
    FileWriter fwClusters=new FileWriter(clusters);
    fwClusters.write(KMeansData.INITIAL_CENTERS);
    fwClusters.close();
    URL jarFileURL=getClass().getResource("/KMeansForTest.jar");
    String jarPath=jarFileURL.getFile();
    lde.start(2);
    RemoteExecutor ex=new RemoteExecutor("localhost",6498,Collections.<String>emptyList());
    ex.executeJar(jarPath,"eu.stratosphere.examples.scala.testing.KMeansForTest",new String[]{"4",points.toURI().toString(),clusters.toURI().toString(),outFile.toURI().toString(),"1"});
    points.delete();
    clusters.delete();
    outFile.delete();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
 finally {
    try {
      lde.stop();
    }
 catch (    Exception e) {
      e.printStackTrace();
      Assert.fail(e.getMessage());
    }
  }
}
