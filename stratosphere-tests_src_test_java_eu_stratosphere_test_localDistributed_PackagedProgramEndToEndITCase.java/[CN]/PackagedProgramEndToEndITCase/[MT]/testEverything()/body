{
  NepheleMiniCluster cluster=new NepheleMiniCluster();
  try {
    File points=File.createTempFile("kmeans_points",".in");
    File clusters=File.createTempFile("kmeans_clusters",".in");
    File outFile=File.createTempFile("kmeans_result",".out");
    points.deleteOnExit();
    clusters.deleteOnExit();
    outFile.deleteOnExit();
    outFile.delete();
    FileWriter fwPoints=new FileWriter(points);
    fwPoints.write(KMeansData.DATAPOINTS);
    fwPoints.close();
    FileWriter fwClusters=new FileWriter(clusters);
    fwClusters.write(KMeansData.INITIAL_CENTERS);
    fwClusters.close();
    String jarPath="target/maven-test-jar.jar";
    cluster.setNumTaskManager(2);
    cluster.start();
    RemoteExecutor ex=new RemoteExecutor("localhost",6498);
    ex.executeJar(jarPath,"eu.stratosphere.test.util.testjar.KMeansForTest",new String[]{points.toURI().toString(),clusters.toURI().toString(),outFile.toURI().toString(),"25"});
    points.delete();
    clusters.delete();
    outFile.delete();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
 finally {
    try {
      cluster.stop();
    }
 catch (    Exception e) {
      e.printStackTrace();
      Assert.fail(e.getMessage());
    }
  }
}
