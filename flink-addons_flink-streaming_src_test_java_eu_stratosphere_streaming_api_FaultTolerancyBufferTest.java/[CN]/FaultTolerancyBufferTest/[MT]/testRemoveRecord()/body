{
  StreamRecord record1=(new StreamRecord(1)).setId("1");
  record1.setField(0,new StringValue("V1"));
  StreamRecord record2=(new StreamRecord(1)).setId("1");
  record2.setField(0,new StringValue("V2"));
  faultTolerancyBuffer.addRecord(record1);
  faultTolerancyBuffer.addRecord(record2);
  Long record1TS=faultTolerancyBuffer.getRecordTimestamps().get(record1.getId());
  Long record2TS=faultTolerancyBuffer.getRecordTimestamps().get(record2.getId());
  faultTolerancyBuffer.removeRecord(record1.getId());
  assertTrue(faultTolerancyBuffer.getRecordBuffer().containsKey(record2.getId()));
  assertTrue(faultTolerancyBuffer.getAckCounter().containsKey(record2.getId()));
  assertTrue(faultTolerancyBuffer.getRecordTimestamps().containsKey(record2.getId()));
  assertTrue(faultTolerancyBuffer.getRecordsByTime().get(record2TS).contains(record2.getId()));
  assertFalse(faultTolerancyBuffer.getRecordBuffer().containsKey(record1.getId()));
  assertFalse(faultTolerancyBuffer.getAckCounter().containsKey(record1.getId()));
  assertFalse(faultTolerancyBuffer.getRecordTimestamps().containsKey(record1.getId()));
  assertFalse(faultTolerancyBuffer.getRecordsByTime().get(record1TS).contains(record1.getId()));
}
