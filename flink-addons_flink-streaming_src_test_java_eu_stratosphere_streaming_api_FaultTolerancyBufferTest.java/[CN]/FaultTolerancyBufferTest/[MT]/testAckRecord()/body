{
  StreamRecord record1=(new StreamRecord(1)).setId("1");
  record1.setField(0,new StringValue("V1"));
  faultTolerancyBuffer.addRecord(record1);
  Long record1TS=faultTolerancyBuffer.getRecordTimestamps().get(record1.getId());
  faultTolerancyBuffer.ackRecord(record1.getId());
  faultTolerancyBuffer.ackRecord(record1.getId());
  assertEquals((Integer)1,faultTolerancyBuffer.getAckCounter().get(record1.getId()));
  assertTrue(faultTolerancyBuffer.getRecordBuffer().containsKey(record1.getId()));
  assertTrue(faultTolerancyBuffer.getAckCounter().containsKey(record1.getId()));
  assertTrue(faultTolerancyBuffer.getRecordTimestamps().containsKey(record1.getId()));
  assertTrue(faultTolerancyBuffer.getRecordsByTime().get(record1TS).contains(record1.getId()));
  faultTolerancyBuffer.ackRecord(record1.getId());
  assertFalse(faultTolerancyBuffer.getRecordBuffer().containsKey(record1.getId()));
  assertFalse(faultTolerancyBuffer.getAckCounter().containsKey(record1.getId()));
  assertFalse(faultTolerancyBuffer.getRecordTimestamps().containsKey(record1.getId()));
  assertFalse(faultTolerancyBuffer.getRecordsByTime().get(record1TS).contains(record1.getId()));
  faultTolerancyBuffer.ackRecord(record1.getId());
}
