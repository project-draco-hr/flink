{
  BatchGroupReduceInvokable<OUT,R> invokable;
  if (isGrouped) {
    invokable=new GroupedBatchGroupReduceInvokable<OUT,R>(reducer,batchSize,slideSize,keyPosition);
  }
 else {
    invokable=new BatchGroupReduceInvokable<OUT,R>(reducer,batchSize,slideSize);
  }
  return invokable;
}
