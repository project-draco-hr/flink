{
  if (this.isEmpty())   return EMPTY_ITERATOR;
  if (!this.isAdhoc() && this.inputFormatClass != null) {
    final InputFileIterator inputFileIterator=this.getInputFileIterator();
    if (!inputFileIterator.hasNext() || info == null)     return inputFileIterator;
    return this.createSortedIterator(inputFileIterator,info);
  }
  if (info != null)   Collections.sort(this.records,new Comparator<PactRecord>(){
    @Override public int compare(    PactRecord o1,    PactRecord o2){
      for (int index=0; index < info.keyClasses.size(); index++) {
        Key f1=o1.getField(info.sortKeys.get(index),info.keyClasses.get(index));
        Key f2=o2.getField(info.sortKeys.get(index),info.keyClasses.get(index));
        if (f1 == f2)         continue;
        if (f1 == null)         return -1;
        if (f2 == null)         return 1;
        int comparison=info.comparators.get(index).compare(f1,f2);
        if (comparison != 0)         return comparison;
      }
      return 0;
    }
  }
);
  return this.records.iterator();
}
