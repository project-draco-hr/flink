{
  List<Key> actualKeys=new ArrayList<Key>(currentKeys);
  PactRecord actualRecord=null;
  while (actualIterator.hasNext()) {
    actualRecord=actualIterator.next();
    setKeys(actualKeys,actualRecord,sortInfo);
    if (!currentKeys.equals(actualKeys))     break;
    actualValuesWithCurrentKey.add(actualRecord);
    actualRecord=null;
  }
  if (actualValuesWithCurrentKey.isEmpty())   throw new ArrayComparisonFailure("Unexpected value for key " + currentKeys,new AssertionFailedError(Assert.format(" ",toString(expectedValuesWithCurrentKey.iterator(),schema),toString(actualRecord,schema))),itemIndex + expectedValuesWithCurrentKey.size() - 1);
  fuzzyMatcher.removeMatchingValues(similarityMap,schema,expectedValuesWithCurrentKey,actualValuesWithCurrentKey);
  if (!expectedValuesWithCurrentKey.isEmpty() || !actualValuesWithCurrentKey.isEmpty())   throw new ArrayComparisonFailure("Unexpected values for key " + currentKeys + ": ",new AssertionFailedError(Assert.format(" ",toString(expectedValuesWithCurrentKey.iterator(),schema),toString(actualValuesWithCurrentKey.iterator(),schema))),itemIndex - expectedValuesWithCurrentKey.size());
  if (actualRecord != null)   actualValuesWithCurrentKey.add(actualRecord);
}
