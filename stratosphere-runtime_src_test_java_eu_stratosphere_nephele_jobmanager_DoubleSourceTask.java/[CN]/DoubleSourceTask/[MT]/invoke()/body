{
  this.output1.initializeSerializers();
  this.output2.initializeSerializers();
  final Iterator<FileInputSplit> splitIterator=getFileInputSplits();
  while (splitIterator.hasNext()) {
    final FileInputSplit split=splitIterator.next();
    final long start=split.getStart();
    final long length=split.getLength();
    final FileSystem fs=FileSystem.get(split.getPath().toUri());
    final FSDataInputStream fdis=fs.open(split.getPath());
    final LineReader lineReader=new LineReader(fdis,start,length,(1024 * 1024));
    byte[] line=lineReader.readLine();
    while (line != null) {
      StringRecord str=new StringRecord();
      str.set(line);
      output1.emit(str);
      output2.emit(str);
      line=lineReader.readLine();
    }
    lineReader.close();
  }
  this.output1.flush();
  this.output2.flush();
}
