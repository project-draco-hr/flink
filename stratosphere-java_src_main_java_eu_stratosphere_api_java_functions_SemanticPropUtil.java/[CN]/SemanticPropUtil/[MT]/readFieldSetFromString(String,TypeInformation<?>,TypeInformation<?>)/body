{
  Matcher matcher=FIELD_SET_CHECK_PATTERN.matcher(s);
  if (!matcher.matches()) {
    throw new RuntimeException("Unrecognized annotation string format.");
  }
  matcher=DIGIT_PATTERN.matcher(s);
  FieldSet fs=new FieldSet();
  while (matcher.find()) {
    int field=Integer.valueOf(matcher.group());
    if (!isValidField(outType,field) || !isValidField(inType,field)) {
      throw new IndexOutOfBoundsException("Annotation: Field " + field + " not available in the output tuple.");
    }
    fs.add(field);
  }
  return fs;
}
