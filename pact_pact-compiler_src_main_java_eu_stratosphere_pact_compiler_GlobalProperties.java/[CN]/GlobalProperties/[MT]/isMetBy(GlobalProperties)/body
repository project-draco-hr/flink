{
  if (this.partitioning == PartitioningProperty.FULL_REPLICATION || other.partitioning == PartitioningProperty.FULL_REPLICATION) {
    return other.partitioning == this.partitioning;
  }
  if (this.partitioning == PartitioningProperty.RANDOM) {
    return true;
  }
  if (this.partitioning == PartitioningProperty.ANY_PARTITIONING) {
    if (other.partitioning == PartitioningProperty.RANDOM) {
      return false;
    }
  }
 else   if (other.partitioning != this.partitioning) {
    return false;
  }
  if (this.ordering != null) {
    if (other.ordering == null)     throw new CompilerException("BUG: Equal partitioning property, ordering not equally set.");
    if (this.ordering.getInvolvedIndexes().isValidSubset(other.ordering.getInvolvedIndexes())) {
      for (int i=0; i < other.ordering.getNumberOfFields(); i++) {
        Order to=this.ordering.getOrder(i);
        Order oo=other.ordering.getOrder(i);
        if (to == Order.NONE)         continue;
        if (oo == Order.NONE)         return false;
        if (to != Order.ANY && to != oo)         return false;
      }
      return true;
    }
 else {
      return false;
    }
  }
 else   if (this.partitioningFields != null) {
    return this.partitioningFields.isValidSubset(other.partitioningFields);
  }
 else {
    throw new RuntimeException("Found a partitioning property, but no fields.");
  }
}
