{
  ArrayList<Integer> newPartitionedFields=null;
  PartitionProperty newPartitioning=PartitionProperty.NONE;
  Ordering newOrdering=null;
  if (node instanceof UnionNode) {
    if (partitioning == PartitionProperty.HASH_PARTITIONED) {
      newPartitioning=PartitionProperty.HASH_PARTITIONED;
      newPartitionedFields=partitionedFields;
    }
  }
 else {
    if (partitionedFields != null) {
      for (      Integer index : partitionedFields) {
        if (node.isFieldKept(input,index) == true) {
          if (newPartitionedFields == null) {
            newPartitioning=this.partitioning;
            newPartitionedFields=new ArrayList<Integer>();
          }
          newPartitionedFields.add(index);
        }
      }
    }
    if (ordering != null) {
      boolean orderingPreserved=true;
      ArrayList<Integer> involvedIndexes=ordering.getInvolvedIndexes();
      for (int i=0; i < involvedIndexes.size(); i++) {
        if (node.isFieldKept(input,i) == false) {
          orderingPreserved=false;
          break;
        }
      }
      if (orderingPreserved) {
        newOrdering=ordering.clone();
      }
    }
  }
  if (newPartitioning == PartitionProperty.NONE && newOrdering == null) {
    return null;
  }
 else {
    FieldList partitionFields=new FieldList();
    partitionFields.addAll(newPartitionedFields);
    return new GlobalProperties(newPartitioning,newOrdering,partitionFields);
  }
}
