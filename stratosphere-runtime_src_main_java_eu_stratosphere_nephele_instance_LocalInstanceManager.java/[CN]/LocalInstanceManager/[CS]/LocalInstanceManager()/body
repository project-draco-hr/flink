{
  int numTaskManager=GlobalConfiguration.getInteger(ConfigConstants.LOCAL_INSTANCE_MANAGER_NUMBER_TASK_MANAGER,1);
  ExecutionMode execMode=numTaskManager == 1 ? ExecutionMode.LOCAL : ExecutionMode.CLUSTER;
  for (int i=0; i < numTaskManager; i++) {
    Configuration tm=new Configuration();
    int ipcPort=GlobalConfiguration.getInteger(ConfigConstants.TASK_MANAGER_IPC_PORT_KEY,ConfigConstants.DEFAULT_TASK_MANAGER_IPC_PORT);
    int dataPort=GlobalConfiguration.getInteger(ConfigConstants.TASK_MANAGER_DATA_PORT_KEY,ConfigConstants.DEFAULT_TASK_MANAGER_DATA_PORT);
    tm.setInteger(ConfigConstants.TASK_MANAGER_IPC_PORT_KEY,ipcPort + i);
    tm.setInteger(ConfigConstants.TASK_MANAGER_DATA_PORT_KEY,dataPort + i);
    GlobalConfiguration.includeConfiguration(tm);
    taskManagers.add(new TaskManager(execMode));
  }
}
