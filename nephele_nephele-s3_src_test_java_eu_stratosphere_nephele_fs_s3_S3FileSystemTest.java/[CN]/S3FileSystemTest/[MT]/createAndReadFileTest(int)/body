{
  if (!testActivated()) {
    return;
  }
  final String bucketName=getRandomName();
  final String objectName=getRandomName();
  final Path bucketPath=new Path(S3_BASE_URI + bucketName + Path.SEPARATOR);
  final Path objectPath=new Path(S3_BASE_URI + bucketName + Path.SEPARATOR+ objectName);
  FileSystem fs=bucketPath.getFileSystem();
  fs.mkdirs(bucketPath);
  final FSDataOutputStream outputStream=fs.create(objectPath,false);
  generateTestData(outputStream,fileSize);
  outputStream.close();
  final FSDataInputStream inputStream=fs.open(objectPath);
  testReceivedData(inputStream,fileSize);
  inputStream.close();
  fs.delete(bucketPath,true);
}
