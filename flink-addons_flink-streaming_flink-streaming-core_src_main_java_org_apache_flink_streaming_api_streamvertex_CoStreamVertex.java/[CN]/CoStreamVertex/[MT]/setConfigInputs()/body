{
  setDeserializers();
  int numberOfInputs=configuration.getNumberOfInputs();
  ArrayList<MutableRecordReader<DeserializationDelegate<StreamRecord<IN1>>>> inputList1=new ArrayList<MutableRecordReader<DeserializationDelegate<StreamRecord<IN1>>>>();
  ArrayList<MutableRecordReader<DeserializationDelegate<StreamRecord<IN2>>>> inputList2=new ArrayList<MutableRecordReader<DeserializationDelegate<StreamRecord<IN2>>>>();
  for (int i=0; i < numberOfInputs; i++) {
    int inputType=configuration.getInputType(i);
switch (inputType) {
case 1:
      inputList1.add(new MutableRecordReader<DeserializationDelegate<StreamRecord<IN1>>>(this));
    break;
case 2:
  inputList2.add(new MutableRecordReader<DeserializationDelegate<StreamRecord<IN2>>>(this));
break;
default :
throw new RuntimeException("Invalid input type number: " + inputType);
}
}
coReader=new CoRecordReader<DeserializationDelegate<StreamRecord<IN1>>,DeserializationDelegate<StreamRecord<IN2>>>(inputList1,inputList2);
}
