{
  final ByteBuffer buf=this.headerBuffer;
  buf.clear();
  buf.putInt(MAGIC_NUMBER);
  buf.putInt(env.getSequenceNumber());
  env.getJobID().write(buf);
  env.getSource().write(buf);
  buf.putInt(env.getBuffer() == null ? 0 : env.getBuffer().size());
  buf.putInt(env.getEventsSerialized() == null ? 0 : env.getEventsSerialized().remaining());
  buf.flip();
}
