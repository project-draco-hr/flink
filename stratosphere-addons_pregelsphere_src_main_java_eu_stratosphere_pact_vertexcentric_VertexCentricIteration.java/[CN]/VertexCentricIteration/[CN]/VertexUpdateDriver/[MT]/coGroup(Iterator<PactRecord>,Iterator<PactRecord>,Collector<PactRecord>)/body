{
  if (vertex.hasNext()) {
    PactRecord first=vertex.next();
    first.getFieldInto(0,vertexKey);
    first.getFieldInto(1,vertexValue);
    messageIter.setSource(messages);
    vertexUpdateFunction.setOutput(first,out);
    vertexUpdateFunction.updateVertex(vertexKey,vertexValue,messageIter);
  }
 else {
    if (messages.hasNext()) {
      String message="Target vertex does not exist!.";
      try {
        PactRecord next=messages.next();
        next.getFieldInto(0,vertexKey);
        message="Target vertex '" + vertexKey + "' does not exist!.";
      }
 catch (      Throwable t) {
      }
      throw new Exception(message);
    }
 else {
      throw new Exception();
    }
  }
}
