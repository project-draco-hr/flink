{
  cellID=(IntValue)record.getField(0);
  timeStamp=(LongValue)record.getField(1);
  numOfFields=record.getNumOfFields();
  if (numOfFields == 2) {
    engine.put(cellID.getValue(),timeStamp.getValue());
    outValue.setValue(cellID.toString() + " " + timeStamp.toString());
    outputRecord.setRecord(outValue);
    emit(outputRecord);
  }
 else   if (numOfFields == 3) {
    lastMillis=(IntValue)record.getField(2);
    outValue.setValue(String.valueOf(engine.get(timeStamp.getValue(),lastMillis.getValue(),cellID.getValue())));
    outputRecord.setRecord(outValue);
    emit(outputRecord);
  }
}
