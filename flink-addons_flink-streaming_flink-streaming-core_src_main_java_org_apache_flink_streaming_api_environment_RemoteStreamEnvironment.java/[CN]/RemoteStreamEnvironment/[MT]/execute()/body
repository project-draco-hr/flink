{
  if (LOG.isInfoEnabled()) {
    LOG.info("Running remotely at " + host + ":"+ port);
  }
  JobGraph jobGraph=jobGraphBuilder.getJobGraph();
  for (int i=0; i < jarFiles.length; i++) {
    File file=new File(jarFiles[i]);
    try {
      JobWithJars.checkJarFile(file);
    }
 catch (    IOException e) {
      throw new RuntimeException("Problem with jar file " + file.getAbsolutePath(),e);
    }
    jobGraph.addJar(new Path(file.getAbsolutePath()));
  }
  Configuration configuration=jobGraph.getJobConfiguration();
  Client client=new Client(new InetSocketAddress(host,port),configuration);
  try {
    client.run(jobGraph,true);
  }
 catch (  ProgramInvocationException e) {
    throw new RuntimeException("Cannot execute job due to ProgramInvocationException",e);
  }
}
