{
  int type=dis.read();
  if (NULL_HANDLE == type) {
    return null;
  }
 else   if (FILE_STREAM_STATE_HANDLE == type) {
    String pathString=dis.readUTF();
    return new FileStateHandle(new Path(pathString));
  }
 else   if (BYTE_STREAM_STATE_HANDLE == type) {
    int numBytes=dis.readInt();
    byte[] data=new byte[numBytes];
    dis.read(data);
    return new ByteStreamStateHandle(data);
  }
 else {
    throw new IOException("Unknown implementation of StreamStateHandle, code: " + type);
  }
}
