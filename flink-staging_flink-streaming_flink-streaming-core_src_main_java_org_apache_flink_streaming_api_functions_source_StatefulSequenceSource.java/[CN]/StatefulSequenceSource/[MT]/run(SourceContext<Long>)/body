{
  final Object checkpointLock=ctx.getCheckpointLock();
  RuntimeContext context=getRuntimeContext();
  final long stepSize=context.getNumberOfParallelSubtasks();
  final long congruence=start + context.getIndexOfThisSubtask();
  final long toCollect=((end - start + 1) % stepSize > (congruence - start)) ? ((end - start + 1) / stepSize + 1) : ((end - start + 1) / stepSize);
  Long currentCollected=collected.getState();
  while (isRunning && currentCollected < toCollect) {
synchronized (checkpointLock) {
      ctx.collect(currentCollected * stepSize + congruence);
      collected.updateState(currentCollected + 1);
    }
    currentCollected=collected.getState();
  }
}
