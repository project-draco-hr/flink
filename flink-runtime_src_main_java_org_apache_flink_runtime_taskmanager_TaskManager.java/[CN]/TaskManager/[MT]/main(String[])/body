{
  Option configDirOpt=OptionBuilder.withArgName("config directory").hasArg().withDescription("Specify configuration directory.").create("configDir");
  Option tempDir=OptionBuilder.withArgName("temporary directory (overwrites configured option)").hasArg().withDescription("Specify temporary directory.").create(ARG_CONF_DIR);
  configDirOpt.setRequired(true);
  tempDir.setRequired(false);
  Options options=new Options();
  options.addOption(configDirOpt);
  options.addOption(tempDir);
  CommandLineParser parser=new GnuParser();
  CommandLine line=null;
  try {
    line=parser.parse(options,args);
  }
 catch (  ParseException e) {
    System.err.println("CLI Parsing failed. Reason: " + e.getMessage());
    System.exit(STARTUP_FAILURE_RETURN_CODE);
  }
  String configDir=line.getOptionValue(configDirOpt.getOpt(),null);
  String tempDirVal=line.getOptionValue(tempDir.getOpt(),null);
  GlobalConfiguration.loadConfiguration(configDir);
  if (tempDirVal != null && GlobalConfiguration.getString(ConfigConstants.TASK_MANAGER_TMP_DIR_KEY,null) == null) {
    Configuration c=GlobalConfiguration.getConfiguration();
    c.setString(ConfigConstants.TASK_MANAGER_TMP_DIR_KEY,tempDirVal);
    LOG.info("Setting temporary directory to " + tempDirVal);
    GlobalConfiguration.includeConfiguration(c);
  }
  EnvironmentInformation.logEnvironmentInfo(LOG,"TaskManager");
  try {
    createTaskManager(ExecutionMode.CLUSTER);
  }
 catch (  Exception e) {
    LOG.fatal("Taskmanager startup failed: " + e.getMessage(),e);
    System.exit(STARTUP_FAILURE_RETURN_CODE);
  }
  Object mon=new Object();
synchronized (mon) {
    try {
      mon.wait();
    }
 catch (    InterruptedException ex) {
    }
  }
}
