{
  if (config == null) {
    throw new IllegalArgumentException("No Configuration has been passed to the web server");
  }
  if (jobmanager == null || archive == null) {
    throw new NullPointerException();
  }
  final FiniteDuration timeout=AkkaUtils.getTimeout(config);
  this.port=config.getInteger(ConfigConstants.JOB_MANAGER_WEB_PORT_KEY,ConfigConstants.DEFAULT_JOB_MANAGER_WEB_FRONTEND_PORT);
  final String basePath=config.getString(ConfigConstants.FLINK_BASE_DIR_PATH_KEY,"");
  final String[] logDirPaths=config.getString(ConfigConstants.JOB_MANAGER_WEB_LOG_PATH_KEY,basePath + "/log").split(",");
  URL webRootDir=this.getClass().getClassLoader().getResource(WEB_ROOT_DIR);
  if (webRootDir == null) {
    throw new FileNotFoundException("Cannot start jobmanager web info server. The " + "resource " + WEB_ROOT_DIR + " is not included in the jar.");
  }
  final File[] logDirFiles=new File[logDirPaths.length];
  int i=0;
  for (  String path : logDirPaths) {
    logDirFiles[i++]=new File(path);
  }
  if (LOG.isInfoEnabled()) {
    LOG.info("Setting up web info server, using web-root directory" + webRootDir.toExternalForm() + ".");
    LOG.info("Web info server will display information about flink job-manager on " + config.getString(ConfigConstants.JOB_MANAGER_IPC_ADDRESS_KEY,null) + ", port "+ port+ ".");
  }
  server=new Server(port);
  ServletContextHandler servletContext=new ServletContextHandler(ServletContextHandler.SESSIONS);
  servletContext.setContextPath("/");
  servletContext.addServlet(new ServletHolder(new JobManagerInfoServlet(jobmanager,archive,timeout)),"/jobsInfo");
  servletContext.addServlet(new ServletHolder(new LogfileInfoServlet(logDirFiles)),"/logInfo");
  servletContext.addServlet(new ServletHolder(new SetupInfoServlet(config,jobmanager,timeout)),"/setupInfo");
  servletContext.addServlet(new ServletHolder(new MenuServlet()),"/menu");
  ResourceHandler resourceHandler=new ResourceHandler();
  resourceHandler.setDirectoriesListed(false);
  resourceHandler.setResourceBase(webRootDir.toExternalForm());
  HandlerList handlers=new HandlerList();
  handlers.addHandler(servletContext);
  handlers.addHandler(resourceHandler);
  File af=null;
  String authFile=config.getString(ConfigConstants.JOB_MANAGER_WEB_ACCESS_FILE_KEY,null);
  if (authFile != null) {
    af=new File(authFile);
    if (!af.exists()) {
      LOG.error("The specified file '" + af.getAbsolutePath() + "' with the authentication information is missing. Starting server without HTTP authentication.");
      af=null;
    }
  }
  if (af != null) {
    HashLoginService loginService=new HashLoginService("Flink Jobmanager Interface",authFile);
    server.addBean(loginService);
    Constraint constraint=new Constraint();
    constraint.setName(Constraint.__BASIC_AUTH);
    constraint.setAuthenticate(true);
    constraint.setRoles(new String[]{"user"});
    ConstraintMapping mapping=new ConstraintMapping();
    mapping.setPathSpec("/*");
    mapping.setConstraint(constraint);
    ConstraintSecurityHandler sh=new ConstraintSecurityHandler();
    sh.addConstraintMapping(mapping);
    sh.setAuthenticator(new BasicAuthenticator());
    sh.setLoginService(loginService);
    sh.setStrict(true);
    sh.setHandler(handlers);
    server.setHandler(sh);
  }
 else {
    server.setHandler(handlers);
  }
}
