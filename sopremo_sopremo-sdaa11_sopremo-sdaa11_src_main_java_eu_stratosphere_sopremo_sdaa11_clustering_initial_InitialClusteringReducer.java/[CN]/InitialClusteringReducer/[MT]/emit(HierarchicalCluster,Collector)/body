{
  if (cluster.isFinal()) {
    clusterName.setValue(cluster.getId());
    clusterPoints.clear();
    clusterPoints.addAll(Arrays.asList(cluster.getPoints()));
    outputRecord.clear();
    outputRecord.setField(PactRecordIndices.CLUSTER_ID,clusterName);
    outputRecord.setField(PactRecordIndices.CLUSTER_POINTS,clusterPoints);
    outputRecord.setField(PactRecordIndices.CLUSTER_CLUSTROID,cluster.getClustroid());
    out.collect(outputRecord);
  }
 else {
    for (    HierarchicalCluster child : cluster.getChildren()) {
      emit(child,out);
    }
  }
}
