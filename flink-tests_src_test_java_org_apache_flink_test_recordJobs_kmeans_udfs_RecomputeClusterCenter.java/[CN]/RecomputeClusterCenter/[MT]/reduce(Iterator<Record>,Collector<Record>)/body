{
  Record next=null;
  CoordVector coordinates=new CoordVector();
  double[] coordinateSum=null;
  int count=0;
  while (dataPoints.hasNext()) {
    next=dataPoints.next();
    double[] thisCoords=next.getField(1,CoordVector.class).getCoordinates();
    int thisCount=next.getField(2,IntValue.class).getValue();
    if (coordinateSum == null) {
      if (coordinates.getCoordinates() != null) {
        coordinateSum=coordinates.getCoordinates();
      }
 else {
        coordinateSum=new double[thisCoords.length];
      }
    }
    addToCoordVector(coordinateSum,thisCoords);
    count+=thisCount;
  }
  for (int i=0; i < coordinateSum.length; i++) {
    coordinateSum[i]/=count;
  }
  coordinates.setCoordinates(coordinateSum);
  next.setField(1,coordinates);
  next.setNull(2);
  out.collect(next);
}
