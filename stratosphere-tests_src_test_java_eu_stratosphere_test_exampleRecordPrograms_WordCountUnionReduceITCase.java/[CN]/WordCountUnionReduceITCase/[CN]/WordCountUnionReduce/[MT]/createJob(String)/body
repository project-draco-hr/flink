{
  String inputPath=args.length >= 1 ? args[0] : "";
  String outputPath=args.length >= 3 ? args[2] : "";
  int numSubtasks=args.length >= 4 ? Integer.parseInt(args[3]) : 1;
  FileDataSource source=new FileDataSource(TextInputFormat.class,inputPath,"First Input");
  MapOperator wordsFirstInput=MapOperator.builder(TokenizeLine.class).input(source).name("Words (First Input)").build();
  MapOperator wordsSecondInput=MapOperator.builder(TokenizeLine.class).input(source).name("Words (Second Input)").build();
  ReduceOperator counts=ReduceOperator.builder(CountWords.class,PactString.class,0).input(wordsFirstInput,wordsSecondInput).name("Word Counts").build();
  FileDataSink sink=new FileDataSink(CsvOutputFormat.class,outputPath,counts);
  CsvOutputFormat.configureRecordFormat(sink).recordDelimiter('\n').fieldDelimiter(' ').field(PactString.class,0).field(PactInteger.class,1);
  Job plan=new Job(sink,"WordCount Union Reduce");
  plan.setDefaultParallelism(numSubtasks);
  return plan;
}
