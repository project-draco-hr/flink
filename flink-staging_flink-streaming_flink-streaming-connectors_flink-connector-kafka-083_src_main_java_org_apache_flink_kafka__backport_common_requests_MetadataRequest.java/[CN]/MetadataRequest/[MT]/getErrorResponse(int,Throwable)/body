{
  Map<String,Errors> topicErrors=new HashMap<String,Errors>();
  for (  String topic : topics) {
    topicErrors.put(topic,Errors.forException(e));
  }
  Cluster cluster=new Cluster(new ArrayList<Node>(),new ArrayList<PartitionInfo>());
switch (versionId) {
case 0:
    return new MetadataResponse(cluster,topicErrors);
default :
  throw new IllegalArgumentException(String.format("Version %d is not valid. Valid versions for %s are 0 to %d",versionId,this.getClass().getSimpleName(),ProtoUtils.latestVersion(ApiKeys.METADATA.id)));
}
}
