{
  LogUtils.initializeDefaultConsoleLogger(Level.ERROR,Level.INFO);
  try {
    JobGraph jG=getJobGraph();
    Configuration configuration=jG.getJobConfiguration();
    if (args.length == 0) {
      args=new String[]{"local"};
    }
    if (args[0].equals("local")) {
      System.out.println("Running in Local mode");
      NepheleMiniCluster exec=new NepheleMiniCluster();
      exec.start();
      Client client=new Client(new InetSocketAddress("localhost",6498),configuration);
      client.run(jG,true);
      exec.stop();
    }
 else     if (args[0].equals("cluster")) {
      System.out.println("Running in Cluster2 mode");
      Client client=new Client(new InetSocketAddress("hadoop02.ilab.sztaki.hu",6123),configuration);
      client.run(jG,true);
    }
  }
 catch (  Exception e) {
    System.out.println(e);
  }
}
