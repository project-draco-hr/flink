{
  if (input1.isEmpty() || input2.isEmpty()) {
    throw new RuntimeException("Inputs must not be empty");
  }
  this.inputIterator1=input1.iterator();
  this.inputIterator2=input2.iterator();
  TypeInformation<IN1> inTypeInfo1=TypeExtractor.getForObject(input1.iterator().next());
  inDeserializer1=new StreamRecordSerializer<IN1>(inTypeInfo1,new ExecutionConfig());
  TypeInformation<IN2> inTypeInfo2=TypeExtractor.getForObject(input2.iterator().next());
  inDeserializer2=new StreamRecordSerializer<IN2>(inTypeInfo2,new ExecutionConfig());
  mockIterator=new MockCoReaderIterator(inDeserializer1,inDeserializer2);
  outputs=new ArrayList<OUT>();
  collector=new MockOutput<OUT>(outputs);
}
