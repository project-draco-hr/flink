{
  try {
    final JobID jid=new JobID();
    final JobVertexID vid=new JobVertexID();
    AbstractJobVertex ajv=new AbstractJobVertex("TestVertex",vid);
    ajv.setParallelism(3);
    ajv.setInvokableClass(mock(AbstractInvokable.class).getClass());
    ExecutionGraph graph=new ExecutionGraph(jid,"test job",new Configuration(),AkkaUtils.DEFAULT_TIMEOUT());
    graph.attachJobGraph(Arrays.asList(ajv));
    setGraphStatus(graph,JobStatus.RUNNING);
    ExecutionJobVertex ejv=graph.getJobVertex(vid);
    ActorRef taskManager=system.actorOf(Props.create(SimpleAcknowledgingTaskManager.class));
    for (    ExecutionVertex ee : ejv.getTaskVertices()) {
      AllocatedSlot slot=getInstance(taskManager).allocateSlot(jid);
      ee.deployToSlot(slot);
    }
    for (    ExecutionVertex ee : ejv.getTaskVertices()) {
      ee.executionFinished();
    }
    assertTrue(ejv.isInFinalState());
    assertEquals(JobStatus.FINISHED,graph.getState());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
