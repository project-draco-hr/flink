{
  super(0);
  if (!(type instanceof CompositeType<?>)) {
    throw new IllegalArgumentException("Key expressions are only supported on POJO types and Tuples. " + "A type is considered a POJO if all its fields are public, or have both getters and setters defined");
  }
  @SuppressWarnings("unchecked") CompositeType<T> cType=(CompositeType<T>)type;
  List<FlatFieldDescriptor> fieldDescriptors=cType.getFlatFields(field);
  int logicalKeyPosition=fieldDescriptors.get(0).getPosition();
  Class<?> keyClass=fieldDescriptors.get(0).getType().getTypeClass();
  adder=SumFunction.getForClass(keyClass);
  if (cType instanceof PojoTypeInfo) {
    comparator=(PojoComparator<T>)cType.createComparator(new int[]{logicalKeyPosition},new boolean[]{false},0,getRuntimeContext().getExecutionConfig());
  }
 else {
    throw new IllegalArgumentException("Key expressions are only supported on POJO types. " + "A type is considered a POJO if all its fields are public, or have both getters and setters defined");
  }
}
