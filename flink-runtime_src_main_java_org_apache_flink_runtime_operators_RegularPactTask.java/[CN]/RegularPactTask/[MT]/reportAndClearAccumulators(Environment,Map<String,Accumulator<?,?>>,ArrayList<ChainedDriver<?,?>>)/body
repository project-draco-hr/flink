{
  if (!chainedTasks.isEmpty()) {
    if (accumulators == null) {
      accumulators=new HashMap<String,Accumulator<?,?>>();
    }
    for (    ChainedDriver<?,?> chainedTask : chainedTasks) {
      RuntimeContext rc=FunctionUtils.getFunctionRuntimeContext(chainedTask.getStub(),null);
      if (rc != null) {
        Map<String,Accumulator<?,?>> chainedAccumulators=rc.getAllAccumulators();
        if (chainedAccumulators != null) {
          AccumulatorHelper.mergeInto(accumulators,chainedAccumulators);
        }
      }
    }
  }
  if (accumulators == null || accumulators.size() == 0) {
    return;
  }
  env.reportAccumulators(accumulators);
  AccumulatorHelper.resetAndClearAccumulators(accumulators);
  for (  ChainedDriver<?,?> chainedTask : chainedTasks) {
    RuntimeContext rc=FunctionUtils.getFunctionRuntimeContext(chainedTask.getStub(),null);
    if (rc != null) {
      AccumulatorHelper.resetAndClearAccumulators(rc.getAllAccumulators());
    }
  }
}
