{
synchronized (this.lock) {
    if (this.nephele == null) {
      throw new Exception("The local executor has not been started.");
    }
    PactCompiler pc=new PactCompiler();
    OptimizedPlan op=pc.compile(plan);
    NepheleJobGraphGenerator jgg=new NepheleJobGraphGenerator();
    JobGraph jobGraph=jgg.compileJobGraph(op);
    JobClient jobClient=this.nephele.getJobClient(jobGraph);
    return jobClient.submitJobAndWait();
  }
}
