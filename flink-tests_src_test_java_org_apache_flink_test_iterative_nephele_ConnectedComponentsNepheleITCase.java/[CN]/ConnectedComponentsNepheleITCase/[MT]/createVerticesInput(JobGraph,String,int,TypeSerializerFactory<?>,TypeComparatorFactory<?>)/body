{
  @SuppressWarnings("unchecked") CsvInputFormat verticesInFormat=new CsvInputFormat(' ',LongValue.class);
  InputFormatInputVertex verticesInput=JobGraphUtils.createInput(verticesInFormat,verticesPath,"VerticesInput",jobGraph,numSubTasks);
  TaskConfig verticesInputConfig=new TaskConfig(verticesInput.getConfiguration());
{
    verticesInputConfig.addOutputShipStrategy(ShipStrategyType.FORWARD);
    verticesInputConfig.setOutputSerializer(serializer);
    TaskConfig chainedMapperConfig=new TaskConfig(new Configuration());
    chainedMapperConfig.setStubWrapper(new UserCodeClassWrapper<IdDuplicator>(IdDuplicator.class));
    chainedMapperConfig.setDriverStrategy(DriverStrategy.COLLECTOR_MAP);
    chainedMapperConfig.setInputLocalStrategy(0,LocalStrategy.NONE);
    chainedMapperConfig.setInputSerializer(serializer,0);
    chainedMapperConfig.setOutputSerializer(serializer);
    chainedMapperConfig.addOutputShipStrategy(ShipStrategyType.PARTITION_HASH);
    chainedMapperConfig.addOutputShipStrategy(ShipStrategyType.PARTITION_HASH);
    chainedMapperConfig.setOutputComparator(comparator,0);
    chainedMapperConfig.setOutputComparator(comparator,1);
    verticesInputConfig.addChainedTask(ChainedCollectorMapDriver.class,chainedMapperConfig,"ID Duplicator");
  }
  return verticesInput;
}
