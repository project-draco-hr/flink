{
  OutputFormatOutputVertex output=JobGraphUtils.createFileOutput(jobGraph,"Final Output",numSubTasks);
  TaskConfig outputConfig=new TaskConfig(output.getConfiguration());
{
    outputConfig.addInputToGroup(0);
    outputConfig.setInputSerializer(serializer,0);
    outputConfig.setStubWrapper(new UserCodeClassWrapper<CsvOutputFormat>(CsvOutputFormat.class));
    outputConfig.setStubParameter(FileOutputFormat.FILE_PARAMETER_KEY,resultPath);
    Configuration outputUserConfig=outputConfig.getStubParameters();
    outputUserConfig.setString(CsvOutputFormat.RECORD_DELIMITER_PARAMETER,"\n");
    outputUserConfig.setString(CsvOutputFormat.FIELD_DELIMITER_PARAMETER," ");
    outputUserConfig.setClass(CsvOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 0,LongValue.class);
    outputUserConfig.setInteger(CsvOutputFormat.RECORD_POSITION_PARAMETER_PREFIX + 0,0);
    outputUserConfig.setClass(CsvOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 1,LongValue.class);
    outputUserConfig.setInteger(CsvOutputFormat.RECORD_POSITION_PARAMETER_PREFIX + 1,1);
    outputUserConfig.setInteger(CsvOutputFormat.NUM_FIELDS_PARAMETER,2);
  }
  return output;
}
