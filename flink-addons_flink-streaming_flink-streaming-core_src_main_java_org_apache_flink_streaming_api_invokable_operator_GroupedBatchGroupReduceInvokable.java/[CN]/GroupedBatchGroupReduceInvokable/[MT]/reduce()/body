{
  iterator=state.getStreamRecordIterator();
  while (iterator.hasNext()) {
    StreamRecord<IN> nextRecord=iterator.next();
    Object key=nextRecord.getField(keyPosition);
    nextValue=nextRecord.getObject();
    List<IN> group=values.get(key);
    if (group != null) {
      group.add(nextValue);
    }
 else {
      group=new ArrayList<IN>();
      group.add(nextValue);
      values.put(key,group);
    }
  }
  for (  List<IN> group : values.values()) {
    userIterable=group;
    callUserFunctionAndLogException();
  }
  values.clear();
}
