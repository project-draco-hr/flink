{
  boolean success=false;
  try {
    if (!isReleased.get()) {
synchronized (receivedBuffers) {
        if (expectedSequenceNumber == sequenceNumber) {
          receivedBuffers.add(buffer);
          expectedSequenceNumber++;
          notifyReaderAboutAvailableBuffer();
          success=true;
          return;
        }
      }
      IOException error=new BufferReorderingException(expectedSequenceNumber,sequenceNumber);
      ioError.compareAndSet(null,error);
    }
  }
  finally {
    if (!success) {
      buffer.recycle();
    }
  }
}
