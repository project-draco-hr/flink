{
  try {
    Buffer buffer=null;
    if (bufferPool != null) {
      buffer=bufferPool.requestBuffer();
    }
    if (buffer == null) {
      buffer=new Buffer(new MemorySegment(new byte[bufferSize]),new BufferRecycler(){
        @Override public void recycle(        MemorySegment memorySegment){
          memorySegment.free();
        }
      }
);
    }
    spillingChannel.read(buffer.getMemorySegment().wrap(0,bufferSize));
    return buffer;
  }
 catch (  Exception e) {
    close();
    throw new IOException(e);
  }
}
