{
  for (int i=0; i < 50; i++) {
    ServerSocket serverSocket=null;
    try {
      serverSocket=new ServerSocket(0);
      int port=serverSocket.getLocalPort();
      if (port != 0) {
        return port;
      }
    }
  finally {
      serverSocket.close();
    }
  }
  throw new IOException("could not find free port");
}
