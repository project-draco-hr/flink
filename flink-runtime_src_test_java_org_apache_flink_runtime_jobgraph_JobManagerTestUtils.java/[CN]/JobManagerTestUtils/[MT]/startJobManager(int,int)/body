{
  Configuration cfg=new Configuration();
  cfg.setString(ConfigConstants.JOB_MANAGER_IPC_ADDRESS_KEY,"localhost");
  cfg.setInteger(ConfigConstants.JOB_MANAGER_IPC_PORT_KEY,getAvailablePort());
  cfg.setInteger(ConfigConstants.TASK_MANAGER_MEMORY_SIZE_KEY,10);
  cfg.setInteger(ConfigConstants.TASK_MANAGER_NUM_TASK_SLOTS,numSlotsPerTaskManager);
  cfg.setInteger(ConfigConstants.LOCAL_INSTANCE_MANAGER_NUMBER_TASK_MANAGER,numTaskManagers);
  GlobalConfiguration.includeConfiguration(cfg);
  JobManager jm=new JobManager(ExecutionMode.LOCAL);
  long deadline=System.currentTimeMillis() + 5000;
  while (jm.getNumberOfSlotsAvailableToScheduler() < numTaskManagers * numSlotsPerTaskManager && System.currentTimeMillis() < deadline) {
    Thread.sleep(10);
  }
  assertEquals(numTaskManagers * numSlotsPerTaskManager,jm.getNumberOfSlotsAvailableToScheduler());
  return jm;
}
