{
  Callable<?,?> callable=getScope(packageName).getFunctionRegistry().get(name.getText());
  if (callable == null)   throw new QueryParserException(String.format("Unknown function %s",name));
  if (callable instanceof MacroBase)   return ((MacroBase)callable).call(params,null,this.getContext());
  if (callable instanceof Inlineable)   return ((Inlineable)callable).getDefinition();
  if (!(callable instanceof SopremoFunction))   throw new QueryParserException(String.format("Unknown callable %s",callable));
  if (object != null) {
    ObjectArrayList<EvaluationExpression> paramList=ObjectArrayList.wrap(params);
    paramList.add(0,object);
    params=paramList.elements();
  }
  return new FunctionCall(name.getText(),(SopremoFunction)callable,params);
}
