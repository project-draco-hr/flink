{
  Preconditions.checkNotNull(recordWriter);
  this.recordWriter=(RecordWriter<SerializationDelegate<Object>>)recordWriter;
  TypeSerializer<Object> outRecordSerializer;
  if (enableWatermarkMultiplexing) {
    outRecordSerializer=new MultiplexingStreamRecordSerializer<OUT>(outSerializer);
  }
 else {
    outRecordSerializer=(TypeSerializer<Object>)(TypeSerializer<?>)new StreamRecordSerializer<OUT>(outSerializer);
  }
  if (outSerializer != null) {
    serializationDelegate=new SerializationDelegate<Object>(outRecordSerializer);
  }
}
