{
  Preconditions.checkNotNull(recordWriter);
  this.recordWriter=recordWriter;
  StreamRecordSerializer<OUT> outRecordSerializer;
  if (enableWatermarkMultiplexing) {
    outRecordSerializer=new MultiplexingStreamRecordSerializer<OUT>(outSerializer);
  }
 else {
    outRecordSerializer=new StreamRecordSerializer<OUT>(outSerializer);
  }
  if (outSerializer != null) {
    serializationDelegate=new SerializationDelegate(outRecordSerializer);
  }
}
