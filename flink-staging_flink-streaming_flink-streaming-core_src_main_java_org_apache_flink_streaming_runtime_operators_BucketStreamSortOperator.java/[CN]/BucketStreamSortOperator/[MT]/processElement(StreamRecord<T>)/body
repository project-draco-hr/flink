{
  long bucketId=record.getTimestamp() - (record.getTimestamp() % granularity);
  List<StreamRecord<T>> bucket=buckets.get(bucketId);
  if (bucket == null) {
    bucket=new ArrayList<>();
    buckets.put(bucketId,bucket);
  }
  bucket.add(record);
}
