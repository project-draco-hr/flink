{
  factory=new ConnectionFactory();
  factory.setHost(HOST_NAME);
  try {
    connection=factory.newConnection();
    channel=connection.createChannel();
    channel.queueDeclare(QUEUE_NAME,false,false,false,null);
    consumer=new QueueingConsumer(channel);
    channel.basicConsume(QUEUE_NAME,true,consumer);
  }
 catch (  IOException e) {
    new RuntimeException("Cannot create RMQ connection with " + QUEUE_NAME + " at "+ HOST_NAME,e);
  }
}
