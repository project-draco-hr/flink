{
  Configuration taskConfiguration=getTaskConfiguration();
  StreamComponentHelper<StreamTask> streamTaskHelper=new StreamComponentHelper<StreamTask>();
  try {
    streamTaskHelper.setConfigInputs(this,taskConfiguration,inputs);
    streamTaskHelper.setConfigOutputs(this,taskConfiguration,outputs,partitioners);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  recordBuffer=new FaultTolerancyBuffer(outputs,taskInstanceID);
  userFunction=(UserTaskInvokable)streamTaskHelper.getUserFunction(taskConfiguration,outputs,taskInstanceID,recordBuffer);
  streamTaskHelper.setAckListener(recordBuffer,taskInstanceID,outputs);
  streamTaskHelper.setFailListener(recordBuffer,taskInstanceID,outputs);
}
