{
  final Class<? extends AbstractInvokable> invokableClass=jobVertex.getInvokableClass();
  if (invokableClass == null) {
    throw new GraphConversionException("JobVertex " + jobVertex.getID() + " ("+ jobVertex.getName()+ ") does not specify a task");
  }
  final ExecutionSignature signature=ExecutionSignature.createSignature(jobVertex.getInvokableClass(),jobVertex.getJobGraph().getJobID());
  ExecutionGroupVertex groupVertex=null;
  try {
    groupVertex=new ExecutionGroupVertex(jobVertex.getName(),jobVertex.getID(),this,jobVertex.getNumberOfSubtasks(),jobVertex.getVertexToShareInstancesWith() != null ? true : false,jobVertex.getNumberOfExecutionRetries(),jobVertex.getConfiguration(),signature,invokableClass);
  }
 catch (  Throwable t) {
    throw new GraphConversionException(StringUtils.stringifyException(t));
  }
  try {
    jobVertex.checkConfiguration(groupVertex.getEnvironment().getInvokable());
  }
 catch (  IllegalConfigurationException e) {
    throw new GraphConversionException(StringUtils.stringifyException(e));
  }
  if (jobVertex instanceof AbstractJobInputVertex) {
    final InputSplit[] inputSplits;
    if (groupVertex.getEnvironment().getInvokable() instanceof AbstractInputTask) {
      try {
        inputSplits=((AbstractInputTask<?>)groupVertex.getEnvironment().getInvokable()).computeInputSplits(jobVertex.getNumberOfSubtasks());
      }
 catch (      Exception e) {
        throw new GraphConversionException("Cannot compute input splits for " + groupVertex.getName(),e);
      }
    }
 else {
      throw new GraphConversionException("JobInputVertex contained a task class which was not an input task.");
    }
    if (inputSplits == null) {
      LOG.info("Job input vertex " + jobVertex.getName() + " generated 0 input splits");
    }
 else {
      LOG.info("Job input vertex " + jobVertex.getName() + " generated "+ inputSplits.length+ " input splits");
    }
    groupVertex.setInputSplits(inputSplits);
  }
  if (jobVertex instanceof JobFileOutputVertex) {
    final JobFileOutputVertex jbov=(JobFileOutputVertex)jobVertex;
    jobVertex.getConfiguration().setString("outputPath",jbov.getFilePath().toString());
  }
  initialExecutionStage.addStageMember(groupVertex);
  final ExecutionVertex ev=new ExecutionVertex(this,groupVertex,jobVertex.getNumberOfForwardConnections(),jobVertex.getNumberOfBackwardConnections());
  ev.setAllocatedResource(new AllocatedResource(DummyInstance.createDummyInstance(),null));
  return ev;
}
