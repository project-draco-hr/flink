{
  final Class<? extends AbstractInvokable> invokableClass=jobVertex.getInvokableClass();
  if (invokableClass == null) {
    throw new GraphConversionException("JobVertex " + jobVertex.getID() + " ("+ jobVertex.getName()+ ") does not specify a task");
  }
  final ExecutionSignature signature=ExecutionSignature.createSignature(jobVertex.getInvokableClass(),jobVertex.getJobGraph().getJobID());
  ExecutionGroupVertex groupVertex=null;
  try {
    groupVertex=new ExecutionGroupVertex(jobVertex.getName(),jobVertex.getID(),this,jobVertex.getNumberOfSubtasks(),jobVertex.getVertexToShareInstancesWith() != null ? true : false,jobVertex.getNumberOfExecutionRetries(),jobVertex.getConfiguration(),signature,invokableClass);
  }
 catch (  Throwable t) {
    throw new GraphConversionException(StringUtils.stringifyException(t));
  }
  if (jobVertex instanceof AbstractJobInputVertex) {
    final InputSplit[] inputSplits;
    final Class<? extends InputSplit> inputSplitType=jobInputVertex.getInputSplitType();
    try {
      inputSplits=jobInputVertex.getInputSplits(jobVertex.getNumberOfSubtasks());
    }
 catch (    Exception e) {
      throw new GraphConversionException("Cannot compute input splits for " + groupVertex.getName() + ": "+ StringUtils.stringifyException(e));
    }
    if (inputSplits == null) {
      LOG.info("Job input vertex " + jobVertex.getName() + " generated 0 input splits");
    }
 else {
      LOG.info("Job input vertex " + jobVertex.getName() + " generated "+ inputSplits.length+ " input splits");
    }
    groupVertex.setInputSplits(inputSplits);
    groupVertex.setInputSplitType(inputSplitType);
  }
  if (jobVertex instanceof JobOutputVertex) {
    final JobOutputVertex jobOutputVertex=(JobOutputVertex)jobVertex;
    final OutputFormat<?> outputFormat=jobOutputVertex.getOutputFormat();
    if (outputFormat != null) {
      outputFormat.initialize(groupVertex.getConfiguration());
    }
  }
  initialExecutionStage.addStageMember(groupVertex);
  final ExecutionVertex ev=new ExecutionVertex(this,groupVertex,jobVertex.getNumberOfForwardConnections(),jobVertex.getNumberOfBackwardConnections());
  ev.setAllocatedResource(new AllocatedResource(DummyInstance.createDummyInstance(),null));
  return ev;
}
