{
  while (running) {
    ConsumerRecords<byte[],byte[]> consumed;
synchronized (fetcher) {
      consumed=fetcher.poll(pollTimeout);
    }
    final Iterator<ConsumerRecord<byte[],byte[]>> records=consumed.iterator();
    while (running && records.hasNext()) {
      ConsumerRecord<byte[],byte[]> record=records.next();
      T value=valueDeserializer.deserialize(record.value());
synchronized (sourceContext.getCheckpointLock()) {
        sourceContext.collect(value);
        lastOffsets[record.partition()]=record.offset();
      }
    }
  }
}
