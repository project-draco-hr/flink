{
synchronized (fetcher) {
    if (fetcher.subscriptions().isEmpty()) {
      fetcher.subscribe(partitions.toArray(new TopicPartition[partitions.size()]));
    }
 else {
      throw new IllegalStateException("Fetcher has already subscribed to its set of partitions");
    }
  }
}
