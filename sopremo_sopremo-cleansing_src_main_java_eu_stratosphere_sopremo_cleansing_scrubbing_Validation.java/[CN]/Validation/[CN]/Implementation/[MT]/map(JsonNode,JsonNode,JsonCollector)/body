{
  try {
    this.context.setContextNode(value);
    for (    final ValidationRule rule : this.rules) {
      final List<String> targetPath=rule.getTargetPath();
      if (targetPath.isEmpty()) {
        if (!rule.validate(value,this.context)) {
          this.context.setViolatedRule(rule);
          value=rule.fix(value,this.context);
        }
      }
 else {
        JsonNode parent=value;
        final int lastIndex=targetPath.size() - 1;
        for (int index=0; index < lastIndex; index++)         parent=parent.get(targetPath.get(index));
        final String lastSegment=targetPath.get(lastIndex);
        final JsonNode validationValue=parent.get(lastSegment);
        if (!rule.validate(validationValue,this.context)) {
          this.context.setViolatedRule(rule);
          ((ObjectNode)parent).put(lastSegment,rule.fix(validationValue,this.context));
        }
      }
    }
    out.collect(key,value);
  }
 catch (  final UnresolvableEvaluationException e) {
    if (SopremoUtil.LOG.isDebugEnabled())     SopremoUtil.LOG.debug(String.format("Cannot fix validation rule for tuple %s: %s",value,e.getMessage()));
  }
}
