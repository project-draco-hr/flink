{
  TypeInformation<T> inType=input.getType();
  TypeInformation<R> resultType=TypeExtractor.getUnaryOperatorReturnType(function,KeyedWindowFunction.class,true,true,inType,null,false);
  String callLocation=Utils.getCallLocationName();
  String udfName="MapWindow at " + callLocation;
  DataStream<R> result=createFastTimeOperatorIfValid(function,resultType,udfName);
  if (result != null) {
    return result;
  }
  String opName="TriggerWindow(" + windowAssigner + ", "+ trigger+ ", "+ udfName+ ")";
  KeySelector<T,K> keySel=input.getKeySelector();
  OneInputStreamOperator<T,R> operator;
  if (evictor != null) {
    operator=new EvictingWindowOperator<>(windowAssigner,keySel,new HeapWindowBuffer.Factory<T>(),function,trigger,evictor);
  }
 else {
    operator=new WindowOperator<>(windowAssigner,keySel,new HeapWindowBuffer.Factory<T>(),function,trigger);
  }
  return input.transform(opName,resultType,operator);
}
