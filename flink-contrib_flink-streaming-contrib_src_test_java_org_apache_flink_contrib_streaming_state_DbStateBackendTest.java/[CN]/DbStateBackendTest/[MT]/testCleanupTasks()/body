{
  String url="jdbc:derby://localhost:1527/" + tempDir.getAbsolutePath() + "/flinkDB1;create=true";
  DbBackendConfig conf=new DbBackendConfig("flink","flink",Lists.newArrayList(url,url));
  conf.setDbAdapterClass(DerbyAdapter.class);
  DbStateBackend backend1=new DbStateBackend(conf);
  DbStateBackend backend2=new DbStateBackend(conf);
  DbStateBackend backend3=new DbStateBackend(conf);
  DbStateBackend backend4=new DbStateBackend(conf);
  DbStateBackend backend5=new DbStateBackend(conf);
  backend1.initializeForJob(new DummyEnvironment("test",5,0));
  backend2.initializeForJob(new DummyEnvironment("test",5,1));
  backend3.initializeForJob(new DummyEnvironment("test",5,2));
  backend4.initializeForJob(new DummyEnvironment("test",5,3));
  backend5.initializeForJob(new DummyEnvironment("test",5,4));
  assertTrue(backend1.createKvState(1,"a",null,null,null).isCompacter());
  assertTrue(backend2.createKvState(1,"a",null,null,null).isCompacter());
  assertFalse(backend3.createKvState(1,"a",null,null,null).isCompacter());
  assertFalse(backend4.createKvState(1,"a",null,null,null).isCompacter());
  assertFalse(backend5.createKvState(1,"a",null,null,null).isCompacter());
}
