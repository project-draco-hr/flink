{
  final int dataVolumePerSubtaskInMB=getTaskConfiguration().getInteger(SpeedTest.DATA_VOLUME_CONFIG_KEY,1) * 1024 / getCurrentNumberOfSubtasks();
  final long numberOfRecordsToEmit=(long)dataVolumePerSubtaskInMB * 1024L * 1024L / (long)SpeedTestRecord.RECORD_SIZE;
  final SpeedTestRecord record=SpeedTestRecord.create();
  for (long i=0; i < numberOfRecordsToEmit; ++i) {
    this.writer.emit(record);
  }
}
