{
  if (coordinatorUnknown())   return RequestFuture.coordinatorNotAvailable();
  if (offsets.isEmpty())   return RequestFuture.voidSuccess();
  Map<TopicPartition,OffsetCommitRequest.PartitionData> offsetData;
  offsetData=new HashMap<TopicPartition,OffsetCommitRequest.PartitionData>(offsets.size());
  for (  Map.Entry<TopicPartition,Long> entry : offsets.entrySet())   offsetData.put(entry.getKey(),new OffsetCommitRequest.PartitionData(entry.getValue(),""));
  OffsetCommitRequest req=new OffsetCommitRequest(this.groupId,this.generation,this.consumerId,OffsetCommitRequest.DEFAULT_RETENTION_TIME,offsetData);
  return client.send(consumerCoordinator,ApiKeys.OFFSET_COMMIT,req).compose(new OffsetCommitResponseHandler(offsets));
}
