{
  @SuppressWarnings("unchecked") OutputEmitter oe1=new OutputEmitter(ShipStrategy.PARTITION_HASH,new int[]{0},new Class[]{PactDouble.class});
  PipedInputStream pipedInput=new PipedInputStream(1024 * 1024);
  DataInputStream in=new DataInputStream(pipedInput);
  DataOutputStream out;
  PactRecord rec=null;
  try {
    out=new DataOutputStream(new PipedOutputStream(pipedInput));
    rec=new PactRecord(1);
    rec.setField(0,new PactInteger());
    rec.write(out);
    rec=new PactRecord();
    rec.read(in);
  }
 catch (  IOException e) {
    fail("Test erroneous");
  }
  boolean correctException=false;
  try {
    oe1.selectChannels(rec,100);
  }
 catch (  RuntimeException re) {
    if (re.getMessage().equals("Key field 0 of type 'eu.stratosphere.pact.common.type.base.PactDouble' could not be deserialized."))     correctException=true;
  }
  assertTrue(correctException);
}
