{
  FileDataSource input=new FileDataSource(new ContractITCaseInputFormat(),inputPath);
  MapOperator testMapper=MapOperator.builder(FailingMapper.class).build();
  FileDataSink output=new FileDataSink(new ContractITCaseOutputFormat(),resultPath);
  output.setInput(testMapper);
  testMapper.setInput(input);
  Plan plan=new Plan(output);
  plan.setDefaultParallelism(4);
  PactCompiler pc=new PactCompiler(new DataStatistics());
  OptimizedPlan op=pc.compile(plan);
  NepheleJobGraphGenerator jgg=new NepheleJobGraphGenerator();
  return jgg.compileJobGraph(op);
}
