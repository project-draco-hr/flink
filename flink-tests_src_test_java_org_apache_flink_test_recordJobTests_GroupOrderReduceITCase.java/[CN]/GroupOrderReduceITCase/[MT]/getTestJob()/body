{
  int parallelism=this.config.getInteger("GroupOrderTest#NumSubtasks",1);
  @SuppressWarnings("unchecked") CsvInputFormat format=new CsvInputFormat(',',IntValue.class,IntValue.class);
  FileDataSource source=new FileDataSource(format,this.textPath,"Source");
  ReduceOperator reducer=ReduceOperator.builder(CheckingReducer.class).keyField(IntValue.class,0).input(source).name("Ordered Reducer").build();
  reducer.setGroupOrder(new Ordering(1,IntValue.class,Order.ASCENDING));
  FileDataSink sink=new FileDataSink(CsvOutputFormat.class,this.resultPath,reducer,"Sink");
  CsvOutputFormat.configureRecordFormat(sink).recordDelimiter('\n').fieldDelimiter(',').field(IntValue.class,0).field(IntValue.class,1);
  Plan p=new Plan(sink);
  p.setDefaultParallelism(parallelism);
  return p;
}
