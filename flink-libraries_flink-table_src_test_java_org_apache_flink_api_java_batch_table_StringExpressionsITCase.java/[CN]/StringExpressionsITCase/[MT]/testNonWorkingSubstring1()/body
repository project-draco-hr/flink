{
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  BatchTableEnvironment tableEnv=TableEnvironment.getTableEnvironment(env);
  DataSet<Tuple2<String,Float>> ds=env.fromElements(new Tuple2<>("ABCD",2.0f),new Tuple2<>("ABCD",1.0f));
  Table in=tableEnv.fromDataSet(ds,"a, b");
  Table result=in.select("a.substring(0, b)");
  DataSet<Row> resultSet=tableEnv.toDataSet(result,Row.class);
  resultSet.collect();
}
