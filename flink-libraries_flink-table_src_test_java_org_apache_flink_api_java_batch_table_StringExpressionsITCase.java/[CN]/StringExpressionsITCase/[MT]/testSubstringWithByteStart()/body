{
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  BatchTableEnvironment tableEnv=TableEnvironment.getTableEnvironment(env);
  DataSet<Tuple2<String,Byte>> ds=env.fromElements(new Tuple2<>("AAAA",(byte)2),new Tuple2<>("BBBB",(byte)1));
  Table in=tableEnv.fromDataSet(ds,"a, b");
  Table result=in.select("a.substring(1, b)");
  DataSet<Row> resultSet=tableEnv.toDataSet(result,Row.class);
  List<Row> results=resultSet.collect();
  String expected="AA\nB";
  compareResultAsText(results,expected);
}
