{
  long millis=source.readLong();
  if (millis == IS_WATERMARK) {
    return new Watermark(source.readLong());
  }
 else {
    T element=typeSerializer.deserialize(source);
    return new StreamRecord<T>(element,millis);
  }
}
