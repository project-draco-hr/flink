{
  if (value instanceof StreamRecord) {
    StreamRecord<T> record=(StreamRecord<T>)value;
    target.writeLong(record.getTimestamp());
    typeSerializer.serialize(record.getValue(),target);
  }
 else   if (value instanceof Watermark) {
    target.writeLong(IS_WATERMARK);
    target.writeLong(((Watermark)value).getTimestamp());
  }
}
