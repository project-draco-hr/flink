{
  if (from.isRecord()) {
    StreamRecord<T> fromRecord=from.asRecord();
    return new StreamRecord<T>(typeSerializer.copy(fromRecord.getValue()),fromRecord.getTimestamp());
  }
 else   if (from.isWatermark()) {
    return from;
  }
 else {
    throw new RuntimeException("Cannot copy " + from);
  }
}
