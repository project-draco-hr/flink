{
  if (from instanceof StreamRecord) {
    StreamRecord<T> fromRecord=(StreamRecord<T>)from;
    return new StreamRecord<T>(typeSerializer.copy(fromRecord.getValue()),fromRecord.getTimestamp());
  }
 else   if (from instanceof Watermark) {
    return from;
  }
 else {
    throw new RuntimeException("Cannot copy " + from);
  }
}
