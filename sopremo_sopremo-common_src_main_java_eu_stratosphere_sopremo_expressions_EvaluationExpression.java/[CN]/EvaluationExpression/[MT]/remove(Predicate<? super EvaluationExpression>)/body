{
  final EvaluationExpression REMOVED=new UnevaluableExpression("Removed value");
  final EvaluationExpression taggedValues=this.transformRecursively(new TransformFunction(){
    @Override public EvaluationExpression call(    final EvaluationExpression evaluationExpression){
      if (predicate.isTrue(evaluationExpression))       return REMOVED;
      if (evaluationExpression instanceof ContainerExpression) {
        final List<EvaluationExpression> children=new IdentityList<EvaluationExpression>();
        children.addAll(((ContainerExpression)evaluationExpression).getChildren());
        children.removeAll(Arrays.asList(REMOVED));
        ((ContainerExpression)evaluationExpression).setChildren(children);
      }
      return evaluationExpression;
    }
  }
);
  return taggedValues.replace(new IsSamePredicate(REMOVED),VALUE);
}
