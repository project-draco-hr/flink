{
  SopremoTestPlan sopremoPlan=new SopremoTestPlan(1,1);
  ObjectCreation transformation=new ObjectCreation();
  transformation.addMapping("d",createPath("dept","[0]"));
  transformation.addMapping("total",new FunctionCall("sum",createPath("[*]","income")));
  sopremoPlan.getOutputOperator(0).setInputs(new Aggregation(transformation,Arrays.asList(createPath("dept")),sopremoPlan.getInputOperator(0)));
  sopremoPlan.getInput(0).add(createJsonObject("id",1,"dept",1,"income",12000)).add(createJsonObject("id",2,"dept",1,"income",13000)).add(createJsonObject("id",3,"dept",2,"income",15000)).add(createJsonObject("id",4,"dept",1,"income",10000)).add(createJsonObject("id",5,"dept",3,"income",8000)).add(createJsonObject("id",6,"dept",2,"income",5000)).add(createJsonObject("id",7,"dept",1,"income",24000));
  sopremoPlan.getExpectedOutput(0).add(createJsonObject("d",1,"total",59000)).add(createJsonObject("d",2,"total",20000)).add(createJsonObject("d",3,"total",8000));
  sopremoPlan.run();
}
