{
  Class<InputFormat<?>> clazz=(Class<InputFormat<?>>)((GenericDataSource<? extends InputFormat<?>>)getPactContract()).getFormatClass();
  InputFormat<?> inputFormat;
  try {
    inputFormat=clazz.newInstance();
    if (inputFormat instanceof OutputSchemaProvider) {
      inputFormat.configure(getPactContract().getParameters());
      this.outputSchema=((OutputSchemaProvider)inputFormat).getOutputSchema();
      return;
    }
 else {
      this.outputSchema=null;
      return;
    }
  }
 catch (  InstantiationException e) {
    e.printStackTrace();
  }
catch (  IllegalAccessException e) {
    e.printStackTrace();
  }
}
