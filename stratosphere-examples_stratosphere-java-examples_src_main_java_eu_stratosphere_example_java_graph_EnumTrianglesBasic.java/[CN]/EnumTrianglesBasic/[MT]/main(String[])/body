{
  if (!parseParameters(args)) {
    return;
  }
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<Edge> edges=getEdgeDataSet(env);
  DataSet<Edge> edgesById=edges.map(new EdgeByIdProjector());
  DataSet<Triad> triangles=edgesById.groupBy(Edge.V1).sortGroup(Edge.V2,Order.ASCENDING).reduceGroup(new TriadBuilder()).join(edgesById).where(Triad.V2,Triad.V3).equalTo(Edge.V1,Edge.V2).with(new TriadFilter());
  if (fileOutput) {
    triangles.writeAsCsv(outputPath,"\n",",");
  }
 else {
    triangles.print();
  }
  env.execute("Basic Triangle Enumeration Example");
}
