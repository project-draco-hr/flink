{
  for (  List<NamedChannel> broadcastChannelsCombination : Sets.cartesianProduct(broadcastPlanChannels)) {
    for (    NamedChannel nc : broadcastChannelsCombination) {
      PlanNode bcSource=nc.getSource();
      PlanNode inputSource=in.getSource();
      if (!areBranchCompatible(bcSource,inputSource)) {
        return;
      }
    }
    final SingleInputPlanNode node=dps.instantiate(in,this);
    node.setBroadcastInputs(broadcastChannelsCombination);
    GlobalProperties gProps=in.getGlobalProperties().clone();
    LocalProperties lProps=in.getLocalProperties().clone();
    gProps=dps.computeGlobalProperties(gProps);
    lProps=dps.computeLocalProperties(lProps);
    gProps=gProps.filterByNodesConstantSet(this,0);
    lProps=lProps.filterByNodesConstantSet(this,0);
    node.initProperties(gProps,lProps);
    node.updatePropertiesWithUniqueSets(getUniqueFields());
    target.add(node);
  }
}
