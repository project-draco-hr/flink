{
  try {
    CoGroupOperator coGroupOp=CoGroupOperator.builder(TestCoGroupFunction.class,LongValue.class,1,2).build();
    UserCodeWrapper<org.apache.flink.api.common.functions.CoGroupFunction<Record,Record,Record>> udf=coGroupOp.getUserCodeWrapper();
    UserCodeWrapper<org.apache.flink.api.common.functions.CoGroupFunction<Record,Record,Record>> copy=SerializationUtils.clone(udf);
    org.apache.flink.api.common.functions.CoGroupFunction<Record,Record,Record> cogrouper=copy.getUserCodeObject();
    final List<Record> target=new ArrayList<Record>();
    Collector<Record> collector=new Collector<Record>(){
      @Override public void collect(      Record record){
        target.add(record);
      }
      @Override public void close(){
      }
    }
;
    List<Record> source1=new ArrayList<Record>();
    source1.add(new Record(new IntValue(42)));
    source1.add(new Record(new IntValue(13)));
    List<Record> source2=new ArrayList<Record>();
    source2.add(new Record(new LongValue(11)));
    source2.add(new Record(new LongValue(17)));
    cogrouper.coGroup(source1,source2,collector);
    assertEquals(4,target.size());
    assertEquals(new IntValue(42),target.get(0).getField(0,IntValue.class));
    assertEquals(new IntValue(13),target.get(1).getField(0,IntValue.class));
    assertEquals(new LongValue(11),target.get(2).getField(0,LongValue.class));
    assertEquals(new LongValue(17),target.get(3).getField(0,LongValue.class));
    target.clear();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
