{
  this.deserializer=deserializer;
  this.memoryManager=memoryManager;
  emptySegments=new LinkedBlockingQueue<MemorySegment>();
  filledBuffers=new LinkedBlockingQueue<Buffer.Input>();
  buffers=new ArrayList<MemorySegment>(nrOfBuffers);
  for (int i=0; i < nrOfBuffers; ++i)   buffers.add(memoryManager.allocate(ownerTask,availableMemory / nrOfBuffers));
  emptySegments.addAll(buffers);
  blockFetcher=new BlockFetcher<T>(emptySegments,filledBuffers,reader);
  LOG.debug("Iterator initalized using " + availableMemory + " bytes of IO buffer.");
}
