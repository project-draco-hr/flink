{
  if (nrOfBuffers < 1) {
    throw new IllegalArgumentException("BlockResettableIterator needs at least one element.");
  }
  if (availableMemory < MIN_BUFFER_SIZE) {
    throw new IllegalArgumentException("Block Resettable iterator requires at leat " + MIN_BUFFER_SIZE + " bytes of memory.");
  }
  this.reader=reader;
  this.memoryManager=memoryManager;
  this.deserializer=deserializer;
  this.emptySegments=this.memoryManager.allocate(ownerTask,availableMemory,nrOfBuffers,MIN_BUFFER_SIZE);
  this.fullBuffers=new ArrayList<Buffer.Input>();
  this.consumedBuffers=new ArrayList<Buffer.Input>();
  LOG.debug("Iterator initalized using " + availableMemory + " bytes of IO buffer.");
}
