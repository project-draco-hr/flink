{
  if (compressionLibraries.containsKey(compressionLevel)) {
    return;
  }
  String keySuffix=null;
switch (compressionLevel) {
case LIGHT_COMPRESSION:
    keySuffix="lightClass";
  break;
case MEDIUM_COMPRESSION:
keySuffix="mediumClass";
break;
case HEAVY_COMPRESSION:
keySuffix="heavyClass";
break;
case DYNAMIC_COMPRESSION:
keySuffix="dynamicClass";
break;
}
if (keySuffix == null) {
throw new RuntimeException("Cannot find keySuffix for compression level " + compressionLevel);
}
final String key="channel.compression." + keySuffix;
final String libraryClass=GlobalConfiguration.getString(key,null);
if (libraryClass == null) {
throw new RuntimeException("No library class for compression Level " + compressionLevel + " configured");
}
if (LOG.isDebugEnabled()) {
LOG.debug("Trying to load compression library " + libraryClass);
}
final CompressionLibrary compressionLibrary=initCompressionLibrary(libraryClass);
if (compressionLibrary == null) {
throw new RuntimeException("Cannot load " + libraryClass);
}
compressionLibraries.put(compressionLevel,compressionLibrary);
}
