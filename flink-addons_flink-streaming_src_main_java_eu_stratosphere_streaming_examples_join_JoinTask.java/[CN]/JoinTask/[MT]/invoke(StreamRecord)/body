{
  String streamId=record.getString(0);
  String name=record.getString(1);
  if (streamId.equals("grade")) {
    if (salaryHashmap.containsKey(name)) {
      for (      Integer salary : salaryHashmap.get(name)) {
        Tuple3<String,String,Integer> outputTuple=new Tuple3<String,String,Integer>(name,record.getString(2),salary);
        outRecord.addTuple(outputTuple);
      }
      emit(outRecord);
      outRecord.Clear();
    }
    if (!gradeHashmap.containsKey(name)) {
      gradeHashmap.put(name,new ArrayList<String>());
    }
    gradeHashmap.get(name).add(record.getString(2));
  }
 else {
    if (gradeHashmap.containsKey(name)) {
      for (      String grade : gradeHashmap.get(name)) {
        Tuple3<String,String,Integer> outputTuple=new Tuple3<String,String,Integer>(name,grade,record.getInteger(2));
        outRecord.addTuple(outputTuple);
      }
      emit(outRecord);
      outRecord.Clear();
    }
    if (!salaryHashmap.containsKey(name)) {
      salaryHashmap.put(name,new ArrayList<Integer>());
    }
    salaryHashmap.get(name).add(record.getInteger(2));
  }
}
