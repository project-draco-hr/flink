{
  MockRecordWriter recWriter=MockRecordWriterFactory.create();
  StreamCollector<Tuple1<Integer>> collector=new StreamCollector<Tuple1<Integer>>(2,new SerializationDelegate<StreamRecord<Tuple1<Integer>>>(null));
  collector.addOutput(recWriter,new ArrayList<String>());
  collector.collect(new Tuple1<Integer>(3));
  collector.collect(new Tuple1<Integer>(4));
  collector.collect(new Tuple1<Integer>(5));
  collector.collect(new Tuple1<Integer>(6));
  assertArrayEquals(new Integer[]{3,4,5,6},recWriter.emittedRecords.toArray());
}
