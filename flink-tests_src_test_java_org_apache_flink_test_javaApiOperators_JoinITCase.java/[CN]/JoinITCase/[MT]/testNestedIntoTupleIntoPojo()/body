{
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<POJO> ds1=CollectionDataSets.getSmallPojoDataSet(env);
  DataSet<Tuple7<Integer,String,Integer,Integer,Long,String,Long>> ds2=CollectionDataSets.getSmallTuplebasedDataSet(env);
  DataSet<Tuple2<POJO,Tuple7<Integer,String,Integer,Integer,Long,String,Long>>> joinDs=ds1.join(ds2).where("nestedTupleWithCustom.f0","nestedTupleWithCustom.f1.myInt","nestedTupleWithCustom.f1.myLong").equalTo("f2","f3","f4");
  joinDs.writeAsCsv(resultPath);
  env.setDegreeOfParallelism(1);
  env.execute();
  expected="1 First (10,100,1000,One) 10000,(1,First,10,100,1000,One,10000)\n" + "2 Second (20,200,2000,Two) 20000,(2,Second,20,200,2000,Two,20000)\n" + "3 Third (30,300,3000,Three) 30000,(3,Third,30,300,3000,Three,30000)\n";
}
