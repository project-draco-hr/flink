{
  if (nameNode == null) {
    return;
  }
  InetSocketAddress addr=new InetSocketAddress("localhost",getNameNodePort());
  DFSClient client=new DFSClient(addr,conf);
  while (client.datanodeReport(DatanodeReportType.LIVE).length != numDataNodes) {
    try {
      Thread.sleep(500);
    }
 catch (    Exception e) {
    }
  }
  client.close();
}
