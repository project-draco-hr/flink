{
  Random random=new Random();
  boolean corrupted=false;
  File dataDir=new File(System.getProperty("test.build.data","build/test/data"),"dfs/data");
  if (i < 0 || i >= dataNodes.size())   return false;
  for (int dn=i * 2; dn < i * 2 + 2; dn++) {
    File blockFile=new File(dataDir,"data" + (dn + 1) + "/current/"+ blockName);
    System.out.println("Corrupting for: " + blockFile);
    if (blockFile.exists()) {
      RandomAccessFile raFile=new RandomAccessFile(blockFile,"rw");
      FileChannel channel=raFile.getChannel();
      String badString="BADBAD";
      int rand=random.nextInt((int)channel.size() / 2);
      raFile.seek(rand);
      raFile.write(badString.getBytes());
      raFile.close();
    }
    corrupted=true;
  }
  return corrupted;
}
