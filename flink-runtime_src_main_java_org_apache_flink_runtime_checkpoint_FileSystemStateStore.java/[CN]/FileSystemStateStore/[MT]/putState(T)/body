{
  Exception latestException=null;
  for (int attempt=0; attempt < 10; attempt++) {
    Path filePath=new Path(rootPath,FileUtils.getRandomFilename(prefix));
    FSDataOutputStream outStream;
    try {
      outStream=fileSystem.create(filePath,false);
    }
 catch (    Exception e) {
      latestException=e;
      continue;
    }
    try (ObjectOutputStream os=new ObjectOutputStream(outStream)){
      os.writeObject(state);
    }
     return filePath.toString();
  }
  throw new IOException("Failed to open file output stream",latestException);
}
