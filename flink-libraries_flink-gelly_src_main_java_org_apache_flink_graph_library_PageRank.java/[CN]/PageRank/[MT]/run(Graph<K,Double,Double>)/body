{
  if (numberOfVertices == 0) {
    numberOfVertices=network.numberOfVertices();
  }
  DataSet<Tuple2<K,Long>> vertexOutDegrees=network.outDegrees();
  Graph<K,Double,Double> networkWithWeights=network.joinWithEdgesOnSource(vertexOutDegrees,new InitWeights());
  return networkWithWeights.runScatterGatherIteration(new VertexRankUpdater<K>(beta,numberOfVertices),new RankMessenger<K>(numberOfVertices),maxIterations).getVertices();
}
