{
  DataSet<Tuple2<K,Long>> vertexOutDegrees=network.outDegrees();
  Graph<K,Double,Double> networkWithWeights=network.joinWithEdgesOnSource(vertexOutDegrees,new InitWeights());
  ScatterGatherConfiguration parameters=new ScatterGatherConfiguration();
  parameters.setOptNumVertices(true);
  return networkWithWeights.runScatterGatherIteration(new VertexRankUpdater<K>(beta),new RankMessenger<K>(),maxIterations,parameters).getVertices();
}
