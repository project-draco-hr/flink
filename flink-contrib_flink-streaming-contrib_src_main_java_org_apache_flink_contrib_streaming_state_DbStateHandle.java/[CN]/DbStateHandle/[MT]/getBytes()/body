{
  return retry(new Callable<byte[]>(){
    public byte[] call() throws Exception {
      try (ShardedConnection con=dbConfig.createShardedConnection()){
        return dbConfig.getDbAdapter().getCheckpoint(appId,con.getFirst(),checkpointId,checkpointTs,handleId);
      }
     }
  }
,dbConfig.getMaxNumberOfSqlRetries(),dbConfig.getSleepBetweenSqlRetries());
}
