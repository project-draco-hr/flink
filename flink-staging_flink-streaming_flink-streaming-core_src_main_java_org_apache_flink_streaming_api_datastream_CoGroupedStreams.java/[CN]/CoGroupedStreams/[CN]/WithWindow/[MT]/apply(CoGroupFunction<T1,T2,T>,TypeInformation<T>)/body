{
  function=input1.getExecutionEnvironment().clean(function);
  DataStream<TaggedUnion<T1,T2>> taggedInput1=input1.map(new Input1Tagger<T1,T2>()).returns(new UnionTypeInfo<>(input1.getType(),input2.getType()));
  DataStream<TaggedUnion<T1,T2>> taggedInput2=input2.map(new Input2Tagger<T1,T2>()).returns(new UnionTypeInfo<>(input1.getType(),input2.getType()));
  WindowedStream<TaggedUnion<T1,T2>,KEY,W> windowOp=taggedInput1.union(taggedInput2).keyBy(new UnionKeySelector<>(keySelector1,keySelector2)).window(windowAssigner);
  if (trigger != null) {
    windowOp.trigger(trigger);
  }
  if (evictor != null) {
    windowOp.evictor(evictor);
  }
  return windowOp.apply(new CoGroupWindowFunction<T1,T2,T,KEY,W>(function),resultType);
}
