{
  try {
    final BufferedReader in=new BufferedReader(new FileReader("/proc/net/dev"));
    long receivedSum=0;
    long transmittedSum=0;
    String output;
    while ((output=in.readLine()) != null) {
      final Matcher networkMatcher=NETWORK_PATTERN.matcher(output);
      if (!networkMatcher.matches()) {
        continue;
      }
      receivedSum+=Long.parseLong(networkMatcher.group(1));
      transmittedSum+=Long.parseLong(networkMatcher.group(2));
    }
    in.close();
    long received=receivedSum - this.lastReceivedBytes;
    long transmitted=transmittedSum - this.lastTramsmittedBytes;
    received/=(timestamp - this.lastTimestamp);
    transmitted/=(timestamp - this.lastTimestamp);
    received*=1000;
    transmitted*=1000;
    received/=(1024 * 1024 / 8);
    transmitted/=(1024 * 1024 / 8);
    if (writer != null) {
      writer.write(transmitted + "\t" + received+ "\n");
    }
    this.lastReceivedBytes=receivedSum;
    this.lastTramsmittedBytes=transmittedSum;
  }
 catch (  NumberFormatException nfe) {
    throw new IOException("Error while reading network utilization: " + StringUtils.stringifyException(nfe));
  }
}
