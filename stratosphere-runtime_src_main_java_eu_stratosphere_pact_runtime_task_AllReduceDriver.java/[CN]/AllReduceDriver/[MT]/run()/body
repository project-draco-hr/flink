{
  if (LOG.isDebugEnabled()) {
    LOG.debug(this.taskContext.formatLogString("AllReduce preprocessing done. Running Reducer code."));
  }
  final GenericReduce<T> stub=this.taskContext.getStub();
  final Collector<T> output=this.taskContext.getOutputCollector();
  final MutableToRegularIteratorWrapper<T> inIter=new MutableToRegularIteratorWrapper<T>(this.input,this.serializer);
  T curr=inIter.next();
  while (running & inIter.hasNext()) {
    curr=stub.reduce(curr,inIter.next());
  }
  output.collect(curr);
}
