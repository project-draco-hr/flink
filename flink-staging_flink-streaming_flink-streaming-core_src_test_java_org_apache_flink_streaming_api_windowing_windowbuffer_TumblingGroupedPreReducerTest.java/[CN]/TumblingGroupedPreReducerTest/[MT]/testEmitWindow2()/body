{
  List<Tuple2<Integer,Integer>> inputs=new ArrayList<Tuple2<Integer,Integer>>();
  inputs.add(new Tuple2<Integer,Integer>(1,1));
  inputs.add(new Tuple2<Integer,Integer>(0,0));
  inputs.add(new Tuple2<Integer,Integer>(1,-1));
  inputs.add(new Tuple2<Integer,Integer>(1,-2));
  TestCollector<StreamWindow<Tuple2<Integer,Integer>>> collector=new TestCollector<StreamWindow<Tuple2<Integer,Integer>>>();
  List<StreamWindow<Tuple2<Integer,Integer>>> collected=collector.getCollected();
  WindowBuffer<Tuple2<Integer,Integer>> wb=new TumblingGroupedPreReducer<Tuple2<Integer,Integer>>(reducer,key,serializer).sequentialID();
  wb.store(serializer.copy(inputs.get(0)));
  wb.store(serializer.copy(inputs.get(1)));
  wb.emitWindow(collector);
  assertSetEquals(StreamWindow.fromElements(inputs.get(0),inputs.get(1)),collected.get(0));
  wb.store(serializer.copy(inputs.get(0)));
  wb.store(serializer.copy(inputs.get(1)));
  wb.store(serializer.copy(inputs.get(2)));
  wb.emitWindow(collector);
  assertSetEquals(StreamWindow.fromElements(new Tuple2<Integer,Integer>(2,0),inputs.get(1)),collected.get(1));
}
