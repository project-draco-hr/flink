{
  if (id == null) {
    throw new IllegalArgumentException("Argument id is null");
  }
  if (task == null) {
    throw new IllegalArgumentException("Argument task is null");
  }
synchronized (this.runningTasks) {
    if (this.runningTasks.containsKey(id)) {
      LOG.debug("Task with ID " + id + " is already running");
      TaskSubmissionResult result=new TaskSubmissionResult(id,AbstractTaskResult.ReturnCode.ERROR);
      result.setDescription("Task with ID " + id + " is already running");
      return result;
    }
  }
  final RuntimeEnvironment ee=task.getEnvironment();
  this.byteBufferedChannelManager.register(task,activeOutputChannels);
  boolean enableProfiling=false;
  if (this.profiler != null && jobConfiguration.getBoolean(ProfilingUtils.PROFILE_JOB_KEY,true)) {
    enableProfiling=true;
  }
  if (enableProfiling) {
    this.profiler.registerExecutionListener(task,jobConfiguration);
    for (int i=0; i < ee.getNumberOfInputGates(); i++) {
      this.profiler.registerInputGateListener(id,jobConfiguration,ee.getInputGate(i));
    }
    for (int i=0; i < ee.getNumberOfOutputGates(); i++) {
      this.profiler.registerOutputGateListener(id,jobConfiguration,ee.getOutputGate(i));
    }
  }
  if (!this.taskManagerPlugins.isEmpty()) {
    final Iterator<TaskManagerPlugin> it=this.taskManagerPlugins.values().iterator();
    while (it.hasNext()) {
      it.next().registerTask(id,jobConfiguration,ee);
    }
  }
  return null;
}
