{
  this.byteBufferedChannelManager.unregister(id,environment);
  if (this.profiler != null) {
    this.profiler.unregisterOutputGateListeners(id);
    this.profiler.unregisterInputGateListeners(id);
    this.profiler.unregisterExecutionListener(id);
  }
  if (this.memoryManager != null) {
    this.memoryManager.releaseAll(environment.getInvokable());
  }
  int numberOfVerticesBelongingToThisJob=0;
synchronized (this.runningTasks) {
    final Iterator<Environment> iterator=this.runningTasks.values().iterator();
    while (iterator.hasNext()) {
      final Environment candidateEnvironment=iterator.next();
      if (environment.getJobID().equals(candidateEnvironment.getJobID())) {
        numberOfVerticesBelongingToThisJob++;
      }
    }
  }
  if (numberOfVerticesBelongingToThisJob == 0) {
    try {
      LibraryCacheManager.unregister(environment.getJobID());
    }
 catch (    IOException e) {
      LOG.debug("Unregistering the job vertex ID " + id + " caused an IOException");
    }
  }
}
