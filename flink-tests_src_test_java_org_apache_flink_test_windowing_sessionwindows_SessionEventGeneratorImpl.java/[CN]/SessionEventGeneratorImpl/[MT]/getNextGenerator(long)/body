{
  StreamConfiguration streamConfiguration=configuration.getStreamConfiguration();
  SessionConfiguration<K,E> sessionConfiguration=configuration.getSessionConfiguration();
  long maxAdditionalGap=streamConfiguration.getMaxAdditionalSessionGap();
  long nextStartTime=Math.max(getAfterLatenessTimestamp() + randomGenerator.randomLongBetween(0,maxAdditionalGap),globalWatermark);
  sessionConfiguration=configuration.getSessionConfiguration().getFollowupSessionConfiguration(nextStartTime);
  SessionStreamConfiguration<K,E> sessionStreamConfiguration=new SessionStreamConfiguration<>(sessionConfiguration,streamConfiguration);
  return new SessionEventGeneratorImpl<>(sessionStreamConfiguration,randomGenerator);
}
