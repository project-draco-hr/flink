{
  Environment env=task.getEnvironment();
  int numBuffers=this.globalBufferPool.numBuffers();
  int numChannels=this.channels.size() + env.getNumberOfOutputChannels() + env.getNumberOfInputChannels();
  if (numChannels > 0 && numBuffers / numChannels < 1) {
    String msg=String.format("%s has not enough buffers to safely execute %s (%d buffers missing)",this.connectionInfo.getFQDNHostname(),env.getTaskName(),numChannels - numBuffers);
    throw new InsufficientResourcesException(msg);
  }
}
