{
  this.channelLookup=channelLookup;
  this.connectionInfo=connectionInfo;
  try {
    this.globalBufferPool=new GlobalBufferPool(numNetworkBuffers,networkBufferSize);
  }
 catch (  Throwable e) {
    throw new IOException("Failed to instantiate GlobalBufferPool.",e);
  }
  this.networkConnectionManager=networkConnectionManager;
  networkConnectionManager.start(this);
  this.channels=new ConcurrentHashMap<ChannelID,Channel>();
  this.receiverCache=new ConcurrentHashMap<ChannelID,EnvelopeReceiverList>();
  this.localBuffersPools=new ConcurrentHashMap<AbstractID,LocalBufferPoolOwner>();
  this.ourAddress=new InetSocketAddress(connectionInfo.address(),connectionInfo.dataPort());
  this.discardBufferPool=new DiscardBufferPool();
}
