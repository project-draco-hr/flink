{
  toRemove+=n;
  Integer lastPreAggregateSize=elementsPerPreAggregate.peek();
  while (lastPreAggregateSize != null && lastPreAggregateSize <= toRemove) {
    toRemove=max(toRemove - elementsPerPreAggregate.removeFirst(),0);
    removeLastReduced();
    lastPreAggregateSize=elementsPerPreAggregate.peek();
  }
  if (lastPreAggregateSize == null) {
    toRemove=0;
  }
}
