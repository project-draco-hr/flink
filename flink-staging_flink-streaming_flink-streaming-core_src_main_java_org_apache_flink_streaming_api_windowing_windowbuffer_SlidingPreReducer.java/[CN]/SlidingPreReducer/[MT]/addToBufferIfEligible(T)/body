{
  if (addCurrentToReduce(element) && currentReduced != null) {
    reduced.add(currentReduced);
    elementsPerPreAggregate.add(elementsSinceLastPreAggregate);
    currentReduced=element;
    elementsSinceLastPreAggregate=1;
  }
 else {
    if (currentReduced == null) {
      currentReduced=element;
    }
 else {
      currentReduced=reducer.reduce(serializer.copy(currentReduced),element);
    }
    elementsSinceLastPreAggregate++;
  }
}
