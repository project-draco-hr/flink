{
  LOG.debug("Performing merge of " + channelIDs.size() + " sorted streams.");
  final List<Iterator<KeyValuePair<K,V>>> iterators=new ArrayList<Iterator<KeyValuePair<K,V>>>(channelIDs.size());
  for (int i=0; i < channelIDs.size(); i++) {
    final Channel.ID id=channelIDs.get(i);
    final List<MemorySegment> segsForChannel=inputSegments.get(i);
    final ChannelReader reader=ioManager.createChannelReader(id,segsForChannel,true);
    readerList.add(reader);
    final Iterator<KeyValuePair<K,V>> iterator=new KVReaderIterator<K,V>(reader,keySerialization,valueSerialization);
    iterators.add(iterator);
  }
  return new MergeIterator<K,V>(iterators,keyComparator);
}
