{
  if (LOG.isDebugEnabled())   LOG.debug("Performing merge of " + channelIDs.size() + " sorted streams.");
  final List<ChannelReaderInputView> inViews=new ArrayList<ChannelReaderInputView>(channelIDs.size());
  for (int i=0; i < channelIDs.size(); i++) {
    final Channel.ID id=channelIDs.get(i);
    final List<MemorySegment> segsForChannel=inputSegments.get(i);
    final BlockChannelReader reader=this.ioManager.createBlockChannelReader(id);
    readerList.add(reader);
    registerOpenChannelToBeRemovedAtShudown(reader);
    unregisterChannelToBeRemovedAtShudown(id);
    final ChannelReaderInputView inView=new ChannelReaderInputView(reader,segsForChannel,false);
    inViews.add(inView);
  }
  final List<MutableObjectIterator<PactRecord>> iterators=new ArrayList<MutableObjectIterator<PactRecord>>(channelIDs.size());
  for (int i=0; i < inViews.size(); i++) {
    final ChannelReaderInputView inView=inViews.get(i);
    inView.waitForFirstBlock();
    iterators.add(new ChannelReaderIterator(inView));
  }
  return new MergeIterator(iterators,this.keyComparators,this.keyPositions,this.keyClasses);
}
