{
  boolean alive=true;
  while (isRunning() && alive) {
    CircularElement element=null;
    try {
      element=queues.sort.take();
    }
 catch (    InterruptedException iex) {
      if (isRunning()) {
        if (LOG.isErrorEnabled())         LOG.error("Sorting thread was interrupted (without being shut down) while grabbing a buffer. " + "Retrying to grab buffer...");
        continue;
      }
 else {
        return;
      }
    }
    if (element != SENTINEL && element != SPILLING_MARKER) {
      if (LOG.isDebugEnabled())       LOG.debug("Sorting buffer " + element.id + ".");
      sorter.sort(element.buffer);
      if (LOG.isDebugEnabled())       LOG.debug("Sorted buffer " + element.id + ".");
    }
 else     if (element == SENTINEL) {
      if (LOG.isDebugEnabled())       LOG.debug("Sorting thread done.");
      alive=false;
    }
    queues.spill.add(element);
  }
}
