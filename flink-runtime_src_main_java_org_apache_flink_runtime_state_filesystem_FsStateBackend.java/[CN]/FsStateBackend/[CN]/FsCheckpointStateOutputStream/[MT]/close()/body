{
synchronized (this) {
    if (!closed) {
      closed=true;
      try {
        outStream.close();
        fs.delete(filePath,false);
        try {
          fs.delete(filePath.getParent(),false);
        }
 catch (        IOException ignored) {
        }
      }
 catch (      Exception e) {
        LOG.warn("Cannot delete closed and discarded state stream to " + filePath,e);
      }
    }
  }
}
