{
  this.copy1=this.serializer1.copy(firstV1,this.copy1);
  this.blockHeadCopy=this.serializer2.copy(firstV2,this.blockHeadCopy);
  matchFunction.join(this.copy1,firstV2,collector);
  SpillingResettableIterator<T1> spillIt=null;
  try {
    this.blockIt.reopen(blockVals);
    while (this.blockIt.hasNext()) {
      final T2 nextBlockRec=this.blockIt.next();
      this.copy1=this.serializer1.copy(firstV1,this.copy1);
      matchFunction.join(this.copy1,nextBlockRec,collector);
    }
    this.blockIt.reset();
    final Iterator<T1> leftSideIter;
    final boolean spillingRequired=this.blockIt.hasFurtherInput();
    if (spillingRequired) {
      spillIt=new SpillingResettableIterator<T1>(spillVals,this.serializer1,this.memoryManager,this.ioManager,this.memoryForSpillingIterator);
      leftSideIter=spillIt;
      spillIt.open();
      this.spillHeadCopy=this.serializer1.copy(firstV1,this.spillHeadCopy);
    }
 else {
      leftSideIter=spillVals;
    }
    while (leftSideIter.hasNext()) {
      final T1 nextSpillVal=leftSideIter.next();
      this.copy1=this.serializer1.copy(nextSpillVal,this.copy1);
      this.copy2=this.serializer2.copy(this.blockHeadCopy,this.copy2);
      matchFunction.join(this.copy1,this.copy2,collector);
      while (this.blockIt.hasNext()) {
        T2 nextBlockRec=this.blockIt.next();
        this.copy1=this.serializer1.copy(nextSpillVal,this.copy1);
        matchFunction.join(this.copy1,nextBlockRec,collector);
      }
      this.blockIt.reset();
    }
    if (!spillingRequired) {
      return;
    }
    while (this.blockIt.nextBlock()) {
      spillIt.reset();
      while (this.blockIt.hasNext()) {
        this.copy1=this.serializer1.copy(this.spillHeadCopy,this.copy1);
        final T2 nextBlockVal=blockIt.next();
        matchFunction.join(this.copy1,nextBlockVal,collector);
      }
      this.blockIt.reset();
      while (spillIt.hasNext()) {
        final T1 nextSpillVal=spillIt.next();
        while (this.blockIt.hasNext()) {
          final T2 nextBlockVal=this.blockIt.next();
          this.copy1=this.serializer1.copy(nextSpillVal,this.copy1);
          matchFunction.join(this.copy1,nextBlockVal,collector);
        }
        this.blockIt.reset();
      }
      spillIt.reset();
    }
  }
  finally {
    if (spillIt != null) {
      this.memoryForSpillingIterator.addAll(spillIt.close());
    }
  }
}
