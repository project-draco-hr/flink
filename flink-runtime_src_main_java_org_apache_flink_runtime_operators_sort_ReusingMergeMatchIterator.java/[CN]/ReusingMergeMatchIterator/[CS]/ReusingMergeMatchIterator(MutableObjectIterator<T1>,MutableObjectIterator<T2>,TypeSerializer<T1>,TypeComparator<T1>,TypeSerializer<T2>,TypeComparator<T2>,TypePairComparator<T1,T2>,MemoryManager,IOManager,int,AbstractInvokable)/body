{
  if (numMemoryPages < 2) {
    throw new IllegalArgumentException("Merger needs at least 2 memory pages.");
  }
  this.comp=pairComparator;
  this.serializer1=serializer1;
  this.serializer2=serializer2;
  this.copy1=serializer1.createInstance();
  this.spillHeadCopy=serializer1.createInstance();
  this.copy2=serializer2.createInstance();
  this.blockHeadCopy=serializer2.createInstance();
  this.memoryManager=memoryManager;
  this.ioManager=ioManager;
  this.iterator1=new ReusingKeyGroupedIterator<T1>(input1,this.serializer1,comparator1.duplicate());
  this.iterator2=new ReusingKeyGroupedIterator<T2>(input2,this.serializer2,comparator2.duplicate());
  final int numPagesForSpiller=numMemoryPages > 20 ? 2 : 1;
  this.blockIt=new NonReusingBlockResettableIterator<T2>(this.memoryManager,this.serializer2,(numMemoryPages - numPagesForSpiller),parentTask);
  this.memoryForSpillingIterator=memoryManager.allocatePages(parentTask,numPagesForSpiller);
}
