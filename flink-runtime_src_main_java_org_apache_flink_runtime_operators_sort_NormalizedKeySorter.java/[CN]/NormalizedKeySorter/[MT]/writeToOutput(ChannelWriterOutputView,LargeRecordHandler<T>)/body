{
  final int numRecords=this.numRecords;
  int currentMemSeg=0;
  int currentRecord=0;
  while (currentRecord < numRecords) {
    final MemorySegment currentIndexSegment=this.sortIndex.get(currentMemSeg++);
    for (int offset=0; currentRecord < numRecords && offset <= this.lastIndexEntryOffset; currentRecord++, offset+=this.indexEntrySize) {
      final long pointer=currentIndexSegment.getLong(offset);
      if (pointer >= 0) {
        this.recordBuffer.setReadPosition(pointer);
        this.serializer.copy(this.recordBuffer,output);
      }
 else {
        this.recordBuffer.setReadPosition(-pointer);
        T record=this.serializer.deserialize(this.recordBuffer);
        largeRecordsOutput.addRecord(record);
      }
    }
  }
}
