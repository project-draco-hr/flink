{
  ClientConfiguration awsClientConfig=new ClientConfigurationFactory().getConfig();
  awsClientConfig.setUserAgent("Apache Flink " + EnvironmentInformation.getVersion() + " ("+ EnvironmentInformation.getRevisionInformation().commitId+ ") Kinesis Connector");
  AmazonKinesisClient client;
  if (AWSUtil.getCredentialsProvider(configProps) != null) {
    client=new AmazonKinesisClient(AWSUtil.getCredentialsProvider(configProps).getCredentials(),awsClientConfig);
  }
 else {
    client=new AmazonKinesisClient(awsClientConfig);
  }
  client.setRegion(Region.getRegion(Regions.fromName(configProps.getProperty(AWSConfigConstants.AWS_REGION))));
  if (configProps.containsKey(AWSConfigConstants.AWS_ENDPOINT)) {
    client.setEndpoint(configProps.getProperty(AWSConfigConstants.AWS_ENDPOINT));
  }
  return client;
}
