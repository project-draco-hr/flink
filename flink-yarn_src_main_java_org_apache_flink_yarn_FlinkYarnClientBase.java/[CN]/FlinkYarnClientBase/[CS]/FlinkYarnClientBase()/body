{
  conf=new YarnConfiguration();
  if (this.yarnClient == null) {
    yarnClient=YarnClient.createYarnClient();
    yarnClient.init(conf);
    yarnClient.start();
  }
  if (System.getenv("IN_TESTS") != null) {
    try {
      conf.addResource(new File(System.getenv("YARN_CONF_DIR") + "/yarn-site.xml").toURI().toURL());
    }
 catch (    Throwable t) {
      throw new RuntimeException("Error",t);
    }
  }
}
