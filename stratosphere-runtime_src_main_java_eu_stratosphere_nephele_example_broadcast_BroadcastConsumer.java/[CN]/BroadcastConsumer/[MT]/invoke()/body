{
  int i=0;
  final BroadcastRecord record=new BroadcastRecord();
  BufferedWriter writer=null;
  try {
    writer=new BufferedWriter(new FileWriter(getFilename()));
    while (this.input.next(record)) {
      if ((i++ % BroadcastProducer.TIMESTAMP_INTERVAL) == 0) {
        final long timestamp=record.getTimestamp();
        writer.write((System.currentTimeMillis() - timestamp) + "\n");
      }
    }
  }
  finally {
    if (writer != null) {
      writer.close();
    }
  }
}
