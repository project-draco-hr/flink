{
  ObjectCreation projection=new ObjectCreation();
  final BatchAggregationExpression batch=new BatchAggregationExpression();
  projection.addMapping("names",new ArrayCreation(new PathExpression(batch.add(BuiltinFunctions.FIRST),new ObjectAccess("recipient"))));
  projection.addMapping("id",new GenerateExpression("earmarkReceiver%s"));
  ObjectCreation funds=new ObjectCreation();
  funds.addMapping("fund",new FunctionCall("format",new ConstantExpression("earmark%s"),new ObjectAccess("earmarkId")));
  funds.addMapping("amount",new ObjectAccess("currentContractValue"));
  funds.addMapping("currency",new ConstantExpression("USD"));
  projection.addMapping("receivedFunds",batch.add(BuiltinFunctions.ALL,funds));
  ObjectCreation address=new ObjectCreation();
  address.addMapping("street",new FunctionCall("trim",new FunctionCall("format",new ConstantExpression("%s %s"),new ObjectAccess("recipientStreet1"),new ObjectAccess("recipientStreet2"))));
  address.addMapping("city",new ObjectAccess("recipientCity"));
  address.addMapping("zipCode",new ObjectAccess("recipientZipcode"));
  address.addMapping("state",new FunctionCall("camelCase",new ObjectAccess("sponsorStateCode")));
  address.addMapping("country",new ObjectAccess("recipientCountry"));
  projection.addMapping("addresses",new FunctionCall("distinct",batch.add(BuiltinFunctions.ALL,address)));
  projection.addMapping("phones",new FunctionCall("distinct",batch.add(BuiltinFunctions.ALL,new ObjectAccess("phone"))));
  ComparativeExpression recipientCondition=new ComparativeExpression(new ObjectAccess("recordType"),BinaryOperator.EQUAL,new ConstantExpression("R"));
  Selection sponsors=new Selection().withInputs(this.scrubbed[EARMARK]).withCondition(recipientCondition);
  Grouping grouping=new Grouping().withInputs(sponsors).withGroupingKey(new ObjectAccess("recipient")).withResultProjection(projection);
  return grouping;
}
