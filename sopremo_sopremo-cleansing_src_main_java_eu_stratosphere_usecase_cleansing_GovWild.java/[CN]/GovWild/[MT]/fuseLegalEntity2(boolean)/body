{
  if (simulate) {
    this.fused[SPENDING][LEGAL_ENTITY]=new Source(getInternalInputFormat(),String.format("%s/LegalEntity2.json",this.outputDir));
    return;
  }
  Selection links=new Selection(new ComparativeExpression(new FunctionCall("count",EvaluationExpression.VALUE),BinaryOperator.GREATER,new ConstantExpression(1)),this.cluster[EARMARK][LEGAL_ENTITY]);
  Selection oneSourceOnly=new Selection(new ComparativeExpression(new FunctionCall("count",EvaluationExpression.VALUE),BinaryOperator.EQUAL,new ConstantExpression(1)),this.cluster[EARMARK][LEGAL_ENTITY]);
  ObjectCreation merge=new ObjectCreation();
  merge.addMapping(new ObjectCreation.CopyFields(new InputSelection(1)));
  merge.addMapping("names",new FunctionCall("distict",new FunctionCall("unionAll",new PathExpression(new InputSelection(0),new ObjectAccess("names")),new PathExpression(new InputSelection(1),new ObjectAccess("names")))));
  merge.addMapping("addresses",new FunctionCall("distict",new FunctionCall("unionAll",new PathExpression(new InputSelection(0),new ObjectAccess("addresses")),new PathExpression(new InputSelection(1),new ObjectAccess("addresses")))));
  Projection linksProjection=new Projection(merge,links);
  Projection oneSourceProjection=new Projection(new ArrayAccess(0),oneSourceOnly);
  this.fused[SPENDING][LEGAL_ENTITY]=new UnionAll(linksProjection,oneSourceProjection);
  this.sinks.add(new Sink(getInternalOutputFormat(),String.format("%s/LegalEntity2.json",this.outputDir),this.fused[SPENDING][LEGAL_ENTITY]));
}
