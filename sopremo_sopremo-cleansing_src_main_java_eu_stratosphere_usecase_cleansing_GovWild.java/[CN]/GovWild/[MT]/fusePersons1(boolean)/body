{
  if (simulate) {
    this.fused[EARMARK][PERSON]=new Source(getInternalInputFormat(),String.format("%s/Persons1.json",this.outputDir));
    return;
  }
  Selection links=new Selection(new ComparativeExpression(new FunctionCall("count",EvaluationExpression.VALUE),BinaryOperator.GREATER,new ConstantExpression(1)),this.cluster[EARMARK][PERSON]);
  Selection earmarksOnly=new Selection(new ComparativeExpression(new FunctionCall("count",EvaluationExpression.VALUE),BinaryOperator.EQUAL,new ConstantExpression(1)),this.cluster[EARMARK][PERSON]);
  ObjectCreation merge=new ObjectCreation();
  merge.addMapping(new ObjectCreation.CopyFields(new InputSelection(0)));
  merge.addMapping("funds",new PathExpression(new InputSelection(1),new ObjectAccess("enactedFunds")));
  Projection linksProjection=new Projection(merge,links);
  Projection earmarkProjection=new Projection(new InputSelection(0),earmarksOnly);
  this.fused[EARMARK][PERSON]=new UnionAll(linksProjection,earmarkProjection);
  this.sinks.add(new Sink(getInternalOutputFormat(),String.format("%s/Person1.json",this.outputDir),this.fused[EARMARK][PERSON]));
}
