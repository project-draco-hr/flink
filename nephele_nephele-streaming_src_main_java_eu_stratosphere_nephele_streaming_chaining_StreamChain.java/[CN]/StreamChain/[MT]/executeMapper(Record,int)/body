{
  final StreamChainLink chainLink=this.chainLinks.get(chainIndex);
  final Queue output=new ArrayDeque();
  chainLink.getMapper().map(record,output);
  if (chainIndex == this.chainLinks.size() - 1) {
    final StreamingOutputGate outputGate=chainLink.getOutputGate();
    while (!output.isEmpty()) {
      outputGate.writeRecord((Record)output.poll());
    }
  }
 else {
    while (!output.isEmpty()) {
      executeMapper((Record)output.poll(),chainIndex + 1);
    }
  }
}
