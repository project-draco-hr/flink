{
  final StreamChainLink chainLink=this.chainLinks.get(chainIndex);
  final Queue output=new ArrayDeque();
  chainLink.getInputGate().reportRecordReceived(record);
  chainLink.getMapper().map(record,output);
  final StreamingOutputGate outputGate=chainLink.getOutputGate();
  if (chainIndex == this.chainLinks.size() - 1) {
    while (!output.isEmpty()) {
      outputGate.writeRecord((Record)output.poll());
    }
  }
 else {
    while (!output.isEmpty()) {
      final Record outputRecord=(Record)output.poll();
      outputGate.reportRecordEmitted(outputRecord);
      executeMapper(outputRecord,chainIndex + 1);
    }
  }
}
