{
synchronized (buffers) {
    if (spillWriter == null) {
      spillWriter=ioManager.createBufferFileWriter(ioManager.createChannel());
      final int numberOfBuffers=buffers.size();
      for (int i=0; i < numberOfBuffers; i++) {
        spillWriter.writeBlock(buffers.remove(0));
      }
      LOG.debug("Spilling {} buffers of {}.",numberOfBuffers,this);
      return numberOfBuffers;
    }
  }
  return 0;
}
