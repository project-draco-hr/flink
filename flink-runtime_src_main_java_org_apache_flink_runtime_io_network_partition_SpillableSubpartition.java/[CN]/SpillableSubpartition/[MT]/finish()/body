{
synchronized (buffers) {
    if (add(EventSerializer.toBuffer(EndOfPartitionEvent.INSTANCE))) {
      if (spillWriter != null) {
        spillWriter.close();
      }
      isFinished=true;
    }
  }
}
