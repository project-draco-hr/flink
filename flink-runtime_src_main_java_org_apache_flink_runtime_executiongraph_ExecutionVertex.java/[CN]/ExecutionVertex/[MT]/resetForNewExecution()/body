{
  LOG.debug("Resetting execution vertex {} for new execution.",getSimpleName());
synchronized (priorExecutions) {
    Execution execution=currentExecution;
    ExecutionState state=execution.getState();
    if (state == ExecutionState.FINISHED || state == ExecutionState.CANCELED || state == ExecutionState.FAILED) {
      priorExecutions.add(execution);
      currentExecution=new Execution(this,execution.getAttemptNumber() + 1,System.currentTimeMillis(),timeout);
      CoLocationGroup grp=jobVertex.getCoLocationGroup();
      if (grp != null) {
        this.locationConstraint=grp.getLocationConstraint(subTaskIndex);
      }
      if (operatorState != null) {
        execution.setOperatorState(operatorState);
      }
    }
 else {
      throw new IllegalStateException("Cannot reset a vertex that is in state " + state);
    }
  }
}
