{
  int numSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String dataPointInput=(args.length > 1 ? args[1] : "");
  String clusterInput=(args.length > 2 ? args[2] : "");
  String output=(args.length > 3 ? args[3] : "");
  FileDataSource dataPoints=new FileDataSource(new PointInFormat(),dataPointInput,"Data Points");
  dataPoints.getCompilerHints().addUniqueField(0);
  FileDataSource clusterPoints=new FileDataSource(new PointInFormat(),clusterInput,"Centers");
  clusterPoints.setDegreeOfParallelism(1);
  clusterPoints.getCompilerHints().addUniqueField(0);
  MapOperator findNearestClusterCenters=MapOperator.builder(new FindNearestCenterBroadcast()).setBroadcastVariable("centers",clusterPoints).input(dataPoints).name("Find Nearest Centers").build();
  ReduceOperator recomputeClusterCenter=ReduceOperator.builder(new RecomputeClusterCenter(),IntValue.class,0).input(findNearestClusterCenters).name("Recompute Center Positions").build();
  FileDataSink newClusterPoints=new FileDataSink(new PointOutFormat(),output,recomputeClusterCenter,"New Center Positions");
  Plan plan=new Plan(newClusterPoints,"KMeans Iteration");
  plan.setDefaultParallelism(numSubTasks);
  return plan;
}
