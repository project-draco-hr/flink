{
  this.inputs=inputs;
  this.outputs=outputs;
  final Class<? extends Driver<S,OT>> driverClass=this.task.getTaskConfig().getDriver();
  Driver<S,OT> driver=InstantiationUtil.instantiate(driverClass,Driver.class);
  this.numInputs=driver.getNumberOfInputs();
  this.numOutputs=outputs.size();
  this.readers=new ArrayList<KeyValueReader>(numInputs);
  for (int i=0; i < numInputs; i++)   this.readers.add(null);
  HashMap<String,ArrayList<Integer>> inputPositions=((TezTaskConfig)this.task.getTaskConfig()).getInputPositions();
  if (this.inputs != null) {
    for (    String name : this.inputs.keySet()) {
      LogicalInput input=this.inputs.get(name);
      input.start();
      ArrayList<Integer> positions=inputPositions.get(name);
      for (      Integer pos : positions) {
        readers.set(pos,(KeyValueReader)input.getReader());
      }
    }
  }
  this.writers=new ArrayList<KeyValueWriter>(numOutputs);
  if (this.outputs != null) {
    for (    LogicalOutput output : this.outputs.values()) {
      output.start();
      writers.add((KeyValueWriter)output.getWriter());
    }
  }
  task.invoke(readers,writers);
}
