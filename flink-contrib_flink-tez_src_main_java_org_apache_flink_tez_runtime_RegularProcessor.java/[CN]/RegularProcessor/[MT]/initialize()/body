{
  UserPayload payload=getContext().getUserPayload();
  Configuration conf=TezUtils.createConfFromUserPayload(payload);
  TezTaskConfig taskConfig=(TezTaskConfig)EncodingUtils.decodeObjectFromString(conf.get(TezTaskConfig.TEZ_TASK_CONFIG),getClass().getClassLoader());
  taskConfig.setTaskName(getContext().getTaskVertexName());
  RuntimeUDFContext runtimeUdfContext=new RuntimeUDFContext(new TaskInfo(getContext().getTaskVertexName(),getContext().getTaskIndex(),getContext().getVertexParallelism(),getContext().getTaskAttemptNumber()),getClass().getClassLoader(),new ExecutionConfig(),new HashMap<String,Future<Path>>(),new HashMap<String,Accumulator<?,?>>());
  this.task=new TezTask<S,OT>(taskConfig,runtimeUdfContext,this.getContext().getTotalMemoryAvailableToTask());
}
