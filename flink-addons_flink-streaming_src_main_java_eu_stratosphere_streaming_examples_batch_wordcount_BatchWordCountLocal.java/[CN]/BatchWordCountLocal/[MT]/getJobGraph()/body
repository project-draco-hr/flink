{
  JobGraphBuilder graphBuilder=new JobGraphBuilder("testGraph",FaultToleranceType.NONE);
  graphBuilder.setSource("BatchWordCountSource",BatchWordCountSource.class);
  graphBuilder.setTask("BatchWordCountSplitter",BatchWordCountSplitter.class,2,1);
  graphBuilder.setTask("BatchWordCountCounter",BatchWordCountCounter.class,2,1);
  graphBuilder.setSink("BatchWordCountSink",BatchWordCountSink.class);
  graphBuilder.shuffleConnect("BatchWordCountSource","BatchWordCountSplitter");
  graphBuilder.fieldsConnect("BatchWordCountSplitter","BatchWordCountCounter",0);
  graphBuilder.shuffleConnect("BatchWordCountCounter","BatchWordCountSink");
  return graphBuilder.getJobGraph();
}
