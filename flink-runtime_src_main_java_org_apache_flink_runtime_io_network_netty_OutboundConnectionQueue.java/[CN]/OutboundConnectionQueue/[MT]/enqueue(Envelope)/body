{
  boolean triggerWrite;
synchronized (channel) {
    if (hasRequestedClose) {
      return false;
    }
    triggerWrite=queuedEnvelopes.isEmpty();
    queuedEnvelopes.add(env);
  }
  if (triggerWrite) {
    channel.pipeline().fireUserEventTriggered(QueueEvent.TRIGGER_WRITE);
  }
  return true;
}
