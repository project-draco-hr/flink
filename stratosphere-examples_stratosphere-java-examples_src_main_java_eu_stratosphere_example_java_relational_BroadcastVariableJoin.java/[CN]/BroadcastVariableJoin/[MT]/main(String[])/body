{
  final ExecutionEnvironment context=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<Comment> userComments=context.fromCollection(new CommentsGenerator(),Comment.class);
  DataSet<Tuple3<Integer,String,String>> usersTuples=context.readCsvFile("file:///home/cicero/Desktop/users.csv").types(Integer.class,String.class,String.class);
  DataSet<User> usersUsers=usersTuples.map(new ToUserObject());
  DataSet<Tuple2<User,Comment>> joined=usersUsers.flatMap(new HandJoin()).withBroadcastSet(userComments,"comments");
  joined.print();
  context.execute();
}
