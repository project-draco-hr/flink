{
  if (cause instanceof LocalTransportException || cause instanceof RemoteTransportException) {
    notifyAllChannelsOfErrorAndClose(cause);
  }
 else {
    final SocketAddress remoteAddr=ctx.channel().remoteAddress();
    if (cause instanceof IOException && cause.getMessage().equals("Connection reset by peer")) {
      notifyAllChannelsOfErrorAndClose(new RemoteTransportException("Lost connection to task manager '" + remoteAddr + "'. This indicates "+ "that the remote task manager was lost.",cause,remoteAddr));
    }
 else {
      notifyAllChannelsOfErrorAndClose(new LocalTransportException(cause.getMessage(),cause));
    }
  }
}
