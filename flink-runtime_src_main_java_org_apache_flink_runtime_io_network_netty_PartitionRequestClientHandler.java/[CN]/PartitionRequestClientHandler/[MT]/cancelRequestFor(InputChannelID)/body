{
  if (cancelled == null) {
    cancelled=Sets.newConcurrentHashSet();
  }
  if (!cancelled.contains(inputChannelId)) {
    ctx.writeAndFlush(new NettyMessage.CancelPartitionRequest(inputChannelId));
    cancelled.add(inputChannelId);
  }
}
