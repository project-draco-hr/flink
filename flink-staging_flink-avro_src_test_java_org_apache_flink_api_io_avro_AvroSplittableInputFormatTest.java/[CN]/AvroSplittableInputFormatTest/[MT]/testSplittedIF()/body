{
  Configuration parameters=new Configuration();
  AvroInputFormat<User> format=new AvroInputFormat<User>(new Path(testFile.getAbsolutePath()),User.class);
  format.configure(parameters);
  FileInputSplit[] splits=format.createInputSplits(4);
  assertEquals(splits.length,4);
  int elements=0;
  int elementsPerSplit[]=new int[4];
  for (int i=0; i < splits.length; i++) {
    format.open(splits[i]);
    while (!format.reachedEnd()) {
      User u=format.nextRecord(null);
      Assert.assertTrue(u.getName().toString().startsWith(TEST_NAME));
      elements++;
      elementsPerSplit[i]++;
    }
    format.close();
  }
  Assert.assertEquals(1491,elementsPerSplit[0]);
  Assert.assertEquals(1491,elementsPerSplit[1]);
  Assert.assertEquals(1490,elementsPerSplit[2]);
  Assert.assertEquals(528,elementsPerSplit[3]);
  Assert.assertEquals(NUM_RECORDS,elements);
  format.close();
}
