def _configure(self, input_file, output_file, port, env):
    self._connection = Connection.BufferingTCPMappedFileConnection(input_file, output_file, port)
    self._iterator = Iterator.Iterator(self._connection, env)
    if (self._keys is None):
        self._run = self._run_all_reduce
    else:
        self._run = self._run_grouped_reduce
        self._group_iterator = Iterator.GroupIterator(self._iterator, self._keys)
    self._collector = Collector.Collector(self._connection, env)
    self.context = RuntimeContext.RuntimeContext(self._iterator, self._collector)
