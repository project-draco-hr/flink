{
  if (OperatingSystem.isWindows()) {
    return;
  }
  Configuration config=new Configuration();
  config.setInteger(ExternalProcessFixedLengthInputFormat.RECORDLENGTH_PARAMETER_KEY,8);
  ExternalProcessInputSplit split=new ExternalProcessInputSplit(1,1,this.thousandRecordsCommand);
  Record record=new Record();
  int cnt=0;
  try {
    format.configure(config);
    format.open(split);
    while (!format.reachedEnd()) {
      if (format.nextRecord(record) != null) {
        cnt++;
      }
    }
    format.close();
  }
 catch (  IOException e) {
    Assert.fail();
  }
catch (  RuntimeException e) {
    Assert.fail(e.getMessage());
  }
  Assert.assertTrue(cnt == 1000);
}
