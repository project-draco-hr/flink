{
  if (this.currentSortIndexOffset > this.lastIndexEntryOffset) {
    if (memoryAvailable()) {
      this.currentSortIndexSegment=nextMemorySegment();
      this.sortIndex.add(this.currentSortIndexSegment);
      this.currentSortIndexOffset=0;
      this.sortIndexBytes+=this.segmentSize;
    }
 else {
      return false;
    }
  }
  this.currentSortIndexSegment.putLong(this.currentSortIndexOffset,this.currentDataBufferOffset);
  if (this.numKeyBytes != 0) {
    this.comparator.putNormalizedKey(record,this.currentSortIndexSegment,this.currentSortIndexOffset + OFFSET_LEN,this.numKeyBytes);
  }
  try {
    this.serializer.serialize(record,this.recordCollector);
    this.currentSortIndexOffset+=this.indexEntrySize;
    this.currentDataBufferOffset=this.recordCollector.getCurrentOffset();
    this.numRecords++;
    return true;
  }
 catch (  EOFException eofex) {
    return false;
  }
}
