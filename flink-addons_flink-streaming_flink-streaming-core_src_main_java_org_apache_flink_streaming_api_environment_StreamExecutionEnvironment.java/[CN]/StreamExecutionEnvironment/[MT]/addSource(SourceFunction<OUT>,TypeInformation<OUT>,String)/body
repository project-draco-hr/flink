{
  if (outTypeInfo == null) {
    outTypeInfo=TypeExtractor.createTypeInfo(SourceFunction.class,function.getClass(),0,null,null);
  }
  boolean isParallel=function instanceof ParallelSourceFunction;
  int dop=isParallel ? getDegreeOfParallelism() : 1;
  DataStreamSource<OUT> returnStream=new DataStreamSource<OUT>(this,sourceName,outTypeInfo,isParallel);
  jobGraphBuilder.addStreamVertex(returnStream.getId(),new SourceInvokable<OUT>(function),null,outTypeInfo,sourceName,dop);
  return returnStream;
}
