{
  JobGraph jobGraph=jobGraphBuilder.getJobGraph(jobName);
  Configuration configuration=jobGraph.getJobConfiguration();
  configuration.setInteger(ConfigConstants.TASK_MANAGER_NUM_TASK_SLOTS,getDegreeOfParallelism());
  configuration.setLong(ConfigConstants.TASK_MANAGER_MEMORY_SIZE_KEY,memorySize);
  ForkableFlinkMiniCluster cluster=new ForkableFlinkMiniCluster(configuration);
  try {
    ActorRef client=cluster.getJobClient();
    JobClient.submitJobAndWait(jobGraph,false,client,cluster.timeout());
  }
 catch (  JobExecutionException e) {
    if (e.getMessage().contains("GraphConversionException")) {
      throw new Exception(CANNOT_EXECUTE_EMPTY_JOB,e);
    }
 else {
      throw e;
    }
  }
 finally {
    cluster.stop();
  }
}
