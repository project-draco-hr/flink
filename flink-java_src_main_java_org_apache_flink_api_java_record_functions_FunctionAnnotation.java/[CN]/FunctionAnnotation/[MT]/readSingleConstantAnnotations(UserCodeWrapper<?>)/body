{
  AllFieldsConstants allConstants=udf.getUserCodeAnnotation(AllFieldsConstants.class);
  ConstantFields constantSet=udf.getUserCodeAnnotation(ConstantFields.class);
  ConstantFieldsExcept notConstantSet=udf.getUserCodeAnnotation(ConstantFieldsExcept.class);
  if (notConstantSet != null && (constantSet != null || allConstants != null)) {
    throw new RuntimeException("Either ConstantFields or ConstantFieldsExcept can be specified, not both.");
  }
  if (notConstantSet != null) {
    FieldSet nonConstant=new FieldSet(notConstantSet.value());
    return new ImplicitlyForwardingSingleInputSemanticProperties(nonConstant);
  }
  if (allConstants != null) {
    return new SingleInputSemanticProperties.AllFieldsForwardedProperties();
  }
  SingleInputSemanticProperties semanticProperties=new SingleInputSemanticProperties();
  if (constantSet != null) {
    for (    int value : constantSet.value()) {
      semanticProperties.addForwardedField(value,value);
    }
  }
  return semanticProperties;
}
