{
  if (mark.getTimestamp() == Long.MAX_VALUE) {
synchronized (lock) {
      nextWatermarkTime=Long.MAX_VALUE;
      output.emitWatermark(mark);
    }
    if (watermarkTimer != null) {
      watermarkTimer.cancel(true);
    }
  }
}
