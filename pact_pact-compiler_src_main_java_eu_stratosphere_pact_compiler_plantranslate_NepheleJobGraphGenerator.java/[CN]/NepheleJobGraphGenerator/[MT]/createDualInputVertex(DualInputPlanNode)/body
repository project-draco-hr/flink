{
  final String taskName=node.getNodeName();
  final DriverStrategy ds=node.getDriverStrategy();
  final JobTaskVertex vertex=new JobTaskVertex(taskName,this.jobGraph);
  final TaskConfig config=new TaskConfig(vertex.getConfiguration());
  vertex.setTaskClass(this.currentIteration == null ? RegularPactTask.class : IterationIntermediatePactTask.class);
  config.setStubWrapper(node.getPactContract().getUserCodeWrapper());
  config.setStubParameters(node.getPactContract().getParameters());
  config.setDriver(ds.getDriverClass());
  config.setDriverStrategy(ds);
  if (node.getComparator1() != null) {
    config.setDriverComparator(node.getComparator1(),0);
  }
  if (node.getComparator2() != null) {
    config.setDriverComparator(node.getComparator2(),1);
  }
  if (node.getPairComparator() != null) {
    config.setDriverPairComparator(node.getPairComparator());
  }
  assignDriverResources(node,config);
  return vertex;
}
