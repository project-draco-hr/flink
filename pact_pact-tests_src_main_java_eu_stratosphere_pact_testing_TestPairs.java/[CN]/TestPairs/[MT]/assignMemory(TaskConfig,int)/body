{
  int ioMem, sortMem, numSortBuffers, sortBufferSize;
  if (memSize > 512)   ioMem=MAX_IO_BUFFER_SIZE;
 else   if (memSize > 64)   ioMem=memSize / 32;
 else   if (memSize > 32)   ioMem=2;
 else   if (memSize > MIN_SORT_HEAP + MIN_IO_BUFFER_SIZE)   ioMem=MIN_IO_BUFFER_SIZE;
 else   throw new OutOfMemoryError();
  sortMem=memSize - ioMem;
  if (sortMem > 3 * MAX_SORT_HEAP_BUFFER_SIZE) {
    numSortBuffers=sortMem / MAX_SORT_HEAP_BUFFER_SIZE + 1;
    numSortBuffers=sortMem / (sortMem / numSortBuffers);
  }
 else   if (sortMem > 3 * 64)   numSortBuffers=3;
 else   if (sortMem >= 2 * MIN_SORT_HEAP)   numSortBuffers=2;
 else   numSortBuffers=1;
  sortBufferSize=sortMem / numSortBuffers;
  config.setIOBufferSize(ioMem);
  config.setMergeFactor(DEFAUTL_MERGE_FACTOR);
  config.setNumSortBuffer(numSortBuffers);
  config.setSortBufferSize(sortBufferSize);
}
