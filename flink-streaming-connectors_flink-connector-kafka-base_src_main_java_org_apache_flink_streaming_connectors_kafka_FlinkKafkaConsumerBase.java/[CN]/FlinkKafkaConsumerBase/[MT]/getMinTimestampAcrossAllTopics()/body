{
  Tuple2<KafkaTopicPartition,Long> minTimestamp=new Tuple2<>(null,Long.MAX_VALUE);
  for (  Map.Entry<KafkaTopicPartition,KafkaPartitionState> entries : partitionState.entrySet()) {
    KafkaTopicPartition part=entries.getKey();
    KafkaPartitionState info=entries.getValue();
    if (partitionIsActive(part) && info.getMaxTimestamp() < minTimestamp.f1) {
      minTimestamp.f0=part;
      minTimestamp.f1=info.getMaxTimestamp();
    }
  }
  if (minTimestamp.f0 != null) {
    KafkaTopicPartition partitionDescriptor=minTimestamp.f0;
    setActiveFlagForPartition(partitionDescriptor,false);
  }
  return minTimestamp;
}
