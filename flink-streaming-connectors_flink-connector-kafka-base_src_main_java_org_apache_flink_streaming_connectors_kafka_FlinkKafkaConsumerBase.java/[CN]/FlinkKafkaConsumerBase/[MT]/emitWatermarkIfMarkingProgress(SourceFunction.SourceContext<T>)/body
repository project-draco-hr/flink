{
  Tuple2<KafkaTopicPartition,Long> globalMinTs=getMinTimestampAcrossAllTopics();
  if (globalMinTs.f0 != null) {
synchronized (sourceContext.getCheckpointLock()) {
      long minTs=globalMinTs.f1;
      if (minTs > lastEmittedWatermark) {
        lastEmittedWatermark=minTs;
        Watermark toEmit=new Watermark(minTs);
        sourceContext.emitWatermark(toEmit);
        return true;
      }
    }
  }
  return false;
}
