{
  if (punctuatedWatermarkAssigner == null && periodicWatermarkAssigner == null) {
    sourceContext.collect(value);
  }
 else {
    if (srcContext == null) {
      srcContext=sourceContext;
    }
    long extractedTimestamp=extractTimestampAndEmitElement(partDescriptor,value);
    if (punctuatedWatermarkAssigner != null) {
      final Watermark nextWatermark=punctuatedWatermarkAssigner.checkAndGetNextWatermark(value,extractedTimestamp);
      if (nextWatermark != null) {
        emitWatermarkIfMarkingProgress(sourceContext);
      }
    }
 else     if (periodicWatermarkAssigner != null && runtime == null) {
      runtime=(StreamingRuntimeContext)getRuntimeContext();
      watermarkInterval=runtime.getExecutionConfig().getAutoWatermarkInterval();
      if (watermarkInterval > 0) {
        runtime.registerTimer(System.currentTimeMillis() + watermarkInterval,this);
      }
    }
  }
  updateOffsetForPartition(partDescriptor,offset);
}
