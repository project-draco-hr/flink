{
  int numSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String dataInput=(args.length > 1 ? args[1] : "");
  String output=(args.length > 2 ? args[2] : "");
  HadoopDataSource source=new HadoopDataSource(new HadoopInputFormatWrapper(new NLineInputFormat(),new JobConf()),dataInput,"Input Lines");
  MapOperator mapper=MapOperator.builder(new TokenizeLine()).input(source).name("Tokenize Lines").build();
  FileDataSink out=new FileDataSink(new CsvOutputFormat(),output,mapper,"Word Counts");
  CsvOutputFormat.configureRecordFormat(out).recordDelimiter('\n').fieldDelimiter(' ').field(LongValue.class,0).field(StringValue.class,1);
  Plan plan=new Plan(out,"WordCount Example");
  plan.setDefaultParallelism(numSubTasks);
  return plan;
}
