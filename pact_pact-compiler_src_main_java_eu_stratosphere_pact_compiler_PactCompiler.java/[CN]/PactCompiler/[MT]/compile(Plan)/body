{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Connecting compiler to JobManager to dertermine instance information.");
  }
  Map<InstanceType,InstanceTypeDescription> instances=null;
  JobManagerConnector jmc=new JobManagerConnector(this.jobManagerAddress);
  Thread connectorThread=new Thread(jmc,"Compiler - JobManager connector.");
  connectorThread.setDaemon(true);
  connectorThread.start();
  try {
    jmc.waitForCompletion();
    instances=jmc.instances;
    if (instances == null) {
      throw new NullPointerException("Returned instance map is <null>");
    }
  }
 catch (  Throwable t) {
    throw new CompilerException("Available instances could not be determined from job manager: " + t.getMessage(),t);
  }
  InstanceTypeDescription type=getType(instances);
  return compile(pactPlan,type);
}
