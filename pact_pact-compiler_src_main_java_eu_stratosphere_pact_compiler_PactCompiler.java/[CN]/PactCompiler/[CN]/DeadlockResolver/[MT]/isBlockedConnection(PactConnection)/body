{
  if (conn.getTempMode() != TempMode.NONE) {
    return false;
  }
  if (this.spillingActivated && (conn.getShipStrategy() == ShipStrategy.BROADCAST || conn.getShipStrategy() == ShipStrategy.PARTITION_HASH || conn.getShipStrategy() == ShipStrategy.PARTITION_RANGE || conn.getShipStrategy() == ShipStrategy.SFR)) {
    return false;
  }
switch (conn.getTargetPact().getPactType()) {
case Match:
    int inConnIdx=conn.getTargetPact().getIncomingConnections().indexOf(conn);
switch (conn.getTargetPact().getLocalStrategy()) {
case HYBRIDHASH_FIRST:
    return inConnIdx == 1;
case HYBRIDHASH_SECOND:
  return inConnIdx == 0;
case MMHASH_FIRST:
return inConnIdx == 1;
case MMHASH_SECOND:
return inConnIdx == 0;
case SORT_FIRST_MERGE:
return inConnIdx == 1;
case SORT_SECOND_MERGE:
return inConnIdx == 0;
default :
return false;
}
case Cogroup:
inConnIdx=conn.getTargetPact().getIncomingConnections().indexOf(conn);
switch (conn.getTargetPact().getLocalStrategy()) {
case SORT_FIRST_MERGE:
return inConnIdx == 1;
case SORT_SECOND_MERGE:
return inConnIdx == 0;
default :
return false;
}
case Cross:
inConnIdx=conn.getTargetPact().getIncomingConnections().indexOf(conn);
switch (conn.getTargetPact().getLocalStrategy()) {
case NESTEDLOOP_BLOCKED_OUTER_SECOND:
return inConnIdx == 1;
case NESTEDLOOP_STREAMED_OUTER_SECOND:
return inConnIdx == 1;
case NESTEDLOOP_BLOCKED_OUTER_FIRST:
return inConnIdx == 0;
case NESTEDLOOP_STREAMED_OUTER_FIRST:
return inConnIdx == 0;
default :
return false;
}
default :
return false;
}
}
