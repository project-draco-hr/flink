{
  if (conn.getTempMode() != TempMode.NONE) {
    return false;
  }
  if (this.spillingActivated && (conn.getShipStrategy() == ShipStrategy.BROADCAST || conn.getShipStrategy() == ShipStrategy.PARTITION_HASH || conn.getShipStrategy() == ShipStrategy.PARTITION_RANGE || conn.getShipStrategy() == ShipStrategy.SFR)) {
    return false;
  }
switch (conn.getTargetPact().getPactType()) {
case Match:
    int inConnIdx=conn.getTargetPact().getIncomingConnections().indexOf(conn);
switch (conn.getTargetPact().getLocalStrategy()) {
case HYBRIDHASH_FIRST:
    if (inConnIdx == 1)     return true;
 else     return false;
case HYBRIDHASH_SECOND:
  if (inConnIdx == 0)   return true;
 else   return false;
case MMHASH_FIRST:
if (inConnIdx == 1) return true;
 else return false;
case MMHASH_SECOND:
if (inConnIdx == 0) return true;
 else return false;
case SORT_FIRST_MERGE:
if (inConnIdx == 1) return true;
 else return false;
case SORT_SECOND_MERGE:
if (inConnIdx == 0) return true;
 else return false;
default :
return false;
}
case Cogroup:
inConnIdx=conn.getTargetPact().getIncomingConnections().indexOf(conn);
switch (conn.getTargetPact().getLocalStrategy()) {
case SORT_FIRST_MERGE:
if (inConnIdx == 1) return true;
 else return false;
case SORT_SECOND_MERGE:
if (inConnIdx == 0) return true;
 else return false;
default :
return false;
}
case Cross:
inConnIdx=conn.getTargetPact().getIncomingConnections().indexOf(conn);
switch (conn.getTargetPact().getLocalStrategy()) {
case NESTEDLOOP_BLOCKED_OUTER_SECOND:
if (inConnIdx == 1) return true;
 else return false;
case NESTEDLOOP_STREAMED_OUTER_SECOND:
if (inConnIdx == 1) return true;
 else return false;
case NESTEDLOOP_BLOCKED_OUTER_FIRST:
if (inConnIdx == 0) return true;
 else return false;
case NESTEDLOOP_STREAMED_OUTER_FIRST:
if (inConnIdx == 0) return true;
 else return false;
default :
return false;
}
default :
return false;
}
}
