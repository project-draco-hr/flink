{
  this.statistics=stats;
  this.costEstimator=estimator;
  Configuration config=GlobalConfiguration.getConfiguration();
  String instanceDescr=config.getString(PactConfigConstants.DEFAULT_INSTANCE_TYPE_KEY,PactConfigConstants.DEFAULT_INSTANCE_TYPE_DESCRIPTION);
  InstanceType type=null;
  try {
    type=InstanceTypeFactory.constructFromDescription(instanceDescr);
  }
 catch (  IllegalArgumentException iaex) {
    LOG.error("Invalid description of standard instance type in PACT configuration: " + instanceDescr + ". Using default instance type "+ PactConfigConstants.DEFAULT_INSTANCE_TYPE_DESCRIPTION+ ".",iaex);
    type=InstanceTypeFactory.constructFromDescription(PactConfigConstants.DEFAULT_INSTANCE_TYPE_DESCRIPTION);
  }
  this.pactInstanceType=type;
  int defaultParallelizationDegree=config.getInteger(PactConfigConstants.DEFAULT_PARALLELIZATION_DEGREE_KEY,PactConfigConstants.DEFAULT_PARALLELIZATION_DEGREE);
  if (defaultParallelizationDegree < 1) {
    LOG.error("Invalid default degree of parallelism: " + defaultParallelizationDegree + ". Using default degree of "+ PactConfigConstants.DEFAULT_PARALLELIZATION_DEGREE+ ".");
    defaultParallelizationDegree=PactConfigConstants.DEFAULT_PARALLELIZATION_DEGREE;
  }
  this.defaultDegreeOfParallelism=defaultParallelizationDegree;
  int defaultInNodePar=config.getInteger(PactConfigConstants.DEFAULT_PARALLELIZATION_INTRA_NODE_DEGREE_KEY,PactConfigConstants.DEFAULT_INTRA_NODE_PARALLELIZATION_DEGREE);
  if (defaultInNodePar < 1) {
    LOG.error("Invalid default degree of intra-node parallelism: " + defaultParallelizationDegree + ". Using default degree of "+ PactConfigConstants.DEFAULT_INTRA_NODE_PARALLELIZATION_DEGREE+ ".");
    defaultInNodePar=PactConfigConstants.DEFAULT_INTRA_NODE_PARALLELIZATION_DEGREE;
  }
  this.defaultIntraNodeParallelism=defaultInNodePar;
  this.memoryPerInstance=pactInstanceType.getMemorySize();
}
