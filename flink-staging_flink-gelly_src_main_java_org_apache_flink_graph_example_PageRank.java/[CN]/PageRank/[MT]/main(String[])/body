{
  if (!parseParameters(args)) {
    return;
  }
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<Edge<Long,Double>> links=getLinksDataSet(env);
  Graph<Long,Double,Double> network=Graph.fromDataSet(links,new MapFunction<Long,Double>(){
    public Double map(    Long value) throws Exception {
      return 1.0;
    }
  }
,env);
  DataSet<Tuple2<Long,Long>> vertexOutDegrees=network.outDegrees();
  Graph<Long,Double,Double> networkWithWeights=network.joinWithEdgesOnSource(vertexOutDegrees,new MapFunction<Tuple2<Double,Long>,Double>(){
    public Double map(    Tuple2<Double,Long> value){
      return value.f0 / value.f1;
    }
  }
);
  DataSet<Vertex<Long,Double>> pageRanks=networkWithWeights.run(new PageRankAlgorithm<Long>(DAMPENING_FACTOR,maxIterations)).getVertices();
  if (fileOutput) {
    pageRanks.writeAsCsv(outputPath,"\n","\t");
    env.execute();
  }
 else {
    pageRanks.print();
  }
}
