{
  int size=in.readInt();
  MultiplexingStreamRecordSerializer<T> recordSerializer=new MultiplexingStreamRecordSerializer<>(serializer);
  ArrayDeque<StreamRecord<T>> elements=new ArrayDeque<>();
  for (int i=0; i < size; i++) {
    elements.add(recordSerializer.deserialize(in).<T>asRecord());
  }
  return new ListWindowBuffer<>(elements,serializer);
}
