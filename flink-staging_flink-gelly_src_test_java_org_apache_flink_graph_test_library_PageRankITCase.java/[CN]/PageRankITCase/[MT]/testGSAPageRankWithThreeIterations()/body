{
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  Graph<Long,Double,Double> inputGraph=Graph.fromDataSet(PageRankData.getDefaultEdgeDataSet(env),new InitMapper(),env);
  DataSet<Tuple2<Long,Long>> vertexOutDegrees=inputGraph.outDegrees();
  Graph<Long,Double,Double> networkWithWeights=inputGraph.joinWithEdgesOnSource(vertexOutDegrees,new InitWeightsMapper());
  List<Vertex<Long,Double>> result=networkWithWeights.run(new GSAPageRank<Long>(0.85,3)).getVertices().collect();
  compareWithDelta(result,expectedResult,0.01);
}
