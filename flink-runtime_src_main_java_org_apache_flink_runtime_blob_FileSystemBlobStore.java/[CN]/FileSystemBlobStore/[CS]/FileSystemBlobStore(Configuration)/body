{
  StateBackend stateBackend=StateBackend.fromConfig(config);
  if (stateBackend == StateBackend.FILESYSTEM) {
    String stateBackendBasePath=config.getString(ConfigConstants.STATE_BACKEND_FS_RECOVERY_PATH,"");
    if (stateBackendBasePath.equals("")) {
      throw new IllegalConfigurationException(String.format("Missing configuration for " + "file system state backend recovery path. Please specify via " + "'%s' key.",ConfigConstants.STATE_BACKEND_FS_RECOVERY_PATH));
    }
    stateBackendBasePath+="/blob";
    this.basePath=stateBackendBasePath;
    try {
      FileSystem.get(new URI(basePath)).mkdirs(new Path(basePath));
    }
 catch (    URISyntaxException e) {
      throw new IOException(e);
    }
    LOG.info("Created blob directory {}.",basePath);
  }
 else {
    throw new IllegalConfigurationException(String.format("Illegal state backend " + "configuration '%s'. Please configure '%s' as state " + "backend and specify the recovery path via '%s' key.",stateBackend,StateBackend.FILESYSTEM,ConfigConstants.STATE_BACKEND_FS_RECOVERY_PATH));
  }
}
