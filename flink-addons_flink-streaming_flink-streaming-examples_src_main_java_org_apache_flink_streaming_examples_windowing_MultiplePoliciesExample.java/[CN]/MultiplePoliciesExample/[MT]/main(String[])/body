{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment(PARALLELISM);
  LinkedList<TriggerPolicy<String>> policies=new LinkedList<TriggerPolicy<String>>();
  policies.add(new CountTriggerPolicy<String>(5));
  policies.add(new CountTriggerPolicy<String>(8));
  ReduceFunction<String> reducer=new ReduceFunction<String>(){
    /** 
 * Auto generates version ID
 */
    private static final long serialVersionUID=1L;
    @Override public String reduce(    String value1,    String value2) throws Exception {
      return value1 + "|" + value2;
    }
  }
;
  DataStream<Tuple2<String,String[]>> stream=env.addSource(new BasicSource()).window(policies,reducer);
  stream.print();
  env.execute();
}
