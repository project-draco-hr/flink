{
  @SuppressWarnings({"unchecked","rawtypes"}) SingleOutputStreamOperator<OUT,?> returnStream=new SingleOutputStreamOperator(environment,functionName,outTypeWrapper);
  try {
    dataStream1.jobGraphBuilder.addCoTask(returnStream.getId(),functionInvokable,in1TypeWrapper,in2TypeWrapper,outTypeWrapper,functionName,SerializationUtils.serialize((Serializable)function),environment.getDegreeOfParallelism());
  }
 catch (  SerializationException e) {
    throw new RuntimeException("Cannot serialize user defined function");
  }
  dataStream1.connectGraph(dataStream1,returnStream.getId(),1);
  dataStream1.connectGraph(dataStream2,returnStream.getId(),2);
  return returnStream;
}
