{
  final String myString="my key|my val$$$my key2\n$$ctd.$$|my value2";
  final FileInputSplit split=createTempFile(myString);
  final Configuration parameters=new Configuration();
  parameters.setString(FileInputFormat.FILE_PARAMETER_KEY,"file:///some/file/that/will/not/be/read");
  parameters.setString(TextInputFormat.RECORD_DELIMITER,"\n");
  format.configure(parameters);
  format.open(split);
  KeyValuePair<PactString,PactString> pair=new KeyValuePair<PactString,PactString>();
  pair.setKey(new PactString());
  pair.setValue(new PactString());
  assertTrue(format.nextRecord(pair));
  assertEquals("my key",pair.getKey().toString());
  assertEquals("my val$$$my key2",pair.getValue().toString());
  assertTrue(format.nextRecord(pair));
  assertEquals("$$ctd.$$",pair.getKey().getValue());
  assertEquals("my value2",pair.getValue().toString());
  assertFalse(format.nextRecord(pair));
  assertTrue(format.reachedEnd());
}
