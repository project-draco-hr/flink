{
  FileDataSource source=new FileDataSource(new DummyInputFormat(),IN_FILE,"Source");
  ReduceContract reduce1=ReduceContract.builder(new IdentityReduce()).name("Reduce1").input(source).build();
  FileDataSink sink=new FileDataSink(new DummyOutputFormat(),OUT_FILE,"Sink");
  sink.setInput(reduce1);
  Plan plan=new Plan(sink,"AllReduce Test");
  plan.setDefaultParallelism(DEFAULT_PARALLELISM);
  try {
    OptimizedPlan oPlan=compileNoStats(plan);
    NepheleJobGraphGenerator jobGen=new NepheleJobGraphGenerator();
    jobGen.compileJobGraph(oPlan);
  }
 catch (  CompilerException ce) {
    ce.printStackTrace();
    fail("The pact compiler is unable to compile this plan correctly");
  }
}
