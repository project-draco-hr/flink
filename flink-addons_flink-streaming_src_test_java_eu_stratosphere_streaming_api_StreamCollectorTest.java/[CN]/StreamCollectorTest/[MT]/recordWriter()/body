{
  MockRecordWriter recWriter=mock(MockRecordWriter.class);
  Mockito.when(recWriter.initList()).thenCallRealMethod();
  doCallRealMethod().when(recWriter).emit(Mockito.any(StreamRecord.class));
  recWriter.initList();
  ArrayList<RecordWriter<StreamRecord>> rwList=new ArrayList<RecordWriter<StreamRecord>>();
  rwList.add(recWriter);
  StreamCollector collector=new StreamCollector(1,1000,0,null,rwList);
  collector.collect(new Tuple1<Integer>(3));
  assertEquals((Integer)3,recWriter.emittedRecords.get(0).getTuple(0).getField(0));
}
