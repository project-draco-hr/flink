{
  SingleInputContract<?> contract=(SingleInputContract<?>)node.getSingleInputNode().getPactContract();
  if (!(contract instanceof RecordContract)) {
    throw new CompilerPostPassException("Error: Contract is not a PactRecord based contract. Wrong compiler invokation.");
  }
  RecordContract recContract=(RecordContract)contract;
  int[] localPositions=contract.getKeyColumns(0);
  Class<? extends Key>[] types=recContract.getKeyClasses();
  for (int i=0; i < localPositions.length; i++) {
    schema.addType(localPositions[i],types[i]);
  }
}
