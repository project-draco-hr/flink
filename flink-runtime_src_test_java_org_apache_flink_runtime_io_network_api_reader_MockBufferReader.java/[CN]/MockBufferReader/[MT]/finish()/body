{
  final Answer<Buffer> answer=new Answer<Buffer>(){
    @Override public Buffer answer(    InvocationOnMock invocationOnMock) throws Throwable {
      when(inputChannel.isReleased()).thenReturn(true);
      return EventSerializer.toBuffer(EndOfPartitionEvent.INSTANCE);
    }
  }
;
  if (stubbing == null) {
    stubbing=when(inputChannel.getNextBuffer()).thenAnswer(answer);
  }
 else {
    stubbing=stubbing.thenAnswer(answer);
  }
  reader.onAvailableInputChannel(inputChannel);
  return this;
}
