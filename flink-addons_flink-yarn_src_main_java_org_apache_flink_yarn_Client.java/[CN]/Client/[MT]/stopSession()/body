{
  try {
    LOG.info("Sending shutdown request to the Application Master");
    if (applicationClient != ActorRef.noSender()) {
      applicationClient.tell(new Messages.StopYarnSession(FinalApplicationStatus.KILLED),ActorRef.noSender());
      applicationClient=ActorRef.noSender();
    }
    if (actorSystem != null) {
      actorSystem.shutdown();
      actorSystem.awaitTermination();
      actorSystem=null;
    }
  }
 catch (  Exception e) {
    LOG.warn("Exception while killing the YARN application",e);
  }
  try {
    yarnPropertiesFile.delete();
  }
 catch (  Exception e) {
    LOG.warn("Exception while deleting the JobManager address file",e);
  }
  LOG.info("YARN Client is shutting down");
  yarnClient.stop();
  LOG.info("Deleting files in " + sessionFilesDir);
  try {
    FileSystem shutFS=FileSystem.get(conf);
    shutFS.delete(sessionFilesDir,true);
    shutFS.close();
  }
 catch (  IOException e) {
    LOG.error("Could not delete the conf and jar files.",e);
  }
}
