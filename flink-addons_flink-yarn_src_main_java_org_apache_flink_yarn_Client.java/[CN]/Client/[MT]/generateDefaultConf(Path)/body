{
  JarFile jar=null;
  try {
    jar=new JarFile(localJarPath.toUri().getPath());
  }
 catch (  FileNotFoundException fne) {
    LOG.error("Unable to access jar file. Specify jar file or configuration file.",fne);
    System.exit(1);
  }
  InputStream confStream=jar.getInputStream(jar.getEntry("flink-conf.yaml"));
  if (confStream == null) {
    LOG.warn("Given jar file does not contain yaml conf.");
    confStream=this.getClass().getResourceAsStream("flink-conf.yaml");
    if (confStream == null) {
      throw new RuntimeException("Unable to find flink-conf in jar file");
    }
  }
  File outFile=new File("flink-conf.yaml");
  if (outFile.exists()) {
    throw new RuntimeException("File unexpectedly exists");
  }
  FileOutputStream outputStream=new FileOutputStream(outFile);
  int read=0;
  byte[] bytes=new byte[1024];
  while ((read=confStream.read(bytes)) != -1) {
    outputStream.write(bytes,0,read);
  }
  confStream.close();
  outputStream.close();
  jar.close();
  return outFile;
}
