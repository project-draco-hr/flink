{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment(PARALLELISM);
  ReduceFunction<String> reduceFunction=new ReduceFunction<String>(){
    /** 
 * default version ID
 */
    private static final long serialVersionUID=1L;
    @Override public String reduce(    String value1,    String value2) throws Exception {
      return value1 + "|" + value2;
    }
  }
;
  DataStream<String> stream=env.addSource(new CountingSource()).window(Count.of(5).withDelete(4)).every(Count.of(4).startingAt(-1)).reduce(reduceFunction);
  stream.print();
  env.execute();
}
