{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment(PARALLELISM);
  TriggerPolicy<String> triggerPolicy=new CountTriggerPolicy<String>(4,-1);
  EvictionPolicy<String> evictionPolicy=new CountEvictionPolicy<String>(5,4);
  ReduceFunction<String> reduceFunction=new ReduceFunction<String>(){
    /** 
 * default version ID
 */
    private static final long serialVersionUID=1L;
    @Override public String reduce(    String value1,    String value2) throws Exception {
      return value1 + "|" + value2;
    }
  }
;
  DataStream<Tuple2<String,String[]>> stream=env.addSource(new CountingSource()).window(triggerPolicy,evictionPolicy,reduceFunction);
  stream.print();
  env.execute();
}
