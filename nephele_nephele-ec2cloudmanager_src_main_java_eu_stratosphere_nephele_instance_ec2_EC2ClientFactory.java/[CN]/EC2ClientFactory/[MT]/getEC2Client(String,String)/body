{
  if (awsAccessId == null) {
    throw new IllegalArgumentException("AWS access ID is null");
  }
  if (awsSecretKey == null) {
    throw new IllegalArgumentException("AWS secret key is null");
  }
  if (ec2clients.containsKey(awsAccessId)) {
    return ec2clients.get(awsAccessId);
  }
  final BasicAWSCredentials credentials=new BasicAWSCredentials(awsAccessId,awsSecretKey);
  final AmazonEC2Client client=new AmazonEC2Client(credentials);
  final String endpoint=GlobalConfiguration.getString("instancemanager.ec2.endpoint","ec2.eu-west-1.amazonaws.com");
  client.setEndpoint(endpoint);
  ec2clients.put(awsAccessId,client);
  return client;
}
