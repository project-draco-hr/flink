{
  FlatMapFunction<IN,OUT> function=userFunction.getUserCodeObject();
  FunctionUtils.setFunctionRuntimeContext(function,ctx);
  FunctionUtils.openFunction(function,parameters);
  ArrayList<OUT> result=new ArrayList<OUT>(input.size());
  ListCollector<OUT> resultCollector=new ListCollector<OUT>(result);
  for (  IN element : input) {
    function.flatMap(element,resultCollector);
  }
  FunctionUtils.closeFunction(function);
  return result;
}
