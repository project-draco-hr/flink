{
  final long timestamp=System.currentTimeMillis();
  final ExecutionJobVertex vertex=graph.getJobVertex(vertexId);
  final String taskName=vertex == null ? "(null)" : vertex.getJobVertex().getName();
  final int totalNumberOfSubtasks=vertex == null ? -1 : vertex.getParallelism();
  final VertexEvent vertexEvent=new VertexEvent(timestamp,vertexId,taskName,totalNumberOfSubtasks,subtask,executionId,newExecutionState,optionalMessage);
  this.eventCollector.addEvent(jobID,vertexEvent);
  final ExecutionStateChangeEvent executionStateChangeEvent=new ExecutionStateChangeEvent(timestamp,vertexId,subtask,executionId,newExecutionState);
  this.eventCollector.addEvent(jobID,executionStateChangeEvent);
  LOG.info(vertexEvent.toString());
}
