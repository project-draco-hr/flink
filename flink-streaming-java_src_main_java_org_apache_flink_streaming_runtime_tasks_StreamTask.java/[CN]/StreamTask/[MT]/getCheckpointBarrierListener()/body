{
  return new EventListener<CheckpointBarrier>(){
    @Override public void onEvent(    CheckpointBarrier barrier){
      try {
        performCheckpoint(barrier.getId(),barrier.getTimestamp());
      }
 catch (      CancelTaskException e) {
        throw e;
      }
catch (      Exception e) {
        throw new RuntimeException("Error triggering a checkpoint as the result of receiving checkpoint barrier",e);
      }
    }
  }
;
}
