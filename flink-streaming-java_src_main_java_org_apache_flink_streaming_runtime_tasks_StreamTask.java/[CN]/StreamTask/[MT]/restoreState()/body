{
  final StreamOperator<?>[] allOperators=operatorChain.getAllOperators();
  try {
    if (lazyRestoreChainedOperatorState != null) {
synchronized (cancelables) {
        cancelables.add(lazyRestoreChainedOperatorState);
      }
      for (int i=0; i < lazyRestoreChainedOperatorState.getLength(); i++) {
        StreamStateHandle state=lazyRestoreChainedOperatorState.get(i);
        if (state == null) {
          continue;
        }
        if (state != null) {
          StreamOperator<?> operator=allOperators[i];
          if (operator != null) {
            LOG.debug("Restore state of task {} in chain ({}).",i,getName());
            FSDataInputStream inputStream=state.openInputStream();
            try {
              operator.restoreState(inputStream);
            }
  finally {
              inputStream.close();
            }
          }
        }
      }
    }
  }
  finally {
synchronized (cancelables) {
      cancelables.remove(lazyRestoreChainedOperatorState);
    }
  }
}
