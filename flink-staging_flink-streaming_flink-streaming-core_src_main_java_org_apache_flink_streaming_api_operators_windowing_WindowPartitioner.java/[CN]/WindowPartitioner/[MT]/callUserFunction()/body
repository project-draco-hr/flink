{
  StreamWindow<T> currentWindow=nextObject;
  if (keySelector == null) {
    if (numberOfSplits <= 1) {
      collector.collect(currentWindow);
    }
 else {
      for (      StreamWindow<T> window : StreamWindow.split(currentWindow,numberOfSplits)) {
        collector.collect(window);
      }
    }
  }
 else {
    for (    StreamWindow<T> window : StreamWindow.partitionBy(currentWindow,keySelector,true)) {
      collector.collect(window);
    }
  }
}
