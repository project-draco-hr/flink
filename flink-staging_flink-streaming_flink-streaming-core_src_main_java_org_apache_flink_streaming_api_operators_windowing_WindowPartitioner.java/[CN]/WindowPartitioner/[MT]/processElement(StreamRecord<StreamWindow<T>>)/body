{
  if (keySelector == null) {
    if (numberOfSplits <= 1) {
      output.collect(currentWindow);
    }
 else {
      StreamWindow<T> unpackedWindow=currentWindow.getValue();
      for (      StreamWindow<T> window : StreamWindow.split(unpackedWindow,numberOfSplits)) {
        currentWindow.replace(window);
        output.collect(currentWindow);
      }
    }
  }
 else {
    for (    StreamWindow<T> window : StreamWindow.partitionBy(currentWindow.getValue(),keySelector,true)) {
      output.collect(new StreamRecord<StreamWindow<T>>(window));
    }
  }
}
