{
  FileDataSource input_left=new FileDataSource(new ContractITCaseInputFormat(),leftInPath);
  DelimitedInputFormat.configureDelimitedFormat(input_left).recordDelimiter('\n');
  input_left.setParallelism(config.getInteger("CrossTest#NoSubtasks",1));
  FileDataSource input_right=new FileDataSource(new ContractITCaseInputFormat(),rightInPath);
  DelimitedInputFormat.configureDelimitedFormat(input_right).recordDelimiter('\n');
  input_right.setParallelism(config.getInteger("CrossTest#NoSubtasks",1));
  CrossOperator testCross=CrossOperator.builder(new TestCross()).build();
  testCross.setParallelism(config.getInteger("CrossTest#NoSubtasks",1));
  testCross.getParameters().setString(Optimizer.HINT_LOCAL_STRATEGY,config.getString("CrossTest#LocalStrategy",""));
  if (config.getString("CrossTest#ShipStrategy","").equals("BROADCAST_FIRST")) {
    testCross.getParameters().setString(Optimizer.HINT_SHIP_STRATEGY_FIRST_INPUT,Optimizer.HINT_SHIP_STRATEGY_BROADCAST);
    testCross.getParameters().setString(Optimizer.HINT_SHIP_STRATEGY_SECOND_INPUT,Optimizer.HINT_SHIP_STRATEGY_FORWARD);
  }
 else   if (config.getString("CrossTest#ShipStrategy","").equals("BROADCAST_SECOND")) {
    testCross.getParameters().setString(Optimizer.HINT_SHIP_STRATEGY_FIRST_INPUT,Optimizer.HINT_SHIP_STRATEGY_BROADCAST);
    testCross.getParameters().setString(Optimizer.HINT_SHIP_STRATEGY_SECOND_INPUT,Optimizer.HINT_SHIP_STRATEGY_FORWARD);
  }
 else {
    testCross.getParameters().setString(Optimizer.HINT_SHIP_STRATEGY,config.getString("CrossTest#ShipStrategy",""));
  }
  FileDataSink output=new FileDataSink(new ContractITCaseOutputFormat(),resultPath);
  output.setParallelism(1);
  output.setInput(testCross);
  testCross.setFirstInput(input_left);
  testCross.setSecondInput(input_right);
  return new Plan(output);
}
