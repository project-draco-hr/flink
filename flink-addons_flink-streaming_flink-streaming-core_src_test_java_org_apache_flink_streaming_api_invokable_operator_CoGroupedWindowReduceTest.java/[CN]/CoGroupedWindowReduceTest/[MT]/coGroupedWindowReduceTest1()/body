{
  List<Long> timestamps1=Arrays.asList(0L,0L,1L,1L,1L,1L,2L,4L,5L,6L);
  List<Tuple2<String,Integer>> inputs1=new ArrayList<Tuple2<String,Integer>>();
  inputs1.add(new Tuple2<String,Integer>("a",1));
  inputs1.add(new Tuple2<String,Integer>("a",2));
  inputs1.add(new Tuple2<String,Integer>("a",3));
  inputs1.add(new Tuple2<String,Integer>("a",4));
  inputs1.add(new Tuple2<String,Integer>("a",5));
  inputs1.add(new Tuple2<String,Integer>("b",6));
  inputs1.add(new Tuple2<String,Integer>("a",7));
  inputs1.add(new Tuple2<String,Integer>("b",8));
  inputs1.add(new Tuple2<String,Integer>("b",9));
  inputs1.add(new Tuple2<String,Integer>("b",10));
  List<Long> timestamps2=Arrays.asList(1L,1L,2L,2L,3L,5L,5L,6L,7L);
  List<Tuple2<String,String>> inputs2=new ArrayList<Tuple2<String,String>>();
  inputs2.add(new Tuple2<String,String>("1","a"));
  inputs2.add(new Tuple2<String,String>("2","b"));
  inputs2.add(new Tuple2<String,String>("1","c"));
  inputs2.add(new Tuple2<String,String>("2","d"));
  inputs2.add(new Tuple2<String,String>("1","e"));
  inputs2.add(new Tuple2<String,String>("2","f"));
  inputs2.add(new Tuple2<String,String>("1","g"));
  inputs2.add(new Tuple2<String,String>("2","h"));
  inputs2.add(new Tuple2<String,String>("1","i"));
  List<String> expected=new ArrayList<String>();
  expected.add("6");
  expected.add("22");
  expected.add("27");
  expected.add("ace");
  expected.add("bd");
  expected.add("g");
  expected.add("fh");
  expected.add("i");
  CoGroupedWindowReduceInvokable<Tuple2<String,Integer>,Tuple2<String,String>,String> invokable=new CoGroupedWindowReduceInvokable<Tuple2<String,Integer>,Tuple2<String,String>,String>(new MyCoReduceFunction(),4L,3L,4L,3L,new TupleKeySelector(0),new TupleKeySelector(0),new MyTimeStamp<Tuple2<String,Integer>>(timestamps1),new MyTimeStamp<Tuple2<String,String>>(timestamps2));
  List<String> result=MockCoInvokable.createAndExecute(invokable,inputs1,inputs2);
  Collections.sort(result);
  Collections.sort(expected);
  assertEquals(expected,result);
}
