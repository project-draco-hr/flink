{
  if (currentValue != null) {
    currentValue=reducer.reduce(currentValue,nextValue);
  }
 else {
    currentValue=nextValue;
  }
  counter++;
  if (miniBatchEnd()) {
    addToBuffer();
    if (batchEnd()) {
      reduceBatch();
    }
  }
}
