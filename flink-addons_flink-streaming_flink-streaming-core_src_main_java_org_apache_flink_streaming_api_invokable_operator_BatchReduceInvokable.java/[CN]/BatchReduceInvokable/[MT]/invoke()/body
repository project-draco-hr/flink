{
  BatchIterator<IN> userIterator;
  if (window) {
    userIterator=new WindowIterator();
  }
 else {
    userIterator=new CounterIterator();
  }
  do {
    if (userIterator.hasNext()) {
      reducer.reduce(userIterator,collector);
      userIterator.reset();
    }
  }
 while (reuse != null);
}
