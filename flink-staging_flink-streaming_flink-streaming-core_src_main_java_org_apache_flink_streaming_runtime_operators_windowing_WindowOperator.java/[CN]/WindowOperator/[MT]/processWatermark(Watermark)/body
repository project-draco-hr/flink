{
  Set<Long> toRemove=new HashSet<>();
  for (  Map.Entry<Long,Set<TriggerContext>> triggers : watermarkTimers.entrySet()) {
    if (triggers.getKey() <= mark.getTimestamp()) {
      for (      TriggerContext trigger : triggers.getValue()) {
        Trigger.TriggerResult triggerResult=trigger.trigger.onTime(mark.getTimestamp(),trigger);
        processTriggerResult(triggerResult,trigger.key,trigger.window);
      }
      toRemove.add(triggers.getKey());
    }
  }
  for (  Long l : toRemove) {
    watermarkTimers.remove(l);
  }
  output.emitWatermark(mark);
}
