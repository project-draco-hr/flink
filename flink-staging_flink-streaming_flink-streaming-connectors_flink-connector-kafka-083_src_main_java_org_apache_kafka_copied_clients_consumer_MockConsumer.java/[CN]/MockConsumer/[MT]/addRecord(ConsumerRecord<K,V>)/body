{
  ensureNotClosed();
  TopicPartition tp=new TopicPartition(record.topic(),record.partition());
  this.subscriptions.assignedPartitions().add(tp);
  List<ConsumerRecord<K,V>> recs=this.records.get(tp);
  if (recs == null) {
    recs=new ArrayList<ConsumerRecord<K,V>>();
    this.records.put(tp,recs);
  }
  recs.add(record);
}
