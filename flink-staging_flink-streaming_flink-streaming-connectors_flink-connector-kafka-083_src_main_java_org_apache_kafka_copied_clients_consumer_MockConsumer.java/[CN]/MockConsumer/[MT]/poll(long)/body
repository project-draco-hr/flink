{
  ensureNotClosed();
  for (  Entry<TopicPartition,List<ConsumerRecord<K,V>>> entry : this.records.entrySet()) {
    List<ConsumerRecord<K,V>> recs=entry.getValue();
    if (!recs.isEmpty())     this.subscriptions.consumed(entry.getKey(),recs.get(recs.size() - 1).offset());
  }
  ConsumerRecords<K,V> copy=new ConsumerRecords<K,V>(this.records);
  this.records=new HashMap<TopicPartition,List<ConsumerRecord<K,V>>>();
  return copy;
}
