{
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  BatchTableEnvironment tableEnv=TableEnvironment.getTableEnvironment(env);
  DataSet<WC> input=env.fromElements(new WC("Hello",1),new WC("Ciao",1),new WC("Hello",1));
  tableEnv.registerDataSet("WordCount",input,"word, frequency");
  Table table=tableEnv.sql("SELECT word, SUM(frequency) as frequency FROM WordCount GROUP BY word");
  DataSet<WC> result=tableEnv.toDataSet(table,WC.class);
  result.print();
}
