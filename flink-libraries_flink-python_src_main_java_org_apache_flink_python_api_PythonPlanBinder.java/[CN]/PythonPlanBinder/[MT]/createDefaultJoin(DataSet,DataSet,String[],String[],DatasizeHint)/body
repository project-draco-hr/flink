{
switch (mode) {
case NONE:
    return op1.join(op2).where(firstKeys).equalTo(secondKeys);
case HUGE:
  return op1.joinWithHuge(op2).where(firstKeys).equalTo(secondKeys);
case TINY:
return op1.joinWithTiny(op2).where(firstKeys).equalTo(secondKeys);
default :
throw new IllegalArgumentException("Invalid join mode specified.");
}
}
