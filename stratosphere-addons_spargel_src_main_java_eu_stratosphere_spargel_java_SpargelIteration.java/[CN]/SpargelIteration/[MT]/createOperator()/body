{
  VertexUpdateUdf<VertexKey,VertexValue,Message> updateUdf=new VertexUpdateUdf<VertexKey,VertexValue,Message>(updateFunction);
  if (edgesWithoutValue != null) {
    MessagingUdfNoEdgeValues<VertexKey,VertexValue,Message> messenger=new MessagingUdfNoEdgeValues<VertexKey,VertexValue,Message>(messagingFunction);
    return new GraphIterationOperator<VertexKey,VertexValue,Message,Tuple2<VertexKey,VertexKey>>(initialVertices,edgesWithoutValue,updateUdf,messenger,messageType,maximumNumberOfIterations);
  }
 else {
    MessagingUdfWithEdgeValues<VertexKey,VertexValue,Message,EdgeValue> messenger=new MessagingUdfWithEdgeValues<VertexKey,VertexValue,Message,EdgeValue>(messagingFunction);
    return new GraphIterationOperator<VertexKey,VertexValue,Message,Tuple3<VertexKey,VertexKey,EdgeValue>>(initialVertices,edgesWithValue,updateUdf,messenger,messageType,maximumNumberOfIterations);
  }
}
