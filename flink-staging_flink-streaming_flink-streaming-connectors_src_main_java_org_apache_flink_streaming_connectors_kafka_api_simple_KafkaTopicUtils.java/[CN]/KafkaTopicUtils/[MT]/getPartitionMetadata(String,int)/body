{
  PartitionMetadata partitionMetadata=getPartitionMetadataWithErrorCode(topicName,partitionId);
switch (partitionMetadata.errorCode()) {
case 0:
    return partitionMetadata;
case 3:
  throw new UnknownTopicOrPartitionException("While fetching metadata for " + topicName + " / "+ partitionId);
case 5:
throw new LeaderNotAvailableException("While fetching metadata for " + topicName + " / "+ partitionId);
default :
throw new RuntimeException("Unknown error occurred while fetching metadata for " + topicName + " / "+ partitionId+ ", with error code: "+ partitionMetadata.errorCode());
}
}
