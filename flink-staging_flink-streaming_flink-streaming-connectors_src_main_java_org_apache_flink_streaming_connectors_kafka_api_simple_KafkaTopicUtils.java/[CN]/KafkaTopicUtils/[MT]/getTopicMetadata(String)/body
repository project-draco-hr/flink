{
  TopicMetadata topicMetadata=getTopicMetadataWithErrorCode(topicName);
switch (topicMetadata.errorCode()) {
case 0:
    return topicMetadata;
case 3:
  throw new UnknownTopicOrPartitionException("While fetching metadata for topic " + topicName);
case 5:
throw new LeaderNotAvailableException("While fetching metadata for topic " + topicName);
default :
throw new RuntimeException("Unknown error occurred while fetching metadata for topic " + topicName + ", with error code: "+ topicMetadata.errorCode());
}
}
