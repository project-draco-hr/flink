{
  isRunning=true;
  PartitionMetadata partitionMetadata=null;
  while (isRunning) {
    try {
      partitionMetadata=getPartitionMetadata(topicName,partitionId);
      return partitionMetadata;
    }
 catch (    LeaderNotAvailableException e) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Got {} trying to fetch metadata again",e.getMessage());
      }
    }
  }
  isRunning=false;
  return partitionMetadata;
}
