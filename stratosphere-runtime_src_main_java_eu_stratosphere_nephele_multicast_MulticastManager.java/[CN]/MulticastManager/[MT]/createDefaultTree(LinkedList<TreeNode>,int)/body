{
  LinkedList<TreeNode> connectedNodes=new LinkedList<TreeNode>();
  final TreeNode rootnode=nodes.pollFirst();
  TreeNode actualnode=rootnode;
  while (nodes.size() > 0) {
    for (int i=0; i < fanout; i++) {
      if (nodes.size() > 0) {
        TreeNode child=pollClosestNode(actualnode,nodes);
        actualnode.addChild(child);
        connectedNodes.add(child);
      }
 else {
        break;
      }
    }
    actualnode=connectedNodes.pollFirst();
  }
  LOG.info("created multicast tree with following topology:\n" + rootnode.printTree());
  return rootnode.createForwardingTable();
}
