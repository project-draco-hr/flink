def pickles(obj, exact=False, safe=False, **kwds):
    'quick check if object pickles with dill'
    if safe:
        exceptions = (Exception,)
    else:
        exceptions = (TypeError, AssertionError, PicklingError, UnpicklingError)
    try:
        pik = copy(obj, **kwds)
        try:
            result = bool((pik.all() == obj.all()))
        except AttributeError:
            result = (pik == obj)
        if result:
            return True
        if (not exact):
            return (type(pik) == type(obj))
        return False
    except exceptions:
        return False
