{
  final ParameterTool params=ParameterTool.fromArgs(args);
  System.out.println("Usage: TwitterStream --output <path> --props <path>");
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.getConfig().setGlobalJobParameters(params);
  DataStream<String> streamSource;
  if (params.has("props")) {
    streamSource=env.addSource(new TwitterSource(params.get("props")));
  }
 else {
    System.out.println("Executing TwitterStream example with default props.");
    System.out.println("Use --props to specify the path to the authentication info.");
    streamSource=env.fromElements(TwitterStreamData.TEXTS);
  }
  DataStream<Tuple2<String,Integer>> tweets=streamSource.flatMap(new SelectEnglishAndTokenizeFlatMap()).keyBy(0).sum(1);
  if (params.has("output")) {
    tweets.writeAsText(params.get("output"));
  }
 else {
    System.out.println("Printing result to stdout. Use --output to specify output path.");
    tweets.print();
  }
  env.execute("Twitter Streaming Example");
}
