{
switch (strategy) {
case FORWARD:
case PARTITION_RANDOM:
case PARTITION_FORCED_REBALANCE:
    return robin(numberOfChannels);
case PARTITION_HASH:
  return hashPartitionDefault(record,numberOfChannels);
case PARTITION_CUSTOM:
return customPartition(record,numberOfChannels);
case BROADCAST:
return broadcast(numberOfChannels);
case PARTITION_RANGE:
return rangePartition(record,numberOfChannels);
default :
throw new UnsupportedOperationException("Unsupported distribution strategy: " + strategy.name());
}
}
