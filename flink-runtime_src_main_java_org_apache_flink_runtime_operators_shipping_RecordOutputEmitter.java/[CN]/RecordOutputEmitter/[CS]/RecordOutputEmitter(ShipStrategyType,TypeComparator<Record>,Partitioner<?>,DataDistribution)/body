{
  if (strategy == null) {
    throw new NullPointerException();
  }
  this.strategy=strategy;
  this.comparator=comparator;
  this.distribution=distr;
  this.partitioner=(Partitioner<Object>)partitioner;
switch (strategy) {
case FORWARD:
case PARTITION_HASH:
case PARTITION_RANGE:
case PARTITION_RANDOM:
    this.channels=new int[1];
  break;
case BROADCAST:
case PARTITION_CUSTOM:
break;
default :
throw new IllegalArgumentException("Invalid shipping strategy for OutputEmitter: " + strategy.name());
}
if ((strategy == ShipStrategyType.PARTITION_RANGE) && distr == null) {
throw new NullPointerException("Data distribution must not be null when the ship strategy is range partitioning.");
}
if (strategy == ShipStrategyType.PARTITION_CUSTOM && partitioner == null) {
throw new NullPointerException("Partitioner must not be null when the ship strategy is set to custom partitioning.");
}
}
