{
  int bytesRemaining=this.readBufferLimit - this.readBufferPos;
  if (bytesRemaining > 0) {
    System.arraycopy(this.readBuffer,this.readBufferPos,this.readBuffer,0,bytesRemaining);
  }
  int toRead=(int)Math.min(this.streamEnd - this.streamPos,this.readBufferSize - bytesRemaining);
  if (toRead <= 0) {
    this.exhausted=true;
    return;
  }
  int read=this.stream.read(this.readBuffer,bytesRemaining,toRead);
  if (read <= 0) {
    this.exhausted=true;
  }
 else {
    this.streamPos+=read;
    this.readBufferPos=0;
    this.readBufferLimit=bytesRemaining + read;
  }
}
