{
  if (keyFields1.length != keyFields2.length || keyFields1.length != comparators1.length || keyFields2.length != comparators2.length) {
    throw new IllegalArgumentException("Number of key fields and comparators differ.");
  }
  int numKeys=keyFields1.length;
  this.keyFields1=keyFields1;
  this.keyFields2=keyFields2;
  this.comparators1=new TypeComparator[numKeys];
  this.comparators2=new TypeComparator[numKeys];
  for (int i=0; i < numKeys; i++) {
    this.comparators1[i]=comparators1[i].duplicate();
    this.comparators2[i]=comparators2[i].duplicate();
  }
}
