{
  while (iterator.hasNext()) {
    MessageWithMetadata msg=iterator.nextWithOffset();
    OUT out=schema.deserialize(msg.getMessage());
    collector.collect(out);
  }
}
