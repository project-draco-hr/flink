{
  while (iterator.hasNext()) {
    MessageWithOffset msg=iterator.nextWithOffset();
    gotMessage(msg);
    OUT out=schema.deserialize(msg.getMessage());
    collector.collect(out);
  }
}
