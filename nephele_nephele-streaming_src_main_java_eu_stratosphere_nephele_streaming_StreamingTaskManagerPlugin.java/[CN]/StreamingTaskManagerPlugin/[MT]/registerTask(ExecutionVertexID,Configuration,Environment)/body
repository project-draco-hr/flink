{
  final StreamingTaskListener listener=new StreamingTaskListener();
  for (int i=0; i < environment.getNumberOfOutputGates(); ++i) {
    final OutputGate<? extends Record> outputGate=environment.getOutputGate(i);
    outputGate.registerOutputGateListener(listener);
  }
  for (int i=0; i < environment.getNumberOfInputGates(); ++i) {
    final InputGate<? extends Record> inputGate=environment.getInputGate(i);
    inputGate.registerInputGateListener(listener);
  }
}
