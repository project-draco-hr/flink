{
  final int aggregationInterval=jobConfiguration.getInteger(AGGREGATION_INTERVAL_KEY,this.aggregationInterval);
  StreamingTaskListener listener=null;
  if (environment.getNumberOfInputGates() == 0) {
    final int taggingInterval=jobConfiguration.getInteger(TAGGING_INTERVAL_KEY,this.taggingInterval);
    listener=StreamingTaskListener.createForInputTask(id,taggingInterval,aggregationInterval);
  }
 else   if (environment.getNumberOfOutputGates() == 0) {
    listener=StreamingTaskListener.createForOutputTask(id,aggregationInterval);
  }
 else {
    listener=StreamingTaskListener.createForRegularTask(id,aggregationInterval);
  }
  for (int i=0; i < environment.getNumberOfOutputGates(); ++i) {
    final OutputGate<? extends Record> outputGate=environment.getOutputGate(i);
    outputGate.registerOutputGateListener(listener);
  }
  for (int i=0; i < environment.getNumberOfInputGates(); ++i) {
    final InputGate<? extends Record> inputGate=environment.getInputGate(i);
    inputGate.registerInputGateListener(listener);
  }
}
