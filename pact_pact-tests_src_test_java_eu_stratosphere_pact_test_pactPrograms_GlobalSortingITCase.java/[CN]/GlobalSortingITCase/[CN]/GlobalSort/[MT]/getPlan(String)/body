{
  int noSubtasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String recordsPath=(args.length > 1 ? args[1] : "");
  String output=(args.length > 2 ? args[2] : "");
  FileDataSource source=new FileDataSource(RecordInputFormat.class,recordsPath);
  source.setDegreeOfParallelism(noSubtasks);
  source.setParameter(RecordInputFormat.RECORD_DELIMITER,"\n");
  source.setParameter(RecordInputFormat.FIELD_DELIMITER_PARAMETER,"|");
  source.setParameter(RecordInputFormat.NUM_FIELDS_PARAMETER,1);
  source.getParameters().setClass(RecordInputFormat.FIELD_PARSER_PARAMETER_PREFIX + 0,DecimalTextIntParser.class);
  source.setParameter(RecordInputFormat.TEXT_POSITION_PARAMETER_PREFIX + 0,0);
  FileDataSink sink=new FileDataSink(RecordOutputFormat.class,output);
  sink.setDegreeOfParallelism(noSubtasks);
  sink.getParameters().setString(RecordOutputFormat.RECORD_DELIMITER_PARAMETER,"\n");
  sink.getParameters().setString(RecordOutputFormat.FIELD_DELIMITER_PARAMETER,"|");
  sink.getParameters().setBoolean(RecordOutputFormat.LENIENT_PARSING,true);
  sink.getParameters().setInteger(RecordOutputFormat.NUM_FIELDS_PARAMETER,1);
  sink.getParameters().setClass(RecordOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 0,PactInteger.class);
  sink.getParameters().setInteger(RecordOutputFormat.RECORD_POSITION_PARAMETER_PREFIX + 0,0);
  sink.setGlobalOrder(new Ordering(0,PactInteger.class,Order.ASCENDING),new UniformDistribution());
  sink.setInput(source);
  return new Plan(sink);
}
