{
  Thread runner=Thread.currentThread();
  while (in.hasNext()) {
    Pair<Key,Value> pair=in.next();
    this.stub.map(pair.getKey(),pair.getValue(),out);
    if (runner.isInterrupted()) {
      if (this.taskWasCanceled) {
        this.stub.close();
        break;
      }
 else {
        this.stub.close();
        throw new InterruptedException("Task thread was unexpectedly interrupted.");
      }
    }
  }
}
