{
  if (!parseParameters(args)) {
    return;
  }
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  DataSet<String> text=getTextDataSet(env);
  DataSet<Word> counts=text.flatMap(new Tokenizer()).groupBy("word").reduce(new ReduceFunction<Word>(){
    @Override public Word reduce(    Word value1,    Word value2) throws Exception {
      return new Word(value1.word,value1.frequency + value2.frequency);
    }
  }
);
  if (fileOutput) {
    counts.writeAsText(outputPath,WriteMode.OVERWRITE);
  }
 else {
    counts.print();
  }
  env.execute("WordCount-Pojo Example");
}
