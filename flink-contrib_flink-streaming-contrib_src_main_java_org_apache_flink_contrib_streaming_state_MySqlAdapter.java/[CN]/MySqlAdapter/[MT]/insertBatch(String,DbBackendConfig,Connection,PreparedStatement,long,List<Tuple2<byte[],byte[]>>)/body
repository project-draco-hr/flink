{
  SQLRetrier.retry(new Callable<Void>(){
    public Void call() throws Exception {
      for (      Tuple2<byte[],byte[]> kv : toInsert) {
        setKvInsertParams(stateId,insertStatement,checkpointId,kv.f0,kv.f1);
        insertStatement.addBatch();
      }
      insertStatement.executeBatch();
      insertStatement.clearBatch();
      return null;
    }
  }
,new Callable<Void>(){
    public Void call() throws Exception {
      insertStatement.clearBatch();
      return null;
    }
  }
,conf.getMaxNumberOfSqlRetries(),conf.getSleepBetweenSqlRetries());
}
