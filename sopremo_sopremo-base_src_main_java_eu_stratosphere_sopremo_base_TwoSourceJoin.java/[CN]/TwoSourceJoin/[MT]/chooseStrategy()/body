{
  this.inverseInputs=false;
  this.strategy=null;
  if (this.condition instanceof ComparativeExpression) {
    ComparativeExpression comparison=(ComparativeExpression)this.condition.clone();
switch (comparison.getBinaryOperator()) {
case EQUAL:
      EvaluationExpression[] expressions=this.sortExpressionsWithInput(comparison.getExpr1(),comparison.getExpr2());
    this.strategy=new OuterJoin().withMode(expressions[0].hasTag(ExpressionTag.RETAIN),expressions[1].hasTag(ExpressionTag.RETAIN)).withKeyExpression(0,expressions[0].remove(InputSelection.class)).withKeyExpression(1,expressions[1].remove(InputSelection.class));
  break;
default :
this.strategy=new ThetaJoin().withComparison(comparison);
}
}
 else if (this.condition instanceof ElementInSetExpression) {
ElementInSetExpression elementInSetExpression=(ElementInSetExpression)this.condition.clone();
this.inverseInputs=elementInSetExpression.getElementExpr().find(InputSelection.class).getIndex() == 1;
switch (elementInSetExpression.getQuantor()) {
case EXISTS_NOT_IN:
this.strategy=new AntiJoin().withKeyExpression(0,elementInSetExpression.getElementExpr().remove(InputSelection.class)).withKeyExpression(1,elementInSetExpression.getSetExpr().remove(InputSelection.class));
break;
case EXISTS_IN:
this.strategy=new SemiJoin().withKeyExpression(0,elementInSetExpression.getElementExpr().remove(InputSelection.class)).withKeyExpression(1,elementInSetExpression.getSetExpr().remove(InputSelection.class));
break;
}
}
if (this.strategy == null) throw new UnsupportedOperationException("condition " + this.condition + " not supported");
}
