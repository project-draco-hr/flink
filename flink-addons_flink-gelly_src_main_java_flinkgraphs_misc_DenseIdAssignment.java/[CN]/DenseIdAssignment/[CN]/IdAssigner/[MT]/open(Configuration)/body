{
  @SuppressWarnings("unchecked") List<Tuple2<Integer,Long>> counters=(List<Tuple2<Integer,Long>>)(List<?>)getRuntimeContext().getBroadcastVariable("COUNTERS");
  Collections.sort(counters,new Comparator<Tuple2<Integer,Long>>(){
    public int compare(    Tuple2<Integer,Long> o1,    Tuple2<Integer,Long> o2){
      return o1.f0.compareTo(o2.f0);
    }
  }
);
  int ourPartition=getRuntimeContext().getIndexOfThisSubtask();
  for (int i=0; i < ourPartition; i++) {
    id+=counters.get(i).f1;
  }
}
