{
  int parallelism=2;
  StreamExecutionEnvironment env=new TestStreamEnvironment(parallelism,MEMORYSIZE);
  iterated=new boolean[parallelism];
  env.setBufferTimeout(10);
  DataStream<Boolean> source=env.fromCollection(Collections.nCopies(parallelism,false));
  IterativeDataStream<Boolean> iteration=source.iterate(3000);
  DataStream<Boolean> increment=iteration.flatMap(new IterationHead()).flatMap(new IterationTail());
  iteration.closeWith(increment).addSink(new MySink());
  env.execute();
  for (  boolean iter : iterated) {
    assertTrue(iter);
  }
}
