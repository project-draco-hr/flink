{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  iterated=new boolean[DEFAULT_PARALLELISM];
  DataStream<Boolean> source=env.fromCollection(Collections.nCopies(DEFAULT_PARALLELISM * 2,false)).map(NoOpBoolMap).name("ParallelizeMap");
  IterativeStream<Boolean> iteration=source.iterate(3000);
  DataStream<Boolean> increment=iteration.flatMap(new IterationHead()).map(NoOpBoolMap);
  iteration.map(NoOpBoolMap).addSink(new ReceiveCheckNoOpSink());
  iteration.closeWith(increment).addSink(new ReceiveCheckNoOpSink());
  env.execute();
  for (  boolean iter : iterated) {
    assertTrue(iter);
  }
}
