{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Iteration source {} invoked with instance id {}",getName(),getInstanceID());
  }
  try {
    StreamRecord<OUT> nextRecord;
    while (true) {
      if (shouldWait) {
        nextRecord=dataChannel.poll(iterationWaitTime,TimeUnit.MILLISECONDS);
      }
 else {
        nextRecord=dataChannel.take();
      }
      if (nextRecord == null) {
        break;
      }
      for (      StreamOutput<?> output : outputs) {
        ((StreamOutput<OUT>)output).collect(nextRecord.getObject());
      }
    }
  }
 catch (  Exception e) {
    if (LOG.isErrorEnabled()) {
      LOG.error("Iteration source failed due to: {}",StringUtils.stringifyException(e));
    }
    throw e;
  }
 finally {
    outputHandler.flushOutputs();
    clearBuffers();
  }
}
