{
  int numSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String dataInput=(args.length > 1 ? args[1] : "");
  String output=(args.length > 2 ? args[2] : "");
  HadoopDataSource source=new HadoopDataSource(new TextInputFormat(),new JobConf(),"Input Lines");
  TextInputFormat.addInputPath(source.getJobConf(),new Path(dataInput));
  MapOperator mapper=MapOperator.builder(new TokenizeLine()).input(source).name("Tokenize Lines").build();
  ReduceOperator reducer=ReduceOperator.builder(CountWords.class,StringValue.class,0).input(mapper).name("Count Words").build();
  HadoopDataSink out=new HadoopDataSink(new TextOutputFormat<Text,IntWritable>(),new JobConf(),"Hadoop TextOutputFormat",reducer,Text.class,IntWritable.class);
  TextOutputFormat.setOutputPath(out.getJobConf(),new Path(output));
  Plan plan=new Plan(out,"Hadoop OutputFormat Example");
  plan.setDefaultParallelism(numSubTasks);
  return plan;
}
