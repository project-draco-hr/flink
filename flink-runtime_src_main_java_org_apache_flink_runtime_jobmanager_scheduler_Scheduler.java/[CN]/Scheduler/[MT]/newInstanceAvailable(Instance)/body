{
  if (instance == null) {
    throw new IllegalArgumentException();
  }
  if (instance.getNumberOfAvailableSlots() <= 0) {
    throw new IllegalArgumentException("The given instance has no resources.");
  }
  if (!instance.isAlive()) {
    throw new IllegalArgumentException("The instance is not alive.");
  }
synchronized (this.globalLock) {
    if (!this.allInstances.add(instance)) {
      throw new IllegalArgumentException("The instance is already contained.");
    }
    try {
      instance.setSlotAvailabilityListener(this);
    }
 catch (    IllegalStateException e) {
      this.allInstances.remove(instance);
      LOG.error("Scheduler could not attach to the instance as a listener.");
    }
    this.instancesWithAvailableResources.add(instance);
    for (int i=0; i < instance.getNumberOfAvailableSlots(); i++) {
      newSlotAvailable(instance);
    }
  }
}
