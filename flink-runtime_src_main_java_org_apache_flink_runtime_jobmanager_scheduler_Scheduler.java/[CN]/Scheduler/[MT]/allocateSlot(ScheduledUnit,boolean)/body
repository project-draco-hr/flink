{
  final Object ret=scheduleTask(task,allowQueued);
  if (ret instanceof SimpleSlot) {
    FlinkCompletableFuture<SimpleSlot> future=new FlinkCompletableFuture<>();
    future.complete((SimpleSlot)ret);
    return future;
  }
 else   if (ret instanceof Future) {
    return (Future)ret;
  }
 else {
    throw new RuntimeException();
  }
}
