{
  long hashjoinMemorySize=config.getSolutionSetMemory();
  TypeSerializerFactory<BT> solutionTypeSerializerFactory=config.getSolutionSetSerializer(userCodeClassLoader);
  TypeSerializerFactory<PT> probeSideSerializerFactory=config.getSolutionSetProberSerializer(userCodeClassLoader);
  TypeComparatorFactory<BT> solutionTypeComparatorFactory=config.getSolutionSetComparator(userCodeClassLoader);
  TypeComparatorFactory<PT> probeSideComparatorFactory=config.getSolutionSetProberComparator(userCodeClassLoader);
  TypePairComparatorFactory<BT,PT> pairComparatorFactory=config.getSolutionSetPairComparatorFactory(userCodeClassLoader);
  TypeSerializer<BT> solutionTypeSerializer=solutionTypeSerializerFactory.getSerializer();
  TypeSerializer<PT> probeSideSerializer=probeSideSerializerFactory.getSerializer();
  TypeComparator<BT> solutionTypeComparator=solutionTypeComparatorFactory.createComparator();
  TypeComparator<PT> probeSideComparator=probeSideComparatorFactory.createComparator();
  TypePairComparator<PT,BT> pairComparator=pairComparatorFactory.createComparator21(solutionTypeComparator,probeSideComparator);
  MutableHashTable<BT,PT> hashTable=null;
  List<MemorySegment> memSegments=null;
  boolean success=false;
  try {
    memSegments=getMemoryManager().allocatePages(getOwningNepheleTask(),hashjoinMemorySize);
    hashTable=new MutableHashTable<BT,PT>(solutionTypeSerializer,probeSideSerializer,solutionTypeComparator,probeSideComparator,pairComparator,memSegments,getIOManager());
    success=true;
    return hashTable;
  }
  finally {
    if (!success) {
      if (hashTable != null) {
        try {
          hashTable.close();
        }
 catch (        Throwable t) {
          log.error("Error closing the solution set hash table after unsuccessful creation.",t);
        }
      }
      if (memSegments != null) {
        try {
          getMemoryManager().release(memSegments);
        }
 catch (        Throwable t) {
          log.error("Error freeing memory after error during solution set hash table creation.",t);
        }
      }
    }
  }
}
