{
  EphemeralCheckpoint checkpoint=null;
synchronized (this.finishedCheckpoints) {
    checkpoint=this.finishedCheckpoints.remove(vertexID);
  }
  if (checkpoint == null) {
    LOG.error("Cannot find checkpoint for vertex " + vertexID);
    return;
  }
  ChannelID[] checkpointedChannels=checkpoint.getIDsOfCheckpointedOutputChannels();
  if (checkpointedChannels == null) {
    LOG.error("Cannot remove checkpoint for vertex " + vertexID + ": list of checkpointed channels is null");
    return;
  }
synchronized (this.channelIDToVertexIDMap) {
    for (int i=0; i < checkpointedChannels.length; i++) {
      this.channelIDToVertexIDMap.remove(checkpointedChannels[i]);
    }
  }
  checkpoint.remove();
}
