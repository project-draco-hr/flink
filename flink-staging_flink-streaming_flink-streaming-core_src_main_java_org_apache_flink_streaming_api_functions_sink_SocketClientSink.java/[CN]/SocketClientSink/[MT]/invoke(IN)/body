{
  byte[] msg=schema.serialize(value);
  try {
    dataOutputStream.write(msg);
  }
 catch (  IOException e) {
    if (LOG.isErrorEnabled()) {
      LOG.error("Cannot send message to socket server at " + hostName + ":"+ port,e);
    }
    throw new RuntimeException("Cannot send message \"" + value.toString() + "\" to socket server at "+ hostName+ ":"+ port,e);
  }
}
