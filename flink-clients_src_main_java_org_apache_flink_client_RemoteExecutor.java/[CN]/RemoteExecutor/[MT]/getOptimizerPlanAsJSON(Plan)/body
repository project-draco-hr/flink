{
  JobWithJars p=new JobWithJars(plan,this.jarFiles);
  Client c=new Client(this.address,new Configuration(),p.getUserCodeClassLoader());
  OptimizedPlan op=c.getOptimizedPlan(p,-1);
  PlanJSONDumpGenerator jsonGen=new PlanJSONDumpGenerator();
  return jsonGen.getOptimizerPlanAsJSON(op);
}
