{
  File jarFile=new File(jarPath);
  PackagedProgram program=new PackagedProgram(jarFile,assemblerClass,args);
  Client c=new Client(clientConfiguration,program.getUserCodeClassLoader(),-1);
  c.setPrintStatusDuringExecution(isPrintingStatusDuringExecution());
  JobSubmissionResult result=c.run(program.getPlanWithJars(),-1,true);
  if (result instanceof JobExecutionResult) {
    return (JobExecutionResult)result;
  }
 else {
    LOG.warn("The Client didn't return a JobExecutionResult");
    return new JobExecutionResult(result.getJobID(),-1,null);
  }
}
