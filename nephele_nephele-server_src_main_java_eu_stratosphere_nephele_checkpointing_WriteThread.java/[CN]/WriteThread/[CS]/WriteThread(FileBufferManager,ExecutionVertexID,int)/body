{
  this.fileBufferManager=fileBufferManager;
  this.vertexID=vertexID;
  this.numberOfConnectedChannels=numberOfConnectedChannels;
  this.queuedEnvelopes=new ArrayBlockingQueue<TransferEnvelope>(256);
  final boolean dist=CheckpointUtils.createDistributedCheckpoint();
  if (dist) {
    final Path p=CheckpointUtils.getDistributedCheckpointPath();
    if (p == null) {
      LOG.error("No distributed checkpoint path configured, writing local checkpoints instead");
      this.checkpointPath=CheckpointUtils.getLocalCheckpointPath();
      this.distributed=false;
    }
 else {
      this.checkpointPath=p;
      this.distributed=true;
    }
  }
 else {
    this.checkpointPath=CheckpointUtils.getLocalCheckpointPath();
    this.distributed=false;
  }
}
