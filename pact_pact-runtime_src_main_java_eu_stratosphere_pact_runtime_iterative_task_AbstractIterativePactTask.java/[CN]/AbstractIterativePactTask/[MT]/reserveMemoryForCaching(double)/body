{
  long completeMemorySize=getTaskConfig().getMemorySize();
  long cacheMemorySize=(long)(completeMemorySize * fraction);
  getTaskConfig().setMemorySize(completeMemorySize - cacheMemorySize);
  try {
    List<MemorySegment> memory=getMemoryManager().allocatePages(getOwningNepheleTask(),cacheMemorySize);
    return new SpillingBuffer(getIOManager(),new ListMemorySegmentSource(memory),getMemoryManager().getPageSize());
  }
 catch (  MemoryAllocationException e) {
    throw new IllegalStateException("Unable to allocate memory for input caching",e);
  }
}
