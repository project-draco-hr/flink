{
  DataSourceContract<Text,Text> source=new DataSourceContract<Text,Text>(TextFormatIn.class,getHDFSProvider().getHdfsHome() + "/" + TEST_FILE_IN);
  source.setFormatParameter("delimiter"," ");
  MapContract<Text,Text,Text,Integer> map=new MapContract<Text,Text,Text,Integer>(Mapper.class);
  ReduceContract<Text,Integer,Text,Integer> reduce=new ReduceContract<Text,Integer,Text,Integer>(Reducer.class);
  DataSinkContract<Text,Integer> sink=new DataSinkContract<Text,Integer>(TextFormatOut.class,getHDFSProvider().getHdfsHome() + "/" + TEST_FILE_OUT);
  sink.setInput(reduce);
  reduce.setInput(map);
  map.setInput(source);
  Plan plan=new Plan(sink);
  PactCompiler pc=new PactCompiler();
  OptimizedPlan op=pc.compile(plan);
  JobGraphGenerator jgg=new JobGraphGenerator();
  return jgg.compileJobGraph(op);
}
