{
  T copiedTuple=StreamRecord.copyTuple(tuple);
  List<String> outputs=(List<String>)outputSelector.getOutputs(tuple);
  int partitionHash=Math.abs(copiedTuple.getField(keyPostition).hashCode());
  for (  String outputName : outputs) {
    Collector<Tuple> notPartitionedCollector=notPartitionedOutputNameMap.get(outputName);
    Collector<Tuple>[] partitionedCollector=partitionedOutputNameMap.get(outputName);
    if (notPartitionedCollector != null) {
      notPartitionedCollector.collect(copiedTuple);
    }
 else     if (partitionedCollector != null) {
      partitionedCollector[partitionHash % partitionedCollector.length].collect(copiedTuple);
    }
  }
  outputSelector.clearList();
}
