{
  PactRecordIterator pactIter=getInputIterator(iterationIter);
  try {
    System.out.println(memorySize);
    sorter=new UnilateralSortMerger(memoryManager,ioManager,memorySize,64,comparators,keyPos,keyClasses,pactIter,this,0.8f);
  }
 catch (  Exception ex) {
    throw new RuntimeException("Error creating sorter",ex);
  }
  KeyGroupedIterator iter=new KeyGroupedIterator(sorter.getIterator(),keyPos,keyClasses);
  while (iter.nextKey()) {
    reduce(iter.getValues(),output);
  }
  sorter.close();
}
