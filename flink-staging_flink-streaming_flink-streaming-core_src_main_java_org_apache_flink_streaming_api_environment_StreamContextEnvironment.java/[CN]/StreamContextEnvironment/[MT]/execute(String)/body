{
  currentEnvironment=null;
  JobGraph jobGraph;
  if (jobName == null) {
    jobGraph=this.streamGraph.getJobGraph();
  }
 else {
    jobGraph=this.streamGraph.getJobGraph(jobName);
  }
  for (  File file : jars) {
    jobGraph.addJar(new Path(file.getAbsolutePath()));
  }
  JobSubmissionResult result=client.run(jobGraph,true);
  if (result instanceof JobExecutionResult) {
    return (JobExecutionResult)result;
  }
 else {
    LOG.warn("The Client didn't return a JobExecutionResult");
    return new JobExecutionResult(result.getJobID(),-1,null);
  }
}
