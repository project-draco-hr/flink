{
  if (readSet1 == null || readSet2 == null) {
    return null;
  }
  int[] readSet=FieldSetOperations.unionSets(readSet1,readSet2);
  if (keySet1 == null && keySet2 == null) {
    return readSet;
  }
 else   if (keySet1 == null || keySet2 == null) {
    throw new RuntimeException("Either both key sets must be defined or none");
  }
 else {
    int[] orderedKeySet=Arrays.copyOf(keySet1,keySet1.length);
    Arrays.sort(orderedKeySet);
    readSet=FieldSetOperations.unionSets(readSet,orderedKeySet);
    orderedKeySet=Arrays.copyOf(keySet2,keySet2.length);
    Arrays.sort(orderedKeySet);
    readSet=FieldSetOperations.unionSets(readSet,orderedKeySet);
    return readSet;
  }
}
