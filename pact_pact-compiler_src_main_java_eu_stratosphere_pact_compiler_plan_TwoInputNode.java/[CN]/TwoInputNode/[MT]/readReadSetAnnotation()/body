{
  DualInputContract<?> c=(DualInputContract<?>)super.getPactContract();
  ReadSetFirst readSet1Annotation=c.getUserCodeClass().getAnnotation(ReadSetFirst.class);
  ReadSetSecond readSet2Annotation=c.getUserCodeClass().getAnnotation(ReadSetSecond.class);
  if (readSet1Annotation == null) {
    this.readSet1=null;
  }
 else {
    this.readSet1=readSet1Annotation.fields();
    Arrays.sort(this.readSet1);
  }
  if (readSet2Annotation == null) {
    this.readSet2=null;
  }
 else {
    this.readSet2=readSet2Annotation.fields();
    Arrays.sort(this.readSet2);
  }
  if (c instanceof MatchContract || c instanceof CoGroupContract) {
    if (this.readSet1 != null) {
      int[] keySet1=c.getKeyColumnNumbers(0);
      Arrays.sort(keySet1);
      this.readSet1=FieldSetOperations.unionSets(keySet1,this.readSet1);
    }
    if (this.readSet2 != null) {
      int[] keySet2=c.getKeyColumnNumbers(1);
      Arrays.sort(keySet2);
      this.readSet2=FieldSetOperations.unionSets(keySet2,this.readSet1);
    }
  }
}
