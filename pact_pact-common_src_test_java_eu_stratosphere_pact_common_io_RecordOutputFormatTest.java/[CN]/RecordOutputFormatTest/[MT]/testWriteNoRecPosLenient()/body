{
  Configuration config=new Configuration();
  config.setString(RecordOutputFormat.FILE_PARAMETER_KEY,"file://" + this.tempFile.getAbsolutePath());
  config.setString(RecordOutputFormat.FIELD_DELIMITER_PARAMETER,"|");
  config.setInteger(RecordOutputFormat.NUM_FIELDS_PARAMETER,2);
  config.setClass(RecordOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 0,PactString.class);
  config.setClass(RecordOutputFormat.FIELD_TYPE_PARAMETER_PREFIX + 1,PactInteger.class);
  config.setBoolean(RecordOutputFormat.LENIENT_PARSING,true);
  format.configure(config);
  try {
    format.open(0);
  }
 catch (  IOException e) {
    fail(e.getMessage());
  }
  PactRecord r=new PactRecord(2);
  try {
    r.setField(0,new PactString("Hello World"));
    r.setField(1,new PactInteger(42));
    format.writeRecord(r);
    r.setNull(0);
    r.setField(1,new PactInteger(13));
    format.writeRecord(r);
    format.close();
    DataInputStream dis=new DataInputStream(new FileInputStream(tempFile));
    assertTrue((dis.readLine() + "\n").equals("Hello World|42\n"));
    assertTrue((dis.readLine() + "\n").equals("|13\n"));
  }
 catch (  IOException e) {
    fail(e.getMessage());
  }
}
