{
  final Source sampleSource=new Source(args[0]);
  final InitialClustering initialClustering=new InitialClustering().withInputs(sampleSource);
  final List<Sink> sinks=new ArrayList<Sink>();
  int i=1;
  for (  final JsonStream output : initialClustering.getOutputs()) {
    final Sink sink=new Sink(args[i++]).withInputs(output);
    sinks.add(sink);
  }
  final SopremoPlan sopremoPlan=new SopremoPlan();
  sopremoPlan.setSinks(sinks);
  final Plan pactPlan=sopremoPlan.asPactPlan();
  SopremoUtil.serialize(pactPlan.getPlanConfiguration(),SopremoUtil.CONTEXT,new EvaluationContext());
  return pactPlan;
}
