{
  @SuppressWarnings("unchecked") Iterator<Map<Object,OUT>> reducedIterator=(Iterator<Map<Object,OUT>>)batch.getIterator();
  Map<Object,OUT> reducedValues=reducedIterator.next();
  while (reducedIterator.hasNext()) {
    Map<Object,OUT> nextValues=reducedIterator.next();
    for (    Entry<Object,OUT> entry : nextValues.entrySet()) {
      OUT currentValue=reducedValues.get(entry.getKey());
      if (currentValue == null) {
        reducedValues.put(entry.getKey(),entry.getValue());
      }
 else {
        reducedValues.put(entry.getKey(),reducer.reduce(currentValue,entry.getValue()));
      }
    }
  }
  for (  OUT value : reducedValues.values()) {
    collector.collect(value);
  }
}
