{
  OUT nextValue=next.getObject();
  Object key=next.getField(keyPosition);
  checkBatchEnd(timestamp.getTimestamp(nextValue));
  OUT currentValue=currentValues.get(key);
  if (currentValue != null) {
    currentValues.put(key,reducer.reduce(currentValue,nextValue));
  }
 else {
    currentValues.put(key,nextValue);
  }
}
