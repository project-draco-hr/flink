{
  int numReadBuffers=0;
  int numIterations=0;
  while (true) {
    Buffer buffer;
    while ((buffer=reader.getNextBufferBlocking()) != null) {
      buffer.recycle();
      numReadBuffers++;
    }
    if (reader.isFinished()) {
      break;
    }
 else     if (reader.hasReachedEndOfSuperstep()) {
      reader.startNextSuperstep();
      numIterations++;
    }
 else {
      continue;
    }
  }
  assertEquals(expectedNumReadBuffers,numReadBuffers);
  assertEquals(expectedNumReadIterations,numIterations);
}
