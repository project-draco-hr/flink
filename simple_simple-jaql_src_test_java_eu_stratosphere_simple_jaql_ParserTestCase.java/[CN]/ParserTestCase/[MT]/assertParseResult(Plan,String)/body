{
  Plan parsedPlan;
  try {
    parsedPlan=new JaqlPlanCreator().getPlan(new ByteArrayInputStream(jaqlScript.getBytes()));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail("cannot parse jaql script: " + jaqlScript + " "+ e.toString());
    return;
  }
  if (parsedPlan == null && expected != null)   Assert.fail("empty plan unexpected");
  List<Operator> expectedNodes=expected.getAllNodes();
  List<Operator> actualNodes=parsedPlan.getAllNodes();
  if (expectedNodes.size() != actualNodes.size())   Assert.fail(String.format("%d nodes expected instead of %d",expectedNodes.size(),actualNodes.size()));
  for (int index=0; index < expectedNodes.size(); index++) {
    if (!expectedNodes.get(index).equals(actualNodes.get(index)))     Assert.fail(String.format("%d. node differs: %s expected instead of %s",index,expectedNodes.get(index),actualNodes.get(index)));
  }
}
