{
  JsonPath lastSegment=null, firstSegment=null;
  for (int index=0; index < parts.length; index++) {
    JsonPath segment;
    if (parts[index].equals("$"))     segment=new JsonPath.Input(0);
 else     if (parts[index].matches("[0-9]+"))     segment=new JsonPath.Input(Integer.parseInt(parts[index]));
 else     if (parts[index].matches("\\[.*\\]")) {
      if (parts[index].charAt(1) == '*')       segment=new JsonPath.ArrayAccess();
 else       if (parts[index].contains(":")) {
        int delim=parts[index].indexOf(":");
        segment=new JsonPath.ArrayAccess(Integer.parseInt(parts[index].substring(1,delim)),Integer.parseInt(parts[index].substring(delim + 1,parts[index].length() - 1)));
      }
 else       segment=new JsonPath.ArrayAccess(Integer.parseInt(parts[index].substring(1,parts[index].length() - 1)));
    }
 else     segment=new JsonPath.FieldAccess(parts[index]);
    if (lastSegment != null)     lastSegment.setSelector(segment);
 else     firstSegment=segment;
    lastSegment=segment;
  }
  return firstSegment;
}
