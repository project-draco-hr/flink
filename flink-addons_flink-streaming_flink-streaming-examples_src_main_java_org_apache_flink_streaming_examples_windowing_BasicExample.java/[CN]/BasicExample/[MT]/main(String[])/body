{
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment(PARALLELISM);
  ReduceFunction<String> reduceFunction=new ReduceFunction<String>(){
    /** 
 * Auto generates version ID
 */
    private static final long serialVersionUID=1L;
    @Override public String reduce(    String value1,    String value2) throws Exception {
      return value1 + "|" + value2;
    }
  }
;
  DataStream<Tuple2<String,String[]>> stream=env.addSource(new BasicSource()).window(Count.of(5)).every(Count.of(2)).reduce(reduceFunction);
  stream.print();
  env.execute();
}
