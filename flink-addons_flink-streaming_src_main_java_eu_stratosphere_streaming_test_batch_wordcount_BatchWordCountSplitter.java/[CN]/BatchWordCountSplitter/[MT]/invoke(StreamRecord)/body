{
  StreamRecordBatch records=(StreamRecordBatch)record;
  int numberOfRecords=records.getNumOfRecords();
  for (int i=0; i < numberOfRecords; ++i) {
    sentence=(StringValue)records.getField(i,0);
    timestamp=(LongValue)records.getField(i,1);
    words=sentence.getValue().split(" ");
    for (    CharSequence word : words) {
      wordValue.setValue(word);
      outputRecord.setField(0,wordValue);
      outputRecord.setField(1,timestamp);
      emit(outputRecord);
    }
  }
}
