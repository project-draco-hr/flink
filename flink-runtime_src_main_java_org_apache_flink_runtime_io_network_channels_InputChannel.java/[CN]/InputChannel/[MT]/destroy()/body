{
  final Queue<Buffer> buffersToRecycle=new ArrayDeque<Buffer>();
synchronized (this.queuedEnvelopes) {
    this.destroyCalled=true;
    while (!this.queuedEnvelopes.isEmpty()) {
      final Envelope envelope=this.queuedEnvelopes.poll();
      if (envelope.getBuffer() != null) {
        buffersToRecycle.add(envelope.getBuffer());
      }
    }
  }
  while (!buffersToRecycle.isEmpty()) {
    buffersToRecycle.poll().recycleBuffer();
  }
}
