{
  if (weClosedChannel) {
    return;
  }
  weClosedChannel=true;
  this.deserializer.clear();
  if (this.dataBuffer != null) {
    releasedConsumedReadBuffer(this.dataBuffer);
    this.dataBuffer=null;
  }
  while (!this.senderClosedChannel) {
    BufferOrEvent next=getNextBufferOrEvent();
    if (next != null) {
      if (next.isEvent()) {
        if (next.getEvent() instanceof ChannelCloseEvent) {
          this.senderClosedChannel=true;
        }
      }
 else {
        releasedConsumedReadBuffer(next.getBuffer());
      }
    }
 else {
      Thread.sleep(200);
    }
  }
  transferEventToOutputChannel(new ChannelCloseEvent());
}
