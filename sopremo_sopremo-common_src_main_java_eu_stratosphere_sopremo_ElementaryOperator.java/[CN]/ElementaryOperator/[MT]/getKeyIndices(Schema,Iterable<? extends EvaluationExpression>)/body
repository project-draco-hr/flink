{
  if (keyExpressions.equals(ALL_KEYS)) {
    final int[] allSchema=new int[globalSchema.getPactSchema().length];
    for (int index=0; index < allSchema.length; index++)     allSchema[index]=index;
    return allSchema;
  }
  final IntList keyIndices=new IntArrayList();
  for (  final EvaluationExpression expression : keyExpressions)   for (  final int index : globalSchema.indicesOf(expression))   keyIndices.add(index);
  if (keyIndices.isEmpty()) {
    if (keyExpressions.iterator().hasNext())     throw new IllegalStateException(String.format("Operator %s did not specify key expression that it now requires",this.getClass()));
    throw new IllegalStateException(String.format("Needs to specify key expressions: %s",this.getClass()));
  }
  return keyIndices.toIntArray();
}
