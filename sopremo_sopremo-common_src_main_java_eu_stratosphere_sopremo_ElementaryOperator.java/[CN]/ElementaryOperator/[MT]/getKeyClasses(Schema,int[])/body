{
  final Class<? extends Value>[] pactSchema=globalSchema.getPactSchema();
  final Class<? extends Key>[] keyClasses=new Class[keyIndices.length];
  for (int index=0; index < keyIndices.length; index++) {
    final Class<? extends Value> schemaClass=pactSchema[keyIndices[index]];
    if (!Key.class.isAssignableFrom(schemaClass))     throw new IllegalStateException("Schema wrapped a key value with a class that does not implement Key");
    keyClasses[index]=(Class<? extends Key>)schemaClass;
  }
  return keyClasses;
}
