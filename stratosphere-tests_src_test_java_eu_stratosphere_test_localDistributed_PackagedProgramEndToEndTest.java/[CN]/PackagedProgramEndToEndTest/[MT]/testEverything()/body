{
  LocalDistributedExecutor lde=new LocalDistributedExecutor();
  try {
    File points=File.createTempFile("kmeans_points",".in");
    File clusters=File.createTempFile("kmeans_clusters",".in");
    File outFile=File.createTempFile("kmeans_result",".out");
    points.deleteOnExit();
    clusters.deleteOnExit();
    outFile.deleteOnExit();
    FileWriter fwPoints=new FileWriter(points);
    fwPoints.write(KMeansStepITCase.DATAPOINTS);
    fwPoints.close();
    FileWriter fwClusters=new FileWriter(clusters);
    fwClusters.write(KMeansStepITCase.CLUSTERCENTERS);
    fwClusters.close();
    URL jarFileURL=getClass().getResource("/KMeansForTest.jar");
    String jarPath=jarFileURL.getFile();
    lde.start(2);
    RemoteExecutor ex=new RemoteExecutor("localhost",6498,new LinkedList<String>());
    ex.executeJar(jarPath,"eu.stratosphere.examples.scala.datamining.KMeansForTest",new String[]{"4","file://" + points.getAbsolutePath(),"file://" + clusters.getAbsolutePath(),"file://" + outFile.getAbsolutePath(),"1"});
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
 finally {
    try {
      lde.stop();
    }
 catch (    Exception e) {
      e.printStackTrace();
      Assert.fail(e.getMessage());
    }
  }
}
