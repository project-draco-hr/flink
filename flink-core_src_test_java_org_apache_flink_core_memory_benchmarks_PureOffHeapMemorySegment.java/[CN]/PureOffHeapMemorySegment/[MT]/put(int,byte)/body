{
  final long pos=address + index;
  if (index >= 0 && pos < addressLimit) {
    UNSAFE.putByte(pos,b);
  }
 else   if (address > addressLimit) {
    throw new IllegalStateException("This segment has been freed.");
  }
 else {
    throw new IndexOutOfBoundsException();
  }
}
