{
  Integer id=partInfo.f0;
  Integer numOfParts=partInfo.f1;
  Tuple2<Integer,Integer> currentPartInfo=receivedNumberOfParts.get(id);
  if (currentPartInfo != null) {
    currentPartInfo.f0+=numOfParts;
    currentPartInfo.f1++;
  }
 else {
    currentPartInfo=new Tuple2<Integer,Integer>(numOfParts,1);
    receivedNumberOfParts.put(id,currentPartInfo);
  }
  if (currentPartInfo.f1 >= numberOfDiscretizers) {
    receivedNumberOfParts.remove(id);
    Tuple2<StreamWindow<OUT>,Integer> current=receivedWindows.get(id);
    Integer count=current != null ? current.f1 : -1;
    if (count >= currentPartInfo.f0) {
      out.collect(current.f0);
      receivedWindows.remove(id);
      checkOld(id);
    }
 else     if (currentPartInfo.f0 > 0) {
      availableNumberOfParts.put(id,currentPartInfo.f1);
    }
  }
}
