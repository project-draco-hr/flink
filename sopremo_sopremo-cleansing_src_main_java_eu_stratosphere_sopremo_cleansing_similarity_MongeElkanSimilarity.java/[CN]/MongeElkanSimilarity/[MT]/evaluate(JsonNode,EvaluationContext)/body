{
  JsonNode leftValues=leftExpression.evaluate(node,context);
  JsonNode rightValues=rightExpression.evaluate(node,context);
  if (((ArrayNode)leftValues).size() == 0 || ((ArrayNode)rightValues).size() == 0)   return DoubleNode.valueOf(0);
  double sum=0;
  for (  JsonNode leftValue : (ArrayNode)leftValues) {
    double max=0;
    for (    JsonNode rightValue : (ArrayNode)rightValues) {
      max=Math.max(max,((DoubleNode)baseMeasure.evaluate(JsonUtil.asArray(leftValue,rightValue),context)).getDoubleValue());
    }
    sum+=max;
  }
  return DoubleNode.valueOf(sum / ((ArrayNode)leftValues).size());
}
