{
  JsonNode leftValues=this.leftExpression.evaluate(node,context);
  JsonNode rightValues=this.rightExpression.evaluate(node,context);
  if (leftValues.size() == 0 || rightValues.size() == 0)   return DoubleNode.valueOf(0);
  double sum=0;
  for (  JsonNode leftValue : leftValues) {
    double max=0;
    for (    JsonNode rightValue : rightValues)     max=Math.max(max,this.baseMeasure.evaluate(JsonUtil.asArray(leftValue,rightValue),context).getDoubleValue());
    sum+=max;
  }
  return DoubleNode.valueOf(sum / leftValues.size());
}
