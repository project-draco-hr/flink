{
  Preconditions.checkNotNull(state,"State map");
  if (stateDesc.isQueryable()) {
    this.state=new ConcurrentHashMap<>(state);
  }
 else {
    this.state=state;
  }
  this.keySerializer=Preconditions.checkNotNull(keySerializer);
  this.namespaceSerializer=Preconditions.checkNotNull(namespaceSerializer);
  this.stateSerializer=stateSerializer;
  this.stateDesc=stateDesc;
}
