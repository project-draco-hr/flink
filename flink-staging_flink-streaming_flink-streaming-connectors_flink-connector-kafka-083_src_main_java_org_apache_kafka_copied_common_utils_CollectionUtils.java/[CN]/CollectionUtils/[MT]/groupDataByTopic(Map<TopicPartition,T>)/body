{
  Map<String,Map<Integer,T>> dataByTopic=new HashMap<String,Map<Integer,T>>();
  for (  Map.Entry<TopicPartition,T> entry : data.entrySet()) {
    String topic=entry.getKey().topic();
    int partition=entry.getKey().partition();
    Map<Integer,T> topicData=dataByTopic.get(topic);
    if (topicData == null) {
      topicData=new HashMap<Integer,T>();
      dataByTopic.put(topic,topicData);
    }
    topicData.put(partition,entry.getValue());
  }
  return dataByTopic;
}
