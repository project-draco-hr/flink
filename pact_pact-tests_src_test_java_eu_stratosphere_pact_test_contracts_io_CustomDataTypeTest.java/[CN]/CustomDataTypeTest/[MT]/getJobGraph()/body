{
  GenericDataSource<EmptyInputFormat> datasource=new GenericDataSource<EmptyInputFormat>(EmptyInputFormat.class,"Source");
  datasource.getParameters().setString(CLASS_TO_INSTANTIATE_KEY,CLASS_TO_INSTANTIATE_NAME);
  GenericDataSink sink=new GenericDataSink(BlackholeOutputFormat.class,datasource,"Sink");
  sink.getParameters().setString(CLASS_TO_INSTANTIATE_KEY,CLASS_TO_INSTANTIATE_NAME);
  Plan plan=new Plan(sink);
  PactCompiler pc=new PactCompiler();
  OptimizedPlan op=pc.compile(plan);
  JobGraphGenerator jgg=new JobGraphGenerator();
  JobGraph jobGraph=jgg.compileJobGraph(op);
  URL jarFileURL=getClass().getResource(EXTERNAL_JAR_RESOURCE);
  jobGraph.addJar(new Path("file://" + jarFileURL.getPath()));
  return jobGraph;
}
