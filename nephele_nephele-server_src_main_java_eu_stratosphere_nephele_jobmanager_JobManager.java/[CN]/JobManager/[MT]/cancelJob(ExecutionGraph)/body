{
  TaskCancelResult errorResult=null;
synchronized (eg) {
    final Iterator<ExecutionVertex> it=new ExecutionGraphIterator(eg,eg.getIndexOfCurrentExecutionStage(),false,true);
    while (it.hasNext()) {
      final ExecutionVertex vertex=it.next();
      final TaskCancelResult result=vertex.cancelTask();
      if (result.getReturnCode() == AbstractTaskResult.ReturnCode.ERROR) {
        errorResult=result;
      }
    }
  }
  return errorResult;
}
