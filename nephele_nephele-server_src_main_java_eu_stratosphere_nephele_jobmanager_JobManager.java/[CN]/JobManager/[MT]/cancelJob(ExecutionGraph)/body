{
  TaskCancelResult errorResult=null;
  final Iterator<ExecutionVertex> it=new ExecutionGraphIterator(eg,eg.getIndexOfCurrentExecutionStage(),false,true);
  while (it.hasNext()) {
    final ExecutionVertex vertex=it.next();
    final ExecutionState state=vertex.getExecutionState();
    if (state != ExecutionState.FAILED) {
      final TaskCancelResult result=vertex.cancelTask();
      if (result.getReturnCode() == AbstractTaskResult.ReturnCode.ERROR) {
        errorResult=result;
      }
    }
  }
  return errorResult;
}
