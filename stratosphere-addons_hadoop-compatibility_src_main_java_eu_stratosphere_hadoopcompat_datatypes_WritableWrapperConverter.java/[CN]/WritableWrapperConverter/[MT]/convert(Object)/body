{
  if (!(in instanceof Writable)) {
    throw new RuntimeException("Found element that is not Writable. " + "It is " + in.getClass().getCanonicalName());
  }
  if (in instanceof WritableComparable) {
    return new WritableComparableWrapper((WritableComparable)in);
  }
  return new WritableWrapper((Writable)in);
}
