{
  String pathPrefix=getFilesystemProvider().getURIPrefix() + getFilesystemProvider().getTempDirPath();
  FileDataSource input1=new FileDataSource(new ContractITCaseInputFormat(),pathPrefix + config.getString("UnionTest#Input1Path",""));
  DelimitedInputFormat.configureDelimitedFormat(input1).recordDelimiter('\n');
  input1.setDegreeOfParallelism(config.getInteger("UnionTest#NoSubtasks",1));
  FileDataSource input2=new FileDataSource(new ContractITCaseInputFormat(),pathPrefix + config.getString("UnionTest#Input2Path",""));
  DelimitedInputFormat.configureDelimitedFormat(input2).recordDelimiter('\n');
  input2.setDegreeOfParallelism(config.getInteger("UnionTest#NoSubtasks",1));
  MapContract testMapper1=MapContract.builder(new TestMapper()).build();
  testMapper1.setDegreeOfParallelism(config.getInteger("UnionTest#NoSubtasks",1));
  MapContract testMapper2=MapContract.builder(new TestMapper()).build();
  testMapper2.setDegreeOfParallelism(config.getInteger("UnionTest#NoSubtasks",1));
  FileDataSink output=new FileDataSink(new ContractITCaseOutputFormat(),pathPrefix + "/result.txt");
  output.setDegreeOfParallelism(1);
  testMapper1.addInput(input1);
  testMapper2.addInput(input2);
  output.addInput(testMapper1);
  output.addInput(testMapper2);
  Plan plan=new Plan(output);
  PactCompiler pc=new PactCompiler(new DataStatistics());
  OptimizedPlan op=pc.compile(plan);
  NepheleJobGraphGenerator jgg=new NepheleJobGraphGenerator();
  return jgg.compileJobGraph(op);
}
