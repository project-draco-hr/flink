{
  Iterator<ExecutionVertex> it=new ExecutionGraphIterator(this,true);
  while (it.hasNext()) {
    final ExecutionVertex sourceVertex=it.next();
    for (int i=0; i < sourceVertex.getEnvironment().getNumberOfOutputGates(); i++) {
      final OutputGate<? extends Record> outputGate=sourceVertex.getEnvironment().getOutputGate(i);
      for (int j=0; j < outputGate.getNumberOfOutputChannels(); j++) {
        final AbstractOutputChannel<? extends Record> outputChannel=outputGate.getOutputChannel(j);
        final ChannelType channelType=outputChannel.getType();
        if (channelType == ChannelType.FILE || channelType == ChannelType.INMEMORY) {
          final ExecutionVertex targetVertex=getVertexByChannelID(outputChannel.getConnectedChannelID());
          targetVertex.setAllocatedResource(sourceVertex.getAllocatedResource());
        }
      }
    }
  }
  it=new ExecutionGraphIterator(this,false);
  while (it.hasNext()) {
    final ExecutionVertex targetVertex=it.next();
    for (int i=0; i < targetVertex.getEnvironment().getNumberOfInputGates(); i++) {
      final InputGate<? extends Record> inputGate=targetVertex.getEnvironment().getInputGate(i);
      for (int j=0; j < inputGate.getNumberOfInputChannels(); j++) {
        final AbstractInputChannel<? extends Record> inputChannel=inputGate.getInputChannel(j);
        final ChannelType channelType=inputChannel.getType();
        if (channelType == ChannelType.FILE || channelType == ChannelType.INMEMORY) {
          final ExecutionVertex sourceVertex=getVertexByChannelID(inputChannel.getConnectedChannelID());
          sourceVertex.setAllocatedResource(targetVertex.getAllocatedResource());
        }
      }
    }
  }
}
