{
  final InternalJobStatus oldStatus=this.jobStatus;
  LOG.info(newExecutionState);
  if (newExecutionState == ExecutionState.RERUNNING) {
    this.recovering.remove(getVertexByEnvironment(ee));
  }
  checkAndUpdateJobStatus(newExecutionState);
  if (newExecutionState == ExecutionState.FINISHED) {
    if (this.isCurrentStageCompleted()) {
      ++this.indexToCurrentExecutionStage;
      if (this.indexToCurrentExecutionStage < this.stages.size()) {
        final Iterator<ExecutionStageListener> it=this.executionStageListeners.iterator();
        final ExecutionStage nextExecutionStage=getCurrentExecutionStage();
        while (it.hasNext()) {
          it.next().nextExecutionStageEntered(ee.getJobID(),nextExecutionStage);
        }
      }
    }
  }
  if (this.jobStatus == InternalJobStatus.RECOVERING) {
    LOG.info("RECOVERING");
    this.recovering.add(this.getVertexByEnvironment(ee));
  }
  if (this.jobStatus != oldStatus) {
    if (this.jobStatus == InternalJobStatus.FAILING) {
      this.errorDescription=optionalMessage;
    }
    if (this.jobStatus == InternalJobStatus.FAILED) {
      optionalMessage=this.errorDescription;
    }
    final Iterator<JobStatusListener> it=this.jobStatusListeners.iterator();
    while (it.hasNext()) {
      it.next().jobStatusHasChanged(this,this.jobStatus,optionalMessage);
    }
  }
}
