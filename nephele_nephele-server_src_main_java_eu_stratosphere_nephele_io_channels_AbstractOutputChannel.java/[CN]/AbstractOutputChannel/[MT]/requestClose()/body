{
  if (!this.closeRequested) {
    this.closeRequested=true;
    if (this.recordSerializer.dataLeftFromPreviousSerialization()) {
      flush();
    }
    if (!isBroadcastChannel() || getChannelIndex() == 0) {
      transferEvent(new ChannelCloseEvent());
      flush();
    }
  }
}
