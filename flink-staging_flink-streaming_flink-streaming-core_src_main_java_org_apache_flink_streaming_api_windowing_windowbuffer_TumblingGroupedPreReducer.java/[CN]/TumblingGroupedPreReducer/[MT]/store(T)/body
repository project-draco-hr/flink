{
  Object key=keySelector.getKey(element);
  T reduced=reducedValues.get(key);
  if (reduced == null) {
    reduced=element;
  }
 else {
    reduced=reducer.reduce(serializer.copy(reduced),element);
  }
  reducedValues.put(key,reduced);
  if (emitPerGroup && !keyInstancePerKey.containsKey(key)) {
    keyInstancePerKey.put(key,element);
  }
}
