def flat_map(self, operator, types):
    '\n        Applies a FlatMap transformation on a DataSet.\n\n        The transformation calls a FlatMapFunction for each element of the DataSet.\n        Each FlatMapFunction call can return any number of elements including none.\n\n        :param operator: The FlatMapFunction that is called for each element of the DataSet.\n        :param types: The type of the resulting DataSet.\n        :return:A FlatMapOperator that represents the transformed DataSe\n        '
    if isinstance(operator, TYPES.FunctionType):
        f = operator
        operator = FlatMapFunction()
        operator.flat_map = f
    child = dict()
    child_set = OperatorSet(self._env, child)
    child[_Fields.IDENTIFIER] = _Identifier.FLATMAP
    child[_Fields.PARENT] = self._info
    child[_Fields.OPERATOR] = operator
    child[_Fields.META] = ((str(inspect.getmodule(operator)) + '|') + str(operator.__class__.__name__))
    child[_Fields.TYPES] = types
    child[_Fields.NAME] = 'PythonFlatMap'
    self._info[_Fields.CHILDREN].append(child)
    self._env._sets.append(child)
    return child_set
