{
  File tempFile;
  String FIRST="First line";
  String SECOND="Second line";
  String CONTENT=FIRST + lineBreaker + SECOND+ lineBreaker;
  try {
    tempFile=File.createTempFile("TextInputFormatTest","tmp");
    tempFile.deleteOnExit();
    tempFile.setWritable(true);
    OutputStreamWriter wrt=new OutputStreamWriter(new FileOutputStream(tempFile));
    wrt.write(CONTENT);
    wrt.close();
    TextInputFormat inputFormat=new TextInputFormat();
    inputFormat.setFilePath(tempFile.toURI().toString());
    Configuration parameters=new Configuration();
    inputFormat.configure(parameters);
    inputFormat.setDelimiter(delimiter);
    FileInputSplit[] splits=inputFormat.createInputSplits(1);
    inputFormat.open(splits[0]);
    Record r=new Record();
    if ((delimiter.equals("\n") && (lineBreaker.equals("\n") || lineBreaker.equals("\r\n"))) || (lineBreaker.equals(delimiter))) {
      assertNotNull("Expecting first record here",inputFormat.nextRecord(r));
      assertEquals(FIRST,r.getField(0,StringValue.class).getValue());
      assertNotNull("Expecting second record here",inputFormat.nextRecord(r));
      assertEquals(SECOND,r.getField(0,StringValue.class).getValue());
      assertNull("The input file is over",inputFormat.nextRecord(r));
    }
 else {
      assertNotNull("Expecting first record here",inputFormat.nextRecord(r));
      assertEquals(CONTENT,r.getField(0,StringValue.class).getValue());
    }
  }
 catch (  Throwable t) {
    System.err.println("test failed with exception: " + t.getMessage());
    t.printStackTrace(System.err);
    fail("Test erroneous");
  }
}
