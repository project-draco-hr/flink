{
  if (value.isRecord()) {
    StreamRecord<T> record=value.asRecord();
    target.writeLong(record.getTimestamp());
    typeSerializer.serialize(record.getValue(),target);
  }
 else   if (value.isWatermark()) {
    target.writeLong(IS_WATERMARK);
    target.writeLong(value.asWatermark().getTimestamp());
  }
 else {
    throw new RuntimeException();
  }
}
