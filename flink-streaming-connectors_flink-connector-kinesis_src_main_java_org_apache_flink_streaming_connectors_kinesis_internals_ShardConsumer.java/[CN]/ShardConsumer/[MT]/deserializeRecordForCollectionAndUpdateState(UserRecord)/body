{
  ByteBuffer recordData=record.getData();
  byte[] dataBytes=new byte[recordData.remaining()];
  recordData.get(dataBytes);
  byte[] keyBytes=record.getPartitionKey().getBytes();
  final T value=deserializer.deserialize(keyBytes,dataBytes,subscribedShard.getStreamName(),record.getSequenceNumber());
  if (record.isAggregated()) {
    fetcherRef.emitRecordAndUpdateState(value,subscribedShardStateIndex,new SequenceNumber(record.getSequenceNumber(),record.getSubSequenceNumber()));
  }
 else {
    fetcherRef.emitRecordAndUpdateState(value,subscribedShardStateIndex,new SequenceNumber(record.getSequenceNumber()));
  }
}
