{
  final int bucketsPerSegment=this.bucketsPerSegmentMask + 1;
  for (  MemorySegment segment : this.buckets) {
    for (int i=0; i < bucketsPerSegment; i++) {
      final int bucketInSegmentOffset=i * HASH_BUCKET_SIZE;
      byte partitionNumber=segment.get(bucketInSegmentOffset + HEADER_PARTITION_OFFSET);
      if (partitionNumber == partNum) {
        byte status=segment.get(bucketInSegmentOffset + HEADER_STATUS_OFFSET);
        if (status == BUCKET_STATUS_IN_MEMORY) {
          buildBloomFilterForBucket(bucketInSegmentOffset,segment,partition);
        }
      }
    }
  }
}
