{
  super(struct);
  responses=new HashMap<TopicPartition,PartitionResponse>();
  for (  Object topicResponse : struct.getArray("responses")) {
    Struct topicRespStruct=(Struct)topicResponse;
    String topic=topicRespStruct.getString("topic");
    for (    Object partResponse : topicRespStruct.getArray("partition_responses")) {
      Struct partRespStruct=(Struct)partResponse;
      int partition=partRespStruct.getInt("partition");
      short errorCode=partRespStruct.getShort("error_code");
      long offset=partRespStruct.getLong("base_offset");
      TopicPartition tp=new TopicPartition(topic,partition);
      responses.put(tp,new PartitionResponse(errorCode,offset));
    }
  }
}
