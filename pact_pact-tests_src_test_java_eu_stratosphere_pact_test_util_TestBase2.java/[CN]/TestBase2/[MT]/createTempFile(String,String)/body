{
  File baseDir=new File(System.getProperty("java.io.tmpdir"));
  File f=new File(baseDir,fileName);
  if (f.exists()) {
    deleteRecursively(f);
  }
  File parentToDelete=f;
  while (true) {
    File parent=parentToDelete.getParentFile();
    if (parent == null) {
      throw new IOException("Missed temp dir while traversing parents of a temp file.");
    }
    if (parent.equals(baseDir)) {
      break;
    }
    parentToDelete=parent;
  }
  Files.createParentDirs(f);
  Files.write(contents,f,Charsets.UTF_8);
  this.tempFiles.add(parentToDelete);
  return "file://" + f.getAbsolutePath();
}
