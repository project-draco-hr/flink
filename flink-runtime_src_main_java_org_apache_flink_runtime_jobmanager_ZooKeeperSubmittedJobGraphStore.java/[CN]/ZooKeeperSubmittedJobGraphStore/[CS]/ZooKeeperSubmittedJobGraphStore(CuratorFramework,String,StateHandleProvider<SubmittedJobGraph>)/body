{
  checkNotNull(currentJobsPath,"Current jobs path");
  checkNotNull(stateHandleProvider,"State handle provider");
  this.client=checkNotNull(client,"Curator client");
  client.newNamespaceAwareEnsurePath(currentJobsPath).ensure(client.getZookeeperClient());
  client=client.usingNamespace(client.getNamespace() + currentJobsPath);
  this.jobGraphsInZooKeeper=new ZooKeeperStateHandleStore<>(client,stateHandleProvider);
  this.pathCache=new PathChildrenCache(client,"/",false);
  pathCache.getListenable().addListener(new SubmittedJobGraphsPathCacheListener());
}
