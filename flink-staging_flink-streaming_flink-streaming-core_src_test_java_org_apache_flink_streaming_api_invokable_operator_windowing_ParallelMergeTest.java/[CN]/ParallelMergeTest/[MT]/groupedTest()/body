{
  TestCollector<StreamWindow<Integer>> out=new TestCollector<StreamWindow<Integer>>();
  List<StreamWindow<Integer>> output=out.getCollected();
  ParallelMerge<Integer> merger=new ParallelGroupedMerge<Integer>();
  merger.numberOfDiscretizers=2;
  merger.flatMap1(createTestWindow(1),out);
  merger.flatMap1(createTestWindow(1),out);
  merger.flatMap2(new Tuple2<Integer,Integer>(1,1),out);
  assertTrue(output.isEmpty());
  merger.flatMap2(new Tuple2<Integer,Integer>(1,1),out);
  assertEquals(StreamWindow.fromElements(1,1),output.get(0));
}
