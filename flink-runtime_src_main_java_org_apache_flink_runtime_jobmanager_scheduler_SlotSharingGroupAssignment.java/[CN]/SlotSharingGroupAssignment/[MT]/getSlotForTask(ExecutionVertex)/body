{
synchronized (lock) {
    Pair<SharedSlot,Locality> p=getSlotForTaskInternal(vertex.getJobvertexId(),vertex,vertex.getPreferredLocations(),false);
    if (p != null) {
      SharedSlot ss=p.getLeft();
      SimpleSlot slot=ss.allocateSubSlot(vertex.getJobvertexId());
      slot.setLocality(p.getRight());
      return slot;
    }
 else {
      return null;
    }
  }
}
