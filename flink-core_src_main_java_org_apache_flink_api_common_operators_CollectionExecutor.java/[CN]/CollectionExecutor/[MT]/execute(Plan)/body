{
  long startTime=System.currentTimeMillis();
  JobID jobID=program.getJobId();
  if (jobID == null) {
    jobID=new JobID();
  }
  this.jobMetricGroup=new TaskManagerMetricGroup(new MetricRegistry(new Configuration()),"localhost",new AbstractID().toString()).addJob(jobID,program.getJobName());
  initCache(program.getCachedFiles());
  Collection<? extends GenericDataSinkBase<?>> sinks=program.getDataSinks();
  for (  Operator<?> sink : sinks) {
    execute(sink);
  }
  long endTime=System.currentTimeMillis();
  Map<String,Object> accumulatorResults=AccumulatorHelper.toResultMap(accumulators);
  return new JobExecutionResult(null,endTime - startTime,accumulatorResults);
}
