{
  @SuppressWarnings("unchecked") GenericDataSourceBase<OUT,?> typedSource=(GenericDataSourceBase<OUT,?>)source;
  RuntimeUDFContext ctx;
  if (RichInputFormat.class.isAssignableFrom(typedSource.getUserCodeWrapper().getUserCodeClass())) {
    ctx=superStep == 0 ? new RuntimeUDFContext(source.getName(),1,0,getClass().getClassLoader(),executionConfig,cachedFiles,accumulators) : new IterationRuntimeUDFContext(source.getName(),1,0,classLoader,executionConfig,cachedFiles,accumulators);
  }
 else {
    ctx=null;
  }
  return typedSource.executeOnCollections(ctx,executionConfig);
}
