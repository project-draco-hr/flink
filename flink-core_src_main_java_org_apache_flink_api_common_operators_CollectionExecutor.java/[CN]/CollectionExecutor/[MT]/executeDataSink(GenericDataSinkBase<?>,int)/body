{
  Operator<?> inputOp=sink.getInput();
  if (inputOp == null) {
    throw new InvalidProgramException("The data sink " + sink.getName() + " has no input.");
  }
  @SuppressWarnings("unchecked") List<IN> input=(List<IN>)execute(inputOp);
  @SuppressWarnings("unchecked") GenericDataSinkBase<IN> typedSink=(GenericDataSinkBase<IN>)sink;
  RuntimeUDFContext ctx;
  if (RichOutputFormat.class.isAssignableFrom(typedSink.getUserCodeWrapper().getUserCodeClass())) {
    ctx=superStep == 0 ? new RuntimeUDFContext(typedSink.getName(),1,0,getClass().getClassLoader(),executionConfig,accumulators) : new IterationRuntimeUDFContext(typedSink.getName(),1,0,classLoader,executionConfig,accumulators);
  }
 else {
    ctx=null;
  }
  typedSink.executeOnCollections(input,ctx,executionConfig);
}
