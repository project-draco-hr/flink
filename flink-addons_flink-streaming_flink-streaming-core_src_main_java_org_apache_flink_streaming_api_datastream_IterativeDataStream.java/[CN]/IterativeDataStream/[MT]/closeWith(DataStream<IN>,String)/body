{
  DataStream<R> returnStream=new DataStreamSink<R>(environment,"iterationSink");
  jobGraphBuilder.addIterationSink(returnStream.getId(),iterationTail.getId(),iterationID.toString(),iterationTail.getParallelism(),waitTime);
  jobGraphBuilder.setIterationSourceSettings(iterationID.toString(),iterationTail.getId());
  List<String> name=Arrays.asList(new String[]{iterationName});
  if (iterationTail instanceof MergedDataStream) {
    for (    DataStream<IN> stream : ((MergedDataStream<IN>)iterationTail).mergedStreams) {
      String inputID=stream.getId();
      jobGraphBuilder.setEdge(inputID,returnStream.getId(),new ForwardPartitioner<IN>(),0,name);
    }
  }
 else {
    jobGraphBuilder.setEdge(iterationTail.getId(),returnStream.getId(),new ForwardPartitioner<IN>(),0,name);
  }
  return iterationTail;
}
