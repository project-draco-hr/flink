{
  LineItemFilter out=new LineItemFilter();
  String shipDate="1996-03-13";
  Tuple input=createInputTuple(shipDate);
  IntValue inputKey=new IntValue();
  Record rec=new Record();
  rec.setField(0,inputKey);
  rec.setField(1,input);
  Collector<Record> collector=new RecordOutputCollector(writerList);
  StringValue returnFlag=new StringValue(RETURN_FLAG);
  out.map(rec,collector);
  ArgumentCaptor<Record> argument=ArgumentCaptor.forClass(Record.class);
  verify(recordWriterMock).emit(argument.capture());
  assertEquals(returnFlag,argument.getValue().getField(0,StringValue.class));
  assertEquals(input,argument.getValue().getField(1,Record.class));
}
