{
  if (!parseParameters(args)) {
    return;
  }
  final StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  DataStream<String> text=env.socketTextStream(hostname,port);
  DataStream<Tuple2<String,Integer>> counts=text.flatMap(new WordCount.Tokenizer()).groupBy(0).sum(1);
  if (fileOutput) {
    counts.writeAsText(outputPath,1);
  }
 else {
    counts.print();
  }
  env.execute("WordCount with SocketTextStream Example");
}
