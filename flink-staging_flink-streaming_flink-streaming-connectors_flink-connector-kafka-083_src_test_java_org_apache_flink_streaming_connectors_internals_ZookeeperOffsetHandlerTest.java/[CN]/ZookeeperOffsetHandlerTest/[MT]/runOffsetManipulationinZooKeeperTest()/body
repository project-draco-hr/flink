{
  try {
    final String topicName="ZookeeperOffsetHandlerTest-Topic";
    final String groupId="ZookeeperOffsetHandlerTest-Group";
    final long offset=(long)(Math.random() * Long.MAX_VALUE);
    ZkClient zkClient=createZookeeperClient();
    AdminUtils.createTopic(zkClient,topicName,3,2,new Properties());
    ZookeeperOffsetHandler.setOffsetInZooKeeper(zkClient,groupId,topicName,0,offset);
    long fetchedOffset=ZookeeperOffsetHandler.getOffsetFromZooKeeper(zkClient,groupId,topicName,0);
    zkClient.close();
    assertEquals(offset,fetchedOffset);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
