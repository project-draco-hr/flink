{
  final AggregationFunction<Object>[] aggFunctions=this.aggFunctions;
  final int[] fieldPositions=this.fieldPositions;
  T current=null;
  final Iterator<T> values=records.iterator();
  while (values.hasNext()) {
    current=values.next();
    for (int i=0; i < fieldPositions.length; i++) {
      try {
        Object val=current.getFieldNotNull(fieldPositions[i]);
        aggFunctions[i].aggregate(val);
      }
 catch (      NullKeyFieldException e) {
        throw new NullFieldException(fieldPositions[i]);
      }
    }
  }
  for (int i=0; i < fieldPositions.length; i++) {
    Object aggVal=aggFunctions[i].getAggregate();
    current.setField(aggVal,fieldPositions[i]);
    aggFunctions[i].initializeAggregate();
  }
  out.collect(current);
}
