{
  final int numSubtasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  final String recordsPath=(args.length > 1 ? args[1] : "");
  final String output=(args.length > 2 ? args[2] : "");
  @SuppressWarnings("unchecked") FileDataSource source=new FileDataSource(new CsvInputFormat(',',IntValue.class,IntValue.class,IntValue.class),recordsPath);
  FileDataSink sink=new FileDataSink(CsvOutputFormat.class,output);
  CsvOutputFormat.configureRecordFormat(sink).recordDelimiter('\n').fieldDelimiter(',').lenient(true).field(IntValue.class,0).field(IntValue.class,1).field(IntValue.class,2);
  sink.setGlobalOrder(new Ordering(0,IntValue.class,Order.DESCENDING).appendOrdering(1,IntValue.class,Order.ASCENDING).appendOrdering(2,IntValue.class,Order.DESCENDING),new TripleIntDistribution(Order.DESCENDING,Order.ASCENDING,Order.DESCENDING));
  sink.setInput(source);
  Plan p=new Plan(sink);
  p.setDefaultParallelism(numSubtasks);
  return p;
}
