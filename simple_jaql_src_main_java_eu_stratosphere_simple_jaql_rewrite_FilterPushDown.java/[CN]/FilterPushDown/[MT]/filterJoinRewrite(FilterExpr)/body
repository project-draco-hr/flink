{
  VarMap vm=new VarMap();
  JoinExpr join_expr=(JoinExpr)filter_expr.binding().inExpr();
  if (join_expr.numBindings() > 2)   return false;
  boolean left_preserve=join_expr.binding(0).preserve;
  boolean right_preserve=join_expr.binding(1).preserve;
  Expr left_child=join_expr.binding(0).inExpr();
  Expr right_child=join_expr.binding(1).inExpr();
  MappingTable left_mt=left_child.getMappingTable();
  MappingTable right_mt=right_child.getMappingTable();
  Var filter_pipe_var=filter_expr.binding().var;
  if (left_mt.replaceVarInAfterExpr(filter_pipe_var) == false)   return false;
  if (right_mt.replaceVarInAfterExpr(filter_pipe_var) == false)   return false;
  ArrayList<Expr> left_pushed_pred=new ArrayList<Expr>();
  ArrayList<Expr> right_pushed_pred=new ArrayList<Expr>();
  for (int k=0; k < filter_expr.conjunctivePred_count(); k++) {
    Expr crnt_pred=filter_expr.conjunctivePred(k);
    ArrayList<Expr> usedIn_list=findMaximalVarOrPathExpr(crnt_pred,filter_pipe_var);
    if (usedIn_list.size() == 0) {
      left_pushed_pred.add(crnt_pred);
      right_pushed_pred.add(crnt_pred.clone(vm));
      continue;
    }
    ArrayList<Expr> mappedTo_list=predMappedTo(usedIn_list,left_mt,false);
    if ((mappedTo_list != null) && (!right_preserve)) {
      left_pushed_pred.add(crnt_pred);
      continue;
    }
    mappedTo_list=predMappedTo(usedIn_list,right_mt,false);
    if ((mappedTo_list != null) && (!left_preserve)) {
      right_pushed_pred.add(crnt_pred);
      continue;
    }
  }
  if ((left_pushed_pred.size() == 0) && (right_pushed_pred.size() == 0))   return false;
  for (int i=0; i < left_pushed_pred.size(); i++)   left_pushed_pred.get(i).detach();
  for (int i=0; i < right_pushed_pred.size(); i++)   right_pushed_pred.get(i).detach();
  if (filter_expr.conjunctivePred_count() == 0)   filter_expr.replaceInParent(filter_expr.binding().inExpr());
  if (left_pushed_pred.size() > 0)   plugin_filter_below_join(left_pushed_pred,filter_pipe_var,join_expr,0);
  if (right_pushed_pred.size() > 0)   plugin_filter_below_join(right_pushed_pred,filter_pipe_var,join_expr,1);
  return true;
}
