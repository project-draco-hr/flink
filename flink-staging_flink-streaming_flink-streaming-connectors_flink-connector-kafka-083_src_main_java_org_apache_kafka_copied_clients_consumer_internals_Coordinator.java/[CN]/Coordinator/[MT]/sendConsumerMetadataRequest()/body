{
  Node node=this.client.leastLoadedNode();
  if (node == null) {
    return RequestFuture.noBrokersAvailable();
  }
 else {
    log.debug("Issuing consumer metadata request to broker {}",node.id());
    ConsumerMetadataRequest metadataRequest=new ConsumerMetadataRequest(this.groupId);
    return client.send(node,ApiKeys.CONSUMER_METADATA,metadataRequest).compose(new RequestFutureAdapter<ClientResponse,Void>(){
      @Override public void onSuccess(      ClientResponse response,      RequestFuture<Void> future){
        handleConsumerMetadataResponse(response,future);
      }
    }
);
  }
}
