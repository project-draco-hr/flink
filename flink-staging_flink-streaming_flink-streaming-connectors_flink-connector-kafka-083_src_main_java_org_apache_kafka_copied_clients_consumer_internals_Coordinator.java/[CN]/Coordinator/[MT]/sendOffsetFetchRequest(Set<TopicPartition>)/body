{
  if (coordinatorUnknown())   return RequestFuture.coordinatorNotAvailable();
  log.debug("Fetching committed offsets for partitions: {}",Utils.join(partitions,", "));
  OffsetFetchRequest request=new OffsetFetchRequest(this.groupId,new ArrayList<TopicPartition>(partitions));
  return client.send(consumerCoordinator,ApiKeys.OFFSET_FETCH,request).compose(new OffsetFetchResponseHandler());
}
