{
  if (args.length == 3) {
    String infilename=args[0];
    String topicId=args[1];
    String brokerAddr=args[2];
    ProducerPrepare(brokerAddr);
    BufferedReader reader=new BufferedReader(new FileReader(infilename));
    while (true) {
      String line=reader.readLine();
      if (line == null) {
        reader.close();
        reader=new BufferedReader(new FileReader(infilename));
        continue;
      }
      producer.send(new KeyedMessage<Integer,String>(topicId,line));
    }
  }
 else {
    System.out.println("please set filename!");
    System.exit(-1);
  }
}
