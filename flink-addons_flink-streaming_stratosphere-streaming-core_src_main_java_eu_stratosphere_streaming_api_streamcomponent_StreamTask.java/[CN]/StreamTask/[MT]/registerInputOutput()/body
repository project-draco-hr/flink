{
  initialize();
  try {
    setSerializers();
    inputs=getConfigInputs();
    setConfigOutputs(outputs,partitioners);
    setCollector(outputs);
  }
 catch (  StreamComponentException e) {
    if (log.isErrorEnabled()) {
      log.error("Cannot register inputs/outputs for " + getClass().getSimpleName(),e);
    }
  }
  numberOfOutputChannels=new int[outputs.size()];
  for (int i=0; i < numberOfOutputChannels.length; i++) {
    numberOfOutputChannels[i]=configuration.getInteger("channels_" + i,0);
  }
  setInvokable();
}
