{
  TestCollector<StreamWindow<Integer>> collector=new TestCollector<StreamWindow<Integer>>();
  SlidingCountPreReducer<Integer> preReducer=new SlidingCountPreReducer<Integer>(reducer,serializer,5,2,0);
  preReducer.store(1);
  preReducer.store(2);
  preReducer.emitWindow(collector);
  preReducer.store(3);
  preReducer.store(4);
  preReducer.emitWindow(collector);
  preReducer.store(5);
  preReducer.store(6);
  preReducer.evict(1);
  preReducer.emitWindow(collector);
  preReducer.evict(2);
  preReducer.store(7);
  preReducer.store(8);
  preReducer.emitWindow(collector);
  preReducer.evict(2);
  preReducer.store(9);
  preReducer.store(10);
  preReducer.emitWindow(collector);
  preReducer.evict(2);
  preReducer.store(11);
  preReducer.store(12);
  preReducer.emitWindow(collector);
  preReducer.store(13);
  List<StreamWindow<Integer>> expected=new ArrayList<StreamWindow<Integer>>();
  expected.add(StreamWindow.fromElements(3));
  expected.add(StreamWindow.fromElements(10));
  expected.add(StreamWindow.fromElements(20));
  expected.add(StreamWindow.fromElements(30));
  expected.add(StreamWindow.fromElements(40));
  expected.add(StreamWindow.fromElements(50));
  assertEquals(expected,collector.getCollected());
}
