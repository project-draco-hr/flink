{
  try {
switch (this.checkpointingDecision) {
case NO_CHECKPOINTING:
      transferEnvelope.getProcessingLog().setWrittenToCheckpoint();
    return;
case UNDECIDED:
case CHECKPOINTING:
  final ChannelCheckpoint channelCheckpoint=this.channelCheckpoints.get(transferEnvelope.getSource());
if (channelCheckpoint == null) {
  LOG.error("Cannot find output channel with ID " + transferEnvelope.getSource());
  return;
}
if (transferEnvelope.getProcessingLog().mustBeSentViaNetwork()) {
transferEnvelope=transferEnvelope.duplicate();
}
channelCheckpoint.addToCheckpoint(transferEnvelope);
break;
}
}
 catch (IOException ioe) {
ioe.printStackTrace();
LOG.error(ioe);
discardCheckpoint();
}
}
