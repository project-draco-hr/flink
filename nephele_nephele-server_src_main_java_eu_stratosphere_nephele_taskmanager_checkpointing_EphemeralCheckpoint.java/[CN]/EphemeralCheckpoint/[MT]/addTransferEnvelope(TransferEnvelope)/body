{
  try {
switch (this.checkpointingDecision) {
case NO_CHECKPOINTING:
      return;
case UNDECIDED:
    ChannelCheckpoint undeciedChannelCheckpoint=this.channelCheckpoints.get(transferEnvelope.getSource());
  if (undeciedChannelCheckpoint == null) {
    LOG.error("Cannot find output channel with ID " + transferEnvelope.getSource());
    return;
  }
undeciedChannelCheckpoint.addToCheckpoint(transferEnvelope);
break;
case CHECKPOINTING:
final ChannelCheckpoint channelCheckpoint=this.channelCheckpoints.get(transferEnvelope.getSource());
if (channelCheckpoint == null) {
LOG.error("Cannot find output channel with ID " + transferEnvelope.getSource());
return;
}
channelCheckpoint.addToCheckpoint(transferEnvelope);
break;
}
}
 catch (IOException ioe) {
ioe.printStackTrace();
LOG.error(ioe);
discardCheckpoint();
}
}
