{
  int noSubTasks=(args.length > 0 ? Integer.parseInt(args[0]) : 1);
  String dataPointInput=(args.length > 1 ? args[1] : "");
  String clusterInput=(args.length > 2 ? args[2] : "");
  String output=(args.length > 3 ? args[3] : "");
  FileDataSource clusterPoints=new FileDataSource(PointInFormat.class,clusterInput,"Centers");
  clusterPoints.setParameter(DelimitedInputFormat.RECORD_DELIMITER,"\n");
  clusterPoints.setDegreeOfParallelism(1);
  FileDataSource dataPoints=new FileDataSource(PointInFormat.class,dataPointInput,"Data Points");
  dataPoints.setParameter(DelimitedInputFormat.RECORD_DELIMITER,"\n");
  CrossContract computeDistance=new CrossContract(ComputeDistance.class,"Compute Distances");
  computeDistance.setFirstInput(dataPoints);
  computeDistance.getCompilerHints().setAvgBytesPerRecord(48);
  ReduceContract findNearestClusterCenters=new ReduceContract(FindNearestCenter.class,PactInteger.class,0,computeDistance,"Find Nearest Centers");
  findNearestClusterCenters.getCompilerHints().setAvgBytesPerRecord(48);
  ReduceContract recomputeClusterCenter=new ReduceContract(RecomputeClusterCenter.class,PactInteger.class,0,findNearestClusterCenters,"Recompute Center Positions");
  recomputeClusterCenter.getCompilerHints().setAvgBytesPerRecord(36);
  Iteration iter=new Iteration("K-Means Loop");
  iter.setInitialPartialSolution(clusterPoints);
  iter.setNextPartialSolution(recomputeClusterCenter);
  computeDistance.setSecondInput(iter.getPartialSolution());
  MatchContract partialSolutionDiff=new MatchContract(null,null,0,0,"Diff Partial Solutions");
  partialSolutionDiff.setFirstInput(iter.getPartialSolution());
  partialSolutionDiff.setSecondInput(recomputeClusterCenter);
  iter.setTerminationCriterion(partialSolutionDiff);
  FileDataSink newClusterPoints=new FileDataSink(PointOutFormat.class,output,iter,"New Center Positions");
  Plan plan=new Plan(newClusterPoints,"KMeans Iteration");
  plan.setDefaultParallelism(noSubTasks);
  return plan;
}
