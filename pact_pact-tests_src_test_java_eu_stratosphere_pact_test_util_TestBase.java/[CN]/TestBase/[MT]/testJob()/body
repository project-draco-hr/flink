{
  preSubmit();
  JobGraph jobGraph=null;
  try {
    jobGraph=getJobGraph();
  }
 catch (  Exception e) {
    LOG.error(e);
    e.printStackTrace();
    Assert.fail("Failed to obtain JobGraph!");
  }
  try {
    cluster.submitJobAndWait(jobGraph,getJarFilePath());
  }
 catch (  Exception e) {
    LOG.error(e);
    Assert.fail("Job execution failed!");
  }
  postSubmit();
}
