{
  preSubmit();
  JobGraph jobGraph=null;
  try {
    jobGraph=getJobGraph();
  }
 catch (  Exception e) {
    LOG.error(e);
    Assert.fail("Failed to obtain JobGraph!");
  }
  try {
    final JobClient client=cluster.getJobClient(jobGraph,getJarFilePath());
    client.submitJobAndWait();
  }
 catch (  Exception e) {
    LOG.error(e);
    Assert.fail("Job execution failed!");
  }
  postSubmit();
}
