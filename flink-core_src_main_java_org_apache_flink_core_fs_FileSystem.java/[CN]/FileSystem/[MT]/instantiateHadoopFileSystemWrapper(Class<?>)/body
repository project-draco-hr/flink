{
  FileSystem fs=null;
  Class<? extends FileSystem> fsClass;
  try {
    fsClass=ClassUtils.getFileSystemByName(HADOOP_WRAPPER_FILESYSTEM_CLASS);
    Constructor<? extends FileSystem> fsClassCtor=fsClass.getConstructor(Class.class);
    fs=fsClassCtor.newInstance(wrappedFileSystem);
  }
 catch (  Throwable e) {
    throw new IOException("Error loading Hadoop FS wrapper",e);
  }
  return fs;
}
