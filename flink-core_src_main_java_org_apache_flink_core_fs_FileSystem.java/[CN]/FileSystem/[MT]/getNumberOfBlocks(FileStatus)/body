{
  int numberOfBlocks=0;
  if (file == null) {
    return 0;
  }
  if (!file.isDir()) {
    return getNumberOfBlocks(file.getLen(),file.getBlockSize());
  }
  final FileStatus[] files=this.listStatus(file.getPath());
  for (int i=0; i < files.length; i++) {
    if (!files[i].isDir()) {
      numberOfBlocks+=getNumberOfBlocks(files[i].getLen(),files[i].getBlockSize());
    }
  }
  return numberOfBlocks;
}
