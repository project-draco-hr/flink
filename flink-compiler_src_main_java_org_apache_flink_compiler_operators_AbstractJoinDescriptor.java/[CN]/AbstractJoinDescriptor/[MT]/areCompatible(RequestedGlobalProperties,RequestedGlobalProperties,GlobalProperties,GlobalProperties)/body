{
  if (requested1.getPartitioning().isPartitionedOnKey() && requested2.getPartitioning().isPartitionedOnKey()) {
    return produced1.getPartitioning() == produced2.getPartitioning() && (produced1.getCustomPartitioner() == null ? produced2.getCustomPartitioner() == null : produced1.getCustomPartitioner().equals(produced2.getCustomPartitioner()));
  }
 else {
    return true;
  }
}
