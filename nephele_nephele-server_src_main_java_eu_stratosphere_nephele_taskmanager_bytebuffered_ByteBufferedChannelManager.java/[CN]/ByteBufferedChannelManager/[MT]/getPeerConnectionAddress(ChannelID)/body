{
  InetSocketAddress connectionAddress=null;
synchronized (this.connectionAddresses) {
    connectionAddress=this.connectionAddresses.get(sourceChannelID);
  }
  if (connectionAddress == null) {
    ByteBufferedChannelWrapper channelWrapper=null;
synchronized (this.registeredChannels) {
      channelWrapper=this.registeredChannels.get(sourceChannelID);
      if (channelWrapper == null) {
        LOG.error("Cannot find channel object for ID " + sourceChannelID + " to do lookup");
        return null;
      }
    }
    InstanceConnectionInfo ici=null;
    while (!Thread.interrupted()) {
      final ConnectionInfoLookupResponse lookupResponse=this.channelLookupService.lookupConnectionInfo(channelWrapper.getJobID(),sourceChannelID);
      if (lookupResponse.receiverNotFound()) {
        throw new IOException("Task with channel ID " + channelWrapper.getConnectedChannelID() + " does not appear to be running");
      }
      if (lookupResponse.receiverNotReady()) {
        Thread.sleep(500);
        continue;
      }
      if (lookupResponse.receiverReady()) {
        ici=lookupResponse.getInstanceConnectionInfo();
        break;
      }
    }
    if (ici != null) {
      connectionAddress=new InetSocketAddress(ici.getAddress(),ici.getDataPort());
synchronized (this.connectionAddresses) {
        this.connectionAddresses.put(sourceChannelID,connectionAddress);
      }
    }
  }
  return connectionAddress;
}
