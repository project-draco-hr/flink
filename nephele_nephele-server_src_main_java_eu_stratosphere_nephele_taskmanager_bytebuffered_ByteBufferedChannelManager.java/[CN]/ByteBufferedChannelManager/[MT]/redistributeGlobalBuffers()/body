{
  final int totalNumberOfBuffers=GlobalBufferPool.getInstance().getTotalNumberOfBuffers();
synchronized (this.taskMap) {
    if (this.taskMap.isEmpty()) {
      return;
    }
    final int buffersPerTask=(int)Math.ceil((double)totalNumberOfBuffers / (double)this.taskMap.size());
    System.out.println("Buffers per task: " + buffersPerTask);
    final Iterator<TaskContext> it=this.taskMap.values().iterator();
    while (it.hasNext()) {
      it.next().setBufferLimit(buffersPerTask);
    }
  }
}
