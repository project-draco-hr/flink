{
  final int totalNumberOfBuffers=GlobalBufferPool.getInstance().getTotalNumberOfBuffers();
synchronized (this.taskMap) {
    if (this.taskMap.isEmpty()) {
      return;
    }
    final int numberOfTasks=this.taskMap.size() + (this.multicastEnabled ? 1 : 0);
    final int buffersPerTask=(int)Math.ceil((double)totalNumberOfBuffers / (double)numberOfTasks);
    System.out.println("Buffers per task: " + buffersPerTask);
    final Iterator<TaskContext> it=this.taskMap.values().iterator();
    while (it.hasNext()) {
      it.next().setBufferLimit(buffersPerTask);
    }
    if (this.multicastEnabled) {
      this.transitBufferPool.setDesignatedNumberOfBuffers(buffersPerTask);
    }
  }
}
