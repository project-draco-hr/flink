{
  if (System.getenv("HADOOP_CONF_DIR") == null && System.getenv("YARN_CONF_DIR") == null) {
    LOG.warn("Neither the HADOOP_CONF_DIR nor the YARN_CONF_DIR environment variable is set." + "The Flink YARN Client needs one of these to be set to properly load the Hadoop " + "configuration for accessing YARN.");
  }
  final ApplicationId yarnAppId=ConverterUtils.toApplicationId(appId);
  return new FlinkYarnCluster(yarnClient,yarnAppId,conf,flinkConfiguration,sessionFilesDir,detached);
}
