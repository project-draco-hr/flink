{
  String jobManagerHost=config.getString(ConfigConstants.JOB_MANAGER_IPC_ADDRESS_KEY,null);
  int jobManagerPort=config.getInteger(ConfigConstants.JOB_MANAGER_IPC_PORT_KEY,-1);
  if (jobManagerHost != null && jobManagerPort != -1) {
    YarnClient yarnClient=getYarnClient();
    final List<ApplicationReport> applicationReports;
    try {
      applicationReports=yarnClient.getApplications();
    }
 catch (    Exception e) {
      throw new RuntimeException("Couldn't get Yarn application reports",e);
    }
    for (    ApplicationReport report : applicationReports) {
      if (report.getHost().equals(jobManagerHost) && report.getRpcPort() == jobManagerPort) {
        LOG.info("Found application '{}' " + "with JobManager host name '{}' and port '{}' from Yarn properties file.",report.getApplicationId(),jobManagerHost,jobManagerPort);
        return retrieve(report.getApplicationId().toString());
      }
    }
  }
  LOG.warn("Couldn't retrieve Yarn cluster from Flink configuration using JobManager address '{}:{}'",jobManagerHost,jobManagerPort);
  throw new IllegalConfigurationException("Could not resume Yarn cluster from config.");
}
