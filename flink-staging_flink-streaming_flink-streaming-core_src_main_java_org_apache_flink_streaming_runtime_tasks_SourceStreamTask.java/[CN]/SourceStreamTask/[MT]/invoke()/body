{
  final SourceOutput<StreamRecord<OUT>> output=new SourceOutput<StreamRecord<OUT>>(outputHandler.getOutput(),checkpointLock);
  boolean operatorOpen=false;
  if (LOG.isDebugEnabled()) {
    LOG.debug("Task {} invoked",getName());
  }
  try {
    openOperator();
    operatorOpen=true;
    streamOperator.run(checkpointLock,output);
    closeOperator();
    operatorOpen=false;
    if (LOG.isDebugEnabled()) {
      LOG.debug("Task {} invocation finished",getName());
    }
  }
 catch (  Exception e) {
    LOG.error(getEnvironment().getTaskNameWithSubtasks() + " failed",e);
    if (operatorOpen) {
      try {
        closeOperator();
      }
 catch (      Throwable t) {
        LOG.warn("Exception while closing operator.",t);
      }
    }
    throw e;
  }
 finally {
    this.isRunning=false;
    outputHandler.flushOutputs();
    clearBuffers();
  }
}
