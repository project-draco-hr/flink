{
  for (  final Entry<Operator<?>,ElementarySopremoModule> operatorModule : this.modules.entrySet()) {
    final Operator<?> operator=operatorModule.getKey();
    final ElementarySopremoModule module=operatorModule.getValue();
    final Map<JsonStream,JsonStream> operatorInputToModuleOutput=new IdentityHashMap<JsonStream,JsonStream>();
    for (int index=0; index < operator.getInputs().size(); index++) {
      final JsonStream input=traceInput(operator,index);
      operatorInputToModuleOutput.put(module.getInput(index).getOutput(0),input);
    }
    DependencyAwareGraphTraverser.INSTANCE.traverse(module.getAllOutputs(),OperatorNavigator.INSTANCE,new GraphTraverseListener<Operator<?>>(){
      @Override public void nodeTraversed(      final Operator<?> innerNode){
        final List<JsonStream> innerNodeInputs=innerNode.getInputs();
        for (int index=0; index < innerNodeInputs.size(); index++) {
          final JsonStream moduleOutput=operatorInputToModuleOutput.get(innerNodeInputs.get(index));
          if (moduleOutput != null)           innerNodeInputs.set(index,moduleOutput);
        }
        innerNode.setInputs(innerNodeInputs);
      }
    }
);
  }
}
