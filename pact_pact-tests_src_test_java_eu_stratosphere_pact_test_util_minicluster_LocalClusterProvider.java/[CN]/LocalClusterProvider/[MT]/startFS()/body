{
  if (fsIsRunning()) {
    return;
  }
  if (config.getString(Constants.FILESYSTEM_TYPE,"").equals("local_fs")) {
    filesystemProvider=new LocalFSProvider();
  }
 else   if (config.getString(Constants.FILESYSTEM_TYPE,"").equals("mini_hdfs")) {
    filesystemProvider=new MiniDFSProvider();
  }
 else {
    throw new IllegalConfigurationException("Invalid file system type: " + config.getString(Constants.FILESYSTEM_TYPE,""));
  }
  filesystemProvider.start();
  filesystemRunning=true;
}
