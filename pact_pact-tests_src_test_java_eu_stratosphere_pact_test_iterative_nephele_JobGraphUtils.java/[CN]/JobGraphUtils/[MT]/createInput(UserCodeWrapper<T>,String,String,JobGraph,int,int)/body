{
  JobInputVertex inputVertex=new JobInputVertex(name,graph);
  @SuppressWarnings("unchecked") Class<AbstractInputTask<?>> clazz=(Class<AbstractInputTask<?>>)(Class<?>)DataSourceTask.class;
  inputVertex.setInputClass(clazz);
  inputVertex.setNumberOfSubtasks(degreeOfParallelism);
  inputVertex.setNumberOfSubtasksPerInstance(numSubTasksPerInstance);
  TaskConfig inputConfig=new TaskConfig(inputVertex.getConfiguration());
  inputConfig.setStubWrapper(stub);
  if (configPath != null) {
    inputConfig.setStubParameter("pact.input.file.path",configPath);
  }
  return inputVertex;
}
