{
  MessageWithOffset msg;
  while (iterator.hasNext()) {
    msg=iterator.nextWithOffset();
    gotMessage(msg);
    OUT out=schema.deserialize(msg.getMessage());
    collector.collect(out);
    kafkaOffSet.update(msg.getOffset());
  }
}
