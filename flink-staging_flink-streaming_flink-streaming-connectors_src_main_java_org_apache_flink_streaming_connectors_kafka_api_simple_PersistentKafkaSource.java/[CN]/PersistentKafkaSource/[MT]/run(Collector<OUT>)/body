{
  MessageWithMetadata msg;
  while (iterator.hasNext()) {
    msg=iterator.nextWithOffset();
    OUT out=schema.deserialize(msg.getMessage());
    if (schema.isEndOfStream(out)) {
      break;
    }
    collector.collect(out);
    partitions.put(msg.getPartition(),new GivenOffset(msg.getOffset()));
    kafkaOffSet.update(partitions);
  }
}
