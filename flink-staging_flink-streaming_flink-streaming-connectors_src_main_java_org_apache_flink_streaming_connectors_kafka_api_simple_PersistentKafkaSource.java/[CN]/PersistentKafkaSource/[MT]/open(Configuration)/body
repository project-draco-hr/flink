{
  StreamingRuntimeContext context=(StreamingRuntimeContext)getRuntimeContext();
  SimpleState<Long> lastKafkaOffSet=(SimpleState<Long>)context.getState("kafka");
  if (lastKafkaOffSet.getState() == null) {
    kafkaOffSet=new SimpleState<Long>(initialOffset);
  }
 else {
    kafkaOffSet=lastKafkaOffSet;
  }
  checkpointCounter=0;
  super.open(parameters);
}
