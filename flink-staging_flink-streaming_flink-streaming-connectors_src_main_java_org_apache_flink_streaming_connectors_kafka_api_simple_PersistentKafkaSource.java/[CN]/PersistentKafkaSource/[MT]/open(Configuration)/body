{
  StreamingRuntimeContext context=(StreamingRuntimeContext)getRuntimeContext();
  @SuppressWarnings("unchecked") OperatorState<Long> lastKafkaOffSet=(OperatorState<Long>)context.getState("kafka");
  if (lastKafkaOffSet.getState() == null) {
    kafkaOffSet=new OperatorState<Long>(initialOffset);
    context.registerState("kafka",kafkaOffSet);
  }
 else {
    kafkaOffSet=lastKafkaOffSet;
  }
  super.open(parameters);
}
