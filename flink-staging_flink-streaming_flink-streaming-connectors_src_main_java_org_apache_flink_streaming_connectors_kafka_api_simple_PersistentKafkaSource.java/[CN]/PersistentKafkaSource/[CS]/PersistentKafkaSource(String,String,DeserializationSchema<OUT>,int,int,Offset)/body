{
  super(deserializationSchema);
  Preconditions.checkNotNull(zookeeperAddress,"The Zookeeper address can not be null");
  Preconditions.checkNotNull(topicId,"The topic id can not be null");
  Preconditions.checkNotNull(deserializationSchema,"The deserialization schema can not be null");
  Preconditions.checkArgument(zookeeperSyncTimeMillis > 0,"The sync time must be positive");
  Preconditions.checkArgument(waitOnEmptyFetchMillis > 0,"The wait time must be positive");
  this.topicId=topicId;
  this.zookeeperServerAddress=zookeeperAddress;
switch (startOffsetType) {
case FROM_BEGINNING:
    this.startingOffset=new BeginningOffset();
  break;
case FROM_CURRENT:
this.startingOffset=new CurrentOffset();
break;
default :
this.startingOffset=new CurrentOffset();
break;
}
this.zookeeperSyncTimeMillis=zookeeperSyncTimeMillis;
this.waitOnEmptyFetchMillis=waitOnEmptyFetchMillis;
}
