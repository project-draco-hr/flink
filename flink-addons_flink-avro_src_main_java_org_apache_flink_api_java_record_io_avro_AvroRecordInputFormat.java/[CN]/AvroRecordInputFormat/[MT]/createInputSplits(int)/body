{
  int numAvroFiles=0;
  final Path path=this.filePath;
  final FileSystem fs=path.getFileSystem();
  final FileStatus pathFile=fs.getFileStatus(path);
  if (!acceptFile(pathFile)) {
    throw new IOException("The given file does not pass the file-filter");
  }
  if (pathFile.isDir()) {
    final FileStatus[] dir=fs.listStatus(path);
    for (int i=0; i < dir.length; i++) {
      if (!dir[i].isDir() && acceptFile(dir[i])) {
        numAvroFiles++;
      }
    }
  }
 else {
    numAvroFiles=1;
  }
  return super.createInputSplits(numAvroFiles);
}
