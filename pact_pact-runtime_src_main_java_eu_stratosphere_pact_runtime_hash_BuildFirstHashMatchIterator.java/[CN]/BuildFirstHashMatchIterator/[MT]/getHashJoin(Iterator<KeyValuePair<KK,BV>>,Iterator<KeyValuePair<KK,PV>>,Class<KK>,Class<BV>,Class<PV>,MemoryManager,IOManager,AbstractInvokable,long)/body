{
  totalMemory&=~(((long)HASH_JOIN_PAGE_SIZE) - 1);
  final int numPages=(int)(totalMemory / HASH_JOIN_PAGE_SIZE);
  final List<MemorySegment> memorySegments=memManager.allocate(ownerTask,totalMemory,numPages,HASH_JOIN_PAGE_SIZE);
  return new HashJoin<KK,BV,PV>(buildSideInput,probeSideInput,keyClass,buildSideValueClass,probeSideValueClass,memorySegments,ioManager);
}
