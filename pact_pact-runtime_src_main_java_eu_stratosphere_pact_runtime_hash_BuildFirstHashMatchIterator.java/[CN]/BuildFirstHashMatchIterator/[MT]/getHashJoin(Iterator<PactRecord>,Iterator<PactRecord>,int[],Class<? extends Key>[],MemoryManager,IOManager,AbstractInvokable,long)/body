{
  totalMemory&=~(((long)HASH_JOIN_PAGE_SIZE) - 1);
  final int numPages=(int)(totalMemory / HASH_JOIN_PAGE_SIZE);
  final List<MemorySegment> memorySegments=memManager.allocateStrict(ownerTask,numPages,HASH_JOIN_PAGE_SIZE);
  return new HashJoin(buildSideInput,probeSideInput,keyFields,keyClasses,memorySegments,ioManager);
}
