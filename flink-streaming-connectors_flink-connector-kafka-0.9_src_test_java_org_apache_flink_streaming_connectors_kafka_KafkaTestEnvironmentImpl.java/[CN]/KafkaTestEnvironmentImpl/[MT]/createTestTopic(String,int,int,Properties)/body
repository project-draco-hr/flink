{
  LOG.info("Creating topic {}",topic);
  ZkUtils zkUtils=getZkUtils();
  try {
    AdminUtils.createTopic(zkUtils,topic,numberOfPartitions,replicationFactor,topicConfig);
  }
  finally {
    zkUtils.close();
  }
  final long deadline=System.currentTimeMillis() + 30000;
  do {
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException e) {
    }
    ZkUtils checkZKConn=getZkUtils();
    if (AdminUtils.topicExists(checkZKConn,topic)) {
      checkZKConn.close();
      return;
    }
    checkZKConn.close();
  }
 while (System.currentTimeMillis() < deadline);
  fail("Test topic could not be created");
}
