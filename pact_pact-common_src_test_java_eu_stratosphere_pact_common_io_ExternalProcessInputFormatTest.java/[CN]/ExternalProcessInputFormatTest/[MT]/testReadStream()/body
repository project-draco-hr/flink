{
  Configuration config=new Configuration();
  ExternalProcessInputSplit split=new ExternalProcessInputSplit(1,this.thousandRecordsCommand);
  PactRecord record=new PactRecord();
  int cnt=0;
  try {
    format.configure(config);
    format.open(split);
    while (!format.reachedEnd()) {
      if (format.nextRecord(record)) {
        cnt++;
      }
    }
    format.close();
  }
 catch (  IOException e) {
    Assert.fail();
  }
catch (  RuntimeException e) {
    Assert.fail(e.getMessage());
  }
  Assert.assertTrue("Expected read count was 1000, actual read count was " + cnt,cnt == 1000);
}
