{
  int numberOfOutputs=configuration.getInteger("numberOfOutputs",0);
  for (int i=0; i < numberOfOutputs; i++) {
    setPartitioner(i,partitioners);
    ChannelSelector<StreamRecord> outputPartitioner=partitioners.get(i);
    outputs.add(new RecordWriter<StreamRecord>(this,outputPartitioner));
    if (outputsPartitioned.size() < batchSizesPartitioned.size()) {
      outputsPartitioned.add(outputs.get(i));
    }
 else {
      outputsNotPartitioned.add(outputs.get(i));
    }
  }
}
