{
  @SuppressWarnings("unchecked") CsvInputFormat pointsInFormat=new CsvInputFormat('|',IntValue.class,DoubleValue.class,DoubleValue.class,DoubleValue.class);
  InputFormatInputVertex pointsInput=JobGraphUtils.createInput(pointsInFormat,pointsPath,"[Points]",jobGraph,numSubTasks);
{
    TaskConfig taskConfig=new TaskConfig(pointsInput.getConfiguration());
    taskConfig.addOutputShipStrategy(ShipStrategyType.FORWARD);
    taskConfig.setOutputSerializer(serializer);
    TaskConfig chainedMapper=new TaskConfig(new Configuration());
    chainedMapper.setDriverStrategy(DriverStrategy.COLLECTOR_MAP);
    chainedMapper.setStubWrapper(new UserCodeObjectWrapper<PointBuilder>(new PointBuilder()));
    chainedMapper.addOutputShipStrategy(ShipStrategyType.FORWARD);
    chainedMapper.setOutputSerializer(serializer);
    taskConfig.addChainedTask(ChainedCollectorMapDriver.class,chainedMapper,"Build points");
  }
  return pointsInput;
}
