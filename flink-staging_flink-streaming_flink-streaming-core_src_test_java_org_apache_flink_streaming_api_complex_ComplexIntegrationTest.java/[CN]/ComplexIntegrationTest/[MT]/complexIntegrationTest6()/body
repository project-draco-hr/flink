{
  expected1="(6,(a,6))\n" + "(6,(b,3))\n" + "(6,(c,4))\n"+ "(6,(d,2))\n"+ "(6,(f,2))\n"+ "(7,(a,1))\n"+ "(7,(b,2))\n"+ "(7,(c,3))\n"+ "(7,(d,1))\n"+ "(7,(e,1))\n"+ "(7,(f,1))\n"+ "(8,(a,6))\n"+ "(8,(b,4))\n"+ "(8,(c,5))\n"+ "(8,(d,1))\n"+ "(8,(e,2))\n"+ "(8,(f,2))\n"+ "(9,(a,4))\n"+ "(9,(b,4))\n"+ "(9,(c,7))\n"+ "(9,(d,3))\n"+ "(9,(e,1))\n"+ "(9,(f,2))\n"+ "(10,(a,3))\n"+ "(10,(b,2))\n"+ "(10,(c,3))\n"+ "(10,(d,2))\n"+ "(10,(e,1))\n"+ "(10,(f,1))";
  expected2="[a, a, c, c, d, f]\n" + "[a, b, b, d]\n" + "[a, a, a, b, c, c, f]\n"+ "[a, d, e]\n"+ "[b, b, c, c, c, f]\n"+ "[a, a, a, a, b, b, c, c, e]\n"+ "[a, a, b, b, c, c, c, d, e, f, f]\n"+ "[a, a, a, b, c, c, c, d, d, f]\n"+ "[a, b, b, b, c, c, c, c, d, e, f]\n"+ "[a, a, a, b, b, c, c, c, d, d, e, f]";
  SimpleDateFormat ft=new SimpleDateFormat("dd-MM-yyyy");
  ArrayList<Tuple2<Date,HashMap<Character,Integer>>> sales=new ArrayList<>();
  HashMap<Character,Integer> sale1=new HashMap<>();
  sale1.put('a',2);
  sale1.put('c',2);
  sale1.put('d',1);
  sale1.put('f',1);
  sales.add(new Tuple2<>(ft.parse("03-06-2014"),sale1));
  HashMap<Character,Integer> sale2=new HashMap<>();
  sale2.put('a',1);
  sale2.put('b',2);
  sale2.put('d',1);
  sales.add(new Tuple2<>(ft.parse("10-06-2014"),sale2));
  HashMap<Character,Integer> sale3=new HashMap<>();
  sale3.put('a',3);
  sale3.put('b',1);
  sale3.put('c',2);
  sale3.put('f',1);
  sales.add(new Tuple2<>(ft.parse("29-06-2014"),sale3));
  HashMap<Character,Integer> sale4=new HashMap<>();
  sale4.put('a',1);
  sale4.put('d',1);
  sale4.put('e',1);
  sales.add(new Tuple2<>(ft.parse("15-07-2014"),sale4));
  HashMap<Character,Integer> sale5=new HashMap<>();
  sale5.put('b',2);
  sale5.put('c',3);
  sale5.put('f',1);
  sales.add(new Tuple2<>(ft.parse("24-07-2014"),sale5));
  HashMap<Character,Integer> sale6=new HashMap<>();
  sale6.put('a',4);
  sale6.put('b',2);
  sale6.put('c',2);
  sale6.put('e',1);
  sales.add(new Tuple2<>(ft.parse("17-08-2014"),sale6));
  HashMap<Character,Integer> sale7=new HashMap<>();
  sale7.put('a',2);
  sale7.put('b',2);
  sale7.put('c',3);
  sale7.put('d',1);
  sale7.put('e',1);
  sale7.put('f',2);
  sales.add(new Tuple2<>(ft.parse("27-08-2014"),sale7));
  HashMap<Character,Integer> sale8=new HashMap<>();
  sale8.put('a',3);
  sale8.put('b',1);
  sale8.put('c',3);
  sale8.put('d',2);
  sale8.put('f',1);
  sales.add(new Tuple2<>(ft.parse("16-09-2014"),sale8));
  HashMap<Character,Integer> sale9=new HashMap<>();
  sale9.put('a',1);
  sale9.put('b',3);
  sale9.put('c',4);
  sale9.put('d',1);
  sale9.put('e',1);
  sale9.put('f',1);
  sales.add(new Tuple2<>(ft.parse("25-09-2014"),sale9));
  HashMap<Character,Integer> sale10=new HashMap<>();
  sale10.put('a',3);
  sale10.put('b',2);
  sale10.put('c',3);
  sale10.put('d',2);
  sale10.put('e',1);
  sale10.put('f',1);
  sales.add(new Tuple2<>(ft.parse("01-10-2014"),sale10));
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.getConfig().enableTimestamps();
  DataStream<Tuple2<Date,HashMap<Character,Integer>>> sourceStream6=env.fromCollection(sales);
  sourceStream6.assignTimestamps(new Timestamp6()).timeWindowAll(Time.of(1,TimeUnit.MILLISECONDS)).reduce(new SalesReduceFunction()).flatMap(new FlatMapFunction6()).writeAsText(resultPath1,FileSystem.WriteMode.OVERWRITE);
  sourceStream6.map(new MapFunction6()).writeAsText(resultPath2,FileSystem.WriteMode.OVERWRITE);
  env.execute();
}
