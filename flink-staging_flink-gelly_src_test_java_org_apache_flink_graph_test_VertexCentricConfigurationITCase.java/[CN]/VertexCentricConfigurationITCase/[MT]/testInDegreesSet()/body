{
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  Graph<Long,Long,Long> graph=Graph.fromCollection(TestGraphUtils.getLongLongVertices(),TestGraphUtils.getLongLongEdges(),env);
  VertexCentricConfiguration parameters=new VertexCentricConfiguration();
  parameters.setOptDegrees(true);
  DataSet<Vertex<Long,Long>> verticesWithDegrees=graph.runVertexCentricIteration(new UpdateFunctionInDegrees(),new DegreesMessageFunction(),5,parameters).getVertices();
  List<Vertex<Long,Long>> result=verticesWithDegrees.collect();
  expectedResult="1,1\n" + "2,1\n" + "3,2\n"+ "4,1\n"+ "5,2";
  CompareResults.compareResultAsTuples(result,expectedResult);
}
