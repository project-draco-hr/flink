{
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  Graph<Long,Boolean,Long> graph=Graph.fromCollection(TestGraphUtils.getLongBooleanVertices(),TestGraphUtils.getLongLongEdges(),env);
  IterationConfiguration parameters=new IterationConfiguration();
  parameters.setOptDegrees(true);
  parameters.setDirection(EdgeDirection.ALL);
  DataSet<Vertex<Long,Boolean>> verticesWithNumNeighbors=graph.runVertexCentricIteration(new VertexUpdateNumNeighbors(),new IdMessenger(),1,parameters).getVertices();
  verticesWithNumNeighbors.writeAsCsv(resultPath,"\n","\t");
  env.execute();
  expectedResult="1	true\n" + "2	true\n" + "3	true\n"+ "4	true\n"+ "5	true";
}
