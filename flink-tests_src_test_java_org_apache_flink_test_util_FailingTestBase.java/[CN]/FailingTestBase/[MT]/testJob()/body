{
  startCluster();
  try {
    try {
      preSubmit();
    }
 catch (    Exception e) {
      System.err.println(e.getMessage());
      e.printStackTrace();
      Assert.fail("Pre-submit work caused an error: " + e.getMessage());
    }
    SubmissionThread st=new SubmissionThread(Thread.currentThread(),this.executor,getFailingJobGraph(),getJobGraph());
    st.start();
    try {
      Thread.sleep(getTimeout() * 1000);
      Assert.fail("Failing job and successful job did not fail.");
    }
 catch (    InterruptedException ie) {
    }
    Exception cte=st.error;
    if (cte != null) {
      cte.printStackTrace();
      Assert.fail("Task Canceling failed: " + cte.getMessage());
    }
    try {
      postSubmit();
    }
 catch (    Exception e) {
      System.err.println(e.getMessage());
      e.printStackTrace();
      Assert.fail("Post-submit work caused an error: " + e.getMessage());
    }
  }
  finally {
    stopCluster();
  }
}
