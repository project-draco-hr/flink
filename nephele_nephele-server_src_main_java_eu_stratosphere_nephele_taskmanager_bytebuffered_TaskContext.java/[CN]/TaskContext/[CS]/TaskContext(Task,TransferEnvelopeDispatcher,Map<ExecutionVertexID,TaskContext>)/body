{
  this.localBufferPool=new LocalBufferPool(1,false,this);
  this.task=task;
  final Environment environment=task.getEnvironment();
  int nooc=0;
  boolean ephemeral=true;
  for (int i=0; i < environment.getNumberOfOutputGates(); ++i) {
    final OutputGate<? extends Record> outputGate=environment.getOutputGate(i);
    nooc+=outputGate.getNumberOfOutputChannels();
    if (outputGate.getChannelType() == ChannelType.FILE) {
      ephemeral=false;
    }
  }
  this.numberOfOutputChannels=nooc;
  this.forwardTransferEnvelopes=ephemeral;
  this.ephemeralCheckpoint=new EphemeralCheckpoint(task,ephemeral);
  if (ephemeral) {
    tasksWithUndecidedCheckpoints.put(task.getVertexID(),this);
  }
  this.transferEnvelopeDispatcher=transferEnvelopeDispatcher;
  this.subEventListener=new AsynchronousEventListener[environment.getNumberOfOutputGates()];
}
