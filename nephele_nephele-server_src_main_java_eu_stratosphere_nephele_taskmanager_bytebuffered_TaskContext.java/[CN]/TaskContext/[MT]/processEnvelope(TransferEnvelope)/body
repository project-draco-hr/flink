{
  if (!this.ephemeralCheckpoint.isDiscarded()) {
    final TransferEnvelope dup=outgoingTransferEnvelope.duplicate();
    this.ephemeralCheckpoint.addTransferEnvelope(dup);
  }
  if (this.forwardTransferEnvelopes) {
    this.transferEnvelopeDispatcher.processEnvelopeFromOutputChannel(outgoingTransferEnvelope);
  }
 else {
    final Buffer buffer=outgoingTransferEnvelope.getBuffer();
    if (buffer != null) {
      buffer.recycleBuffer();
    }
  }
}
