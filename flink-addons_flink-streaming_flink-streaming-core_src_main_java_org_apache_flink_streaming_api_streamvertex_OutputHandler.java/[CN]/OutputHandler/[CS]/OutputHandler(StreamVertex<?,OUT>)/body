{
  this.vertex=vertex;
  this.configuration=new StreamConfig(vertex.getTaskConfiguration());
  this.chainedInvokables=new ArrayList<ChainableInvokable<?,?>>();
  this.outputMap=new HashMap<String,StreamOutput<?>>();
  this.cl=vertex.getUserCodeClassLoader();
  this.chainedConfigs=configuration.getTransitiveChainedTaskConfigs(cl);
  this.recordWriterOrder=configuration.getRecordWriterOrder(cl);
  for (  String outName : configuration.getOutputs(cl)) {
    StreamOutput<?> streamOutput=createStreamOutput(outName,configuration);
    outputMap.put(outName,streamOutput);
  }
  if (chainedConfigs != null) {
    for (    StreamConfig config : chainedConfigs.values()) {
      for (      String outName : config.getOutputs(cl)) {
        StreamOutput<?> streamOutput=createStreamOutput(outName,config);
        outputMap.put(outName,streamOutput);
      }
    }
  }
  this.outerCollector=createChainedCollector(configuration);
}
