{
  this.vertex=vertex;
  this.configuration=new StreamConfig(vertex.getTaskConfiguration());
  this.chainedInvokables=new ArrayList<ChainableInvokable<?,?>>();
  this.outputMap=new HashMap<String,StreamOutput<?>>();
  this.cl=vertex.getUserCodeClassLoader();
  this.chainedConfigs=configuration.getTransitiveChainedTaskConfigs(cl);
  this.chainedConfigs.put(configuration.getTaskName(),configuration);
  this.outEdgesInOrder=configuration.getOutEdgesInOrder(cl);
  for (  Tuple2<String,String> outEdge : outEdgesInOrder) {
    StreamOutput<?> streamOutput=createStreamOutput(outEdge.f1,chainedConfigs.get(outEdge.f0),outEdgesInOrder.indexOf(outEdge));
    outputMap.put(outEdge.f1,streamOutput);
  }
  this.outerCollector=createChainedCollector(configuration);
}
