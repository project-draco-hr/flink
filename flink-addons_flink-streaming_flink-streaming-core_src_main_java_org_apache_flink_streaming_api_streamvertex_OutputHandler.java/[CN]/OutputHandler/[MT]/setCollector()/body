{
  if (streamVertex.configuration.getDirectedEmit()) {
    OutputSelector<OUT> outputSelector=streamVertex.configuration.getOutputSelector(streamVertex.userClassLoader);
    collector=new DirectedOutputWrapper<OUT>(streamVertex.getInstanceID(),outSerializationDelegate,outputSelector);
  }
 else {
    collector=new StreamOutputWrapper<OUT>(streamVertex.getInstanceID(),outSerializationDelegate);
  }
  return collector;
}
