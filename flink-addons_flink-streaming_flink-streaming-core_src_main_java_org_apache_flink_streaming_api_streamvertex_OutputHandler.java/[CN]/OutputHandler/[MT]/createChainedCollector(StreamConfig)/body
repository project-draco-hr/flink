{
  CollectorWrapper<OUT> wrapper=new CollectorWrapper<OUT>();
  if (chainedTaskConfig.getNumberOfOutputs() > 0) {
    wrapper.addCollector((Collector<OUT>)createNetworkCollector(chainedTaskConfig));
  }
  for (  String output : chainedTaskConfig.getChainedOutputs(cl)) {
    wrapper.addCollector(createChainedCollector(chainedConfigs.get(output)));
  }
  if (chainedTaskConfig.isChainStart()) {
    return wrapper;
  }
 else {
    ChainableInvokable chainableInvokable=chainedTaskConfig.getUserInvokable(vertex.getUserCodeClassLoader());
    chainableInvokable.setup(wrapper,chainedTaskConfig.getTypeSerializerIn1(vertex.getUserCodeClassLoader()));
    chainedInvokables.add(chainableInvokable);
    return chainableInvokable;
  }
}
