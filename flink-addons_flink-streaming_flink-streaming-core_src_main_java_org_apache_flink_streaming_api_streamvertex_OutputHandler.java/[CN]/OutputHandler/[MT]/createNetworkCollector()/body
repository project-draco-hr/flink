{
  createOutSerializer();
  StreamOutputWrapper<OUT> collector;
  if (vertex.configuration.isDirectedEmit()) {
    OutputSelector<OUT> outputSelector=vertex.configuration.getOutputSelector(vertex.userClassLoader);
    collector=new DirectedOutputWrapper<OUT>(vertex.getInstanceID(),outSerializationDelegate,outputSelector);
  }
 else {
    collector=new StreamOutputWrapper<OUT>(vertex.getInstanceID(),outSerializationDelegate);
  }
  int numberOfOutputs=configuration.getNumberOfOutputs();
  for (int i=0; i < numberOfOutputs; i++) {
    collector=(StreamOutputWrapper<OUT>)addStreamOutput(i,collector);
  }
  return collector;
}
