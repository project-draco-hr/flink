{
  if (numberOfChainedTasks == chainedTaskIndex) {
    return createEndCollector();
  }
 else {
    CollectorWrapper<OUT> chainedCollector=new CollectorWrapper<OUT>();
    @SuppressWarnings("rawtypes") ChainableInvokable chainableInvokable=configuration.getChainedInvokable(chainedTaskIndex,streamVertex.getUserCodeClassLoader());
    chainableInvokable.setup(createChainedOutputs(chainedTaskIndex + 1),configuration.getChainedInSerializer(chainedTaskIndex,streamVertex.getUserCodeClassLoader()));
    chainedInvokables.add(chainableInvokable);
    chainedCollector.addChainedOutput((Collector<OUT>)chainableInvokable);
    return chainedCollector;
  }
}
