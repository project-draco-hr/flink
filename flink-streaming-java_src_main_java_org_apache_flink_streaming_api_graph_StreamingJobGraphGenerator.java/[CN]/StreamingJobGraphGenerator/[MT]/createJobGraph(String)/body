{
  jobGraph=new JobGraph(streamGraph.getJobName());
  jobGraph.setScheduleMode(ScheduleMode.ALL);
  init();
  Map<Integer,byte[]> hashes=traverseStreamGraphAndGenerateHashes();
  setChaining(hashes);
  setPhysicalEdges();
  setSlotSharing();
  configureCheckpointing();
  configureExecutionRetries();
  configureExecutionRetryDelay();
  try {
    InstantiationUtil.writeObjectToConfig(this.streamGraph.getExecutionConfig(),this.jobGraph.getJobConfiguration(),ExecutionConfig.CONFIG_KEY);
  }
 catch (  IOException e) {
    throw new RuntimeException("Config object could not be written to Job Configuration: ",e);
  }
  return jobGraph;
}
