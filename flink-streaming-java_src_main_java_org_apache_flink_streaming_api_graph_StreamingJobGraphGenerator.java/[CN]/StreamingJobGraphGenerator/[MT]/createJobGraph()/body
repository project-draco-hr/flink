{
  jobGraph=new JobGraph(streamGraph.getJobName(),streamGraph.getExecutionConfig());
  jobGraph.setScheduleMode(ScheduleMode.ALL);
  init();
  Map<Integer,byte[]> hashes=traverseStreamGraphAndGenerateHashes();
  setChaining(hashes);
  setPhysicalEdges();
  setSlotSharing();
  configureCheckpointing();
  try {
    jobGraph.getExecutionConfig().serializeUserCode();
  }
 catch (  IOException e) {
    throw new IllegalStateException("Could not serialize ExecutionConfig.",e);
  }
  return jobGraph;
}
