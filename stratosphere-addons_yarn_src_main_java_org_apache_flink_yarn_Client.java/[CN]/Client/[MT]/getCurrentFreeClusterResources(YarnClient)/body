{
  ClusterResourceDescription crd=new ClusterResourceDescription();
  crd.totalFreeMemory=0;
  crd.containerLimit=0;
  List<NodeReport> nodes=yarnClient.getNodeReports(NodeState.RUNNING);
  for (  NodeReport rep : nodes) {
    int free=rep.getCapability().getMemory() - (rep.getUsed() != null ? rep.getUsed().getMemory() : 0);
    crd.totalFreeMemory+=free;
    if (free > crd.containerLimit) {
      crd.containerLimit=free;
    }
  }
  return crd;
}
