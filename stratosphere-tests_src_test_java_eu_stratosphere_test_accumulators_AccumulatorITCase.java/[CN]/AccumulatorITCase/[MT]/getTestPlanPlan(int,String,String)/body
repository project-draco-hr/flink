{
  FileDataSource source=new FileDataSource(new TextInputFormat(),input,"Input Lines");
  source.setParameter(TextInputFormat.CHARSET_NAME,"ASCII");
  MapOperator mapper=MapOperator.builder(new TokenizeLine()).input(source).name("Tokenize Lines").build();
  ReduceOperator reducer=ReduceOperator.builder(CountWords.class,StringValue.class,0).input(mapper).name("Count Words").build();
  @SuppressWarnings("unchecked") FileDataSink out=new FileDataSink(new CsvOutputFormat("\n"," ",StringValue.class,IntValue.class),output,reducer,"Word Counts");
  Plan plan=new Plan(out,"WordCount Example");
  plan.setDefaultParallelism(numSubTasks);
  return plan;
}
