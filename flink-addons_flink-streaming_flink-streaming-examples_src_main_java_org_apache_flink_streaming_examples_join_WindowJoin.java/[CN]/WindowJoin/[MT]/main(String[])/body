{
  if (!parseParameters(args)) {
    return;
  }
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  DataStream<Tuple2<String,Integer>> grades=env.addSource(new GradeSource());
  DataStream<Tuple2<String,Integer>> salaries=env.addSource(new SalarySource());
  DataStream<Tuple2<Tuple2<String,Integer>,Tuple2<String,Integer>>> joinedStream=grades.join(salaries).onWindow(1000).where(0).equalTo(0).withDefault();
  if (fileOutput) {
    joinedStream.writeAsText(outputPath,1);
  }
 else {
    joinedStream.print();
  }
  env.execute("Windowed Join Example");
}
