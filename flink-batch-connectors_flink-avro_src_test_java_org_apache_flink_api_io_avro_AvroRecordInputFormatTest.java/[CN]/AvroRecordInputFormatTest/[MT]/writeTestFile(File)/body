{
  ArrayList<CharSequence> stringArray=new ArrayList<CharSequence>();
  stringArray.add(TEST_ARRAY_STRING_1);
  stringArray.add(TEST_ARRAY_STRING_2);
  ArrayList<Boolean> booleanArray=new ArrayList<Boolean>();
  booleanArray.add(TEST_ARRAY_BOOLEAN_1);
  booleanArray.add(TEST_ARRAY_BOOLEAN_2);
  HashMap<CharSequence,Long> longMap=new HashMap<CharSequence,Long>();
  longMap.put(TEST_MAP_KEY1,TEST_MAP_VALUE1);
  longMap.put(TEST_MAP_KEY2,TEST_MAP_VALUE2);
  Address addr=new Address();
  addr.setNum(new Integer(TEST_NUM));
  addr.setStreet(TEST_STREET);
  addr.setCity(TEST_CITY);
  addr.setState(TEST_STATE);
  addr.setZip(TEST_ZIP);
  User user1=new User();
  user1.setName(TEST_NAME);
  user1.setFavoriteNumber(256);
  user1.setTypeDoubleTest(123.45d);
  user1.setTypeBoolTest(true);
  user1.setTypeArrayString(stringArray);
  user1.setTypeArrayBoolean(booleanArray);
  user1.setTypeEnum(TEST_ENUM_COLOR);
  user1.setTypeMap(longMap);
  user1.setTypeNested(addr);
  User user2=User.newBuilder().setName("Charlie").setFavoriteColor("blue").setFavoriteNumber(null).setTypeBoolTest(false).setTypeDoubleTest(1.337d).setTypeNullTest(null).setTypeLongTest(1337L).setTypeArrayString(new ArrayList<CharSequence>()).setTypeArrayBoolean(new ArrayList<Boolean>()).setTypeNullableArray(null).setTypeEnum(Colors.RED).setTypeMap(new HashMap<CharSequence,Long>()).setTypeFixed(null).setTypeUnion(null).setTypeNested(Address.newBuilder().setNum(TEST_NUM).setStreet(TEST_STREET).setCity(TEST_CITY).setState(TEST_STATE).setZip(TEST_ZIP).build()).build();
  DatumWriter<User> userDatumWriter=new SpecificDatumWriter<User>(User.class);
  DataFileWriter<User> dataFileWriter=new DataFileWriter<User>(userDatumWriter);
  dataFileWriter.create(user1.getSchema(),testFile);
  dataFileWriter.append(user1);
  dataFileWriter.append(user2);
  dataFileWriter.close();
}
