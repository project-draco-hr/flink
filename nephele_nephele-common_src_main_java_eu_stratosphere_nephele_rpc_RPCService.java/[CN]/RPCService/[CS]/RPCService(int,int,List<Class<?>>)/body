{
  this.rpcHandlers=Executors.newFixedThreadPool(numRPCHandlers);
  if (typesToRegister == null) {
    this.kryoTypesToRegister=null;
  }
 else {
    ArrayList<Class<?>> kryoTypesToRegister=new ArrayList<Class<?>>();
    addBasicRPCTypes(kryoTypesToRegister);
    kryoTypesToRegister.addAll(typesToRegister);
    this.kryoTypesToRegister=Collections.unmodifiableList(kryoTypesToRegister);
  }
  this.rpcPort=rpcPort;
  this.socket=new DatagramSocket(rpcPort);
  this.receiverThread=new ReceiverThread(this,this.socket);
  this.receiverThread.start();
  this.cleanupTimer.schedule(new CleanupTask(),CLEANUP_INTERVAL,CLEANUP_INTERVAL);
}
