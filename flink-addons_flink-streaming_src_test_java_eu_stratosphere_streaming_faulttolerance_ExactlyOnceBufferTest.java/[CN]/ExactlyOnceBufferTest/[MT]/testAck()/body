{
  StreamRecord record1=new StreamRecord(new StringValue("R1")).setId("1");
  String id=record1.getId();
  buffer.add(record1);
  assertArrayEquals(new int[]{0,1,2,2},buffer.ackCounter.get(id));
  buffer.ack(id,0);
  assertArrayEquals(new int[]{1,0,2,2},buffer.ackCounter.get(id));
  buffer.ack(id,1);
  assertArrayEquals(new int[]{1,0,1,2},buffer.ackCounter.get(id));
  buffer.ack(id,1);
  assertArrayEquals(new int[]{2,0,0,2},buffer.ackCounter.get(id));
  buffer.ack(id,2);
  buffer.ack(id,2);
  assertFalse(buffer.ackCounter.containsKey(id));
}
