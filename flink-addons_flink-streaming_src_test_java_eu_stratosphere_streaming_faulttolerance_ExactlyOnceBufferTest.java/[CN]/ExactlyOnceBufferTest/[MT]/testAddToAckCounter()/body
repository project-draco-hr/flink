{
  StreamRecord record1=new ArrayStreamRecord(1).setTuple(0,new Tuple1<String>("R1")).setId(1);
  buffer.addToAckCounter(record1.getId());
  assertArrayEquals(new int[]{0,1,2,2},buffer.ackCounter.get(record1.getId()));
  StreamRecord record2=new ArrayStreamRecord(1).setTuple(0,new Tuple1<String>("R2")).setId(1);
  buffer.addToAckCounter(record2.getId(),1);
  int[] acks=buffer.ackCounter.get(record2.getId());
  assertArrayEquals(new int[]{2,0,2,0},acks);
  StreamRecord record3=new ArrayStreamRecord(1).setTuple(0,new Tuple1<String>("R3")).setId(1);
  buffer.addToAckCounter(record3.getId(),0);
  acks=buffer.ackCounter.get(record3.getId());
  assertArrayEquals(new int[]{2,1,0,0},acks);
}
