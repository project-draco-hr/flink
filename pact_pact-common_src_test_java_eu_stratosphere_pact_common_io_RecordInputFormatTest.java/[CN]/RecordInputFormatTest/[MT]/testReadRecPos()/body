{
  final String fileContent="111|222|333|\n444|555|666|";
  final FileInputSplit split=createTempFile(fileContent);
  final Configuration parameters=new Configuration();
  parameters.setString(RecordInputFormat.FILE_PARAMETER_KEY,"file:///some/file/that/will/not/be/read");
  parameters.setInteger(RecordInputFormat.NUM_FIELDS_PARAMETER,3);
  parameters.setString(RecordInputFormat.RECORD_DELIMITER_PARAMETER,"\n");
  parameters.setString(RecordInputFormat.FIELD_DELIMITER_PARAMETER,"|");
  parameters.setClass(RecordInputFormat.FIELD_PARSER_PARAMETER_PREFIX + 0,DecimalTextIntParser.class);
  parameters.setClass(RecordInputFormat.FIELD_PARSER_PARAMETER_PREFIX + 1,DecimalTextIntParser.class);
  parameters.setClass(RecordInputFormat.FIELD_PARSER_PARAMETER_PREFIX + 2,DecimalTextIntParser.class);
  parameters.setInteger(RecordInputFormat.RECORD_POSITION_PARAMETER_PREFIX + 0,1);
  parameters.setInteger(RecordInputFormat.RECORD_POSITION_PARAMETER_PREFIX + 1,2);
  parameters.setInteger(RecordInputFormat.RECORD_POSITION_PARAMETER_PREFIX + 2,0);
  format.configure(parameters);
  format.open(split);
  PactRecord record=new PactRecord();
  assertTrue(format.nextRecord(record));
  assertEquals(111,record.getField(1,PactInteger.class).getValue());
  assertEquals(222,record.getField(2,PactInteger.class).getValue());
  assertEquals(333,record.getField(0,PactInteger.class).getValue());
  assertTrue(format.nextRecord(record));
  assertEquals(444,record.getField(1,PactInteger.class).getValue());
  assertEquals(555,record.getField(2,PactInteger.class).getValue());
  assertEquals(666,record.getField(0,PactInteger.class).getValue());
  assertFalse(format.nextRecord(record));
  assertTrue(format.reachedEnd());
  parameters.setInteger(RecordInputFormat.RECORD_POSITION_PARAMETER_PREFIX + 0,1);
  parameters.setInteger(RecordInputFormat.RECORD_POSITION_PARAMETER_PREFIX + 1,8);
  parameters.setInteger(RecordInputFormat.RECORD_POSITION_PARAMETER_PREFIX + 2,3);
  format.configure(parameters);
  format.open(split);
  assertTrue(format.nextRecord(record));
  assertEquals(111,record.getField(1,PactInteger.class).getValue());
  assertEquals(222,record.getField(8,PactInteger.class).getValue());
  assertEquals(333,record.getField(3,PactInteger.class).getValue());
  assertTrue(format.nextRecord(record));
  assertEquals(444,record.getField(1,PactInteger.class).getValue());
  assertEquals(555,record.getField(8,PactInteger.class).getValue());
  assertEquals(666,record.getField(3,PactInteger.class).getValue());
  assertFalse(format.nextRecord(record));
  assertTrue(format.reachedEnd());
}
