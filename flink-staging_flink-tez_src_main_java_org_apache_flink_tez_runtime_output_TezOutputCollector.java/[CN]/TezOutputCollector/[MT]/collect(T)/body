{
  for (int i=0; i < numOutputs; i++) {
    KeyValueWriter writer=writers.get(i);
    TezChannelSelector<T> outputEmitter=outputEmitters.get(i);
    int numberOfStreamsInOutput=numberOfStreamsInOutputs.get(i);
    try {
      for (      int channel : outputEmitter.selectChannels(record,numberOfStreamsInOutput)) {
        IntWritable key=new IntWritable(channel);
        writer.write(key,record);
      }
    }
 catch (    IOException e) {
      throw new RuntimeException("Emitting the record caused an I/O exception: " + e.getMessage(),e);
    }
  }
}
