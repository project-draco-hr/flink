{
  if (!currentPageRankIterator.hasNext()) {
    throw new IllegalStateException("No current ");
  }
  PactRecord currentPageRank=currentPageRankIterator.next();
  double rank=0;
  while (partialRanks.hasNext()) {
    PactRecord record=partialRanks.next();
    if (currentPageRank.getField(0,PactLong.class).getValue() != record.getField(0,PactLong.class).getValue()) {
      throw new IllegalStateException();
    }
    rank+=record.getField(1,PactDouble.class).getValue();
  }
  double currentRank=currentPageRank.getField(1,PactDouble.class).getValue();
  double diff=Math.abs(currentRank - rank);
  diffOfPartition+=diff;
  accumulator.setField(0,currentPageRank.getField(0,PactLong.class));
  accumulator.setField(1,new PactDouble(rank));
  collector.collect(accumulator);
}
